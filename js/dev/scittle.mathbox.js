(function(){
shadow$provide[5]=function(l,L,q){q.__esModule=!0;q.useThreestrap=void 0;var x=l(3),r=(0,x.createContext)(null);q["default"]=r;q.useThreestrap=function(){var e=(0,x.useContext)(r);if(!e)throw Error("Threestrap context is not available");return e}};
shadow$provide[6]=function(l,L,q){q.__esModule=!0;var x=l(3),r=l(5);q["default"]=function(e){var g=(0,r.useThreestrap)();(0,x.useEffect)(function(){e.clearColor&&g.renderer.setClearColor(e.clearColor)});return null}};
shadow$provide[7]=function(l,L,q){q.__esModule=!0;var x=l(3),r=l(5),e=["orbit"],g=function(f,k){var m=k.type,p=k.enablePan,z=k.enableRotate,t=k.enableZoom,v=k.onStart,y=k.onEnd;(0,x.useEffect)(function(){if(m==="orbit"&&f.controls){var B=f.controls;p!==void 0&&(B.enablePan=p);t!==void 0&&(B.enableZoom=t);z!==void 0&&(B.enableRotate=z)}},[m,p,z,t,f.controls]);(0,x.useEffect)(function(){if(m!=="orbit"||!f.controls)return function(){};var B=f.controls;v&&B.addEventListener("start",v);return function(){v&&
B.removeEventListener("start",v)}},[m,v,f.controls]);(0,x.useEffect)(function(){if(m!=="orbit"||!f.controls)return function(){};var B=f.controls;y&&B.addEventListener("end",y);return function(){y&&B.removeEventListener("end",y)}},[m,y,f.controls])};q["default"]=function(f){if(!e.includes(f.type))throw Error("Invalid control type ".concat(f.type));var k=(0,r.useThreestrap)();g(k,f);return null}};
shadow$provide[8]=function(l,L,q){L=this&&this.__createBinding||(Object.create?function(r,e,g,f){f===void 0&&(f=g);var k=Object.getOwnPropertyDescriptor(e,g);if(!k||("get"in k?!e.__esModule:k.writable||k.configurable))k={enumerable:!0,get:function(){return e[g]}};Object.defineProperty(r,f,k)}:function(r,e,g,f){f===void 0&&(f=g);r[f]=e[g]});q.__esModule=!0;q.useThreestrap=q.Controls=q.Renderer=void 0;var x=l(6);L(q,x,"default","Renderer");x=l(7);L(q,x,"default","Controls");l=l(5);L(q,l,"useThreestrap")};
shadow$provide[9]=function(l,L,q){q.__esModule=!0;q.useMathbox=void 0;var x=l(3),r=(0,x.createContext)(null);q.useMathbox=function(){var e=(0,x.useContext)(r);if(!e)throw Error("useMathbox must be used within Mathbox or ContainedMathbox");return e};q["default"]=r};
shadow$provide[10]=function(l,L,q){L.exports=function(){this.__data__=[];this.size=0}};
shadow$provide[11]=function(l,L,q){L.exports=function(x,r){return x===r||x!==x&&r!==r}};
shadow$provide[12]=function(l,L,q){var x=l(11);L.exports=function(r,e){for(var g=r.length;g--;)if(x(r[g][0],e))return g;return-1}};
shadow$provide[13]=function(l,L,q){var x=l(12),r=Array.prototype.splice;L.exports=function(e){var g=this.__data__;e=x(g,e);if(e<0)return!1;e==g.length-1?g.pop():r.call(g,e,1);--this.size;return!0}};
shadow$provide[14]=function(l,L,q){var x=l(12);L.exports=function(r){var e=this.__data__;r=x(e,r);return r<0?void 0:e[r][1]}};
shadow$provide[15]=function(l,L,q){var x=l(12);L.exports=function(r){return x(this.__data__,r)>-1}};
shadow$provide[16]=function(l,L,q){var x=l(12);L.exports=function(r,e){var g=this.__data__,f=x(g,r);f<0?(++this.size,g.push([r,e])):g[f][1]=e;return this}};
shadow$provide[17]=function(l,L,q){function x(f){var k=-1,m=f==null?0:f.length;for(this.clear();++k<m;){var p=f[k];this.set(p[0],p[1])}}q=l(10);var r=l(13),e=l(14),g=l(15);l=l(16);x.prototype.clear=q;x.prototype["delete"]=r;x.prototype.get=e;x.prototype.has=g;x.prototype.set=l;L.exports=x};
shadow$provide[18]=function(l,L,q){var x=l(17);L.exports=function(){this.__data__=new x;this.size=0}};
shadow$provide[19]=function(l,L,q){L.exports=function(x){var r=this.__data__;x=r["delete"](x);this.size=r.size;return x}};
shadow$provide[20]=function(l,L,q){L.exports=function(x){return this.__data__.get(x)}};
shadow$provide[21]=function(l,L,q){L.exports=function(x){return this.__data__.has(x)}};
shadow$provide[22]=function(l,L,q,x){L.exports=typeof x=="object"&&x&&x.Object===Object&&x};
shadow$provide[23]=function(l,L,q){l=l(22);q=typeof self=="object"&&self&&self.Object===Object&&self;l=l||q||Function("return this")();L.exports=l};
shadow$provide[24]=function(l,L,q){l=l(23).Symbol;L.exports=l};
shadow$provide[25]=function(l,L,q){l=l(24);q=Object.prototype;var x=q.hasOwnProperty,r=q.toString,e=l?l.toStringTag:void 0;L.exports=function(g){var f=x.call(g,e),k=g[e];try{g[e]=void 0;var m=!0}catch(z){}var p=r.call(g);m&&(f?g[e]=k:delete g[e]);return p}};
shadow$provide[26]=function(l,L,q){var x=Object.prototype.toString;L.exports=function(r){return x.call(r)}};
shadow$provide[27]=function(l,L,q){q=l(24);var x=l(25),r=l(26),e=q?q.toStringTag:void 0;L.exports=function(g){return g==null?g===void 0?"[object Undefined]":"[object Null]":e&&e in Object(g)?x(g):r(g)}};
shadow$provide[28]=function(l,L,q){L.exports=function(x){var r=typeof x;return x!=null&&(r=="object"||r=="function")}};
shadow$provide[29]=function(l,L,q){var x=l(27),r=l(28);L.exports=function(e){if(!r(e))return!1;e=x(e);return e=="[object Function]"||e=="[object GeneratorFunction]"||e=="[object AsyncFunction]"||e=="[object Proxy]"}};
shadow$provide[30]=function(l,L,q){l=l(23)["__core-js_shared__"];L.exports=l};
shadow$provide[31]=function(l,L,q){var x=l(30),r=function(){var e=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();L.exports=function(e){return!!r&&r in e}};
shadow$provide[32]=function(l,L,q){var x=Function.prototype.toString;L.exports=function(r){if(r!=null){try{return x.call(r)}catch(e){}try{return r+""}catch(e){}}return""}};
shadow$provide[33]=function(l,L,q){var x=l(29),r=l(31),e=l(28),g=l(32),f=/^\[object .+?Constructor\]$/,k=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$\x26").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");L.exports=function(m){return!e(m)||r(m)?!1:(x(m)?k:f).test(g(m))}};
shadow$provide[34]=function(l,L,q){L.exports=function(x,r){return x==null?void 0:x[r]}};
shadow$provide[35]=function(l,L,q){var x=l(33),r=l(34);L.exports=function(e,g){e=r(e,g);return x(e)?e:void 0}};
shadow$provide[36]=function(l,L,q){q=l(35);l=l(23);l=q(l,"Map");L.exports=l};
shadow$provide[37]=function(l,L,q){l=l(35)(Object,"create");L.exports=l};
shadow$provide[38]=function(l,L,q){var x=l(37);L.exports=function(){this.__data__=x?x(null):{};this.size=0}};
shadow$provide[39]=function(l,L,q){L.exports=function(x){x=this.has(x)&&delete this.__data__[x];this.size-=x?1:0;return x}};
shadow$provide[40]=function(l,L,q){var x=l(37),r=Object.prototype.hasOwnProperty;L.exports=function(e){var g=this.__data__;return x?(e=g[e],e==="__lodash_hash_undefined__"?void 0:e):r.call(g,e)?g[e]:void 0}};
shadow$provide[41]=function(l,L,q){var x=l(37),r=Object.prototype.hasOwnProperty;L.exports=function(e){var g=this.__data__;return x?g[e]!==void 0:r.call(g,e)}};
shadow$provide[42]=function(l,L,q){var x=l(37);L.exports=function(r,e){var g=this.__data__;this.size+=this.has(r)?0:1;g[r]=x&&e===void 0?"__lodash_hash_undefined__":e;return this}};
shadow$provide[43]=function(l,L,q){function x(f){var k=-1,m=f==null?0:f.length;for(this.clear();++k<m;){var p=f[k];this.set(p[0],p[1])}}q=l(38);var r=l(39),e=l(40),g=l(41);l=l(42);x.prototype.clear=q;x.prototype["delete"]=r;x.prototype.get=e;x.prototype.has=g;x.prototype.set=l;L.exports=x};
shadow$provide[44]=function(l,L,q){var x=l(43),r=l(17),e=l(36);L.exports=function(){this.size=0;this.__data__={hash:new x,map:new (e||r),string:new x}}};
shadow$provide[45]=function(l,L,q){L.exports=function(x){var r=typeof x;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?x!=="__proto__":x===null}};
shadow$provide[46]=function(l,L,q){var x=l(45);L.exports=function(r,e){r=r.__data__;return x(e)?r[typeof e=="string"?"string":"hash"]:r.map}};
shadow$provide[47]=function(l,L,q){var x=l(46);L.exports=function(r){r=x(this,r)["delete"](r);this.size-=r?1:0;return r}};
shadow$provide[48]=function(l,L,q){var x=l(46);L.exports=function(r){return x(this,r).get(r)}};
shadow$provide[49]=function(l,L,q){var x=l(46);L.exports=function(r){return x(this,r).has(r)}};
shadow$provide[50]=function(l,L,q){var x=l(46);L.exports=function(r,e){var g=x(this,r),f=g.size;g.set(r,e);this.size+=g.size==f?0:1;return this}};
shadow$provide[51]=function(l,L,q){function x(f){var k=-1,m=f==null?0:f.length;for(this.clear();++k<m;){var p=f[k];this.set(p[0],p[1])}}q=l(44);var r=l(47),e=l(48),g=l(49);l=l(50);x.prototype.clear=q;x.prototype["delete"]=r;x.prototype.get=e;x.prototype.has=g;x.prototype.set=l;L.exports=x};
shadow$provide[52]=function(l,L,q){var x=l(17),r=l(36),e=l(51);L.exports=function(g,f){var k=this.__data__;if(k instanceof x){var m=k.__data__;if(!r||m.length<199)return m.push([g,f]),this.size=++k.size,this;k=this.__data__=new e(m)}k.set(g,f);this.size=k.size;return this}};
shadow$provide[53]=function(l,L,q){function x(k){this.size=(this.__data__=new r(k)).size}var r=l(17);q=l(18);var e=l(19),g=l(20),f=l(21);l=l(52);x.prototype.clear=q;x.prototype["delete"]=e;x.prototype.get=g;x.prototype.has=f;x.prototype.set=l;L.exports=x};
shadow$provide[54]=function(l,L,q){L.exports=function(x){this.__data__.set(x,"__lodash_hash_undefined__");return this}};
shadow$provide[55]=function(l,L,q){L.exports=function(x){return this.__data__.has(x)}};
shadow$provide[56]=function(l,L,q){function x(e){var g=-1,f=e==null?0:e.length;for(this.__data__=new r;++g<f;)this.add(e[g])}var r=l(51);q=l(54);l=l(55);x.prototype.add=x.prototype.push=q;x.prototype.has=l;L.exports=x};
shadow$provide[57]=function(l,L,q){L.exports=function(x,r){for(var e=-1,g=x==null?0:x.length;++e<g;)if(r(x[e],e,x))return!0;return!1}};
shadow$provide[58]=function(l,L,q){L.exports=function(x,r){return x.has(r)}};
shadow$provide[59]=function(l,L,q){var x=l(56),r=l(57),e=l(58);L.exports=function(g,f,k,m,p,z){var t=k&1,v=g.length,y=f.length;if(v!=y&&!(t&&y>v))return!1;y=z.get(g);var B=z.get(f);if(y&&B)return y==f&&B==g;y=-1;B=!0;var D=k&2?new x:void 0;z.set(g,f);for(z.set(f,g);++y<v;){var G=g[y],I=f[y];if(m)var K=t?m(I,G,y,f,g,z):m(G,I,y,g,f,z);if(K!==void 0){if(K)continue;B=!1;break}if(D){if(!r(f,function(Q,O){if(!e(D,O)&&(G===Q||p(G,Q,k,m,z)))return D.push(O)})){B=!1;break}}else if(G!==I&&!p(G,I,k,m,z)){B=
!1;break}}z["delete"](g);z["delete"](f);return B}};
shadow$provide[60]=function(l,L,q){l=l(23).Uint8Array;L.exports=l};
shadow$provide[61]=function(l,L,q){L.exports=function(x){var r=-1,e=Array(x.size);x.forEach(function(g,f){e[++r]=[f,g]});return e}};
shadow$provide[62]=function(l,L,q){L.exports=function(x){var r=-1,e=Array(x.size);x.forEach(function(g){e[++r]=g});return e}};
shadow$provide[63]=function(l,L,q){q=l(24);var x=l(60),r=l(11),e=l(59),g=l(61),f=l(62),k=(l=q?q.prototype:void 0)?l.valueOf:void 0;L.exports=function(m,p,z,t,v,y,B){switch(z){case "[object DataView]":if(m.byteLength!=p.byteLength||m.byteOffset!=p.byteOffset)break;m=m.buffer;p=p.buffer;case "[object ArrayBuffer]":if(m.byteLength!=p.byteLength||!y(new x(m),new x(p)))break;return!0;case "[object Boolean]":case "[object Date]":case "[object Number]":return r(+m,+p);case "[object Error]":return m.name==
p.name&&m.message==p.message;case "[object RegExp]":case "[object String]":return m==p+"";case "[object Map]":var D=g;case "[object Set]":D||(D=f);if(m.size!=p.size&&!(t&1))break;if(z=B.get(m))return z==p;t|=2;B.set(m,p);p=e(D(m),D(p),t,v,y,B);B["delete"](m);return p;case "[object Symbol]":if(k)return k.call(m)==k.call(p)}return!1}};
shadow$provide[64]=function(l,L,q){L.exports=function(x,r){for(var e=-1,g=r.length,f=x.length;++e<g;)x[f+e]=r[e];return x}};
shadow$provide[65]=function(l,L,q){L.exports=Array.isArray};
shadow$provide[66]=function(l,L,q){var x=l(64),r=l(65);L.exports=function(e,g,f){g=g(e);return r(e)?g:x(g,f(e))}};
shadow$provide[67]=function(l,L,q){L.exports=function(x,r){for(var e=-1,g=x==null?0:x.length,f=0,k=[];++e<g;){var m=x[e];r(m,e,x)&&(k[f++]=m)}return k}};
shadow$provide[68]=function(l,L,q){L.exports=function(){return[]}};
shadow$provide[69]=function(l,L,q){var x=l(67);l=l(68);var r=Object.prototype.propertyIsEnumerable,e=Object.getOwnPropertySymbols;L.exports=e?function(g){if(g==null)return[];g=Object(g);return x(e(g),function(f){return r.call(g,f)})}:l};
shadow$provide[70]=function(l,L,q){L.exports=function(x,r){for(var e=-1,g=Array(x);++e<x;)g[e]=r(e);return g}};
shadow$provide[71]=function(l,L,q){L.exports=function(x){return x!=null&&typeof x=="object"}};
shadow$provide[72]=function(l,L,q){var x=l(27),r=l(71);L.exports=function(e){return r(e)&&x(e)=="[object Arguments]"}};
shadow$provide[73]=function(l,L,q){q=l(72);var x=l(71);l=Object.prototype;var r=l.hasOwnProperty,e=l.propertyIsEnumerable;l=q(function(){return arguments}())?q:function(g){return x(g)&&r.call(g,"callee")&&!e.call(g,"callee")};L.exports=l};
shadow$provide[74]=function(l,L,q){L.exports=function(){return!1}};
shadow$provide[75]=function(l,L,q){var x=l(23);l=l(74);var r=(q=typeof q=="object"&&q&&!q.nodeType&&q)&&typeof L=="object"&&L&&!L.nodeType&&L;x=r&&r.exports===q?x.Buffer:void 0;L.exports=(x?x.isBuffer:void 0)||l};
shadow$provide[76]=function(l,L,q){var x=/^(?:0|[1-9]\d*)$/;L.exports=function(r,e){var g=typeof r;e=e==null?9007199254740991:e;return!!e&&(g=="number"||g!="symbol"&&x.test(r))&&r>-1&&r%1==0&&r<e}};
shadow$provide[77]=function(l,L,q){L.exports=function(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=9007199254740991}};
shadow$provide[78]=function(l,L,q){var x=l(27),r=l(77),e=l(71),g={};g["[object Float32Array]"]=g["[object Float64Array]"]=g["[object Int8Array]"]=g["[object Int16Array]"]=g["[object Int32Array]"]=g["[object Uint8Array]"]=g["[object Uint8ClampedArray]"]=g["[object Uint16Array]"]=g["[object Uint32Array]"]=!0;g["[object Arguments]"]=g["[object Array]"]=g["[object ArrayBuffer]"]=g["[object Boolean]"]=g["[object DataView]"]=g["[object Date]"]=g["[object Error]"]=g["[object Function]"]=g["[object Map]"]=
g["[object Number]"]=g["[object Object]"]=g["[object RegExp]"]=g["[object Set]"]=g["[object String]"]=g["[object WeakMap]"]=!1;L.exports=function(f){return e(f)&&r(f.length)&&!!g[x(f)]}};
shadow$provide[79]=function(l,L,q){L.exports=function(x){return function(r){return x(r)}}};
shadow$provide[80]=function(l,L,q){l=l(22);var x=typeof q=="object"&&q&&!q.nodeType&&q;l=(q=x&&typeof L=="object"&&L&&!L.nodeType&&L)&&q.exports===x&&l.process;a:{try{var r=q&&q.require&&q.require("util").types;if(r){var e=r;break a}e=l&&l.binding&&l.binding("util");break a}catch(g){}e=void 0}L.exports=e};
shadow$provide[81]=function(l,L,q){q=l(78);var x=l(79);q=(l=(l=l(80))&&l.isTypedArray)?x(l):q;L.exports=q};
shadow$provide[82]=function(l,L,q){var x=l(70),r=l(73),e=l(65),g=l(75),f=l(76),k=l(81),m=Object.prototype.hasOwnProperty;L.exports=function(p,z){var t=e(p),v=!t&&r(p),y=!t&&!v&&g(p),B=!t&&!v&&!y&&k(p);v=(t=t||v||y||B)?x(p.length,String):[];var D=v.length,G;for(G in p)!z&&!m.call(p,G)||t&&(G=="length"||y&&(G=="offset"||G=="parent")||B&&(G=="buffer"||G=="byteLength"||G=="byteOffset")||f(G,D))||v.push(G);return v}};
shadow$provide[83]=function(l,L,q){var x=Object.prototype;L.exports=function(r){var e=r&&r.constructor;return r===(typeof e=="function"&&e.prototype||x)}};
shadow$provide[84]=function(l,L,q){L.exports=function(x,r){return function(e){return x(r(e))}}};
shadow$provide[85]=function(l,L,q){l=l(84)(Object.keys,Object);L.exports=l};
shadow$provide[86]=function(l,L,q){var x=l(83),r=l(85),e=Object.prototype.hasOwnProperty;L.exports=function(g){if(!x(g))return r(g);var f=[],k;for(k in Object(g))e.call(g,k)&&k!="constructor"&&f.push(k);return f}};
shadow$provide[87]=function(l,L,q){var x=l(29),r=l(77);L.exports=function(e){return e!=null&&r(e.length)&&!x(e)}};
shadow$provide[88]=function(l,L,q){var x=l(82),r=l(86),e=l(87);L.exports=function(g){return e(g)?x(g):r(g)}};
shadow$provide[89]=function(l,L,q){var x=l(66),r=l(69),e=l(88);L.exports=function(g){return x(g,e,r)}};
shadow$provide[90]=function(l,L,q){var x=l(89),r=Object.prototype.hasOwnProperty;L.exports=function(e,g,f,k,m,p){var z=f&1,t=x(e),v=t.length,y=x(g).length;if(v!=y&&!z)return!1;for(y=v;y--;){var B=t[y];if(!(z?B in g:r.call(g,B)))return!1}var D=p.get(e);B=p.get(g);if(D&&B)return D==g&&B==e;D=!0;p.set(e,g);p.set(g,e);for(var G=z;++y<v;){B=t[y];var I=e[B],K=g[B];if(k)var Q=z?k(K,I,B,g,e,p):k(I,K,B,e,g,p);if(Q===void 0?I!==K&&!m(I,K,f,k,p):!Q){D=!1;break}G||(G=B=="constructor")}D&&!G&&(f=e.constructor,
k=g.constructor,f!=k&&"constructor"in e&&"constructor"in g&&!(typeof f=="function"&&f instanceof f&&typeof k=="function"&&k instanceof k)&&(D=!1));p["delete"](e);p["delete"](g);return D}};
shadow$provide[91]=function(l,L,q){q=l(35);l=l(23);l=q(l,"DataView");L.exports=l};
shadow$provide[92]=function(l,L,q){q=l(35);l=l(23);l=q(l,"Promise");L.exports=l};
shadow$provide[93]=function(l,L,q){q=l(35);l=l(23);l=q(l,"Set");L.exports=l};
shadow$provide[94]=function(l,L,q){q=l(35);l=l(23);l=q(l,"WeakMap");L.exports=l};
shadow$provide[95]=function(l,L,q){q=l(91);var x=l(36),r=l(92),e=l(93),g=l(94),f=l(27),k=l(32),m=k(q),p=k(x),z=k(r),t=k(e),v=k(g);l=f;if(q&&l(new q(new ArrayBuffer(1)))!="[object DataView]"||x&&l(new x)!="[object Map]"||r&&l(r.resolve())!="[object Promise]"||e&&l(new e)!="[object Set]"||g&&l(new g)!="[object WeakMap]")l=function(y){var B=f(y);if(y=(y=B=="[object Object]"?y.constructor:void 0)?k(y):"")switch(y){case m:return"[object DataView]";case p:return"[object Map]";case z:return"[object Promise]";
case t:return"[object Set]";case v:return"[object WeakMap]"}return B};L.exports=l};
shadow$provide[96]=function(l,L,q){var x=l(53),r=l(59),e=l(63),g=l(90),f=l(95),k=l(65),m=l(75),p=l(81),z=Object.prototype.hasOwnProperty;L.exports=function(t,v,y,B,D,G){var I=k(t),K=k(v),Q=I?"[object Array]":f(t),O=K?"[object Array]":f(v);Q=Q=="[object Arguments]"?"[object Object]":Q;O=O=="[object Arguments]"?"[object Object]":O;var J=Q=="[object Object]";K=O=="[object Object]";if((O=Q==O)&&m(t)){if(!m(v))return!1;I=!0;J=!1}if(O&&!J)return G||(G=new x),I||p(t)?r(t,v,y,B,D,G):e(t,v,Q,y,B,D,G);if(!(y&
1)&&(I=J&&z.call(t,"__wrapped__"),Q=K&&z.call(v,"__wrapped__"),I||Q))return t=I?t.value():t,v=Q?v.value():v,G||(G=new x),D(t,v,y,B,G);if(!O)return!1;G||(G=new x);return g(t,v,y,B,D,G)}};
shadow$provide[97]=function(l,L,q){function x(g,f,k,m,p){return g===f?!0:g==null||f==null||!e(g)&&!e(f)?g!==g&&f!==f:r(g,f,k,m,x,p)}var r=l(96),e=l(71);L.exports=x};
shadow$provide[98]=function(l,L,q){var x=l(97);L.exports=function(r,e){return x(r,e)}};
shadow$provide[99]=function(l,L,q){L=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{"default":g}};q.__esModule=!0;q.useDeepCompareMemo=q.capitalize=q.canNodeHaveChildren=q.isSelectionParent=q.isRootDestroyed=void 0;var x=L(l(98)),r=l(3);q.isRootDestroyed=function(g){for(;g._up;)g=g._up;return g.three===void 0};q.isSelectionParent=function(g,f){var k;return((k=g._up)===null||k===void 0?void 0:k[0])===f[0]};var e="view cartesian cartesian4 polar spherical stereographic stereographic4 transform transform4 vertex fragment layer mask group inherit root unit rtt clock now move present reveal slide".split(" ");
q.canNodeHaveChildren=function(g){return e.includes(g)};q.capitalize=function(g){return g?g[0].toLocaleUpperCase()+g.slice(1):""};q.useDeepCompareMemo=function(g,f){var k=(0,r.useRef)(f);return(0,r.useMemo)(function(){return(0,x["default"])(g,k.current)?k.current:k.current=g},[g])}};
shadow$provide[100]=function(l,L,q){var x=this&&this.__createBinding||(Object.create?function(p,z,t,v){v===void 0&&(v=t);var y=Object.getOwnPropertyDescriptor(z,t);if(!y||("get"in y?!z.__esModule:y.writable||y.configurable))y={enumerable:!0,get:function(){return z[t]}};Object.defineProperty(p,v,y)}:function(p,z,t,v){v===void 0&&(v=t);p[v]=z[t]}),r=this&&this.__setModuleDefault||(Object.create?function(p,z){Object.defineProperty(p,"default",{enumerable:!0,value:z})}:function(p,z){p["default"]=z});
L=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var z={};if(p!=null)for(var t in p)t!=="default"&&Object.prototype.hasOwnProperty.call(p,t)&&x(z,p,t);r(z,p);return z};var e=this&&this.__rest||function(p,z){var t={},v;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&z.indexOf(v)<0&&(t[v]=p[v]);if(p!=null&&typeof Object.getOwnPropertySymbols==="function"){var y=0;for(v=Object.getOwnPropertySymbols(p);y<v.length;y++)z.indexOf(v[y])<0&&Object.prototype.propertyIsEnumerable.call(p,
v[y])&&(t[v[y]]=p[v[y]])}return t},g=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{"default":p}};q.__esModule=!0;q.Strip=q.Stereographic4=q.Stereographic=q.Step=q.Spread=q.Split=q.Spherical=q.Slide=q.Slice=q.Shader=q.Scale=q.Rtt=q.Reveal=q.Retext=q.Resample=q.Repeat=q.Readback=q.Present=q.Polar=q.Point=q.Play=q.Now=q.Move=q.Memo=q.Matrix=q.Mask=q.Line=q.Lerp=q.Layer=q.Label=q.Join=q.Interval=q.Inherit=q.Html=q.Grow=q.Group=q.Grid=q.Fragment=q.Format=q.Face=q.Dom=q.Compose=q.Clock=
q.Clamp=q.Cartesian4=q.Cartesian=q.Camera=q.Axis=q.Array=q.Area=void 0;q.Voxel=q.Volume=q.View=q.Vertex=q.Vector=q.Unit=q.Transpose=q.Transform4=q.Transform=q.Ticks=q.Text=q.Swizzle=q.Surface=q.Subdivide=void 0;var f=L(l(3)),k=g(l(9)),m=l(99);l=function(p){var z=(0,m.canNodeHaveChildren)(p),t=(0,m.capitalize)(p);return(0,f.forwardRef)(function(v,y){var B=(0,f.useReducer)(function(O){return O+1},0)[1],D=(0,f.useContext)(k["default"]),G=(0,f.useRef)(null),I=(0,f.useRef)(void 0);(0,f.useEffect)(function(){return function(){G.current&&
(G.current.remove(),G.current=null)}},[]);(0,f.useImperativeHandle)(y,function(){return G.current});var K=v.liveProps,Q=e(v,["children","liveProps"]);(0,f.useEffect)(function(){D&&((0,m.isRootDestroyed)(D)?B():(G.current&&!(0,m.isSelectionParent)(G.current,D)&&(G.current.remove(),G.current=null,B()),G.current?(I.current&&K!==I.current&&Object.keys(I.current).forEach(function(O){G.current.unbind(O)}),K&&K!==I.current&&G.current.bind(K),G.current.set(Q)):(G.current=D[p](Q,K),B()),I.current=K))},[D,
Q,K]);if(!z){if(v.children)throw Error("Component \x3c".concat(t," /\x3e cannot have children."));return null}return f["default"].createElement(k["default"].Provider,{value:G.current},v.children)})};q.Area=l("area");L=l("array");q.Array=L;q.Axis=l("axis");q.Camera=l("camera");q.Cartesian=l("cartesian");q.Cartesian4=l("cartesian4");q.Clamp=l("clamp");q.Clock=l("clock");q.Compose=l("compose");q.Dom=l("dom");q.Face=l("face");q.Format=l("format");q.Fragment=l("fragment");q.Grid=l("grid");q.Group=l("group");
q.Grow=l("grow");q.Html=l("html");q.Inherit=l("inherit");q.Interval=l("interval");q.Join=l("join");q.Label=l("label");q.Layer=l("layer");q.Lerp=l("lerp");q.Line=l("line");q.Mask=l("mask");q.Matrix=l("matrix");q.Memo=l("memo");q.Move=l("move");q.Now=l("now");q.Play=l("play");q.Point=l("point");q.Polar=l("polar");q.Present=l("present");q.Readback=l("readback");q.Repeat=l("repeat");q.Resample=l("resample");q.Retext=l("retext");q.Reveal=l("reveal");q.Rtt=l("rtt");q.Scale=l("scale");q.Shader=l("shader");
q.Slice=l("slice");q.Slide=l("slide");q.Spherical=l("spherical");q.Split=l("split");q.Spread=l("spread");q.Step=l("step");q.Stereographic=l("stereographic");q.Stereographic4=l("stereographic4");q.Strip=l("strip");q.Subdivide=l("subdivide");q.Surface=l("surface");q.Swizzle=l("swizzle");q.Text=l("text");q.Ticks=l("ticks");q.Transform=l("transform");q.Transform4=l("transform4");q.Transpose=l("transpose");q.Unit=l("unit");q.Vector=l("vector");q.Vertex=l("vertex");q.View=l("view");q.Volume=l("volume");
q.Voxel=l("voxel")};
shadow$provide[101]=function(l,L,q){function x(){const a=Math.random()*4294967295|0,b=Math.random()*4294967295|0,d=Math.random()*4294967295|0,h=Math.random()*4294967295|0;return(Rc[a&255]+Rc[a>>8&255]+Rc[a>>16&255]+Rc[a>>24&255]+"-"+Rc[b&255]+Rc[b>>8&255]+"-"+Rc[b>>16&15|64]+Rc[b>>24&255]+"-"+Rc[d&63|128]+Rc[d>>8&255]+"-"+Rc[d>>16&255]+Rc[d>>24&255]+Rc[h&255]+Rc[h>>8&255]+Rc[h>>16&255]+Rc[h>>24&255]).toLowerCase()}function r(a,b,d){return Math.max(b,Math.min(d,a))}function e(a,b){return(a%b+b)%b}
function g(a,b,d){return(1-d)*a+d*b}function f(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return a/4294967295;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/2147483647,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw Error("Invalid component type.");}}function k(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return Math.round(a*4294967295);case Uint16Array:return Math.round(a*
65535);case Uint8Array:return Math.round(a*255);case Int32Array:return Math.round(a*2147483647);case Int16Array:return Math.round(a*32767);case Int8Array:return Math.round(a*127);default:throw Error("Invalid component type.");}}function m(a){for(let b=a.length-1;b>=0;--b)if(a[b]>=65535)return!0;return!1}function p(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}function z(){const a=p("canvas");a.style.display="block";return a}function t(a){a in Pg||(Pg[a]=!0,console.warn(a))}
function v(a,b,d){return new Promise(function(h,n){function u(){switch(a.clientWaitSync(b,a.SYNC_FLUSH_COMMANDS_BIT,0)){case a.WAIT_FAILED:n();break;case a.TIMEOUT_EXPIRED:setTimeout(u,d);break;default:h()}}setTimeout(u,d)})}function y(a){return a<.04045?a*.0773993808:Math.pow(a*.9478672986+.0521327014,2.4)}function B(a){return a<.0031308?a*12.92:1.055*Math.pow(a,.41666)-.055}function D(a){if(typeof HTMLImageElement!=="undefined"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&
a instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&a instanceof ImageBitmap)return Qg.getDataURL(a);if(a.data)return{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name};console.warn("THREE.Texture: Unable to serialize Texture.");return{}}function G(a,b,d,h,n){for(let u=0,E=a.length-3;u<=E;u+=3){he.fromArray(a,u);const F=n.x*Math.abs(he.x)+n.y*Math.abs(he.y)+n.z*Math.abs(he.z),H=b.dot(he),M=d.dot(he),R=h.dot(he);if(Math.max(-Math.max(H,M,R),Math.min(H,
M,R))>F)return!1}return!0}function I(a,b,d){d<0&&(d+=1);d>1&&--d;return d<1/6?a+(b-a)*6*d:d<.5?b:d<2/3?a+(b-a)*6*(2/3-d):a}function K(a){Math.abs(a)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range.");a=r(a,-65504,65504);ie.floatView[0]=a;a=ie.uint32View[0];const b=a>>23&511;return ie.baseTable[b]+((a&8388607)>>ie.shiftTable[b])}function Q(a){const b=a>>10;ie.uint32View[0]=ie.mantissaTable[ie.offsetTable[b]+(a&1023)]+ie.exponentTable[b];return ie.floatView[0]}function O(a,b,
d,h,n,u,E,F,H,M){a.getVertexPosition(F,kg);a.getVertexPosition(H,lg);a.getVertexPosition(M,mg);(b.side===1?h.intersectTriangle(mg,lg,kg,!0,Rg):h.intersectTriangle(kg,lg,mg,b.side===0,Rg))===null?a=null:(Sg.copy(Rg),Sg.applyMatrix4(a.matrixWorld),b=d.ray.origin.distanceTo(Sg),a=b<d.near||b>d.far?null:{distance:b,point:Sg.clone(),object:a});a&&(d=new ma,ud.getBarycoord(Rg,kg,lg,mg,d),n&&(a.uv=ud.getInterpolatedAttribute(n,F,H,M,d,new Xa)),u&&(a.uv1=ud.getInterpolatedAttribute(u,F,H,M,d,new Xa)),E&&
(a.normal=ud.getInterpolatedAttribute(E,F,H,M,d,new ma),a.normal.dot(h.direction)>0&&a.normal.multiplyScalar(-1)),h={a:F,b:H,c:M,normal:new ma,materialIndex:0},ud.getNormal(kg,lg,mg,h.normal),a.face=h,a.barycoord=d);return a}function J(a){const b={};for(const d in a){b[d]={};for(const h in a[d]){const n=a[d][h];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),
b[d][h]=null):b[d][h]=n.clone():Array.isArray(n)?b[d][h]=n.slice():b[d][h]=n}}return b}function W(a){const b={};for(let d=0;d<a.length;d++){const h=J(a[d]);for(const n in h)b[n]=h[n]}return b}function ba(a){const b=a.getRenderTarget();return b===null?a.outputColorSpace:b.isXRRenderTarget===!0?b.texture.colorSpace:$b.workingColorSpace}function Y(a,b,d,h,n,u){wf.subVectors(a,d).addScalar(.5).multiply(h);n!==void 0?(ng.x=u*wf.x-n*wf.y,ng.y=n*wf.x+u*wf.y):ng.copy(wf);a.copy(b);a.x+=ng.x;a.y+=ng.y;a.applyMatrix4(ck)}
function S(a,b){return a-b}function ca(a,b){return a.z-b.z}function V(a,b){return b.z-a.z}function xa(a,b,d=0){const h=b.itemSize;if(a.isInterleavedBufferAttribute||a.array.constructor!==b.array.constructor){const n=a.count;for(let u=0;u<n;u++)for(let E=0;E<h;E++)b.setComponent(u+d,E,a.getComponent(u,E))}else b.array.set(a.array,d*h);b.needsUpdate=!0}function na(a,b){if(a.constructor!==b.constructor){const d=Math.min(a.length,b.length);for(let h=0;h<d;h++)b[h]=a[h]}else b.set(new a.constructor(a.buffer,
0,Math.min(a.length,b.length)))}function N(a,b,d,h,n,u,E){const F=a.geometry.attributes.position;Tg.fromBufferAttribute(F,n);Ug.fromBufferAttribute(F,u);if(!(d.distanceSqToSegment(Tg,Ug,$h,dk)>h||($h.applyMatrix4(a.matrixWorld),d=b.ray.origin.distanceTo($h),d<b.near||d>b.far)))return{distance:d,point:dk.clone().applyMatrix4(a.matrixWorld),index:E,face:null,faceIndex:null,barycoord:null,object:a}}function pa(a,b,d,h,n,u,E){const F=ai.distanceSqToPoint(a);F<d&&(d=new ma,ai.closestPointToPoint(a,d),
d.applyMatrix4(h),a=n.ray.origin.distanceTo(d),a<n.near||a>n.far||u.push({distance:a,distanceToRay:Math.sqrt(F),point:d,index:b,face:null,faceIndex:null,barycoord:null,object:E}))}function ra(){let a=0,b=0,d=0,h=0;return{initCatmullRom:function(n,u,E,F,H){n=H*(E-n);F=H*(F-u);a=u;b=n;d=-3*u+3*E-2*n-F;h=2*u-2*E+n+F},initNonuniformCatmullRom:function(n,u,E,F,H,M,R){n=((u-n)/H-(E-n)/(H+M)+(E-u)/M)*M;F=((E-u)/M-(F-u)/(M+R)+(F-E)/R)*M;a=u;b=n;d=-3*u+3*E-2*n-F;h=2*u-2*E+n+F},calc:function(n){const u=n*n;
return a+b*n+d*u+u*n*h}}}function Ea(a,b,d,h,n){b=(h-b)*.5;n=(n-d)*.5;const u=a*a;return a*u*(2*d-2*h+b+n)+(-3*d+3*h-2*b-n)*u+b*a+d}function Ua(a,b,d,h){const n=1-a;return n*n*b+2*(1-a)*a*d+a*a*h}function jb(a,b,d,h,n){const u=1-a,E=1-a;return u*u*u*b+3*E*E*a*d+3*(1-a)*a*a*h+a*a*a*n}function eb(a,b,d=2){var h=b&&b.length;const n=h?b[0]*d:a.length;var u=rc(a,0,n,d,!0);const E=[];if(!u||u.next===u.prev)return E;let F,H;var M;if(h){h=u;u=[];for(let X=0,ea=b.length;X<ea;X++){const aa=rc(a,b[X]*d,X<ea-
1?b[X+1]*d:a.length,d,!1);aa===aa.next&&(aa.steiner=!0);var R=u,T=R.push;let da=aa,U=aa;do{if(da.x<U.x||da.x===U.x&&da.y<U.y)U=da;da=da.next}while(da!==aa);T.call(R,U)}u.sort(qb);for(b=0;b<u.length;b++)R=u[b],T=h,(h=cc(R,T))?(R=ab(h,R),xb(R,R.next),h=xb(h,h.next)):h=T;u=h}if(a.length>80*d){H=F=Infinity;b=M=-Infinity;for(h=d;h<n;h+=d)R=a[h],T=a[h+1],R<F&&(F=R),T<H&&(H=T),R>M&&(M=R),T>b&&(b=T);M=Math.max(M-F,b-H);M=M!==0?32767/M:0}Bb(u,E,d,F,H,M,0);return E}function rc(a,b,d,h,n){let u,E=0;for(let F=
b,H=d-h;F<d;F+=h)E+=(a[H]-a[F])*(a[F+1]+a[H+1]),H=F;if(n===E>0)for(;b<d;b+=h)u=Qb(b/h|0,a[b],a[b+1],u);else for(d-=h;d>=b;d-=h)u=Qb(d/h|0,a[d],a[d+1],u);u&&lb(u,u.next)&&(fc(u),u=u.next);return u}function xb(a,b){if(!a)return a;b||(b=a);let d;do if(d=!1,a.steiner||!lb(a,a.next)&&yb(a.prev,a,a.next)!==0)a=a.next;else{fc(a);a=b=a.prev;if(a===a.next)break;d=!0}while(d||a!==b);return b}function Bb(a,b,d,h,n,u,E){if(a){if(!E&&u){var F=a,H=F;do H.z===0&&(H.z=Db(H.x,H.y,h,n,u)),H.prevZ=H.prev,H=H.nextZ=
H.next;while(H!==F);H.prevZ.nextZ=null;H.prevZ=null;F=H;var M=1;do{var R=F,T=void 0,X=F=null;for(H=0;R;){H++;var ea=R,aa=0;for(T=0;T<M&&(aa++,ea=ea.nextZ,ea);T++);for(var da=M;aa>0||da>0&&ea;)aa!==0&&(da===0||!ea||R.z<=ea.z)?(T=R,R=R.nextZ,aa--):(T=ea,ea=ea.nextZ,da--),X?X.nextZ=T:F=T,T.prevZ=X,X=T;R=ea}X.nextZ=null;M*=2}while(H>1)}for(F=a;a.prev!==a.next;){H=a.prev;M=a.next;if(u)R=bc(a,h,n,u);else a:{R=a.prev;var U=a;da=a.next;if(yb(R,U,da)>=0){R=!1;break a}X=R.x;ea=U.x;aa=da.x;T=R.y;U=U.y;const ka=
da.y,qa=Math.min(X,ea,aa),wa=Math.min(T,U,ka),sa=Math.max(X,ea,aa),Aa=Math.max(T,U,ka);for(da=da.next;da!==R;){if(da.x>=qa&&da.x<=sa&&da.y>=wa&&da.y<=Aa&&Bc(X,T,ea,U,aa,ka,da.x,da.y)&&yb(da.prev,da,da.next)>=0){R=!1;break a}da=da.next}R=!0}if(R)b.push(H.i,a.i,M.i),fc(a),F=a=M.next;else if(a=M,a===F){if(!E)Bb(xb(a),b,d,h,n,u,1);else if(E===1){a=xb(a);E=b;F=a;do H=F.prev,M=F.next.next,!lb(H,M)&&Tb(H,F,F.next,M)&&fb(H,M)&&fb(M,H)&&(E.push(H.i,F.i,M.i),fc(F),fc(F.next),F=a=M),F=F.next;while(F!==a);a=
xb(F);Bb(a,b,d,h,n,u,2)}else if(E===2)a:{E=a;do{for(F=E.next.next;F!==E.prev;){if(H=E.i!==F.i){H=E;M=F;if(R=H.next.i!==M.i&&H.prev.i!==M.i){b:{R=H;do{if(R.i!==H.i&&R.next.i!==H.i&&R.i!==M.i&&R.next.i!==M.i&&Tb(R,R.next,H,M)){R=!0;break b}R=R.next}while(R!==H);R=!1}R=!R}if(R){if(R=fb(H,M)&&fb(M,H)){R=H;X=!1;ea=(H.x+M.x)/2;aa=(H.y+M.y)/2;do R.y>aa!==R.next.y>aa&&R.next.y!==R.y&&ea<(R.next.x-R.x)*(aa-R.y)/(R.next.y-R.y)+R.x&&(X=!X),R=R.next;while(R!==H);R=X}R=R&&(yb(H.prev,H,M.prev)||yb(H,M.prev,M))||
lb(H,M)&&yb(H.prev,H,H.next)>0&&yb(M.prev,M,M.next)>0}H=R}if(H){a=ab(E,F);E=xb(E,E.next);a=xb(a,a.next);Bb(E,b,d,h,n,u,0);Bb(a,b,d,h,n,u,0);break a}F=F.next}E=E.next}while(E!==a)}break}}}}function bc(a,b,d,h){const n=a.prev,u=a.next;if(yb(n,a,u)>=0)return!1;const E=n.x,F=a.x,H=u.x,M=n.y,R=a.y,T=u.y,X=Math.min(E,F,H),ea=Math.min(M,R,T),aa=Math.max(E,F,H),da=Math.max(M,R,T),U=Db(X,ea,b,d,h);b=Db(aa,da,b,d,h);d=a.prevZ;for(a=a.nextZ;d&&d.z>=U&&a&&a.z<=b;){if(d.x>=X&&d.x<=aa&&d.y>=ea&&d.y<=da&&d!==n&&
d!==u&&Bc(E,M,F,R,H,T,d.x,d.y)&&yb(d.prev,d,d.next)>=0)return!1;d=d.prevZ;if(a.x>=X&&a.x<=aa&&a.y>=ea&&a.y<=da&&a!==n&&a!==u&&Bc(E,M,F,R,H,T,a.x,a.y)&&yb(a.prev,a,a.next)>=0)return!1;a=a.nextZ}for(;d&&d.z>=U;){if(d.x>=X&&d.x<=aa&&d.y>=ea&&d.y<=da&&d!==n&&d!==u&&Bc(E,M,F,R,H,T,d.x,d.y)&&yb(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;a&&a.z<=b;){if(a.x>=X&&a.x<=aa&&a.y>=ea&&a.y<=da&&a!==n&&a!==u&&Bc(E,M,F,R,H,T,a.x,a.y)&&yb(a.prev,a,a.next)>=0)return!1;a=a.nextZ}return!0}function qb(a,b){let d=a.x-
b.x;d===0&&(d=a.y-b.y,d===0&&(d=(a.next.y-a.y)/(a.next.x-a.x)-(b.next.y-b.y)/(b.next.x-b.x)));return d}function cc(a,b){let d=b;const h=a.x,n=a.y;let u=-Infinity,E;if(lb(a,d))return d;do{if(lb(a,d.next))return d.next;if(n<=d.y&&n>=d.next.y&&d.next.y!==d.y){var F=d.x+(n-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(F<=h&&F>u&&(u=F,E=d.x<d.next.x?d:d.next,F===h))return E}d=d.next}while(d!==b);if(!E)return null;b=E;F=E.x;const H=E.y;let M=Infinity;d=E;do{if(h>=d.x&&d.x>=F&&h!==d.x&&nc(n<H?h:u,n,F,H,n<H?u:h,
n,d.x,d.y)){const X=Math.abs(n-d.y)/(h-d.x);var R;if((R=fb(d,a))&&!(R=X<M)&&(R=X===M)&&!(R=d.x>E.x)&&(R=d.x===E.x)){R=E;var T=d;R=yb(R.prev,R,T.prev)<0&&yb(T.next,R,R.next)<0}R&&(E=d,M=X)}d=d.next}while(d!==b);return E}function Db(a,b,d,h,n){a=(a-d)*n|0;b=(b-h)*n|0;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function nc(a,b,d,h,n,u,E,F){return(n-E)*(b-F)>=(a-E)*(u-F)&&
(a-E)*(h-F)>=(d-E)*(b-F)&&(d-E)*(u-F)>=(n-E)*(h-F)}function Bc(a,b,d,h,n,u,E,F){return!(a===E&&b===F)&&nc(a,b,d,h,n,u,E,F)}function yb(a,b,d){return(b.y-a.y)*(d.x-b.x)-(b.x-a.x)*(d.y-b.y)}function lb(a,b){return a.x===b.x&&a.y===b.y}function Tb(a,b,d,h){const n=Ha(yb(a,b,d)),u=Ha(yb(a,b,h)),E=Ha(yb(d,h,a)),F=Ha(yb(d,h,b));return n!==u&&E!==F||n===0&&yc(a,d,b)||u===0&&yc(a,h,b)||E===0&&yc(d,a,h)||F===0&&yc(d,b,h)?!0:!1}function yc(a,b,d){return b.x<=Math.max(a.x,d.x)&&b.x>=Math.min(a.x,d.x)&&b.y<=
Math.max(a.y,d.y)&&b.y>=Math.min(a.y,d.y)}function Ha(a){return a>0?1:a<0?-1:0}function fb(a,b){return yb(a.prev,a,a.next)<0?yb(a,b,a.next)>=0&&yb(a,a.prev,b)>=0:yb(a,b,a.prev)<0||yb(a,a.next,b)<0}function ab(a,b){const d=oc(a.i,a.x,a.y),h=oc(b.i,b.x,b.y),n=a.next,u=b.prev;a.next=b;b.prev=a;d.next=n;n.prev=d;h.next=d;d.prev=h;u.next=h;h.prev=u;return h}function Qb(a,b,d,h){a=oc(a,b,d);h?(a.next=h.next,a.prev=h,h.next.prev=a,h.next=a):(a.prev=a,a.next=a);return a}function fc(a){a.next.prev=a.prev;
a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function oc(a,b,d){return{i:a,x:b,y:d,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Dc(a){const b=a.length;b>2&&a[b-1].equals(a[0])&&a.pop()}function pc(a,b){for(let d=0;d<b.length;d++)a.push(b[d].x),a.push(b[d].y)}function Qd(a,b,d){const h=`${a.x},${a.y},${a.z}-${b.x},${b.y},${b.z}`;a=`${b.x},${b.y},${b.z}-${a.x},${a.y},${a.z}`;if(d.has(h)===!0||d.has(a)===!0)return!1;d.add(h);d.add(a);return!0}
function Ec(a,b){return a&&a.constructor!==b?typeof b.BYTES_PER_ELEMENT==="number"?new b(a):Array.prototype.slice.call(a):a}function te(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function ue(a){const b=a.length,d=Array(b);for(let h=0;h!==b;++h)d[h]=h;d.sort(function(h,n){return a[h]-a[n]});return d}function fe(a,b,d){const h=a.length,n=new a.constructor(h);for(let u=0,E=0;E!==h;++u){const F=d[u]*b;for(let H=0;H!==b;++H)n[E++]=a[F+H]}return n}function ge(a,b,d,h){let n=1,u=a[0];for(;u!==
void 0&&u[h]===void 0;)u=a[n++];if(u!==void 0){var E=u[h];if(E!==void 0)if(Array.isArray(E)){do E=u[h],E!==void 0&&(b.push(u.time),d.push(...E)),u=a[n++];while(u!==void 0)}else if(E.toArray!==void 0){do E=u[h],E!==void 0&&(b.push(u.time),E.toArray(d,d.length)),u=a[n++];while(u!==void 0)}else{do E=u[h],E!==void 0&&(b.push(u.time),d.push(E)),u=a[n++];while(u!==void 0)}}}function ve(a,b,d,h,n=30){a=a.clone();a.name=b;b=[];for(let E=0;E<a.tracks.length;++E){const F=a.tracks[E],H=F.getValueSize(),M=[],
R=[];for(let T=0;T<F.times.length;++T){var u=F.times[T]*n;if(!(u<d||u>=h))for(M.push(F.times[T]),u=0;u<H;++u)R.push(F.values[T*H+u])}M.length!==0&&(F.times=Ec(M,F.times.constructor),F.values=Ec(R,F.values.constructor),b.push(F))}a.tracks=b;d=Infinity;for(h=0;h<a.tracks.length;++h)d>a.tracks[h].times[0]&&(d=a.tracks[h].times[0]);for(h=0;h<a.tracks.length;++h)a.tracks[h].shift(-1*d);a.resetDuration();return a}function Rd(a,b=0,d=a,h=30){h<=0&&(h=30);const n=d.tracks.length;b/=h;for(h=0;h<n;++h){const M=
d.tracks[h],R=M.ValueTypeName;if(R==="bool"||R==="string")continue;const T=a.tracks.find(function(aa){return aa.name===M.name&&aa.ValueTypeName===R});if(T===void 0)continue;var u=0,E=M.getValueSize();M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=E/3);let X=0;const ea=T.getValueSize();T.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(X=ea/3);var F=M.times.length-1;if(b<=M.times[0])u=M.values.slice(u,E-u);else if(b>=M.times[F])F=F*E+u,u=M.values.slice(F,F+E-u);else{F=
M.createInterpolant();var H=u;u=E-u;F.evaluate(b);u=F.resultBuffer.slice(H,u)}R==="quaternion"&&(new dd).fromArray(u).normalize().conjugate().toArray(u);E=T.times.length;for(F=0;F<E;++F)if(H=F*ea+X,R==="quaternion")dd.multiplyQuaternionsFlat(T.values,H,u,0,T.values,H);else{const aa=ea-X*2;for(let da=0;da<aa;++da)T.values[H+da]-=u[da]}}a.blendMode=2501;return a}function md(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return og;case "vector":case "vector2":case "vector3":case "vector4":return pg;
case "color":return bi;case "quaternion":return qg;case "bool":case "boolean":return Ve;case "string":return We}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function Hd(a,b){return a.distance-b.distance}function Ic(a,b,d,h){let n=!0;a.layers.test(b.layers)&&a.raycast(b,d)===!1&&(n=!1);if(n===!0&&h===!0){a=a.children;for(let u=0,E=a.length;u<E;u++)Ic(a[u],b,d,!0)}}function qd(){this._document.hidden===!1&&this.reset()}function ld(a){const b=[];a.isBone===!0&&b.push(a);for(let d=0;d<
a.children.length;d++)b.push(...ld(a.children[d]));return b}function ic(a,b,d,h,n,u,E){Vg.set(n,u,E).unproject(h);a=b[a];if(a!==void 0){d=d.getAttribute("position");for(let F=0,H=a.length;F<H;F++)d.setXYZ(a[F],Vg.x,Vg.y,Vg.z)}}function Ib(a,b,d,h){h=Rb(h);switch(d){case 1021:return a*b;case 1028:return a*b/h.components*h.byteLength;case 1029:return a*b/h.components*h.byteLength;case 1030:return a*b*2/h.components*h.byteLength;case 1031:return a*b*2/h.components*h.byteLength;case 1022:return a*b*3/
h.components*h.byteLength;case 1023:return a*b*4/h.components*h.byteLength;case 1033:return a*b*4/h.components*h.byteLength;case 33776:case 33777:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*8;case 33778:case 33779:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*16;case 35841:case 35843:return Math.max(a,16)*Math.max(b,8)/4;case 35840:case 35842:return Math.max(a,8)*Math.max(b,8)/2;case 36196:case 37492:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*8;case 37496:return Math.floor((a+3)/4)*Math.floor((b+
3)/4)*16;case 37808:return Math.floor((a+3)/4)*Math.floor((b+3)/4)*16;case 37809:return Math.floor((a+4)/5)*Math.floor((b+3)/4)*16;case 37810:return Math.floor((a+4)/5)*Math.floor((b+4)/5)*16;case 37811:return Math.floor((a+5)/6)*Math.floor((b+4)/5)*16;case 37812:return Math.floor((a+5)/6)*Math.floor((b+5)/6)*16;case 37813:return Math.floor((a+7)/8)*Math.floor((b+4)/5)*16;case 37814:return Math.floor((a+7)/8)*Math.floor((b+5)/6)*16;case 37815:return Math.floor((a+7)/8)*Math.floor((b+7)/8)*16;case 37816:return Math.floor((a+
9)/10)*Math.floor((b+4)/5)*16;case 37817:return Math.floor((a+9)/10)*Math.floor((b+5)/6)*16;case 37818:return Math.floor((a+9)/10)*Math.floor((b+7)/8)*16;case 37819:return Math.floor((a+9)/10)*Math.floor((b+9)/10)*16;case 37820:return Math.floor((a+11)/12)*Math.floor((b+9)/10)*16;case 37821:return Math.floor((a+11)/12)*Math.floor((b+11)/12)*16;case 36492:case 36494:case 36495:return Math.ceil(a/4)*Math.ceil(b/4)*16;case 36283:case 36284:return Math.ceil(a/4)*Math.ceil(b/4)*8;case 36285:case 36286:return Math.ceil(a/
4)*Math.ceil(b/4)*16}throw Error(`Unable to determine texture byte length for ${d} format.`);}function Rb(a){switch(a){case 1009:case 1010:return{byteLength:1,components:1};case 1012:case 1011:case 1016:return{byteLength:2,components:1};case 1017:case 1018:return{byteLength:2,components:4};case 1014:case 1013:case 1015:return{byteLength:4,components:1};case 35902:case 35899:return{byteLength:4,components:3}}throw Error(`Unknown texture type ${a}.`);}function Sd(){function a(u,E){h(u,E);n=b.requestAnimationFrame(a)}
let b=null,d=!1,h=null,n=null;return{start:function(){d!==!0&&h!==null&&(n=b.requestAnimationFrame(a),d=!0)},stop:function(){b.cancelAnimationFrame(n);d=!1},setAnimationLoop:function(u){h=u},setContext:function(u){b=u}}}function Td(a){function b(h,n,u){const E=n.array,F=n.updateRanges;a.bindBuffer(u,h);if(F.length===0)a.bufferSubData(u,0,E);else{F.sort((H,M)=>H.start-M.start);h=0;for(let H=1;H<F.length;H++){const M=F[h],R=F[H];R.start<=M.start+M.count+1?M.count=Math.max(M.count,R.start+R.count-M.start):
(++h,F[h]=R)}F.length=h+1;for(let H=0,M=F.length;H<M;H++)h=F[H],a.bufferSubData(u,h.start*E.BYTES_PER_ELEMENT,E,h.start,h.count);n.clearUpdateRanges()}n.onUploadCallback()}const d=new WeakMap;return{get:function(h){h.isInterleavedBufferAttribute&&(h=h.data);return d.get(h)},remove:function(h){h.isInterleavedBufferAttribute&&(h=h.data);const n=d.get(h);n&&(a.deleteBuffer(n.buffer),d.delete(h))},update:function(h,n){h.isInterleavedBufferAttribute&&(h=h.data);if(h.isGLBufferAttribute)n=d.get(h),(!n||
n.version<h.version)&&d.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});else{var u=d.get(h);if(u===void 0){u=d.set;var E=h;const F=h.array,H=h.usage,M=F.byteLength,R=a.createBuffer();a.bindBuffer(n,R);a.bufferData(n,F,H);h.onUploadCallback();if(F instanceof Float32Array)n=a.FLOAT;else if(typeof Float16Array!=="undefined"&&F instanceof Float16Array)n=a.HALF_FLOAT;else if(F instanceof Uint16Array)n=h.isFloat16BufferAttribute?a.HALF_FLOAT:a.UNSIGNED_SHORT;else if(F instanceof
Int16Array)n=a.SHORT;else if(F instanceof Uint32Array)n=a.UNSIGNED_INT;else if(F instanceof Int32Array)n=a.INT;else if(F instanceof Int8Array)n=a.BYTE;else if(F instanceof Uint8Array)n=a.UNSIGNED_BYTE;else if(F instanceof Uint8ClampedArray)n=a.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+F);u.call(d,E,{buffer:R,type:n,bytesPerElement:F.BYTES_PER_ELEMENT,version:h.version,size:M})}else if(u.version<h.version){if(u.size!==h.array.byteLength)throw Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");
b(u.buffer,h,n);u.version=h.version}}}}}function Id(a,b,d,h,n,u,E){function F(U){let ka=U.isScene===!0?U.background:null;ka&&ka.isTexture&&(ka=(U.backgroundBlurriness>0?d:b).get(ka));return ka}function H(U,ka){U.getRGB(Wg,ba(a));h.buffers.color.setClear(Wg.r,Wg.g,Wg.b,ka,E)}const M=new pb(0);let R=u===!0?0:1,T,X,ea=null,aa=0,da=null;return{getClearColor:function(){return M},setClearColor:function(U,ka=1){M.set(U);R=ka;H(M,R)},getClearAlpha:function(){return R},setClearAlpha:function(U){R=U;H(M,R)},
render:function(U){let ka=!1;U=F(U);U===null?H(M,R):U&&U.isColor&&(H(U,1),ka=!0);U=a.xr.getEnvironmentBlendMode();U==="additive"?h.buffers.color.setClear(0,0,0,1,E):U==="alpha-blend"&&h.buffers.color.setClear(0,0,0,0,E);if(a.autoClear||ka)h.buffers.depth.setTest(!0),h.buffers.depth.setMask(!0),h.buffers.color.setMask(!0),a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil)},addToRenderList:function(U,ka){const qa=F(ka);if(qa&&(qa.isCubeTexture||qa.mapping===306)){X===void 0&&(X=new Kc(new xf(1,
1,1),new Jd({name:"BackgroundCubeMaterial",uniforms:J(Kd.backgroundCube.uniforms),vertexShader:Kd.backgroundCube.vertexShader,fragmentShader:Kd.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),X.geometry.deleteAttribute("normal"),X.geometry.deleteAttribute("uv"),X.onBeforeRender=function(wa,sa,Aa){this.matrixWorld.copyPosition(Aa.matrixWorld)},Object.defineProperty(X.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(X));yd.copy(ka.backgroundRotation);
yd.x*=-1;yd.y*=-1;yd.z*=-1;qa.isCubeTexture&&qa.isRenderTargetTexture===!1&&(yd.y*=-1,yd.z*=-1);X.material.uniforms.envMap.value=qa;X.material.uniforms.flipEnvMap.value=qa.isCubeTexture&&qa.isRenderTargetTexture===!1?-1:1;X.material.uniforms.backgroundBlurriness.value=ka.backgroundBlurriness;X.material.uniforms.backgroundIntensity.value=ka.backgroundIntensity;X.material.uniforms.backgroundRotation.value.setFromMatrix4(om.makeRotationFromEuler(yd));X.material.toneMapped=$b.getTransfer(qa.colorSpace)!==
"srgb";if(ea!==qa||aa!==qa.version||da!==a.toneMapping)X.material.needsUpdate=!0,ea=qa,aa=qa.version,da=a.toneMapping;X.layers.enableAll();U.unshift(X,X.geometry,X.material,0,0,null)}else if(qa&&qa.isTexture){T===void 0&&(T=new Kc(new rg(2,2),new Jd({name:"BackgroundMaterial",uniforms:J(Kd.background.uniforms),vertexShader:Kd.background.vertexShader,fragmentShader:Kd.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),T.geometry.deleteAttribute("normal"),Object.defineProperty(T.material,
"map",{get:function(){return this.uniforms.t2D.value}}),n.update(T));T.material.uniforms.t2D.value=qa;T.material.uniforms.backgroundIntensity.value=ka.backgroundIntensity;T.material.toneMapped=$b.getTransfer(qa.colorSpace)!=="srgb";qa.matrixAutoUpdate===!0&&qa.updateMatrix();T.material.uniforms.uvTransform.value.copy(qa.matrix);if(ea!==qa||aa!==qa.version||da!==a.toneMapping)T.material.needsUpdate=!0,ea=qa,aa=qa.version,da=a.toneMapping;T.layers.enableAll();U.unshift(T,T.geometry,T.material,0,0,null)}},
dispose:function(){X!==void 0&&(X.geometry.dispose(),X.material.dispose(),X=void 0);T!==void 0&&(T.geometry.dispose(),T.material.dispose(),T=void 0)}}}function rd(a,b){function d(aa){const da=[],U=[],ka=[];for(let qa=0;qa<M;qa++)da[qa]=0,U[qa]=0,ka[qa]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:da,enabledAttributes:U,attributeDivisors:ka,object:aa,attributes:{},index:null}}function h(){const aa=X.newAttributes;for(let da=0,U=aa.length;da<U;da++)aa[da]=0}function n(aa){u(aa,0)}
function u(aa,da){const U=X.enabledAttributes,ka=X.attributeDivisors;X.newAttributes[aa]=1;U[aa]===0&&(a.enableVertexAttribArray(aa),U[aa]=1);ka[aa]!==da&&(a.vertexAttribDivisor(aa,da),ka[aa]=da)}function E(){const aa=X.newAttributes,da=X.enabledAttributes;for(let U=0,ka=da.length;U<ka;U++)da[U]!==aa[U]&&(a.disableVertexAttribArray(U),da[U]=0)}function F(){H();ea=!0;X!==T&&(X=T,a.bindVertexArray(X.object))}function H(){T.geometry=null;T.program=null;T.wireframe=!1}const M=a.getParameter(a.MAX_VERTEX_ATTRIBS),
R={},T=d(null);let X=T,ea=!1;return{setup:function(aa,da,U,ka,qa){var wa=da.wireframe===!0;var sa=R[ka.id];sa===void 0&&(sa={},R[ka.id]=sa);var Aa=sa[U.id];Aa===void 0&&(Aa={},sa[U.id]=Aa);sa=Aa[wa];sa===void 0&&(sa=d(a.createVertexArray()),Aa[wa]=sa);wa=sa;X!==wa&&(X=wa,a.bindVertexArray(X.object));a:{wa=X.attributes;Aa=ka.attributes;sa=0;var Ba=U.getAttributes();for(Ja in Ba)if(Ba[Ja].location>=0){var Na=wa[Ja],Ca=Aa[Ja];Ca===void 0&&(Ja==="instanceMatrix"&&aa.instanceMatrix&&(Ca=aa.instanceMatrix),
Ja==="instanceColor"&&aa.instanceColor&&(Ca=aa.instanceColor));if(Na===void 0||Na.attribute!==Ca||Ca&&Na.data!==Ca.data){var Ja=!0;break a}sa++}Ja=X.attributesNum!==sa||X.index!==qa?!0:!1}if(Ja){wa={};Aa=ka.attributes;sa=0;Ba=U.getAttributes();for(var Qa in Ba)Ba[Qa].location>=0&&(Na=Aa[Qa],Na===void 0&&(Qa==="instanceMatrix"&&aa.instanceMatrix&&(Na=aa.instanceMatrix),Qa==="instanceColor"&&aa.instanceColor&&(Na=aa.instanceColor)),Ca={},(Ca.attribute=Na)&&Na.data&&(Ca.data=Na.data),wa[Qa]=Ca,sa++);
X.attributes=wa;X.attributesNum=sa;X.index=qa}qa!==null&&b.update(qa,a.ELEMENT_ARRAY_BUFFER);if(Ja||ea){ea=!1;h();Qa=ka.attributes;U=U.getAttributes();da=da.defaultAttributeValues;for(const ub in U)if(Ja=U[ub],Ja.location>=0){var Za=Qa[ub];Za===void 0&&(ub==="instanceMatrix"&&aa.instanceMatrix&&(Za=aa.instanceMatrix),ub==="instanceColor"&&aa.instanceColor&&(Za=aa.instanceColor));if(Za!==void 0){if(wa=Za.normalized,Aa=Za.itemSize,Ba=b.get(Za),Ba!==void 0){var gb=Ba.buffer;sa=Ba.type;Ba=Ba.bytesPerElement;
Na=sa===a.INT||sa===a.UNSIGNED_INT||Za.gpuType===1013;if(Za.isInterleavedBufferAttribute){var cb=Za.data;Ca=cb.stride;Za=Za.offset;if(cb.isInstancedInterleavedBuffer){for(var rb=0;rb<Ja.locationSize;rb++)u(Ja.location+rb,cb.meshPerAttribute);aa.isInstancedMesh!==!0&&ka._maxInstanceCount===void 0&&(ka._maxInstanceCount=cb.meshPerAttribute*cb.count)}else for(cb=0;cb<Ja.locationSize;cb++)n(Ja.location+cb);a.bindBuffer(a.ARRAY_BUFFER,gb);for(let Cb=0;Cb<Ja.locationSize;Cb++){gb=Ja.location+Cb;cb=Aa/Ja.locationSize;
rb=sa;var Ya=wa,nb=Ca*Ba,ob=(Za+Aa/Ja.locationSize*Cb)*Ba;Na===!0?a.vertexAttribIPointer(gb,cb,rb,nb,ob):a.vertexAttribPointer(gb,cb,rb,Ya,nb,ob)}}else{if(Za.isInstancedBufferAttribute){for(Ca=0;Ca<Ja.locationSize;Ca++)u(Ja.location+Ca,Za.meshPerAttribute);aa.isInstancedMesh!==!0&&ka._maxInstanceCount===void 0&&(ka._maxInstanceCount=Za.meshPerAttribute*Za.count)}else for(Ca=0;Ca<Ja.locationSize;Ca++)n(Ja.location+Ca);a.bindBuffer(a.ARRAY_BUFFER,gb);for(nb=0;nb<Ja.locationSize;nb++)Ca=Ja.location+
nb,Za=Aa/Ja.locationSize,gb=sa,cb=wa,rb=Aa*Ba,Ya=Aa/Ja.locationSize*nb*Ba,Na===!0?a.vertexAttribIPointer(Ca,Za,gb,rb,Ya):a.vertexAttribPointer(Ca,Za,gb,cb,rb,Ya)}}}else if(da!==void 0&&(wa=da[ub],wa!==void 0))switch(wa.length){case 2:a.vertexAttrib2fv(Ja.location,wa);break;case 3:a.vertexAttrib3fv(Ja.location,wa);break;case 4:a.vertexAttrib4fv(Ja.location,wa);break;default:a.vertexAttrib1fv(Ja.location,wa)}}E();qa!==null&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.get(qa).buffer)}},reset:F,resetDefaultState:H,
dispose:function(){F();for(const aa in R){const da=R[aa];for(const U in da){const ka=da[U];for(const qa in ka)a.deleteVertexArray(ka[qa].object),delete ka[qa];delete da[U]}delete R[aa]}},releaseStatesOfGeometry:function(aa){if(R[aa.id]!==void 0){var da=R[aa.id];for(const U in da){const ka=da[U];for(const qa in ka)a.deleteVertexArray(ka[qa].object),delete ka[qa];delete da[U]}delete R[aa.id]}},releaseStatesOfProgram:function(aa){for(const da in R){const U=R[da];if(U[aa.id]===void 0)continue;const ka=
U[aa.id];for(const qa in ka)a.deleteVertexArray(ka[qa].object),delete ka[qa];delete U[aa.id]}},initAttributes:h,enableAttribute:n,disableUnusedAttributes:E}}function La(a,b,d){function h(u,E,F){F!==0&&(a.drawArraysInstanced(n,u,E,F),d.update(E,n,F))}let n;this.setMode=function(u){n=u};this.render=function(u,E){a.drawArrays(n,u,E);d.update(E,n,1)};this.renderInstances=h;this.renderMultiDraw=function(u,E,F){if(F!==0){b.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,u,0,E,0,F);u=0;for(let H=0;H<F;H++)u+=
E[H];d.update(u,n,1)}};this.renderMultiDrawInstances=function(u,E,F,H){if(F!==0){var M=b.get("WEBGL_multi_draw");if(M===null)for(F=0;F<u.length;F++)h(u[F],E[F],H[F]);else{M.multiDrawArraysInstancedWEBGL(n,u,0,E,0,H,0,F);u=0;for(M=0;M<F;M++)u+=E[M]*H[M];d.update(u,n,1)}}}}function sd(a,b,d,h){function n(qa){if(qa==="highp"){if(a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision>0)return"highp";qa="mediump"}return qa===
"mediump"&&a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u,E=d.precision!==void 0?d.precision:"highp";var F=n(E);F!==E&&(console.warn("THREE.WebGLRenderer:",E,"not supported, using",F,"instead."),E=F);F=d.logarithmicDepthBuffer===!0;d=d.reversedDepthBuffer===!0&&b.has("EXT_clip_control");const H=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),M=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
R=a.getParameter(a.MAX_TEXTURE_SIZE),T=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),X=a.getParameter(a.MAX_VERTEX_ATTRIBS),ea=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),aa=a.getParameter(a.MAX_VARYING_VECTORS),da=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),U=M>0,ka=a.getParameter(a.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:function(){if(u!==void 0)return u;if(b.has("EXT_texture_filter_anisotropic")===!0){const qa=b.get("EXT_texture_filter_anisotropic");u=a.getParameter(qa.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else u=
0;return u},getMaxPrecision:n,textureFormatReadable:function(qa){return qa!==1023&&h.convert(qa)!==a.getParameter(a.IMPLEMENTATION_COLOR_READ_FORMAT)?!1:!0},textureTypeReadable:function(qa){const wa=qa===1016&&(b.has("EXT_color_buffer_half_float")||b.has("EXT_color_buffer_float"));return qa===1009||h.convert(qa)===a.getParameter(a.IMPLEMENTATION_COLOR_READ_TYPE)||qa===1015||wa?!0:!1},precision:E,logarithmicDepthBuffer:F,reversedDepthBuffer:d,maxTextures:H,maxVertexTextures:M,maxTextureSize:R,maxCubemapSize:T,
maxAttributes:X,maxVertexUniforms:ea,maxVaryings:aa,maxFragmentUniforms:da,vertexTextures:U,maxSamples:ka}}function Wb(a){function b(R,T,X,ea){const aa=R!==null?R.length:0;let da=null;if(aa!==0){da=M.value;if(ea!==!0||da===null){ea=X+aa*4;T=T.matrixWorldInverse;H.getNormalMatrix(T);if(da===null||da.length<ea)da=new Float32Array(ea);for(let U=0,ka=X;U!==aa;++U,ka+=4)F.copy(R[U]).applyMatrix4(T,H),F.normal.toArray(da,ka),da[ka+3]=F.constant}M.value=da;M.needsUpdate=!0}d.numPlanes=aa;d.numIntersection=
0;return da}const d=this;let h=null,n=0,u=!1,E=!1;const F=new xe,H=new Lb,M={value:null,needsUpdate:!1};this.uniform=M;this.numIntersection=this.numPlanes=0;this.init=function(R,T){const X=R.length!==0||T||n!==0||u;u=T;n=R.length;return X};this.beginShadows=function(){E=!0;b(null)};this.endShadows=function(){E=!1};this.setGlobalState=function(R,T){h=b(R,T,0)};this.setState=function(R,T,X){const ea=R.clippingPlanes,aa=R.clipIntersection;var da=R.clipShadows;R=a.get(R);if(!u||ea===null||ea.length===
0||E&&!da)E?b(null):(M.value!==h&&(M.value=h,M.needsUpdate=n>0),d.numPlanes=n,d.numIntersection=0);else{da=E?0:n;const U=da*4;let ka=R.clippingState||null;M.value=ka;ka=b(ea,T,U,X);for(T=0;T!==U;++T)ka[T]=h[T];R.clippingState=ka;this.numIntersection=aa?this.numPlanes:0;this.numPlanes+=da}}}function Pc(a){function b(n,u){u===303?n.mapping=301:u===304&&(n.mapping=302);return n}function d(n){n=n.target;n.removeEventListener("dispose",d);const u=h.get(n);u!==void 0&&(h.delete(n),u.dispose())}let h=new WeakMap;
return{get:function(n){if(n&&n.isTexture){var u=n.mapping;if(u===303||u===304)return h.has(n)?(u=h.get(n).texture,b(u,n.mapping)):(u=n.image)&&u.height>0?(u=new ek(u.height),u.fromEquirectangularTexture(a,n),h.set(n,u),n.addEventListener("dispose",d),b(u.texture,n.mapping)):null}return n},dispose:function(){h=new WeakMap}}}function $c(a,b,d){a=new zd(a,b,d);a.texture.mapping=306;a.texture.name="PMREM.cubeUv";a.scissorTest=!0;return a}function zc(a,b,d,h,n){a.viewport.set(b,d,h,n);a.scissor.set(b,
d,h,n)}function Va(){return new Jd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Ra(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include \x3ccommon\x3e\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection \x3d normalize( vOutputDirection );\n\t\t\t\tvec2 uv \x3d equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor \x3d vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function uc(){return new Jd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Ra(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor \x3d textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function Ra(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv \x3d 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction \x3d vec3( uv, 1.0 );\n\n\t\t\tif ( face \x3d\x3d 0.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face \x3d\x3d 1.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face \x3d\x3d 2.0 ) {\n\n\t\t\t\tdirection.x *\x3d -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face \x3d\x3d 3.0 ) {\n\n\t\t\t\tdirection \x3d direction.zyx;\n\t\t\t\tdirection.xz *\x3d -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face \x3d\x3d 4.0 ) {\n\n\t\t\t\tdirection \x3d direction.xzy;\n\t\t\t\tdirection.xy *\x3d -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face \x3d\x3d 5.0 ) {\n\n\t\t\t\tdirection.z *\x3d -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection \x3d getDirection( uv, faceIndex );\n\t\t\tgl_Position \x3d vec4( position, 1.0 );\n\n\t\t}\n\t"}
function Ab(a){function b(n){n=n.target;n.removeEventListener("dispose",b);const u=d.get(n);u!==void 0&&(d.delete(n),u.dispose())}let d=new WeakMap,h=null;return{get:function(n){if(n&&n.isTexture){var u=n.mapping;const H=u===303||u===304;var E=u===301||u===302;if(H||E){u=d.get(n);var F=u!==void 0?u.texture.pmremVersion:0;if(n.isRenderTargetTexture&&n.pmremVersion!==F)return h===null&&(h=new ci(a)),u=H?h.fromEquirectangular(n,u):h.fromCubemap(n,u),u.texture.pmremVersion=n.pmremVersion,d.set(n,u),u.texture;
if(u!==void 0)return u.texture;u=n.image;if(!(F=H&&u&&u.height>0)){if(E=E&&u){E=0;for(F=0;F<6;F++)u[F]!==void 0&&E++;E=E===6}F=E}return F?(h===null&&(h=new ci(a)),u=H?h.fromEquirectangular(n):h.fromCubemap(n),u.texture.pmremVersion=n.pmremVersion,d.set(n,u),n.addEventListener("dispose",b),u.texture):null}}return n},dispose:function(){d=new WeakMap;h!==null&&(h.dispose(),h=null)}}}function xc(a){function b(h){if(d[h]!==void 0)return d[h];let n;switch(h){case "WEBGL_depth_texture":n=a.getExtension("WEBGL_depth_texture")||
a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":n=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":n=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;
case "WEBGL_compressed_texture_pvrtc":n=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=a.getExtension(h)}return d[h]=n}const d={};return{has:function(h){return b(h)!==null},init:function(){b("EXT_color_buffer_float");b("WEBGL_clip_cull_distance");b("OES_texture_float_linear");b("EXT_color_buffer_half_float");b("WEBGL_multisampled_render_to_texture");b("WEBGL_render_shared_exponent")},get:function(h){const n=b(h);n===null&&
t("THREE.WebGLRenderer: "+h+" extension not supported.");return n}}}function Jc(a,b,d,h){function n(H){H=H.target;H.index!==null&&b.remove(H.index);for(var M in H.attributes)b.remove(H.attributes[M]);H.removeEventListener("dispose",n);delete E[H.id];if(M=F.get(H))b.remove(M),F.delete(H);h.releaseStatesOfGeometry(H);H.isInstancedBufferGeometry===!0&&delete H._maxInstanceCount;d.memory.geometries--}function u(H){var M=[],R=H.index,T=H.attributes.position;if(R!==null){T=R.array;R=R.version;for(let aa=
0,da=T.length;aa<da;aa+=3){var X=T[aa+0],ea=T[aa+1];const U=T[aa+2];M.push(X,ea,ea,U,U,X)}}else if(T!==void 0){X=T.array;R=T.version;for(let aa=0,da=X.length/3-1;aa<da;aa+=3)T=aa+0,X=aa+1,ea=aa+2,M.push(T,X,X,ea,ea,T)}else return;M=new (m(M)?di:ei)(M,1);M.version=R;(R=F.get(H))&&b.remove(R);F.set(H,M)}const E={},F=new WeakMap;return{get:function(H,M){if(E[M.id]===!0)return M;M.addEventListener("dispose",n);E[M.id]=!0;d.memory.geometries++;return M},update:function(H){H=H.attributes;for(const M in H)b.update(H[M],
a.ARRAY_BUFFER)},getWireframeAttribute:function(H){const M=F.get(H);if(M){const R=H.index;R!==null&&M.version<R.version&&u(H)}else u(H);return F.get(H)}}}function Me(a,b,d){function h(F,H,M){M!==0&&(a.drawElementsInstanced(n,H,u,F*E,M),d.update(H,n,M))}let n,u,E;this.setMode=function(F){n=F};this.setIndex=function(F){u=F.type;E=F.bytesPerElement};this.render=function(F,H){a.drawElements(n,H,u,F*E);d.update(H,n,1)};this.renderInstances=h;this.renderMultiDraw=function(F,H,M){if(M!==0){b.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,
H,0,u,F,0,M);F=0;for(let R=0;R<M;R++)F+=H[R];d.update(F,n,1)}};this.renderMultiDrawInstances=function(F,H,M,R){if(M!==0){var T=b.get("WEBGL_multi_draw");if(T===null)for(M=0;M<F.length;M++)h(F[M]/E,H[M],R[M]);else{T.multiDrawElementsInstancedWEBGL(n,H,0,u,F,0,R,0,M);F=0;for(T=0;T<M;T++)F+=H[T]*R[T];d.update(F,n,1)}}}}function gc(a){const b={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:b,programs:null,autoReset:!0,reset:function(){b.calls=0;b.triangles=
0;b.points=0;b.lines=0},update:function(d,h,n){b.calls++;switch(h){case a.TRIANGLES:b.triangles+=d/3*n;break;case a.LINES:b.lines+=d/2*n;break;case a.LINE_STRIP:b.lines+=n*(d-1);break;case a.LINE_LOOP:b.lines+=n*d;break;case a.POINTS:b.points+=n*d;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",h)}}}}function eg(a,b,d){const h=new WeakMap,n=new ec;return{update:function(u,E,F){const H=u.morphTargetInfluences;var M=E.morphAttributes.position||E.morphAttributes.normal||E.morphAttributes.color;
M=M!==void 0?M.length:0;var R=h.get(E);if(R===void 0||R.count!==M){R!==void 0&&R.texture.dispose();R=E.morphAttributes.position!==void 0;const X=E.morphAttributes.normal!==void 0,ea=E.morphAttributes.color!==void 0,aa=E.morphAttributes.position||[],da=E.morphAttributes.normal||[],U=E.morphAttributes.color||[];var T=0;R===!0&&(T=1);X===!0&&(T=2);ea===!0&&(T=3);let ka=E.attributes.position.count*T,qa=1;ka>b.maxTextureSize&&(qa=Math.ceil(ka/b.maxTextureSize),ka=b.maxTextureSize);const wa=new Float32Array(ka*
qa*4*M),sa=new yf(wa,ka,qa,M);sa.type=1015;sa.needsUpdate=!0;T*=4;for(let Ba=0;Ba<M;Ba++){const Na=aa[Ba],Ca=da[Ba],Ja=U[Ba],Qa=ka*qa*4*Ba;for(let Za=0;Za<Na.count;Za++){const gb=Za*T;R===!0&&(n.fromBufferAttribute(Na,Za),wa[Qa+gb+0]=n.x,wa[Qa+gb+1]=n.y,wa[Qa+gb+2]=n.z,wa[Qa+gb+3]=0);X===!0&&(n.fromBufferAttribute(Ca,Za),wa[Qa+gb+4]=n.x,wa[Qa+gb+5]=n.y,wa[Qa+gb+6]=n.z,wa[Qa+gb+7]=0);ea===!0&&(n.fromBufferAttribute(Ja,Za),wa[Qa+gb+8]=n.x,wa[Qa+gb+9]=n.y,wa[Qa+gb+10]=n.z,wa[Qa+gb+11]=Ja.itemSize===
4?n.w:1)}}R={count:M,texture:sa,size:new Xa(ka,qa)};h.set(E,R);function Aa(){sa.dispose();h.delete(E);E.removeEventListener("dispose",Aa)}E.addEventListener("dispose",Aa)}if(u.isInstancedMesh===!0&&u.morphTexture!==null)F.getUniforms().setValue(a,"morphTexture",u.morphTexture,d);else{u=0;for(M=0;M<H.length;M++)u+=H[M];u=E.morphTargetsRelative?1:1-u;F.getUniforms().setValue(a,"morphTargetBaseInfluence",u);F.getUniforms().setValue(a,"morphTargetInfluences",H)}F.getUniforms().setValue(a,"morphTargetsTexture",
R.texture,d);F.getUniforms().setValue(a,"morphTargetsTextureSize",R.size)}}}function qf(a,b,d,h){function n(E){E=E.target;E.removeEventListener("dispose",n);d.remove(E.instanceMatrix);E.instanceColor!==null&&d.remove(E.instanceColor)}let u=new WeakMap;return{update:function(E){const F=h.render.frame,H=b.get(E,E.geometry);u.get(H)!==F&&(b.update(H),u.set(H,F));E.isInstancedMesh&&(E.hasEventListener("dispose",n)===!1&&E.addEventListener("dispose",n),u.get(E)!==F&&(d.update(E.instanceMatrix,a.ARRAY_BUFFER),
E.instanceColor!==null&&d.update(E.instanceColor,a.ARRAY_BUFFER),u.set(E,F)));E.isSkinnedMesh&&(E=E.skeleton,u.get(E)!==F&&(E.update(),u.set(E,F)));return H},dispose:function(){u=new WeakMap}}}function Eb(a,b,d){const h=a[0];if(h<=0||h>0)return a;const n=b*d;let u=fk[n];u===void 0&&(u=new Float32Array(n),fk[n]=u);if(b!==0){h.toArray(u,0);for(let E=1,F=0;E!==b;++E)F+=d,a[E].toArray(u,F)}return u}function vc(a,b){if(a.length!==b.length)return!1;for(let d=0,h=a.length;d<h;d++)if(a[d]!==b[d])return!1;
return!0}function Ac(a,b){for(let d=0,h=b.length;d<h;d++)a[d]=b[d]}function td(a,b){let d=gk[b];d===void 0&&(d=new Int32Array(b),gk[b]=d);for(let h=0;h!==b;++h)d[h]=a.allocateTextureUnit();return d}function Ne(a,b){const d=this.cache;d[0]!==b&&(a.uniform1f(this.addr,b),d[0]=b)}function ad(a,b){const d=this.cache;if(b.x!==void 0){if(d[0]!==b.x||d[1]!==b.y)a.uniform2f(this.addr,b.x,b.y),d[0]=b.x,d[1]=b.y}else vc(d,b)||(a.uniform2fv(this.addr,b),Ac(d,b))}function Oe(a,b){const d=this.cache;if(b.x!==
void 0){if(d[0]!==b.x||d[1]!==b.y||d[2]!==b.z)a.uniform3f(this.addr,b.x,b.y,b.z),d[0]=b.x,d[1]=b.y,d[2]=b.z}else if(b.r!==void 0){if(d[0]!==b.r||d[1]!==b.g||d[2]!==b.b)a.uniform3f(this.addr,b.r,b.g,b.b),d[0]=b.r,d[1]=b.g,d[2]=b.b}else vc(d,b)||(a.uniform3fv(this.addr,b),Ac(d,b))}function Qe(a,b){const d=this.cache;if(b.x!==void 0){if(d[0]!==b.x||d[1]!==b.y||d[2]!==b.z||d[3]!==b.w)a.uniform4f(this.addr,b.x,b.y,b.z,b.w),d[0]=b.x,d[1]=b.y,d[2]=b.z,d[3]=b.w}else vc(d,b)||(a.uniform4fv(this.addr,b),Ac(d,
b))}function Fc(a,b){const d=this.cache,h=b.elements;h===void 0?vc(d,b)||(a.uniformMatrix2fv(this.addr,!1,b),Ac(d,b)):vc(d,h)||(hk.set(h),a.uniformMatrix2fv(this.addr,!1,hk),Ac(d,h))}function Pe(a,b){const d=this.cache,h=b.elements;h===void 0?vc(d,b)||(a.uniformMatrix3fv(this.addr,!1,b),Ac(d,b)):vc(d,h)||(ik.set(h),a.uniformMatrix3fv(this.addr,!1,ik),Ac(d,h))}function we(a,b){const d=this.cache,h=b.elements;h===void 0?vc(d,b)||(a.uniformMatrix4fv(this.addr,!1,b),Ac(d,b)):vc(d,h)||(jk.set(h),a.uniformMatrix4fv(this.addr,
!1,jk),Ac(d,h))}function ac(a,b){const d=this.cache;d[0]!==b&&(a.uniform1i(this.addr,b),d[0]=b)}function nd(a,b){const d=this.cache;if(b.x!==void 0){if(d[0]!==b.x||d[1]!==b.y)a.uniform2i(this.addr,b.x,b.y),d[0]=b.x,d[1]=b.y}else vc(d,b)||(a.uniform2iv(this.addr,b),Ac(d,b))}function Re(a,b){const d=this.cache;if(b.x!==void 0){if(d[0]!==b.x||d[1]!==b.y||d[2]!==b.z)a.uniform3i(this.addr,b.x,b.y,b.z),d[0]=b.x,d[1]=b.y,d[2]=b.z}else vc(d,b)||(a.uniform3iv(this.addr,b),Ac(d,b))}function cd(a,b){const d=
this.cache;if(b.x!==void 0){if(d[0]!==b.x||d[1]!==b.y||d[2]!==b.z||d[3]!==b.w)a.uniform4i(this.addr,b.x,b.y,b.z,b.w),d[0]=b.x,d[1]=b.y,d[2]=b.z,d[3]=b.w}else vc(d,b)||(a.uniform4iv(this.addr,b),Ac(d,b))}function bd(a,b){const d=this.cache;d[0]!==b&&(a.uniform1ui(this.addr,b),d[0]=b)}function tb(a,b){const d=this.cache;if(b.x!==void 0){if(d[0]!==b.x||d[1]!==b.y)a.uniform2ui(this.addr,b.x,b.y),d[0]=b.x,d[1]=b.y}else vc(d,b)||(a.uniform2uiv(this.addr,b),Ac(d,b))}function Se(a,b){const d=this.cache;if(b.x!==
void 0){if(d[0]!==b.x||d[1]!==b.y||d[2]!==b.z)a.uniform3ui(this.addr,b.x,b.y,b.z),d[0]=b.x,d[1]=b.y,d[2]=b.z}else vc(d,b)||(a.uniform3uiv(this.addr,b),Ac(d,b))}function Yb(a,b){const d=this.cache;if(b.x!==void 0){if(d[0]!==b.x||d[1]!==b.y||d[2]!==b.z||d[3]!==b.w)a.uniform4ui(this.addr,b.x,b.y,b.z,b.w),d[0]=b.x,d[1]=b.y,d[2]=b.z,d[3]=b.w}else vc(d,b)||(a.uniform4uiv(this.addr,b),Ac(d,b))}function Ia(a,b,d){const h=this.cache,n=d.allocateTextureUnit();h[0]!==n&&(a.uniform1i(this.addr,n),h[0]=n);this.type===
a.SAMPLER_2D_SHADOW?(kk.compareFunction=515,a=kk):a=lk;d.setTexture2D(b||a,n)}function hc(a,b,d){const h=this.cache,n=d.allocateTextureUnit();h[0]!==n&&(a.uniform1i(this.addr,n),h[0]=n);d.setTexture3D(b||mk,n)}function dc(a,b,d){const h=this.cache,n=d.allocateTextureUnit();h[0]!==n&&(a.uniform1i(this.addr,n),h[0]=n);d.setTextureCube(b||nk,n)}function Te(a,b,d){const h=this.cache,n=d.allocateTextureUnit();h[0]!==n&&(a.uniform1i(this.addr,n),h[0]=n);d.setTexture2DArray(b||ok,n)}function gg(a){switch(a){case 5126:return Ne;
case 35664:return ad;case 35665:return Oe;case 35666:return Qe;case 35674:return Fc;case 35675:return Pe;case 35676:return we;case 5124:case 35670:return ac;case 35667:case 35671:return nd;case 35668:case 35672:return Re;case 35669:case 35673:return cd;case 5125:return bd;case 36294:return tb;case 36295:return Se;case 36296:return Yb;case 35678:case 36198:case 36298:case 36306:case 35682:return Ia;case 35679:case 36299:case 36307:return hc;case 35680:case 36300:case 36308:case 36293:return dc;case 36289:case 36303:case 36311:case 36292:return Te}}
function hg(a,b){a.uniform1fv(this.addr,b)}function rf(a,b){b=Eb(b,this.size,2);a.uniform2fv(this.addr,b)}function ig(a,b){b=Eb(b,this.size,3);a.uniform3fv(this.addr,b)}function jg(a,b){b=Eb(b,this.size,4);a.uniform4fv(this.addr,b)}function Vd(a,b){b=Eb(b,this.size,4);a.uniformMatrix2fv(this.addr,!1,b)}function Ue(a,b){b=Eb(b,this.size,9);a.uniformMatrix3fv(this.addr,!1,b)}function sf(a,b){b=Eb(b,this.size,16);a.uniformMatrix4fv(this.addr,!1,b)}function se(a,b){a.uniform1iv(this.addr,b)}function cg(a,
b){a.uniform2iv(this.addr,b)}function dg(a,b){a.uniform3iv(this.addr,b)}function tf(a,b){a.uniform4iv(this.addr,b)}function uf(a,b){a.uniform1uiv(this.addr,b)}function vf(a,b){a.uniform2uiv(this.addr,b)}function Z(a,b){a.uniform3uiv(this.addr,b)}function C(a,b){a.uniform4uiv(this.addr,b)}function w(a,b,d){const h=this.cache,n=b.length,u=td(d,n);vc(h,u)||(a.uniform1iv(this.addr,u),Ac(h,u));for(a=0;a!==n;++a)d.setTexture2D(b[a]||lk,u[a])}function c(a,b,d){const h=this.cache,n=b.length,u=td(d,n);vc(h,
u)||(a.uniform1iv(this.addr,u),Ac(h,u));for(a=0;a!==n;++a)d.setTexture3D(b[a]||mk,u[a])}function A(a,b,d){const h=this.cache,n=b.length,u=td(d,n);vc(h,u)||(a.uniform1iv(this.addr,u),Ac(h,u));for(a=0;a!==n;++a)d.setTextureCube(b[a]||nk,u[a])}function P(a,b,d){const h=this.cache,n=b.length,u=td(d,n);vc(h,u)||(a.uniform1iv(this.addr,u),Ac(h,u));for(a=0;a!==n;++a)d.setTexture2DArray(b[a]||ok,u[a])}function fa(a){switch(a){case 5126:return hg;case 35664:return rf;case 35665:return ig;case 35666:return jg;
case 35674:return Vd;case 35675:return Ue;case 35676:return sf;case 5124:case 35670:return se;case 35667:case 35671:return cg;case 35668:case 35672:return dg;case 35669:case 35673:return tf;case 5125:return uf;case 36294:return vf;case 36295:return Z;case 36296:return C;case 35678:case 36198:case 36298:case 36306:case 35682:return w;case 35679:case 36299:case 36307:return c;case 35680:case 36300:case 36308:case 36293:return A;case 36289:case 36303:case 36311:case 36292:return P}}function Da(a,b,d){b=
a.createShader(b);a.shaderSource(b,d);a.compileShader(b);return b}function kb(a){$b._getMatrix(pk,$b.workingColorSpace,a);const b=`mat3( ${pk.elements.map(d=>d.toFixed(4))} )`;switch($b.getTransfer(a)){case "linear":return[b,"LinearTransferOETF"];case "srgb":return[b,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",a),[b,"LinearTransferOETF"]}}function zb(a,b,d){var h=a.getShaderParameter(b,a.COMPILE_STATUS),n=(a.getShaderInfoLog(b)||"").trim();if(h&&
n==="")return"";if(h=/ERROR: 0:(\d+)/.exec(n)){h=parseInt(h[1]);d=d.toUpperCase()+"\n\n"+n+"\n\n";a=a.getShaderSource(b).split("\n");b=[];var u=Math.max(h-6,0);for(n=Math.min(h+6,a.length);u<n;u++){const E=u+1;b.push(`${E===h?"\x3e":" "} ${E}: ${a[u]}`)}h=b.join("\n");return d+h}return n}function Hc(a,b){b=kb(b);return[`vec4 ${a}( vec4 value ) {`,`	return ${b[1]}( vec4( value.rgb * ${b[0]}, value.a ) );`,"}"].join("\n")}function Zc(a,b){switch(b){case 1:b="Linear";break;case 2:b="Reinhard";break;
case 3:b="Cineon";break;case 4:b="ACESFilmic";break;case 6:b="AgX";break;case 7:b="Neutral";break;case 5:b="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",b),b="Linear"}return"vec3 "+a+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}function Oc(){$b.getLuminanceCoefficients(Xg);const a=Xg.x.toFixed(4),b=Xg.y.toFixed(4),d=Xg.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${a}, ${b}, ${d} );`,"\treturn dot( weights, rgb );\n}"].join("\n")}
function Ud(a){const b=[];for(const d in a){const h=a[d];h!==!1&&b.push("#define "+d+" "+h)}return b.join("\n")}function Wc(a){return a!==""}function fg(a,b){const d=b.numSpotLightShadows+b.numSpotLightMaps-b.numSpotLightShadowsWithMaps;return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,b.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,d).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,
b.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,b.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,b.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,b.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,b.numPointLightShadows)}function Yg(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}function sg(a,b){a=Ub[b];if(a===void 0){const d=pm.get(b);if(d!==void 0)a=Ub[d],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',
b,d);else throw Error("Can not resolve #include \x3c"+b+"\x3e");}return a.replace(fi,sg)}function Zg(a,b,d,h){a="";for(b=parseInt(b);b<parseInt(d);b++)a+=h.replace(/\[\s*i\s*\]/g,"[ "+b+" ]").replace(/UNROLLED_LOOP_INDEX/g,b);return a}function $g(a){let b=`precision ${a.precision} float;
	precision ${a.precision} int;
	precision ${a.precision} sampler2D;
	precision ${a.precision} samplerCube;
	precision ${a.precision} sampler3D;
	precision ${a.precision} sampler2DArray;
	precision ${a.precision} sampler2DShadow;
	precision ${a.precision} samplerCubeShadow;
	precision ${a.precision} sampler2DArrayShadow;
	precision ${a.precision} isampler2D;
	precision ${a.precision} isampler3D;
	precision ${a.precision} isamplerCube;
	precision ${a.precision} isampler2DArray;
	precision ${a.precision} usampler2D;
	precision ${a.precision} usampler3D;
	precision ${a.precision} usamplerCube;
	precision ${a.precision} usampler2DArray;
	`;a.precision==="highp"?b+="\n#define HIGH_PRECISION":a.precision==="mediump"?b+="\n#define MEDIUM_PRECISION":a.precision==="lowp"&&(b+="\n#define LOW_PRECISION");return b}function gi(a){let b="SHADOWMAP_TYPE_BASIC";a.shadowMapType===1?b="SHADOWMAP_TYPE_PCF":a.shadowMapType===2?b="SHADOWMAP_TYPE_PCF_SOFT":a.shadowMapType===3&&(b="SHADOWMAP_TYPE_VSM");return b}function hi(a){let b="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case 301:case 302:b="ENVMAP_TYPE_CUBE";break;case 306:b="ENVMAP_TYPE_CUBE_UV"}return b}
function ii(a){let b="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case 302:b="ENVMAP_MODE_REFRACTION"}return b}function ji(a){let b="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case 0:b="ENVMAP_BLENDING_MULTIPLY";break;case 1:b="ENVMAP_BLENDING_MIX";break;case 2:b="ENVMAP_BLENDING_ADD"}return b}function ki(a){a=a.envMapCubeUVHeight;if(a===null)return null;const b=Math.log2(a)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,b),112)),texelHeight:1/a,maxMip:b}}function li(a,b,d,h){function n(Ca){if(a.debug.checkShaderErrors){var Ja=
u.getProgramInfoLog(U)||"",Qa=u.getShaderInfoLog(wa)||"",Za=u.getShaderInfoLog(sa)||"";Ja=Ja.trim();Qa=Qa.trim();Za=Za.trim();var gb=!0,cb=!0;if(u.getProgramParameter(U,u.LINK_STATUS)===!1)if(gb=!1,typeof a.debug.onShaderError==="function")a.debug.onShaderError(u,U,wa,sa);else{const rb=zb(u,wa,"vertex"),Ya=zb(u,sa,"fragment");console.error("THREE.WebGLProgram: Shader Error "+u.getError()+" - VALIDATE_STATUS "+u.getProgramParameter(U,u.VALIDATE_STATUS)+"\n\nMaterial Name: "+Ca.name+"\nMaterial Type: "+
Ca.type+"\n\nProgram Info Log: "+Ja+"\n"+rb+"\n"+Ya)}else if(Ja!=="")console.warn("THREE.WebGLProgram: Program Info Log:",Ja);else if(Qa===""||Za==="")cb=!1;cb&&(Ca.diagnostics={runnable:gb,programLog:Ja,vertexShader:{log:Qa,prefix:ka},fragmentShader:{log:Za,prefix:qa}})}u.deleteShader(wa);u.deleteShader(sa);Aa=new ah(u,U);Ca={};Ja=u.getProgramParameter(U,u.ACTIVE_ATTRIBUTES);for(Qa=0;Qa<Ja;Qa++)Za=u.getActiveAttrib(U,Qa),gb=Za.name,cb=1,Za.type===u.FLOAT_MAT2&&(cb=2),Za.type===u.FLOAT_MAT3&&(cb=
3),Za.type===u.FLOAT_MAT4&&(cb=4),Ca[gb]={type:Za.type,location:u.getAttribLocation(U,gb),locationSize:cb};Ba=Ca}const u=a.getContext();var E=d.defines;let F=d.vertexShader;var H=d.fragmentShader;const M=gi(d),R=hi(d),T=ii(d),X=ji(d),ea=ki(d),aa=[d.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",d.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Wc).join("\n"),da=Ud(E),U=u.createProgram();let ka,qa;E=d.glslVersion?"#version "+d.glslVersion+"\n":
"";d.isRawShaderMaterial?(ka=["#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,da].filter(Wc).join("\n"),ka.length>0&&(ka+="\n"),qa=["#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,da].filter(Wc).join("\n"),qa.length>0&&(qa+="\n")):(ka=[$g(d),"#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,da,d.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",d.batching?"#define USE_BATCHING":"",d.batchingColor?"#define USE_BATCHING_COLOR":
"",d.instancing?"#define USE_INSTANCING":"",d.instancingColor?"#define USE_INSTANCING_COLOR":"",d.instancingMorph?"#define USE_INSTANCING_MORPH":"",d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp2?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define "+T:"",d.lightMap?"#define USE_LIGHTMAP":"",d.aoMap?"#define USE_AOMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":
"",d.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",d.displacementMap?"#define USE_DISPLACEMENTMAP":"",d.emissiveMap?"#define USE_EMISSIVEMAP":"",d.anisotropy?"#define USE_ANISOTROPY":"",d.anisotropyMap?"#define USE_ANISOTROPYMAP":"",d.clearcoatMap?"#define USE_CLEARCOATMAP":"",d.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",d.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",d.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",d.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":
"",d.specularMap?"#define USE_SPECULARMAP":"",d.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",d.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",d.roughnessMap?"#define USE_ROUGHNESSMAP":"",d.metalnessMap?"#define USE_METALNESSMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.alphaHash?"#define USE_ALPHAHASH":"",d.transmission?"#define USE_TRANSMISSION":"",d.transmissionMap?"#define USE_TRANSMISSIONMAP":"",d.thicknessMap?"#define USE_THICKNESSMAP":"",d.sheenColorMap?"#define USE_SHEEN_COLORMAP":
"",d.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",d.mapUv?"#define MAP_UV "+d.mapUv:"",d.alphaMapUv?"#define ALPHAMAP_UV "+d.alphaMapUv:"",d.lightMapUv?"#define LIGHTMAP_UV "+d.lightMapUv:"",d.aoMapUv?"#define AOMAP_UV "+d.aoMapUv:"",d.emissiveMapUv?"#define EMISSIVEMAP_UV "+d.emissiveMapUv:"",d.bumpMapUv?"#define BUMPMAP_UV "+d.bumpMapUv:"",d.normalMapUv?"#define NORMALMAP_UV "+d.normalMapUv:"",d.displacementMapUv?"#define DISPLACEMENTMAP_UV "+d.displacementMapUv:"",d.metalnessMapUv?"#define METALNESSMAP_UV "+
d.metalnessMapUv:"",d.roughnessMapUv?"#define ROUGHNESSMAP_UV "+d.roughnessMapUv:"",d.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+d.anisotropyMapUv:"",d.clearcoatMapUv?"#define CLEARCOATMAP_UV "+d.clearcoatMapUv:"",d.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+d.clearcoatNormalMapUv:"",d.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+d.clearcoatRoughnessMapUv:"",d.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+d.iridescenceMapUv:"",d.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+
d.iridescenceThicknessMapUv:"",d.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+d.sheenColorMapUv:"",d.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+d.sheenRoughnessMapUv:"",d.specularMapUv?"#define SPECULARMAP_UV "+d.specularMapUv:"",d.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+d.specularColorMapUv:"",d.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+d.specularIntensityMapUv:"",d.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+d.transmissionMapUv:"",d.thicknessMapUv?"#define THICKNESSMAP_UV "+
d.thicknessMapUv:"",d.vertexTangents&&d.flatShading===!1?"#define USE_TANGENT":"",d.vertexColors?"#define USE_COLOR":"",d.vertexAlphas?"#define USE_COLOR_ALPHA":"",d.vertexUv1s?"#define USE_UV1":"",d.vertexUv2s?"#define USE_UV2":"",d.vertexUv3s?"#define USE_UV3":"",d.pointsUvs?"#define USE_POINTS_UV":"",d.flatShading?"#define FLAT_SHADED":"",d.skinning?"#define USE_SKINNING":"",d.morphTargets?"#define USE_MORPHTARGETS":"",d.morphNormals&&d.flatShading===!1?"#define USE_MORPHNORMALS":"",d.morphColors?
"#define USE_MORPHCOLORS":"",d.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+d.morphTextureStride:"",d.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+d.morphTargetsCount:"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+M:"",d.sizeAttenuation?"#define USE_SIZEATTENUATION":"",d.numLightProbes>0?"#define USE_LIGHT_PROBES":"",d.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":
"",d.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;",
"attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Wc).join("\n"),qa=[$g(d),
"#define SHADER_TYPE "+d.shaderType,"#define SHADER_NAME "+d.shaderName,da,d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp2?"#define FOG_EXP2":"",d.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",d.map?"#define USE_MAP":"",d.matcap?"#define USE_MATCAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define "+R:"",d.envMap?"#define "+T:"",d.envMap?"#define "+X:"",ea?"#define CUBEUV_TEXEL_WIDTH "+ea.texelWidth:"",ea?"#define CUBEUV_TEXEL_HEIGHT "+ea.texelHeight:"",ea?"#define CUBEUV_MAX_MIP "+
ea.maxMip+".0":"",d.lightMap?"#define USE_LIGHTMAP":"",d.aoMap?"#define USE_AOMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",d.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",d.emissiveMap?"#define USE_EMISSIVEMAP":"",d.anisotropy?"#define USE_ANISOTROPY":"",d.anisotropyMap?"#define USE_ANISOTROPYMAP":"",d.clearcoat?"#define USE_CLEARCOAT":"",d.clearcoatMap?"#define USE_CLEARCOATMAP":"",
d.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",d.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",d.dispersion?"#define USE_DISPERSION":"",d.iridescence?"#define USE_IRIDESCENCE":"",d.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",d.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",d.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",d.roughnessMap?"#define USE_ROUGHNESSMAP":
"",d.metalnessMap?"#define USE_METALNESSMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.alphaTest?"#define USE_ALPHATEST":"",d.alphaHash?"#define USE_ALPHAHASH":"",d.sheen?"#define USE_SHEEN":"",d.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",d.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",d.transmission?"#define USE_TRANSMISSION":"",d.transmissionMap?"#define USE_TRANSMISSIONMAP":"",d.thicknessMap?"#define USE_THICKNESSMAP":"",d.vertexTangents&&d.flatShading===!1?"#define USE_TANGENT":"",
d.vertexColors||d.instancingColor||d.batchingColor?"#define USE_COLOR":"",d.vertexAlphas?"#define USE_COLOR_ALPHA":"",d.vertexUv1s?"#define USE_UV1":"",d.vertexUv2s?"#define USE_UV2":"",d.vertexUv3s?"#define USE_UV3":"",d.pointsUvs?"#define USE_POINTS_UV":"",d.gradientMap?"#define USE_GRADIENTMAP":"",d.flatShading?"#define FLAT_SHADED":"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+M:"",d.premultipliedAlpha?
"#define PREMULTIPLIED_ALPHA":"",d.numLightProbes>0?"#define USE_LIGHT_PROBES":"",d.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",d.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",d.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",d.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",d.toneMapping!==0?"#define TONE_MAPPING":"",d.toneMapping!==0?Ub.tonemapping_pars_fragment:
"",d.toneMapping!==0?Zc("toneMapping",d.toneMapping):"",d.dithering?"#define DITHERING":"",d.opaque?"#define OPAQUE":"",Ub.colorspace_pars_fragment,Hc("linearToOutputTexel",d.outputColorSpace),Oc(),d.useDepthPacking?"#define DEPTH_PACKING "+d.depthPacking:"","\n"].filter(Wc).join("\n"));F=F.replace(fi,sg);F=fg(F,d);F=Yg(F,d);H=H.replace(fi,sg);H=fg(H,d);H=Yg(H,d);F=F.replace(qk,Zg);H=H.replace(qk,Zg);d.isRawShaderMaterial!==!0&&(E="#version 300 es\n",ka=[aa,"#define attribute in\n#define varying out\n#define texture2D texture"].join("\n")+
"\n"+ka,qa=["#define varying in",d.glslVersion==="300 es"?"":"layout(location \x3d 0) out highp vec4 pc_fragColor;",d.glslVersion==="300 es"?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+
"\n"+qa);H=E+qa+H;const wa=Da(u,u.VERTEX_SHADER,E+ka+F),sa=Da(u,u.FRAGMENT_SHADER,H);u.attachShader(U,wa);u.attachShader(U,sa);d.index0AttributeName!==void 0?u.bindAttribLocation(U,0,d.index0AttributeName):d.morphTargets===!0&&u.bindAttribLocation(U,0,"position");u.linkProgram(U);let Aa;this.getUniforms=function(){Aa===void 0&&n(this);return Aa};let Ba;this.getAttributes=function(){Ba===void 0&&n(this);return Ba};let Na=d.rendererExtensionParallelShaderCompile===!1;this.isReady=function(){Na===!1&&
(Na=u.getProgramParameter(U,37297));return Na};this.destroy=function(){h.releaseStatesOfProgram(this);u.deleteProgram(U);this.program=void 0};this.type=d.shaderType;this.name=d.shaderName;this.id=qm++;this.cacheKey=b;this.usedTimes=1;this.program=U;this.vertexShader=wa;this.fragmentShader=sa;return this}function mi(a,b,d,h,n,u,E){function F(U){R.add(U);return U===0?"uv":`uv${U}`}const H=new bh,M=new rm,R=new Set,T=[],X=n.logarithmicDepthBuffer,ea=n.vertexTextures;let aa=n.precision;const da={MeshDepthMaterial:"depth",
MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(U,ka,qa,wa,sa){const Aa=wa.fog,Ba=sa.geometry;wa=U.isMeshStandardMaterial?wa.environment:
null;const Na=(wa=(U.isMeshStandardMaterial?d:b).get(U.envMap||wa))&&wa.mapping===306?wa.image.height:null,Ca=da[U.type];U.precision!==null&&(aa=n.getMaxPrecision(U.precision),aa!==U.precision&&console.warn("THREE.WebGLProgram.getParameters:",U.precision,"not supported, using",aa,"instead."));var Ja=Ba.morphAttributes.position||Ba.morphAttributes.normal||Ba.morphAttributes.color;Ja=Ja!==void 0?Ja.length:0;let Qa=0;Ba.morphAttributes.position!==void 0&&(Qa=1);Ba.morphAttributes.normal!==void 0&&(Qa=
2);Ba.morphAttributes.color!==void 0&&(Qa=3);let Za;let gb,cb;if(Ca){var rb=Kd[Ca];Za=rb.vertexShader;rb=rb.fragmentShader}else Za=U.vertexShader,rb=U.fragmentShader,M.update(U),gb=M.getVertexShaderID(U),cb=M.getFragmentShaderID(U);const Ya=a.getRenderTarget(),nb=a.state.buffers.depth.getReversed(),ob=sa.isInstancedMesh===!0,ub=sa.isBatchedMesh===!0,Cb=!!U.map,sb=!!U.matcap,Mb=!!wa,Wa=!!U.aoMap,hb=!!U.lightMap,ja=!!U.bumpMap,ha=!!U.normalMap,la=!!U.displacementMap,ta=!!U.emissiveMap,ua=!!U.metalnessMap,
Pa=!!U.roughnessMap,oa=U.anisotropy>0,Ga=U.clearcoat>0,ya=U.dispersion>0,Ma=U.iridescence>0,Ta=U.sheen>0,Sa=U.transmission>0,$a=oa&&!!U.anisotropyMap,Jb=Ga&&!!U.clearcoatMap,Kb=Ga&&!!U.clearcoatNormalMap,Fb=Ga&&!!U.clearcoatRoughnessMap,Nb=Ma&&!!U.iridescenceMap,wc=Ma&&!!U.iridescenceThicknessMap,zf=Ta&&!!U.sheenColorMap,Xe=Ta&&!!U.sheenRoughnessMap,ch=!!U.specularMap,Wd=!!U.specularColorMap,Af=!!U.specularIntensityMap,Ye=Sa&&!!U.transmissionMap,za=Sa&&!!U.thicknessMap,Lc=!!U.gradientMap,Xc=!!U.alphaMap,
Ob=U.alphaTest>0,vd=!!U.alphaHash,Pb=!!U.extensions;let lc=0;!U.toneMapped||Ya!==null&&Ya.isXRRenderTarget!==!0||(lc=a.toneMapping);U={shaderID:Ca,shaderType:U.type,shaderName:U.name,vertexShader:Za,fragmentShader:rb,defines:U.defines,customVertexShaderID:gb,customFragmentShaderID:cb,isRawShaderMaterial:U.isRawShaderMaterial===!0,glslVersion:U.glslVersion,precision:aa,batching:ub,batchingColor:ub&&sa._colorsTexture!==null,instancing:ob,instancingColor:ob&&sa.instanceColor!==null,instancingMorph:ob&&
sa.morphTexture!==null,supportsVertexTextures:ea,outputColorSpace:Ya===null?a.outputColorSpace:Ya.isXRRenderTarget===!0?Ya.texture.colorSpace:"srgb-linear",alphaToCoverage:!!U.alphaToCoverage,map:Cb,matcap:sb,envMap:Mb,envMapMode:Mb&&wa.mapping,envMapCubeUVHeight:Na,aoMap:Wa,lightMap:hb,bumpMap:ja,normalMap:ha,displacementMap:ea&&la,emissiveMap:ta,normalMapObjectSpace:ha&&U.normalMapType===1,normalMapTangentSpace:ha&&U.normalMapType===0,metalnessMap:ua,roughnessMap:Pa,anisotropy:oa,anisotropyMap:$a,
clearcoat:Ga,clearcoatMap:Jb,clearcoatNormalMap:Kb,clearcoatRoughnessMap:Fb,dispersion:ya,iridescence:Ma,iridescenceMap:Nb,iridescenceThicknessMap:wc,sheen:Ta,sheenColorMap:zf,sheenRoughnessMap:Xe,specularMap:ch,specularColorMap:Wd,specularIntensityMap:Af,transmission:Sa,transmissionMap:Ye,thicknessMap:za,gradientMap:Lc,opaque:U.transparent===!1&&U.blending===1&&U.alphaToCoverage===!1,alphaMap:Xc,alphaTest:Ob,alphaHash:vd,combine:U.combine,mapUv:Cb&&F(U.map.channel),aoMapUv:Wa&&F(U.aoMap.channel),
lightMapUv:hb&&F(U.lightMap.channel),bumpMapUv:ja&&F(U.bumpMap.channel),normalMapUv:ha&&F(U.normalMap.channel),displacementMapUv:la&&F(U.displacementMap.channel),emissiveMapUv:ta&&F(U.emissiveMap.channel),metalnessMapUv:ua&&F(U.metalnessMap.channel),roughnessMapUv:Pa&&F(U.roughnessMap.channel),anisotropyMapUv:$a&&F(U.anisotropyMap.channel),clearcoatMapUv:Jb&&F(U.clearcoatMap.channel),clearcoatNormalMapUv:Kb&&F(U.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Fb&&F(U.clearcoatRoughnessMap.channel),
iridescenceMapUv:Nb&&F(U.iridescenceMap.channel),iridescenceThicknessMapUv:wc&&F(U.iridescenceThicknessMap.channel),sheenColorMapUv:zf&&F(U.sheenColorMap.channel),sheenRoughnessMapUv:Xe&&F(U.sheenRoughnessMap.channel),specularMapUv:ch&&F(U.specularMap.channel),specularColorMapUv:Wd&&F(U.specularColorMap.channel),specularIntensityMapUv:Af&&F(U.specularIntensityMap.channel),transmissionMapUv:Ye&&F(U.transmissionMap.channel),thicknessMapUv:za&&F(U.thicknessMap.channel),alphaMapUv:Xc&&F(U.alphaMap.channel),
vertexTangents:!!Ba.attributes.tangent&&(ha||oa),vertexColors:U.vertexColors,vertexAlphas:U.vertexColors===!0&&!!Ba.attributes.color&&Ba.attributes.color.itemSize===4,pointsUvs:sa.isPoints===!0&&!!Ba.attributes.uv&&(Cb||Xc),fog:!!Aa,useFog:U.fog===!0,fogExp2:!!Aa&&Aa.isFogExp2,flatShading:U.flatShading===!0&&U.wireframe===!1,sizeAttenuation:U.sizeAttenuation===!0,logarithmicDepthBuffer:X,reversedDepthBuffer:nb,skinning:sa.isSkinnedMesh===!0,morphTargets:Ba.morphAttributes.position!==void 0,morphNormals:Ba.morphAttributes.normal!==
void 0,morphColors:Ba.morphAttributes.color!==void 0,morphTargetsCount:Ja,morphTextureStride:Qa,numDirLights:ka.directional.length,numPointLights:ka.point.length,numSpotLights:ka.spot.length,numSpotLightMaps:ka.spotLightMap.length,numRectAreaLights:ka.rectArea.length,numHemiLights:ka.hemi.length,numDirLightShadows:ka.directionalShadowMap.length,numPointLightShadows:ka.pointShadowMap.length,numSpotLightShadows:ka.spotShadowMap.length,numSpotLightShadowsWithMaps:ka.numSpotLightShadowsWithMaps,numLightProbes:ka.numLightProbes,
numClippingPlanes:E.numPlanes,numClipIntersection:E.numIntersection,dithering:U.dithering,shadowMapEnabled:a.shadowMap.enabled&&qa.length>0,shadowMapType:a.shadowMap.type,toneMapping:lc,decodeVideoTexture:Cb&&U.map.isVideoTexture===!0&&$b.getTransfer(U.map.colorSpace)==="srgb",decodeVideoTextureEmissive:ta&&U.emissiveMap.isVideoTexture===!0&&$b.getTransfer(U.emissiveMap.colorSpace)==="srgb",premultipliedAlpha:U.premultipliedAlpha,doubleSided:U.side===2,flipSided:U.side===1,useDepthPacking:U.depthPacking>=
0,depthPacking:U.depthPacking||0,index0AttributeName:U.index0AttributeName,extensionClipCullDistance:Pb&&U.extensions.clipCullDistance===!0&&h.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Pb&&U.extensions.multiDraw===!0||ub)&&h.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:h.has("KHR_parallel_shader_compile"),customProgramCacheKey:U.customProgramCacheKey()};U.vertexUv1s=R.has(1);U.vertexUv2s=R.has(2);U.vertexUv3s=R.has(3);R.clear();return U},getProgramCacheKey:function(U){const ka=
[];U.shaderID?ka.push(U.shaderID):(ka.push(U.customVertexShaderID),ka.push(U.customFragmentShaderID));if(U.defines!==void 0)for(const qa in U.defines)ka.push(qa),ka.push(U.defines[qa]);U.isRawShaderMaterial===!1&&(ka.push(U.precision),ka.push(U.outputColorSpace),ka.push(U.envMapMode),ka.push(U.envMapCubeUVHeight),ka.push(U.mapUv),ka.push(U.alphaMapUv),ka.push(U.lightMapUv),ka.push(U.aoMapUv),ka.push(U.bumpMapUv),ka.push(U.normalMapUv),ka.push(U.displacementMapUv),ka.push(U.emissiveMapUv),ka.push(U.metalnessMapUv),
ka.push(U.roughnessMapUv),ka.push(U.anisotropyMapUv),ka.push(U.clearcoatMapUv),ka.push(U.clearcoatNormalMapUv),ka.push(U.clearcoatRoughnessMapUv),ka.push(U.iridescenceMapUv),ka.push(U.iridescenceThicknessMapUv),ka.push(U.sheenColorMapUv),ka.push(U.sheenRoughnessMapUv),ka.push(U.specularMapUv),ka.push(U.specularColorMapUv),ka.push(U.specularIntensityMapUv),ka.push(U.transmissionMapUv),ka.push(U.thicknessMapUv),ka.push(U.combine),ka.push(U.fogExp2),ka.push(U.sizeAttenuation),ka.push(U.morphTargetsCount),
ka.push(U.morphAttributeCount),ka.push(U.numDirLights),ka.push(U.numPointLights),ka.push(U.numSpotLights),ka.push(U.numSpotLightMaps),ka.push(U.numHemiLights),ka.push(U.numRectAreaLights),ka.push(U.numDirLightShadows),ka.push(U.numPointLightShadows),ka.push(U.numSpotLightShadows),ka.push(U.numSpotLightShadowsWithMaps),ka.push(U.numLightProbes),ka.push(U.shadowMapType),ka.push(U.toneMapping),ka.push(U.numClippingPlanes),ka.push(U.numClipIntersection),ka.push(U.depthPacking),H.disableAll(),U.supportsVertexTextures&&
H.enable(0),U.instancing&&H.enable(1),U.instancingColor&&H.enable(2),U.instancingMorph&&H.enable(3),U.matcap&&H.enable(4),U.envMap&&H.enable(5),U.normalMapObjectSpace&&H.enable(6),U.normalMapTangentSpace&&H.enable(7),U.clearcoat&&H.enable(8),U.iridescence&&H.enable(9),U.alphaTest&&H.enable(10),U.vertexColors&&H.enable(11),U.vertexAlphas&&H.enable(12),U.vertexUv1s&&H.enable(13),U.vertexUv2s&&H.enable(14),U.vertexUv3s&&H.enable(15),U.vertexTangents&&H.enable(16),U.anisotropy&&H.enable(17),U.alphaHash&&
H.enable(18),U.batching&&H.enable(19),U.dispersion&&H.enable(20),U.batchingColor&&H.enable(21),U.gradientMap&&H.enable(22),ka.push(H.mask),H.disableAll(),U.fog&&H.enable(0),U.useFog&&H.enable(1),U.flatShading&&H.enable(2),U.logarithmicDepthBuffer&&H.enable(3),U.reversedDepthBuffer&&H.enable(4),U.skinning&&H.enable(5),U.morphTargets&&H.enable(6),U.morphNormals&&H.enable(7),U.morphColors&&H.enable(8),U.premultipliedAlpha&&H.enable(9),U.shadowMapEnabled&&H.enable(10),U.doubleSided&&H.enable(11),U.flipSided&&
H.enable(12),U.useDepthPacking&&H.enable(13),U.dithering&&H.enable(14),U.transmission&&H.enable(15),U.sheen&&H.enable(16),U.opaque&&H.enable(17),U.pointsUvs&&H.enable(18),U.decodeVideoTexture&&H.enable(19),U.decodeVideoTextureEmissive&&H.enable(20),U.alphaToCoverage&&H.enable(21),ka.push(H.mask),ka.push(a.outputColorSpace));ka.push(U.customProgramCacheKey);return ka.join()},getUniforms:function(U){const ka=da[U.type];return ka?rk.clone(Kd[ka].uniforms):U.uniforms},acquireProgram:function(U,ka){let qa;
for(let wa=0,sa=T.length;wa<sa;wa++){const Aa=T[wa];if(Aa.cacheKey===ka){qa=Aa;++qa.usedTimes;break}}qa===void 0&&(qa=new li(a,ka,U,u),T.push(qa));return qa},releaseProgram:function(U){if(--U.usedTimes===0){const ka=T.indexOf(U);T[ka]=T[T.length-1];T.pop();U.destroy()}},releaseShaderCache:function(U){M.remove(U)},programs:T,dispose:function(){M.dispose()}}}function ni(){let a=new WeakMap;return{has:function(b){return a.has(b)},get:function(b){let d=a.get(b);d===void 0&&(d={},a.set(b,d));return d},
remove:function(b){a.delete(b)},update:function(b,d,h){a.get(b)[d]=h},dispose:function(){a=new WeakMap}}}function oi(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function dh(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function eh(){function a(E,
F,H,M,R,T){let X=b[d];X===void 0?(X={id:E.id,object:E,geometry:F,material:H,groupOrder:M,renderOrder:E.renderOrder,z:R,group:T},b[d]=X):(X.id=E.id,X.object=E,X.geometry=F,X.material=H,X.groupOrder=M,X.renderOrder=E.renderOrder,X.z=R,X.group=T);d++;return X}const b=[];let d=0;const h=[],n=[],u=[];return{opaque:h,transmissive:n,transparent:u,init:function(){d=0;h.length=0;n.length=0;u.length=0},push:function(E,F,H,M,R,T){E=a(E,F,H,M,R,T);H.transmission>0?n.push(E):H.transparent===!0?u.push(E):h.push(E)},
unshift:function(E,F,H,M,R,T){E=a(E,F,H,M,R,T);H.transmission>0?n.unshift(E):H.transparent===!0?u.unshift(E):h.unshift(E)},finish:function(){for(let E=d,F=b.length;E<F;E++){const H=b[E];if(H.id===null)break;H.id=null;H.object=null;H.geometry=null;H.material=null;H.group=null}},sort:function(E,F){h.length>1&&h.sort(E||oi);n.length>1&&n.sort(F||dh);u.length>1&&u.sort(F||dh)}}}function pi(){let a=new WeakMap;return{get:function(b,d){const h=a.get(b);h===void 0?(d=new eh,a.set(b,[d])):d>=h.length?(d=
new eh,h.push(d)):d=h[d];return d},dispose:function(){a=new WeakMap}}}function qi(){const a={};return{get:function(b){if(a[b.id]!==void 0)return a[b.id];let d;switch(b.type){case "DirectionalLight":d={direction:new ma,color:new pb};break;case "SpotLight":d={position:new ma,direction:new ma,color:new pb,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case "PointLight":d={position:new ma,color:new pb,distance:0,decay:0};break;case "HemisphereLight":d={direction:new ma,skyColor:new pb,groundColor:new pb};
break;case "RectAreaLight":d={color:new pb,position:new ma,halfWidth:new ma,halfHeight:new ma}}return a[b.id]=d}}}function ri(){const a={};return{get:function(b){if(a[b.id]!==void 0)return a[b.id];let d;switch(b.type){case "DirectionalLight":d={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xa};break;case "SpotLight":d={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xa};break;case "PointLight":d={shadowIntensity:1,shadowBias:0,
shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xa,shadowCameraNear:1,shadowCameraFar:1E3}}return a[b.id]=d}}}function si(a,b){return(b.castShadow?2:0)-(a.castShadow?2:0)+(b.map?1:0)-(a.map?1:0)}function ti(a){const b=new qi,d=ri(),h={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],
directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let F=0;F<9;F++)h.probe.push(new ma);const n=new ma,u=new Gb,E=new Gb;return{setup:function(F){let H=0,M=0,R=0;for(var T=0;T<9;T++)h.probe[T].set(0,0,0);let X=T=0,ea=0,aa=0,da=0,U=0,ka=0,qa=0,wa=0,sa=0,Aa=0;F.sort(si);for(let Za=
0,gb=F.length;Za<gb;Za++){var Ba=F[Za],Na=Ba.color,Ca=Ba.intensity,Ja=Ba.distance,Qa=Ba.shadow&&Ba.shadow.map?Ba.shadow.map.texture:null;if(Ba.isAmbientLight)H+=Na.r*Ca,M+=Na.g*Ca,R+=Na.b*Ca;else if(Ba.isLightProbe){for(Qa=0;Qa<9;Qa++)h.probe[Qa].addScaledVector(Ba.sh.coefficients[Qa],Ca);Aa++}else if(Ba.isDirectionalLight)Ca=b.get(Ba),Ca.color.copy(Ba.color).multiplyScalar(Ba.intensity),Ba.castShadow&&(Na=Ba.shadow,Ja=d.get(Ba),Ja.shadowIntensity=Na.intensity,Ja.shadowBias=Na.bias,Ja.shadowNormalBias=
Na.normalBias,Ja.shadowRadius=Na.radius,Ja.shadowMapSize=Na.mapSize,h.directionalShadow[T]=Ja,h.directionalShadowMap[T]=Qa,h.directionalShadowMatrix[T]=Ba.shadow.matrix,U++),h.directional[T]=Ca,T++;else if(Ba.isSpotLight){const cb=b.get(Ba);cb.position.setFromMatrixPosition(Ba.matrixWorld);cb.color.copy(Na).multiplyScalar(Ca);cb.distance=Ja;cb.coneCos=Math.cos(Ba.angle);cb.penumbraCos=Math.cos(Ba.angle*(1-Ba.penumbra));cb.decay=Ba.decay;h.spot[ea]=cb;Ca=Ba.shadow;Ba.map&&(h.spotLightMap[wa]=Ba.map,
wa++,Ca.updateMatrices(Ba),Ba.castShadow&&sa++);h.spotLightMatrix[ea]=Ca.matrix;Ba.castShadow&&(Ba=d.get(Ba),Ba.shadowIntensity=Ca.intensity,Ba.shadowBias=Ca.bias,Ba.shadowNormalBias=Ca.normalBias,Ba.shadowRadius=Ca.radius,Ba.shadowMapSize=Ca.mapSize,h.spotShadow[ea]=Ba,h.spotShadowMap[ea]=Qa,qa++);ea++}else Ba.isRectAreaLight?(Qa=b.get(Ba),Qa.color.copy(Na).multiplyScalar(Ca),Qa.halfWidth.set(Ba.width*.5,0,0),Qa.halfHeight.set(0,Ba.height*.5,0),h.rectArea[aa]=Qa,aa++):Ba.isPointLight?(Ca=b.get(Ba),
Ca.color.copy(Ba.color).multiplyScalar(Ba.intensity),Ca.distance=Ba.distance,Ca.decay=Ba.decay,Ba.castShadow&&(Na=Ba.shadow,Ja=d.get(Ba),Ja.shadowIntensity=Na.intensity,Ja.shadowBias=Na.bias,Ja.shadowNormalBias=Na.normalBias,Ja.shadowRadius=Na.radius,Ja.shadowMapSize=Na.mapSize,Ja.shadowCameraNear=Na.camera.near,Ja.shadowCameraFar=Na.camera.far,h.pointShadow[X]=Ja,h.pointShadowMap[X]=Qa,h.pointShadowMatrix[X]=Ba.shadow.matrix,ka++),h.point[X]=Ca,X++):Ba.isHemisphereLight&&(Qa=b.get(Ba),Qa.skyColor.copy(Ba.color).multiplyScalar(Ca),
Qa.groundColor.copy(Ba.groundColor).multiplyScalar(Ca),h.hemi[da]=Qa,da++)}aa>0&&(a.has("OES_texture_float_linear")===!0?(h.rectAreaLTC1=mb.LTC_FLOAT_1,h.rectAreaLTC2=mb.LTC_FLOAT_2):(h.rectAreaLTC1=mb.LTC_HALF_1,h.rectAreaLTC2=mb.LTC_HALF_2));h.ambient[0]=H;h.ambient[1]=M;h.ambient[2]=R;F=h.hash;if(F.directionalLength!==T||F.pointLength!==X||F.spotLength!==ea||F.rectAreaLength!==aa||F.hemiLength!==da||F.numDirectionalShadows!==U||F.numPointShadows!==ka||F.numSpotShadows!==qa||F.numSpotMaps!==wa||
F.numLightProbes!==Aa)h.directional.length=T,h.spot.length=ea,h.rectArea.length=aa,h.point.length=X,h.hemi.length=da,h.directionalShadow.length=U,h.directionalShadowMap.length=U,h.pointShadow.length=ka,h.pointShadowMap.length=ka,h.spotShadow.length=qa,h.spotShadowMap.length=qa,h.directionalShadowMatrix.length=U,h.pointShadowMatrix.length=ka,h.spotLightMatrix.length=qa+wa-sa,h.spotLightMap.length=wa,h.numSpotLightShadowsWithMaps=sa,h.numLightProbes=Aa,F.directionalLength=T,F.pointLength=X,F.spotLength=
ea,F.rectAreaLength=aa,F.hemiLength=da,F.numDirectionalShadows=U,F.numPointShadows=ka,F.numSpotShadows=qa,F.numSpotMaps=wa,F.numLightProbes=Aa,h.version=sm++},setupView:function(F,H){let M=0,R=0,T=0,X=0,ea=0;H=H.matrixWorldInverse;for(let da=0,U=F.length;da<U;da++){const ka=F[da];if(ka.isDirectionalLight){var aa=h.directional[M];aa.direction.setFromMatrixPosition(ka.matrixWorld);n.setFromMatrixPosition(ka.target.matrixWorld);aa.direction.sub(n);aa.direction.transformDirection(H);M++}else ka.isSpotLight?
(aa=h.spot[T],aa.position.setFromMatrixPosition(ka.matrixWorld),aa.position.applyMatrix4(H),aa.direction.setFromMatrixPosition(ka.matrixWorld),n.setFromMatrixPosition(ka.target.matrixWorld),aa.direction.sub(n),aa.direction.transformDirection(H),T++):ka.isRectAreaLight?(aa=h.rectArea[X],aa.position.setFromMatrixPosition(ka.matrixWorld),aa.position.applyMatrix4(H),E.identity(),u.copy(ka.matrixWorld),u.premultiply(H),E.extractRotation(u),aa.halfWidth.set(ka.width*.5,0,0),aa.halfHeight.set(0,ka.height*
.5,0),aa.halfWidth.applyMatrix4(E),aa.halfHeight.applyMatrix4(E),X++):ka.isPointLight?(aa=h.point[R],aa.position.setFromMatrixPosition(ka.matrixWorld),aa.position.applyMatrix4(H),R++):ka.isHemisphereLight&&(aa=h.hemi[ea],aa.direction.setFromMatrixPosition(ka.matrixWorld),aa.direction.transformDirection(H),ea++)}},state:h}}function fh(a){const b=new ti(a),d=[],h=[],n={lightsArray:d,shadowsArray:h,camera:null,lights:b,transmissionRenderTarget:{}};return{init:function(u){n.camera=u;d.length=0;h.length=
0},state:n,setupLights:function(){b.setup(d)},setupLightsView:function(u){b.setupView(d,u)},pushLight:function(u){d.push(u)},pushShadow:function(u){h.push(u)}}}function ui(a){let b=new WeakMap;return{get:function(d,h=0){const n=b.get(d);n===void 0?(h=new fh(a),b.set(d,[h])):h>=n.length?(h=new fh(a),n.push(h)):h=n[h];return h},dispose:function(){b=new WeakMap}}}function vi(a,b,d){function h(sa,Aa,Ba,Na){sa=Ba.isPointLight===!0?sa.customDistanceMaterial:sa.customDepthMaterial;if(sa===void 0&&(sa=Ba.isPointLight===
!0?T:R,a.localClippingEnabled&&Aa.clipShadows===!0&&Array.isArray(Aa.clippingPlanes)&&Aa.clippingPlanes.length!==0||Aa.displacementMap&&Aa.displacementScale!==0||Aa.alphaMap&&Aa.alphaTest>0||Aa.map&&Aa.alphaTest>0||Aa.alphaToCoverage===!0)){var Ca=sa.uuid;const Ja=Aa.uuid;let Qa=X[Ca];Qa===void 0&&(Qa={},X[Ca]=Qa);Ca=Qa[Ja];Ca===void 0&&(Ca=sa.clone(),Qa[Ja]=Ca,Aa.addEventListener("dispose",u));sa=Ca}sa.visible=Aa.visible;sa.wireframe=Aa.wireframe;sa.side=Na===3?Aa.shadowSide!==null?Aa.shadowSide:
Aa.side:Aa.shadowSide!==null?Aa.shadowSide:aa[Aa.side];sa.alphaMap=Aa.alphaMap;sa.alphaTest=Aa.alphaToCoverage===!0?.5:Aa.alphaTest;sa.map=Aa.map;sa.clipShadows=Aa.clipShadows;sa.clippingPlanes=Aa.clippingPlanes;sa.clipIntersection=Aa.clipIntersection;sa.displacementMap=Aa.displacementMap;sa.displacementScale=Aa.displacementScale;sa.displacementBias=Aa.displacementBias;sa.wireframeLinewidth=Aa.wireframeLinewidth;sa.linewidth=Aa.linewidth;Ba.isPointLight===!0&&sa.isMeshDistanceMaterial===!0&&(a.properties.get(sa).light=
Ba);return sa}function n(sa,Aa,Ba,Na,Ca){if(sa.visible!==!1){if(sa.layers.test(Aa.layers)&&(sa.isMesh||sa.isLine||sa.isPoints)&&(sa.castShadow||sa.receiveShadow&&Ca===3)&&(!sa.frustumCulled||E.intersectsObject(sa))){sa.modelViewMatrix.multiplyMatrices(Ba.matrixWorldInverse,sa.matrixWorld);const Za=b.update(sa);var Ja=sa.material;if(Array.isArray(Ja)){const gb=Za.groups;for(let cb=0,rb=gb.length;cb<rb;cb++){const Ya=gb[cb];var Qa=Ja[Ya.materialIndex];Qa&&Qa.visible&&(Qa=h(sa,Qa,Na,Ca),sa.onBeforeShadow(a,
sa,Aa,Ba,Za,Qa,Ya),a.renderBufferDirect(Ba,null,Za,Qa,sa,Ya),sa.onAfterShadow(a,sa,Aa,Ba,Za,Qa,Ya))}}else Ja.visible&&(Ja=h(sa,Ja,Na,Ca),sa.onBeforeShadow(a,sa,Aa,Ba,Za,Ja,null),a.renderBufferDirect(Ba,null,Za,Ja,sa,null),sa.onAfterShadow(a,sa,Aa,Ba,Za,Ja,null))}sa=sa.children;for(let Za=0,gb=sa.length;Za<gb;Za++)n(sa[Za],Aa,Ba,Na,Ca)}}function u(sa){sa.target.removeEventListener("dispose",u);for(const Aa in X){const Ba=X[Aa],Na=sa.target.uuid;Na in Ba&&(Ba[Na].dispose(),delete Ba[Na])}}let E=new Bf;
const F=new Xa,H=new Xa,M=new ec,R=new wi({depthPacking:3201}),T=new xi,X={},ea=d.maxTextureSize,aa={[0]:1,[1]:0,[2]:2},da=new Jd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xa},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position \x3d vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include \x3cpacking\x3e\nvoid main() {\n\tconst float samples \x3d float( VSM_SAMPLES );\n\tfloat mean \x3d 0.0;\n\tfloat squared_mean \x3d 0.0;\n\tfloat uvStride \x3d samples \x3c\x3d 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart \x3d samples \x3c\x3d 1.0 ? 0.0 : - 1.0;\n\tfor ( float i \x3d 0.0; i \x3c samples; i ++ ) {\n\t\tfloat uvOffset \x3d uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution \x3d unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean +\x3d distribution.x;\n\t\t\tsquared_mean +\x3d distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth \x3d unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean +\x3d depth;\n\t\t\tsquared_mean +\x3d depth * depth;\n\t\t#endif\n\t}\n\tmean \x3d mean / samples;\n\tsquared_mean \x3d squared_mean / samples;\n\tfloat std_dev \x3d sqrt( squared_mean - mean * mean );\n\tgl_FragColor \x3d pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),
U=da.clone();U.defines.HORIZONTAL_PASS=1;d=new Vb;d.setAttribute("position",new sc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ka=new Kc(d,da),qa=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;let wa=this.type=1;this.render=function(sa,Aa,Ba){if(qa.enabled!==!1&&(qa.autoUpdate!==!1||qa.needsUpdate!==!1)&&sa.length!==0){var Na=a.getRenderTarget(),Ca=a.getActiveCubeFace(),Ja=a.getActiveMipmapLevel(),Qa=a.state;Qa.setBlending(0);Qa.buffers.depth.getReversed()===!0?Qa.buffers.color.setClear(0,
0,0,0):Qa.buffers.color.setClear(1,1,1,1);Qa.buffers.depth.setTest(!0);Qa.setScissorTest(!1);var Za=wa!==3&&this.type===3,gb=wa===3&&this.type!==3;for(let nb=0,ob=sa.length;nb<ob;nb++){var cb=sa[nb];const ub=cb.shadow;if(ub===void 0)console.warn("THREE.WebGLShadowMap:",cb,"has no shadow.");else if(ub.autoUpdate!==!1||ub.needsUpdate!==!1){F.copy(ub.mapSize);var rb=ub.getFrameExtents();F.multiply(rb);H.copy(ub.mapSize);if(F.x>ea||F.y>ea)F.x>ea&&(H.x=Math.floor(ea/rb.x),F.x=H.x*rb.x,ub.mapSize.x=H.x),
F.y>ea&&(H.y=Math.floor(ea/rb.y),F.y=H.y*rb.y,ub.mapSize.y=H.y);if(ub.map===null||Za===!0||gb===!0)rb=this.type!==3?{minFilter:1003,magFilter:1003}:{},ub.map!==null&&ub.map.dispose(),ub.map=new zd(F.x,F.y,rb),ub.map.texture.name=cb.name+".shadowMap",ub.camera.updateProjectionMatrix();a.setRenderTarget(ub.map);a.clear();rb=ub.getViewportCount();for(var Ya=0;Ya<rb;Ya++){const Cb=ub.getViewport(Ya);M.set(H.x*Cb.x,H.y*Cb.y,H.x*Cb.z,H.y*Cb.w);Qa.viewport(M);ub.updateMatrices(cb,Ya);E=ub.getFrustum();n(Aa,
Ba,ub.camera,cb,this.type)}ub.isPointLightShadow!==!0&&this.type===3&&(cb=ub,rb=Ba,Ya=b.update(ka),da.defines.VSM_SAMPLES!==cb.blurSamples&&(da.defines.VSM_SAMPLES=cb.blurSamples,U.defines.VSM_SAMPLES=cb.blurSamples,da.needsUpdate=!0,U.needsUpdate=!0),cb.mapPass===null&&(cb.mapPass=new zd(F.x,F.y)),da.uniforms.shadow_pass.value=cb.map.texture,da.uniforms.resolution.value=cb.mapSize,da.uniforms.radius.value=cb.radius,a.setRenderTarget(cb.mapPass),a.clear(),a.renderBufferDirect(rb,null,Ya,da,ka,null),
U.uniforms.shadow_pass.value=cb.mapPass.texture,U.uniforms.resolution.value=cb.mapSize,U.uniforms.radius.value=cb.radius,a.setRenderTarget(cb.map),a.clear(),a.renderBufferDirect(rb,null,Ya,U,ka,null));ub.needsUpdate=!1}}wa=this.type;qa.needsUpdate=!1;a.setRenderTarget(Na,Ca,Ja)}}}function yi(a,b){function d(oa,Ga,ya,Ma){const Ta=new Uint8Array(4),Sa=a.createTexture();a.bindTexture(oa,Sa);a.texParameteri(oa,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(oa,a.TEXTURE_MAG_FILTER,a.NEAREST);for(let $a=
0;$a<ya;$a++)oa===a.TEXTURE_3D||oa===a.TEXTURE_2D_ARRAY?a.texImage3D(Ga,0,a.RGBA,1,1,Ma,0,a.RGBA,a.UNSIGNED_BYTE,Ta):a.texImage2D(Ga+$a,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,Ta);return Sa}function h(oa){aa[oa]!==!0&&(a.enable(oa),aa[oa]=!0)}function n(oa){aa[oa]!==!1&&(a.disable(oa),aa[oa]=!1)}function u(oa,Ga,ya,Ma,Ta,Sa,$a,Jb,Kb,Fb){if(oa===0)wa===!0&&(n(a.BLEND),wa=!1);else if(wa===!1&&(h(a.BLEND),wa=!0),oa!==5){if(oa!==sa||Fb!==cb){if(Aa!==100||Ca!==100)a.blendEquation(a.FUNC_ADD),Ca=Aa=100;if(Fb)switch(oa){case 1:a.blendFuncSeparate(a.ONE,
a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFunc(a.ONE,a.ONE);break;case 3:a.blendFuncSeparate(a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ZERO,a.ONE);break;case 4:a.blendFuncSeparate(a.DST_COLOR,a.ONE_MINUS_SRC_ALPHA,a.ZERO,a.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",oa)}else switch(oa){case 1:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);break;case 2:a.blendFuncSeparate(a.SRC_ALPHA,a.ONE,a.ONE,a.ONE);break;case 3:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha \x3d true");
break;case 4:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha \x3d true");break;default:console.error("THREE.WebGLState: Invalid blending: ",oa)}Qa=Ja=Na=Ba=null;Za.set(0,0,0);gb=0;sa=oa;cb=Fb}}else{Ta=Ta||Ga;Sa=Sa||ya;$a=$a||Ma;if(Ga!==Aa||Ta!==Ca)a.blendEquationSeparate(ua[Ga],ua[Ta]),Aa=Ga,Ca=Ta;if(ya!==Ba||Ma!==Na||Sa!==Ja||$a!==Qa)a.blendFuncSeparate(Pa[ya],Pa[Ma],Pa[Sa],Pa[$a]),Ba=ya,Na=Ma,Ja=Sa,Qa=$a;if(Jb.equals(Za)===!1||Kb!==gb)a.blendColor(Jb.r,Jb.g,
Jb.b,Kb),Za.copy(Jb),gb=Kb;sa=oa;cb=!1}}function E(oa){rb!==oa&&(oa?a.frontFace(a.CW):a.frontFace(a.CCW),rb=oa)}function F(oa){oa!==0?(h(a.CULL_FACE),oa!==Ya&&(oa===1?a.cullFace(a.BACK):oa===2?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):n(a.CULL_FACE);Ya=oa}function H(oa,Ga,ya){if(oa){if(h(a.POLYGON_OFFSET_FILL),ob!==Ga||ub!==ya)a.polygonOffset(Ga,ya),ob=Ga,ub=ya}else n(a.POLYGON_OFFSET_FILL)}const M=new function(){let oa=!1;const Ga=new ec;let ya=null;const Ma=new ec(0,0,0,0);return{setMask:function(Ta){ya===
Ta||oa||(a.colorMask(Ta,Ta,Ta,Ta),ya=Ta)},setLocked:function(Ta){oa=Ta},setClear:function(Ta,Sa,$a,Jb,Kb){Kb===!0&&(Ta*=Jb,Sa*=Jb,$a*=Jb);Ga.set(Ta,Sa,$a,Jb);Ma.equals(Ga)===!1&&(a.clearColor(Ta,Sa,$a,Jb),Ma.copy(Ga))},reset:function(){oa=!1;ya=null;Ma.set(-1,0,0,0)}}},R=new function(){let oa=!1,Ga=!1,ya=null,Ma=null,Ta=null;return{setReversed:function(Sa){if(Ga!==Sa){const $a=b.get("EXT_clip_control");Sa?$a.clipControlEXT($a.LOWER_LEFT_EXT,$a.ZERO_TO_ONE_EXT):$a.clipControlEXT($a.LOWER_LEFT_EXT,
$a.NEGATIVE_ONE_TO_ONE_EXT);Ga=Sa;Sa=Ta;Ta=null;this.setClear(Sa)}},getReversed:function(){return Ga},setTest:function(Sa){Sa?h(a.DEPTH_TEST):n(a.DEPTH_TEST)},setMask:function(Sa){ya===Sa||oa||(a.depthMask(Sa),ya=Sa)},setFunc:function(Sa){Ga&&(Sa=tm[Sa]);if(Ma!==Sa){switch(Sa){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);break;case 2:a.depthFunc(a.LESS);break;case 3:a.depthFunc(a.LEQUAL);break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);
break;case 7:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}Ma=Sa}},setLocked:function(Sa){oa=Sa},setClear:function(Sa){Ta!==Sa&&(Ga&&(Sa=1-Sa),a.clearDepth(Sa),Ta=Sa)},reset:function(){oa=!1;Ta=Ma=ya=null;Ga=!1}}},T=new function(){let oa=!1,Ga=null,ya=null,Ma=null,Ta=null,Sa=null,$a=null,Jb=null,Kb=null;return{setTest:function(Fb){oa||(Fb?h(a.STENCIL_TEST):n(a.STENCIL_TEST))},setMask:function(Fb){Ga===Fb||oa||(a.stencilMask(Fb),Ga=Fb)},setFunc:function(Fb,Nb,wc){if(ya!==Fb||Ma!==Nb||
Ta!==wc)a.stencilFunc(Fb,Nb,wc),ya=Fb,Ma=Nb,Ta=wc},setOp:function(Fb,Nb,wc){if(Sa!==Fb||$a!==Nb||Jb!==wc)a.stencilOp(Fb,Nb,wc),Sa=Fb,$a=Nb,Jb=wc},setLocked:function(Fb){oa=Fb},setClear:function(Fb){Kb!==Fb&&(a.clearStencil(Fb),Kb=Fb)},reset:function(){oa=!1;Kb=Jb=$a=Sa=Ta=Ma=ya=Ga=null}}},X=new WeakMap,ea=new WeakMap;let aa={},da={},U=new WeakMap,ka=[],qa=null,wa=!1,sa=null,Aa=null,Ba=null,Na=null,Ca=null,Ja=null,Qa=null,Za=new pb(0,0,0),gb=0,cb=!1,rb=null,Ya=null,nb=null,ob=null,ub=null;const Cb=
a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let sb=!1;var Mb=0;Mb=a.getParameter(a.VERSION);Mb.indexOf("WebGL")!==-1?(Mb=parseFloat(/^WebGL (\d)/.exec(Mb)[1]),sb=Mb>=1):Mb.indexOf("OpenGL ES")!==-1&&(Mb=parseFloat(/^OpenGL ES (\d)/.exec(Mb)[1]),sb=Mb>=2);let Wa=null,hb={};Mb=a.getParameter(a.SCISSOR_BOX);const ja=a.getParameter(a.VIEWPORT),ha=(new ec).fromArray(Mb),la=(new ec).fromArray(ja),ta={};ta[a.TEXTURE_2D]=d(a.TEXTURE_2D,a.TEXTURE_2D,1);ta[a.TEXTURE_CUBE_MAP]=d(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,
6);ta[a.TEXTURE_2D_ARRAY]=d(a.TEXTURE_2D_ARRAY,a.TEXTURE_2D_ARRAY,1,1);ta[a.TEXTURE_3D]=d(a.TEXTURE_3D,a.TEXTURE_3D,1,1);M.setClear(0,0,0,1);R.setClear(1);T.setClear(0);h(a.DEPTH_TEST);R.setFunc(3);E(!1);F(1);h(a.CULL_FACE);u(0);const ua={[100]:a.FUNC_ADD,[101]:a.FUNC_SUBTRACT,[102]:a.FUNC_REVERSE_SUBTRACT};ua[103]=a.MIN;ua[104]=a.MAX;const Pa={[200]:a.ZERO,[201]:a.ONE,[202]:a.SRC_COLOR,[204]:a.SRC_ALPHA,[210]:a.SRC_ALPHA_SATURATE,[208]:a.DST_COLOR,[206]:a.DST_ALPHA,[203]:a.ONE_MINUS_SRC_COLOR,[205]:a.ONE_MINUS_SRC_ALPHA,
[209]:a.ONE_MINUS_DST_COLOR,[207]:a.ONE_MINUS_DST_ALPHA,[211]:a.CONSTANT_COLOR,[212]:a.ONE_MINUS_CONSTANT_COLOR,[213]:a.CONSTANT_ALPHA,[214]:a.ONE_MINUS_CONSTANT_ALPHA};return{buffers:{color:M,depth:R,stencil:T},enable:h,disable:n,bindFramebuffer:function(oa,Ga){return da[oa]!==Ga?(a.bindFramebuffer(oa,Ga),da[oa]=Ga,oa===a.DRAW_FRAMEBUFFER&&(da[a.FRAMEBUFFER]=Ga),oa===a.FRAMEBUFFER&&(da[a.DRAW_FRAMEBUFFER]=Ga),!0):!1},drawBuffers:function(oa,Ga){let ya=ka,Ma=!1;if(oa){if(ya=U.get(Ga),ya===void 0&&
(ya=[],U.set(Ga,ya)),oa=oa.textures,ya.length!==oa.length||ya[0]!==a.COLOR_ATTACHMENT0){for(let Ta=0,Sa=oa.length;Ta<Sa;Ta++)ya[Ta]=a.COLOR_ATTACHMENT0+Ta;ya.length=oa.length;Ma=!0}}else ya[0]!==a.BACK&&(ya[0]=a.BACK,Ma=!0);Ma&&a.drawBuffers(ya)},useProgram:function(oa){return qa!==oa?(a.useProgram(oa),qa=oa,!0):!1},setBlending:u,setMaterial:function(oa,Ga){oa.side===2?n(a.CULL_FACE):h(a.CULL_FACE);let ya=oa.side===1;Ga&&(ya=!ya);E(ya);oa.blending===1&&oa.transparent===!1?u(0):u(oa.blending,oa.blendEquation,
oa.blendSrc,oa.blendDst,oa.blendEquationAlpha,oa.blendSrcAlpha,oa.blendDstAlpha,oa.blendColor,oa.blendAlpha,oa.premultipliedAlpha);R.setFunc(oa.depthFunc);R.setTest(oa.depthTest);R.setMask(oa.depthWrite);M.setMask(oa.colorWrite);Ga=oa.stencilWrite;T.setTest(Ga);Ga&&(T.setMask(oa.stencilWriteMask),T.setFunc(oa.stencilFunc,oa.stencilRef,oa.stencilFuncMask),T.setOp(oa.stencilFail,oa.stencilZFail,oa.stencilZPass));H(oa.polygonOffset,oa.polygonOffsetFactor,oa.polygonOffsetUnits);oa.alphaToCoverage===!0?
h(a.SAMPLE_ALPHA_TO_COVERAGE):n(a.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:E,setCullFace:F,setLineWidth:function(oa){oa!==nb&&(sb&&a.lineWidth(oa),nb=oa)},setPolygonOffset:H,setScissorTest:function(oa){oa?h(a.SCISSOR_TEST):n(a.SCISSOR_TEST)},activeTexture:function(oa){oa===void 0&&(oa=a.TEXTURE0+Cb-1);Wa!==oa&&(a.activeTexture(oa),Wa=oa)},bindTexture:function(oa,Ga,ya){ya===void 0&&(ya=Wa===null?a.TEXTURE0+Cb-1:Wa);let Ma=hb[ya];Ma===void 0&&(Ma={type:void 0,texture:void 0},hb[ya]=Ma);if(Ma.type!==
oa||Ma.texture!==Ga)Wa!==ya&&(a.activeTexture(ya),Wa=ya),a.bindTexture(oa,Ga||ta[oa]),Ma.type=oa,Ma.texture=Ga},unbindTexture:function(){const oa=hb[Wa];oa!==void 0&&oa.type!==void 0&&(a.bindTexture(oa.type,null),oa.type=void 0,oa.texture=void 0)},compressedTexImage2D:function(){try{a.compressedTexImage2D(...arguments)}catch(oa){console.error("THREE.WebGLState:",oa)}},compressedTexImage3D:function(){try{a.compressedTexImage3D(...arguments)}catch(oa){console.error("THREE.WebGLState:",oa)}},texImage2D:function(){try{a.texImage2D(...arguments)}catch(oa){console.error("THREE.WebGLState:",
oa)}},texImage3D:function(){try{a.texImage3D(...arguments)}catch(oa){console.error("THREE.WebGLState:",oa)}},updateUBOMapping:function(oa,Ga){let ya=ea.get(Ga);ya===void 0&&(ya=new WeakMap,ea.set(Ga,ya));let Ma=ya.get(oa);Ma===void 0&&(Ma=a.getUniformBlockIndex(Ga,oa.name),ya.set(oa,Ma))},uniformBlockBinding:function(oa,Ga){const ya=ea.get(Ga).get(oa);X.get(Ga)!==ya&&(a.uniformBlockBinding(Ga,ya,oa.__bindingPointIndex),X.set(Ga,ya))},texStorage2D:function(){try{a.texStorage2D(...arguments)}catch(oa){console.error("THREE.WebGLState:",
oa)}},texStorage3D:function(){try{a.texStorage3D(...arguments)}catch(oa){console.error("THREE.WebGLState:",oa)}},texSubImage2D:function(){try{a.texSubImage2D(...arguments)}catch(oa){console.error("THREE.WebGLState:",oa)}},texSubImage3D:function(){try{a.texSubImage3D(...arguments)}catch(oa){console.error("THREE.WebGLState:",oa)}},compressedTexSubImage2D:function(){try{a.compressedTexSubImage2D(...arguments)}catch(oa){console.error("THREE.WebGLState:",oa)}},compressedTexSubImage3D:function(){try{a.compressedTexSubImage3D(...arguments)}catch(oa){console.error("THREE.WebGLState:",
oa)}},scissor:function(oa){ha.equals(oa)===!1&&(a.scissor(oa.x,oa.y,oa.z,oa.w),ha.copy(oa))},viewport:function(oa){la.equals(oa)===!1&&(a.viewport(oa.x,oa.y,oa.z,oa.w),la.copy(oa))},reset:function(){a.disable(a.BLEND);a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.POLYGON_OFFSET_FILL);a.disable(a.SCISSOR_TEST);a.disable(a.STENCIL_TEST);a.disable(a.SAMPLE_ALPHA_TO_COVERAGE);a.blendEquation(a.FUNC_ADD);a.blendFunc(a.ONE,a.ZERO);a.blendFuncSeparate(a.ONE,a.ZERO,a.ONE,a.ZERO);a.blendColor(0,
0,0,0);a.colorMask(!0,!0,!0,!0);a.clearColor(0,0,0,0);a.depthMask(!0);a.depthFunc(a.LESS);R.setReversed(!1);a.clearDepth(1);a.stencilMask(4294967295);a.stencilFunc(a.ALWAYS,0,4294967295);a.stencilOp(a.KEEP,a.KEEP,a.KEEP);a.clearStencil(0);a.cullFace(a.BACK);a.frontFace(a.CCW);a.polygonOffset(0,0);a.activeTexture(a.TEXTURE0);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null);a.bindFramebuffer(a.READ_FRAMEBUFFER,null);a.useProgram(null);a.lineWidth(1);a.scissor(0,0,a.canvas.width,
a.canvas.height);a.viewport(0,0,a.canvas.width,a.canvas.height);aa={};Wa=null;hb={};da={};U=new WeakMap;ka=[];qa=null;wa=!1;Qa=Ja=Ca=Na=Ba=Aa=sa=null;Za=new pb(0,0,0);gb=0;cb=!1;ub=ob=nb=Ya=rb=null;ha.set(0,0,a.canvas.width,a.canvas.height);la.set(0,0,a.canvas.width,a.canvas.height);M.reset();R.reset();T.reset()}}}function zi(a,b,d,h,n,u,E){function F(ja,ha,la){var ta=1;const ua=Qa(ja);if(ua.width>la||ua.height>la)ta=la/Math.max(ua.width,ua.height);if(ta<1){if(typeof HTMLImageElement!=="undefined"&&
ja instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&ja instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&ja instanceof ImageBitmap||typeof VideoFrame!=="undefined"&&ja instanceof VideoFrame)return la=Math.floor(ta*ua.width),ta=Math.floor(ta*ua.height),Ya===void 0&&(Ya=ob?new OffscreenCanvas(la,ta):p("canvas")),ha=ha?ob?new OffscreenCanvas(la,ta):p("canvas"):Ya,ha.width=la,ha.height=ta,ha.getContext("2d").drawImage(ja,0,0,la,ta),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+
ua.width+"x"+ua.height+") to ("+la+"x"+ta+")."),ha;"data"in ja&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ua.width+"x"+ua.height+").")}return ja}function H(ja,ha,la,ta,ua=!1){if(ja!==null){if(a[ja]!==void 0)return a[ja];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ja+"'")}ja=ha;ha===a.RED&&(la===a.FLOAT&&(ja=a.R32F),la===a.HALF_FLOAT&&(ja=a.R16F),la===a.UNSIGNED_BYTE&&(ja=a.R8));ha===a.RED_INTEGER&&(la===a.UNSIGNED_BYTE&&(ja=a.R8UI),
la===a.UNSIGNED_SHORT&&(ja=a.R16UI),la===a.UNSIGNED_INT&&(ja=a.R32UI),la===a.BYTE&&(ja=a.R8I),la===a.SHORT&&(ja=a.R16I),la===a.INT&&(ja=a.R32I));ha===a.RG&&(la===a.FLOAT&&(ja=a.RG32F),la===a.HALF_FLOAT&&(ja=a.RG16F),la===a.UNSIGNED_BYTE&&(ja=a.RG8));ha===a.RG_INTEGER&&(la===a.UNSIGNED_BYTE&&(ja=a.RG8UI),la===a.UNSIGNED_SHORT&&(ja=a.RG16UI),la===a.UNSIGNED_INT&&(ja=a.RG32UI),la===a.BYTE&&(ja=a.RG8I),la===a.SHORT&&(ja=a.RG16I),la===a.INT&&(ja=a.RG32I));ha===a.RGB_INTEGER&&(la===a.UNSIGNED_BYTE&&(ja=
a.RGB8UI),la===a.UNSIGNED_SHORT&&(ja=a.RGB16UI),la===a.UNSIGNED_INT&&(ja=a.RGB32UI),la===a.BYTE&&(ja=a.RGB8I),la===a.SHORT&&(ja=a.RGB16I),la===a.INT&&(ja=a.RGB32I));ha===a.RGBA_INTEGER&&(la===a.UNSIGNED_BYTE&&(ja=a.RGBA8UI),la===a.UNSIGNED_SHORT&&(ja=a.RGBA16UI),la===a.UNSIGNED_INT&&(ja=a.RGBA32UI),la===a.BYTE&&(ja=a.RGBA8I),la===a.SHORT&&(ja=a.RGBA16I),la===a.INT&&(ja=a.RGBA32I));ha===a.RGB&&(la===a.UNSIGNED_INT_5_9_9_9_REV&&(ja=a.RGB9_E5),la===a.UNSIGNED_INT_10F_11F_11F_REV&&(ja=a.R11F_G11F_B10F));
ha===a.RGBA&&(ha=ua?"linear":$b.getTransfer(ta),la===a.FLOAT&&(ja=a.RGBA32F),la===a.HALF_FLOAT&&(ja=a.RGBA16F),la===a.UNSIGNED_BYTE&&(ja=ha==="srgb"?a.SRGB8_ALPHA8:a.RGBA8),la===a.UNSIGNED_SHORT_4_4_4_4&&(ja=a.RGBA4),la===a.UNSIGNED_SHORT_5_5_5_1&&(ja=a.RGB5_A1));ja!==a.R16F&&ja!==a.R32F&&ja!==a.RG16F&&ja!==a.RG32F&&ja!==a.RGBA16F&&ja!==a.RGBA32F||b.get("EXT_color_buffer_float");return ja}function M(ja,ha){let la;ja?ha===null||ha===1014||ha===1020?la=a.DEPTH24_STENCIL8:ha===1015?la=a.DEPTH32F_STENCIL8:
ha===1012&&(la=a.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ha===null||ha===1014||ha===1020?la=a.DEPTH_COMPONENT24:ha===1015?la=a.DEPTH_COMPONENT32F:ha===1012&&(la=a.DEPTH_COMPONENT16);return la}function R(ja,ha){return ja.generateMipmaps===!0||ja.isFramebufferTexture&&ja.minFilter!==1003&&ja.minFilter!==1006?Math.log2(Math.max(ha.width,ha.height))+1:ja.mipmaps!==void 0&&ja.mipmaps.length>0?ja.mipmaps.length:ja.isCompressedTexture&&
Array.isArray(ja.image)?ha.mipmaps.length:1}function T(ja){ja=ja.target;ja.removeEventListener("dispose",T);var ha=h.get(ja);if(ha.__webglInit!==void 0){var la=ja.source,ta=nb.get(la);ta&&(ha=ta[ha.__cacheKey],ha.usedTimes--,ha.usedTimes===0&&ea(ja),Object.keys(ta).length===0&&nb.delete(la));h.remove(ja)}ja.isVideoTexture&&rb.delete(ja)}function X(ja){ja=ja.target;ja.removeEventListener("dispose",X);var ha=h.get(ja);ja.depthTexture&&(ja.depthTexture.dispose(),h.remove(ja.depthTexture));if(ja.isWebGLCubeRenderTarget)for(var la=
0;la<6;la++){if(Array.isArray(ha.__webglFramebuffer[la]))for(let ta=0;ta<ha.__webglFramebuffer[la].length;ta++)a.deleteFramebuffer(ha.__webglFramebuffer[la][ta]);else a.deleteFramebuffer(ha.__webglFramebuffer[la]);ha.__webglDepthbuffer&&a.deleteRenderbuffer(ha.__webglDepthbuffer[la])}else{if(Array.isArray(ha.__webglFramebuffer))for(la=0;la<ha.__webglFramebuffer.length;la++)a.deleteFramebuffer(ha.__webglFramebuffer[la]);else a.deleteFramebuffer(ha.__webglFramebuffer);ha.__webglDepthbuffer&&a.deleteRenderbuffer(ha.__webglDepthbuffer);
ha.__webglMultisampledFramebuffer&&a.deleteFramebuffer(ha.__webglMultisampledFramebuffer);if(ha.__webglColorRenderbuffer)for(la=0;la<ha.__webglColorRenderbuffer.length;la++)ha.__webglColorRenderbuffer[la]&&a.deleteRenderbuffer(ha.__webglColorRenderbuffer[la]);ha.__webglDepthRenderbuffer&&a.deleteRenderbuffer(ha.__webglDepthRenderbuffer)}ha=ja.textures;for(let ta=0,ua=ha.length;ta<ua;ta++)la=h.get(ha[ta]),la.__webglTexture&&(a.deleteTexture(la.__webglTexture),E.memory.textures--),h.remove(ha[ta]);
h.remove(ja)}function ea(ja){const ha=h.get(ja);a.deleteTexture(ha.__webglTexture);delete nb.get(ja.source)[ha.__cacheKey];E.memory.textures--}function aa(ja,ha){const la=h.get(ja);if(ja.isVideoTexture){var ta=E.render.frame;rb.get(ja)!==ta&&(rb.set(ja,ta),ja.update())}if(ja.isRenderTargetTexture===!1&&ja.isExternalTexture!==!0&&ja.version>0&&la.__version!==ja.version)if(ta=ja.image,ta===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ta.complete===
!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{qa(la,ja,ha);return}else ja.isExternalTexture&&(la.__webglTexture=ja.sourceTexture?ja.sourceTexture:null);d.bindTexture(a.TEXTURE_2D,la.__webglTexture,a.TEXTURE0+ha)}function da(ja,ha){ha.type!==1015||b.has("OES_texture_float_linear")!==!1||ha.magFilter!==1006&&ha.magFilter!==1007&&ha.magFilter!==1005&&ha.magFilter!==1008&&ha.minFilter!==1006&&ha.minFilter!==1007&&ha.minFilter!==1005&&ha.minFilter!==1008||
console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device.");a.texParameteri(ja,a.TEXTURE_WRAP_S,Cb[ha.wrapS]);a.texParameteri(ja,a.TEXTURE_WRAP_T,Cb[ha.wrapT]);ja!==a.TEXTURE_3D&&ja!==a.TEXTURE_2D_ARRAY||a.texParameteri(ja,a.TEXTURE_WRAP_R,Cb[ha.wrapR]);a.texParameteri(ja,a.TEXTURE_MAG_FILTER,sb[ha.magFilter]);a.texParameteri(ja,a.TEXTURE_MIN_FILTER,sb[ha.minFilter]);ha.compareFunction&&(a.texParameteri(ja,
a.TEXTURE_COMPARE_MODE,a.COMPARE_REF_TO_TEXTURE),a.texParameteri(ja,a.TEXTURE_COMPARE_FUNC,Mb[ha.compareFunction]));if(b.has("EXT_texture_filter_anisotropic")===!0&&!(ha.magFilter===1003||ha.minFilter!==1005&&ha.minFilter!==1008||ha.type===1015&&b.has("OES_texture_float_linear")===!1)&&(ha.anisotropy>1||h.get(ha).__currentAnisotropy)){const la=b.get("EXT_texture_filter_anisotropic");a.texParameterf(ja,la.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ha.anisotropy,n.getMaxAnisotropy()));h.get(ha).__currentAnisotropy=
ha.anisotropy}}function U(ja,ha){let la=!1;ja.__webglInit===void 0&&(ja.__webglInit=!0,ha.addEventListener("dispose",T));var ta=ha.source;let ua=nb.get(ta);ua===void 0&&(ua={},nb.set(ta,ua));ta=[];ta.push(ha.wrapS);ta.push(ha.wrapT);ta.push(ha.wrapR||0);ta.push(ha.magFilter);ta.push(ha.minFilter);ta.push(ha.anisotropy);ta.push(ha.internalFormat);ta.push(ha.format);ta.push(ha.type);ta.push(ha.generateMipmaps);ta.push(ha.premultiplyAlpha);ta.push(ha.flipY);ta.push(ha.unpackAlignment);ta.push(ha.colorSpace);
ta=ta.join();if(ta!==ja.__cacheKey){ua[ta]===void 0&&(ua[ta]={texture:a.createTexture(),usedTimes:0},E.memory.textures++,la=!0);ua[ta].usedTimes++;const Pa=ua[ja.__cacheKey];Pa!==void 0&&(ua[ja.__cacheKey].usedTimes--,Pa.usedTimes===0&&ea(ha));ja.__cacheKey=ta;ja.__webglTexture=ua[ta].texture}return la}function ka(ja,ha,la,ta){const ua=ja.updateRanges;if(ua.length===0)d.texSubImage2D(a.TEXTURE_2D,0,0,0,ha.width,ha.height,la,ta,ha.data);else{ua.sort((Sa,$a)=>Sa.start-$a.start);var Pa=0;for(var oa=
1;oa<ua.length;oa++){var Ga=ua[Pa],ya=ua[oa],Ma=Math.floor(Math.floor(ya.start/4)/ha.width),Ta=Math.floor(Math.floor(Ga.start/4)/ha.width);ya.start<=Ga.start+Ga.count+1&&Ma===Ta&&Math.floor(Math.floor((ya.start+ya.count-1)/4)/ha.width)===Ma?Ga.count=Math.max(Ga.count,ya.start+ya.count-Ga.start):(++Pa,ua[Pa]=ya)}ua.length=Pa+1;Pa=a.getParameter(a.UNPACK_ROW_LENGTH);oa=a.getParameter(a.UNPACK_SKIP_PIXELS);Ga=a.getParameter(a.UNPACK_SKIP_ROWS);a.pixelStorei(a.UNPACK_ROW_LENGTH,ha.width);for(let Sa=0,
$a=ua.length;Sa<$a;Sa++)Ma=ua[Sa],Ta=Math.floor(Ma.start/4),ya=Ta%ha.width,Ta=Math.floor(Ta/ha.width),Ma=Math.ceil(Ma.count/4),a.pixelStorei(a.UNPACK_SKIP_PIXELS,ya),a.pixelStorei(a.UNPACK_SKIP_ROWS,Ta),d.texSubImage2D(a.TEXTURE_2D,0,ya,Ta,Ma,1,la,ta,ha.data);ja.clearUpdateRanges();a.pixelStorei(a.UNPACK_ROW_LENGTH,Pa);a.pixelStorei(a.UNPACK_SKIP_PIXELS,oa);a.pixelStorei(a.UNPACK_SKIP_ROWS,Ga)}}function qa(ja,ha,la){let ta=a.TEXTURE_2D;if(ha.isDataArrayTexture||ha.isCompressedArrayTexture)ta=a.TEXTURE_2D_ARRAY;
ha.isData3DTexture&&(ta=a.TEXTURE_3D);var ua=U(ja,ha);const Pa=ha.source;d.bindTexture(ta,ja.__webglTexture,a.TEXTURE0+la);const oa=h.get(Pa);if(Pa.version!==oa.__version||ua===!0){d.activeTexture(a.TEXTURE0+la);la=$b.getPrimaries($b.workingColorSpace);var Ga=ha.colorSpace===""?null:$b.getPrimaries(ha.colorSpace);la=ha.colorSpace===""||la===Ga?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,ha.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ha.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,
ha.unpackAlignment);a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,la);var ya=F(ha.image,!1,n.maxTextureSize);ya=Ja(ha,ya);la=u.convert(ha.format,ha.colorSpace);Ga=u.convert(ha.type);var Ma=H(ha.internalFormat,la,Ga,ha.colorSpace,ha.isVideoTexture);da(ta,ha);const Kb=ha.mipmaps,Fb=ha.isVideoTexture!==!0;var Ta=oa.__version===void 0||ua===!0;ua=Pa.dataReady;var Sa=R(ha,ya);if(ha.isDepthTexture)Ma=M(ha.format===1027,ha.type),Ta&&(Fb?d.texStorage2D(a.TEXTURE_2D,1,Ma,ya.width,ya.height):d.texImage2D(a.TEXTURE_2D,
0,Ma,ya.width,ya.height,0,la,Ga,null));else if(ha.isDataTexture)if(Kb.length>0){Fb&&Ta&&d.texStorage2D(a.TEXTURE_2D,Sa,Ma,Kb[0].width,Kb[0].height);for(let Nb=0,wc=Kb.length;Nb<wc;Nb++){var $a=Kb[Nb];Fb?ua&&d.texSubImage2D(a.TEXTURE_2D,Nb,0,0,$a.width,$a.height,la,Ga,$a.data):d.texImage2D(a.TEXTURE_2D,Nb,Ma,$a.width,$a.height,0,la,Ga,$a.data)}ha.generateMipmaps=!1}else Fb?(Ta&&d.texStorage2D(a.TEXTURE_2D,Sa,Ma,ya.width,ya.height),ua&&ka(ha,ya,la,Ga)):d.texImage2D(a.TEXTURE_2D,0,Ma,ya.width,ya.height,
0,la,Ga,ya.data);else if(ha.isCompressedTexture)if(ha.isCompressedArrayTexture){Fb&&Ta&&d.texStorage3D(a.TEXTURE_2D_ARRAY,Sa,Ma,Kb[0].width,Kb[0].height,ya.depth);for(let Nb=0,wc=Kb.length;Nb<wc;Nb++)if($a=Kb[Nb],ha.format!==1023)if(la!==null)if(Fb){if(ua)if(ha.layerUpdates.size>0){Sa=Ib($a.width,$a.height,ha.format,ha.type);for(var Jb of ha.layerUpdates)Ta=$a.data.subarray(Jb*Sa/$a.data.BYTES_PER_ELEMENT,(Jb+1)*Sa/$a.data.BYTES_PER_ELEMENT),d.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,Nb,0,0,Jb,
$a.width,$a.height,1,la,Ta);ha.clearLayerUpdates()}else d.compressedTexSubImage3D(a.TEXTURE_2D_ARRAY,Nb,0,0,0,$a.width,$a.height,ya.depth,la,$a.data)}else d.compressedTexImage3D(a.TEXTURE_2D_ARRAY,Nb,Ma,$a.width,$a.height,ya.depth,0,$a.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Fb?ua&&d.texSubImage3D(a.TEXTURE_2D_ARRAY,Nb,0,0,0,$a.width,$a.height,ya.depth,la,Ga,$a.data):d.texImage3D(a.TEXTURE_2D_ARRAY,Nb,Ma,$a.width,
$a.height,ya.depth,0,la,Ga,$a.data)}else{Fb&&Ta&&d.texStorage2D(a.TEXTURE_2D,Sa,Ma,Kb[0].width,Kb[0].height);for(let Nb=0,wc=Kb.length;Nb<wc;Nb++)$a=Kb[Nb],ha.format!==1023?la!==null?Fb?ua&&d.compressedTexSubImage2D(a.TEXTURE_2D,Nb,0,0,$a.width,$a.height,la,$a.data):d.compressedTexImage2D(a.TEXTURE_2D,Nb,Ma,$a.width,$a.height,0,$a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Fb?ua&&d.texSubImage2D(a.TEXTURE_2D,Nb,0,0,$a.width,
$a.height,la,Ga,$a.data):d.texImage2D(a.TEXTURE_2D,Nb,Ma,$a.width,$a.height,0,la,Ga,$a.data)}else if(ha.isDataArrayTexture)if(Fb){if(Ta&&d.texStorage3D(a.TEXTURE_2D_ARRAY,Sa,Ma,ya.width,ya.height,ya.depth),ua)if(ha.layerUpdates.size>0){Ma=Ib(ya.width,ya.height,ha.format,ha.type);for($a of ha.layerUpdates)Jb=ya.data.subarray($a*Ma/ya.data.BYTES_PER_ELEMENT,($a+1)*Ma/ya.data.BYTES_PER_ELEMENT),d.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,$a,ya.width,ya.height,1,la,Ga,Jb);ha.clearLayerUpdates()}else d.texSubImage3D(a.TEXTURE_2D_ARRAY,
0,0,0,0,ya.width,ya.height,ya.depth,la,Ga,ya.data)}else d.texImage3D(a.TEXTURE_2D_ARRAY,0,Ma,ya.width,ya.height,ya.depth,0,la,Ga,ya.data);else if(ha.isData3DTexture)Fb?(Ta&&d.texStorage3D(a.TEXTURE_3D,Sa,Ma,ya.width,ya.height,ya.depth),ua&&d.texSubImage3D(a.TEXTURE_3D,0,0,0,0,ya.width,ya.height,ya.depth,la,Ga,ya.data)):d.texImage3D(a.TEXTURE_3D,0,Ma,ya.width,ya.height,ya.depth,0,la,Ga,ya.data);else if(ha.isFramebufferTexture){if(Ta)if(Fb)d.texStorage2D(a.TEXTURE_2D,Sa,Ma,ya.width,ya.height);else for(Jb=
ya.width,ya=ya.height,$a=0;$a<Sa;$a++)d.texImage2D(a.TEXTURE_2D,$a,Ma,Jb,ya,0,la,Ga,null),Jb>>=1,ya>>=1}else if(Kb.length>0){Fb&&Ta&&(ya=Qa(Kb[0]),d.texStorage2D(a.TEXTURE_2D,Sa,Ma,ya.width,ya.height));for(let Nb=0,wc=Kb.length;Nb<wc;Nb++)$a=Kb[Nb],Fb?ua&&d.texSubImage2D(a.TEXTURE_2D,Nb,0,0,la,Ga,$a):d.texImage2D(a.TEXTURE_2D,Nb,Ma,la,Ga,$a);ha.generateMipmaps=!1}else Fb?(Ta&&(Jb=Qa(ya),d.texStorage2D(a.TEXTURE_2D,Sa,Ma,Jb.width,Jb.height)),ua&&d.texSubImage2D(a.TEXTURE_2D,0,0,0,la,Ga,ya)):d.texImage2D(a.TEXTURE_2D,
0,Ma,la,Ga,ya);ha.generateMipmaps&&a.generateMipmap(ta);oa.__version=Pa.version;if(ha.onUpdate)ha.onUpdate(ha)}ja.__version=ha.version}function wa(ja,ha,la,ta,ua,Pa){const oa=u.convert(la.format,la.colorSpace),Ga=u.convert(la.type),ya=H(la.internalFormat,oa,Ga,la.colorSpace);var Ma=h.get(ha);la=h.get(la);la.__renderTarget=ha;if(!Ma.__hasExternalTextures){Ma=Math.max(1,ha.width>>Pa);const Ta=Math.max(1,ha.height>>Pa);ua===a.TEXTURE_3D||ua===a.TEXTURE_2D_ARRAY?d.texImage3D(ua,Pa,ya,Ma,Ta,ha.depth,0,
oa,Ga,null):d.texImage2D(ua,Pa,ya,Ma,Ta,0,oa,Ga,null)}d.bindFramebuffer(a.FRAMEBUFFER,ja);Ca(ha)?Za.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,ta,ua,la.__webglTexture,0,Na(ha)):(ua===a.TEXTURE_2D||ua>=a.TEXTURE_CUBE_MAP_POSITIVE_X&&ua<=a.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&a.framebufferTexture2D(a.FRAMEBUFFER,ta,ua,la.__webglTexture,Pa);d.bindFramebuffer(a.FRAMEBUFFER,null)}function sa(ja,ha,la){a.bindRenderbuffer(a.RENDERBUFFER,ja);if(ha.depthBuffer){var ta=ha.depthTexture;ta=M(ha.stencilBuffer,
ta&&ta.isDepthTexture?ta.type:null);var ua=ha.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,Pa=Na(ha);Ca(ha)?Za.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,Pa,ta,ha.width,ha.height):la?a.renderbufferStorageMultisample(a.RENDERBUFFER,Pa,ta,ha.width,ha.height):a.renderbufferStorage(a.RENDERBUFFER,ta,ha.width,ha.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,ua,a.RENDERBUFFER,ja)}else for(ja=ha.textures,ta=0;ta<ja.length;ta++){ua=ja[ta];Pa=u.convert(ua.format,ua.colorSpace);const oa=
u.convert(ua.type);ua=H(ua.internalFormat,Pa,oa,ua.colorSpace);Pa=Na(ha);la&&Ca(ha)===!1?a.renderbufferStorageMultisample(a.RENDERBUFFER,Pa,ua,ha.width,ha.height):Ca(ha)?Za.renderbufferStorageMultisampleEXT(a.RENDERBUFFER,Pa,ua,ha.width,ha.height):a.renderbufferStorage(a.RENDERBUFFER,ua,ha.width,ha.height)}a.bindRenderbuffer(a.RENDERBUFFER,null)}function Aa(ja,ha){if(ha&&ha.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");d.bindFramebuffer(a.FRAMEBUFFER,
ja);if(!ha.depthTexture||!ha.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");ja=h.get(ha.depthTexture);ja.__renderTarget=ha;ja.__webglTexture&&ha.depthTexture.image.width===ha.width&&ha.depthTexture.image.height===ha.height||(ha.depthTexture.image.width=ha.width,ha.depthTexture.image.height=ha.height,ha.depthTexture.needsUpdate=!0);aa(ha.depthTexture,0);ja=ja.__webglTexture;const la=Na(ha);if(ha.depthTexture.format===1026)Ca(ha)?Za.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,
a.DEPTH_ATTACHMENT,a.TEXTURE_2D,ja,0,la):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.TEXTURE_2D,ja,0);else if(ha.depthTexture.format===1027)Ca(ha)?Za.framebufferTexture2DMultisampleEXT(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,ja,0,la):a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,ja,0);else throw Error("Unknown depthTexture format");}function Ba(ja){const ha=h.get(ja);var la=ja.isWebGLCubeRenderTarget===!0;if(ha.__boundDepthTexture!==ja.depthTexture){const ta=
ja.depthTexture;ha.__depthDisposeCallback&&ha.__depthDisposeCallback();if(ta){const ua=()=>{delete ha.__boundDepthTexture;delete ha.__depthDisposeCallback;ta.removeEventListener("dispose",ua)};ta.addEventListener("dispose",ua);ha.__depthDisposeCallback=ua}ha.__boundDepthTexture=ta}if(ja.depthTexture&&!ha.__autoAllocateDepthBuffer){if(la)throw Error("target.depthTexture not supported in Cube render targets");(la=ja.texture.mipmaps)&&la.length>0?Aa(ha.__webglFramebuffer[0],ja):Aa(ha.__webglFramebuffer,
ja)}else if(la)for(ha.__webglDepthbuffer=[],la=0;la<6;la++)if(d.bindFramebuffer(a.FRAMEBUFFER,ha.__webglFramebuffer[la]),ha.__webglDepthbuffer[la]===void 0)ha.__webglDepthbuffer[la]=a.createRenderbuffer(),sa(ha.__webglDepthbuffer[la],ja,!1);else{const ta=ja.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,ua=ha.__webglDepthbuffer[la];a.bindRenderbuffer(a.RENDERBUFFER,ua);a.framebufferRenderbuffer(a.FRAMEBUFFER,ta,a.RENDERBUFFER,ua)}else(la=ja.texture.mipmaps)&&la.length>0?d.bindFramebuffer(a.FRAMEBUFFER,
ha.__webglFramebuffer[0]):d.bindFramebuffer(a.FRAMEBUFFER,ha.__webglFramebuffer),ha.__webglDepthbuffer===void 0?(ha.__webglDepthbuffer=a.createRenderbuffer(),sa(ha.__webglDepthbuffer,ja,!1)):(ja=ja.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,la=ha.__webglDepthbuffer,a.bindRenderbuffer(a.RENDERBUFFER,la),a.framebufferRenderbuffer(a.FRAMEBUFFER,ja,a.RENDERBUFFER,la));d.bindFramebuffer(a.FRAMEBUFFER,null)}function Na(ja){return Math.min(n.maxSamples,ja.samples)}function Ca(ja){const ha=
h.get(ja);return ja.samples>0&&b.has("WEBGL_multisampled_render_to_texture")===!0&&ha.__useRenderToTexture!==!1}function Ja(ja,ha){const la=ja.colorSpace,ta=ja.format,ua=ja.type;if(ja.isCompressedTexture===!0||ja.isVideoTexture===!0)return ha;la!=="srgb-linear"&&la!==""&&($b.getTransfer(la)==="srgb"?(ta!==1023||ua!==1009)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",la));
return ha}function Qa(ja){typeof HTMLImageElement!=="undefined"&&ja instanceof HTMLImageElement?(cb.width=ja.naturalWidth||ja.width,cb.height=ja.naturalHeight||ja.height):typeof VideoFrame!=="undefined"&&ja instanceof VideoFrame?(cb.width=ja.displayWidth,cb.height=ja.displayHeight):(cb.width=ja.width,cb.height=ja.height);return cb}const Za=b.has("WEBGL_multisampled_render_to_texture")?b.get("WEBGL_multisampled_render_to_texture"):null,gb=typeof navigator==="undefined"?!1:/OculusBrowser/g.test(navigator.userAgent),
cb=new Xa,rb=new WeakMap;let Ya;const nb=new WeakMap;let ob=!1;try{ob=typeof OffscreenCanvas!=="undefined"&&(new OffscreenCanvas(1,1)).getContext("2d")!==null}catch(ja){}let ub=0;const Cb={[1E3]:a.REPEAT,[1001]:a.CLAMP_TO_EDGE,[1002]:a.MIRRORED_REPEAT},sb={[1003]:a.NEAREST,[1004]:a.NEAREST_MIPMAP_NEAREST,[1005]:a.NEAREST_MIPMAP_LINEAR,[1006]:a.LINEAR,[1007]:a.LINEAR_MIPMAP_NEAREST,[1008]:a.LINEAR_MIPMAP_LINEAR},Mb={[512]:a.NEVER,[519]:a.ALWAYS,[513]:a.LESS,[515]:a.LEQUAL,[514]:a.EQUAL,[518]:a.GEQUAL,
[516]:a.GREATER,[517]:a.NOTEQUAL},Wa=[],hb=[];this.allocateTextureUnit=function(){const ja=ub;ja>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ja+" texture units while this GPU supports only "+n.maxTextures);ub+=1;return ja};this.resetTextureUnits=function(){ub=0};this.setTexture2D=aa;this.setTexture2DArray=function(ja,ha){const la=h.get(ja);ja.isRenderTargetTexture===!1&&ja.version>0&&la.__version!==ja.version?qa(la,ja,ha):d.bindTexture(a.TEXTURE_2D_ARRAY,la.__webglTexture,a.TEXTURE0+
ha)};this.setTexture3D=function(ja,ha){const la=h.get(ja);ja.isRenderTargetTexture===!1&&ja.version>0&&la.__version!==ja.version?qa(la,ja,ha):d.bindTexture(a.TEXTURE_3D,la.__webglTexture,a.TEXTURE0+ha)};this.setTextureCube=function(ja,ha){const la=h.get(ja);if(ja.version>0&&la.__version!==ja.version){if(ja.image.length===6){var ta=U(la,ja),ua=ja.source;d.bindTexture(a.TEXTURE_CUBE_MAP,la.__webglTexture,a.TEXTURE0+ha);var Pa=h.get(ua);if(ua.version!==Pa.__version||ta===!0){d.activeTexture(a.TEXTURE0+
ha);ha=$b.getPrimaries($b.workingColorSpace);var oa=ja.colorSpace===""?null:$b.getPrimaries(ja.colorSpace);ha=ja.colorSpace===""||ha===oa?a.NONE:a.BROWSER_DEFAULT_WEBGL;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,ja.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ja.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,ja.unpackAlignment);a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,ha);var Ga=ja.isCompressedTexture||ja.image[0].isCompressedTexture,ya=ja.image[0]&&ja.image[0].isDataTexture;ha=[];
for(oa=0;oa<6;oa++)ha[oa]=Ga||ya?ya?ja.image[oa].image:ja.image[oa]:F(ja.image[oa],!0,n.maxCubemapSize),ha[oa]=Ja(ja,ha[oa]);var Ma=ha[0];oa=u.convert(ja.format,ja.colorSpace);const $a=u.convert(ja.type),Jb=H(ja.internalFormat,oa,$a,ja.colorSpace),Kb=ja.isVideoTexture!==!0;var Ta=Pa.__version===void 0||ta===!0;ta=ua.dataReady;var Sa=R(ja,Ma);da(a.TEXTURE_CUBE_MAP,ja);if(Ga)for(Kb&&Ta&&d.texStorage2D(a.TEXTURE_CUBE_MAP,Sa,Jb,Ma.width,Ma.height),ya=0;ya<6;ya++)for(Ga=ha[ya].mipmaps,Sa=0;Sa<Ga.length;Sa++)Ma=
Ga[Sa],ja.format!==1023?oa!==null?Kb?ta&&d.compressedTexSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ya,Sa,0,0,Ma.width,Ma.height,oa,Ma.data):d.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ya,Sa,Jb,Ma.width,Ma.height,0,Ma.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Kb?ta&&d.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ya,Sa,0,0,Ma.width,Ma.height,oa,$a,Ma.data):d.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+ya,Sa,Jb,Ma.width,Ma.height,
0,oa,$a,Ma.data);else for(Ga=ja.mipmaps,Kb&&Ta&&(Ga.length>0&&Sa++,Ma=Qa(ha[0]),d.texStorage2D(a.TEXTURE_CUBE_MAP,Sa,Jb,Ma.width,Ma.height)),Sa=0;Sa<6;Sa++)if(ya)for(Kb?ta&&d.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,0,0,0,ha[Sa].width,ha[Sa].height,oa,$a,ha[Sa].data):d.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,0,Jb,ha[Sa].width,ha[Sa].height,0,oa,$a,ha[Sa].data),Ma=0;Ma<Ga.length;Ma++)Ta=Ga[Ma].image[Sa].image,Kb?ta&&d.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,Ma+1,0,0,Ta.width,Ta.height,
oa,$a,Ta.data):d.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,Ma+1,Jb,Ta.width,Ta.height,0,oa,$a,Ta.data);else for(Kb?ta&&d.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,0,0,0,oa,$a,ha[Sa]):d.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,0,Jb,oa,$a,ha[Sa]),Ma=0;Ma<Ga.length;Ma++)Ta=Ga[Ma],Kb?ta&&d.texSubImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,Ma+1,0,0,oa,$a,Ta.image[Sa]):d.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+Sa,Ma+1,Jb,oa,$a,Ta.image[Sa]);ja.generateMipmaps&&a.generateMipmap(a.TEXTURE_CUBE_MAP);
Pa.__version=ua.version;if(ja.onUpdate)ja.onUpdate(ja)}la.__version=ja.version}}else d.bindTexture(a.TEXTURE_CUBE_MAP,la.__webglTexture,a.TEXTURE0+ha)};this.rebindTextures=function(ja,ha,la){const ta=h.get(ja);ha!==void 0&&wa(ta.__webglFramebuffer,ja,ja.texture,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,0);la!==void 0&&Ba(ja)};this.setupRenderTarget=function(ja){var ha=ja.texture;const la=h.get(ja);var ta=h.get(ha);ja.addEventListener("dispose",X);var ua=ja.textures,Pa=ja.isWebGLCubeRenderTarget===!0;const oa=
ua.length>1;oa||(ta.__webglTexture===void 0&&(ta.__webglTexture=a.createTexture()),ta.__version=ha.version,E.memory.textures++);if(Pa){la.__webglFramebuffer=[];for(var Ga=0;Ga<6;Ga++)if(ha.mipmaps&&ha.mipmaps.length>0){la.__webglFramebuffer[Ga]=[];for(var ya=0;ya<ha.mipmaps.length;ya++)la.__webglFramebuffer[Ga][ya]=a.createFramebuffer()}else la.__webglFramebuffer[Ga]=a.createFramebuffer()}else{if(ha.mipmaps&&ha.mipmaps.length>0)for(la.__webglFramebuffer=[],Ga=0;Ga<ha.mipmaps.length;Ga++)la.__webglFramebuffer[Ga]=
a.createFramebuffer();else la.__webglFramebuffer=a.createFramebuffer();if(oa)for(let Ta=0,Sa=ua.length;Ta<Sa;Ta++)Ga=h.get(ua[Ta]),Ga.__webglTexture===void 0&&(Ga.__webglTexture=a.createTexture(),E.memory.textures++);if(ja.samples>0&&Ca(ja)===!1){la.__webglMultisampledFramebuffer=a.createFramebuffer();la.__webglColorRenderbuffer=[];d.bindFramebuffer(a.FRAMEBUFFER,la.__webglMultisampledFramebuffer);for(Ga=0;Ga<ua.length;Ga++){ya=ua[Ga];la.__webglColorRenderbuffer[Ga]=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,
la.__webglColorRenderbuffer[Ga]);var Ma=u.convert(ya.format,ya.colorSpace);const Ta=u.convert(ya.type);ya=H(ya.internalFormat,Ma,Ta,ya.colorSpace,ja.isXRRenderTarget===!0);Ma=Na(ja);a.renderbufferStorageMultisample(a.RENDERBUFFER,Ma,ya,ja.width,ja.height);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+Ga,a.RENDERBUFFER,la.__webglColorRenderbuffer[Ga])}a.bindRenderbuffer(a.RENDERBUFFER,null);ja.depthBuffer&&(la.__webglDepthRenderbuffer=a.createRenderbuffer(),sa(la.__webglDepthRenderbuffer,
ja,!0));d.bindFramebuffer(a.FRAMEBUFFER,null)}}if(Pa){d.bindTexture(a.TEXTURE_CUBE_MAP,ta.__webglTexture);da(a.TEXTURE_CUBE_MAP,ha);for(ua=0;ua<6;ua++)if(ha.mipmaps&&ha.mipmaps.length>0)for(ta=0;ta<ha.mipmaps.length;ta++)wa(la.__webglFramebuffer[ua][ta],ja,ha,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+ua,ta);else wa(la.__webglFramebuffer[ua],ja,ha,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+ua,0);ha.generateMipmaps&&a.generateMipmap(a.TEXTURE_CUBE_MAP)}else if(oa)for(let Ta=0,Sa=ua.length;Ta<
Sa;Ta++){ha=ua[Ta];ta=h.get(ha);Pa=a.TEXTURE_2D;if(ja.isWebGL3DRenderTarget||ja.isWebGLArrayRenderTarget)Pa=ja.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY;d.bindTexture(Pa,ta.__webglTexture);da(Pa,ha);wa(la.__webglFramebuffer,ja,ha,a.COLOR_ATTACHMENT0+Ta,Pa,0);ha.generateMipmaps&&a.generateMipmap(Pa)}else{ua=a.TEXTURE_2D;if(ja.isWebGL3DRenderTarget||ja.isWebGLArrayRenderTarget)ua=ja.isWebGL3DRenderTarget?a.TEXTURE_3D:a.TEXTURE_2D_ARRAY;d.bindTexture(ua,ta.__webglTexture);da(ua,ha);if(ha.mipmaps&&
ha.mipmaps.length>0)for(ta=0;ta<ha.mipmaps.length;ta++)wa(la.__webglFramebuffer[ta],ja,ha,a.COLOR_ATTACHMENT0,ua,ta);else wa(la.__webglFramebuffer,ja,ha,a.COLOR_ATTACHMENT0,ua,0);ha.generateMipmaps&&a.generateMipmap(ua)}d.unbindTexture();ja.depthBuffer&&Ba(ja)};this.updateRenderTargetMipmap=function(ja){const ha=ja.textures;for(let ta=0,ua=ha.length;ta<ua;ta++){var la=ha[ta];if(la.generateMipmaps){const Pa=ja.isWebGLCubeRenderTarget?a.TEXTURE_CUBE_MAP:ja.isWebGL3DRenderTarget?a.TEXTURE_3D:ja.isWebGLArrayRenderTarget||
ja.isCompressedArrayTexture?a.TEXTURE_2D_ARRAY:a.TEXTURE_2D;la=h.get(la).__webglTexture;d.bindTexture(Pa,la);a.generateMipmap(Pa);d.unbindTexture()}}};this.updateMultisampleRenderTarget=function(ja){if(ja.samples>0)if(Ca(ja)===!1){const ta=ja.textures;var ha=ja.width;const ua=ja.height;let Pa=a.COLOR_BUFFER_BIT;const oa=ja.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT,Ga=h.get(ja),ya=ta.length>1;if(ya)for(var la=0;la<ta.length;la++)d.bindFramebuffer(a.FRAMEBUFFER,Ga.__webglMultisampledFramebuffer),
a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+la,a.RENDERBUFFER,null),d.bindFramebuffer(a.FRAMEBUFFER,Ga.__webglFramebuffer),a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+la,a.TEXTURE_2D,null,0);d.bindFramebuffer(a.READ_FRAMEBUFFER,Ga.__webglMultisampledFramebuffer);(la=ja.texture.mipmaps)&&la.length>0?d.bindFramebuffer(a.DRAW_FRAMEBUFFER,Ga.__webglFramebuffer[0]):d.bindFramebuffer(a.DRAW_FRAMEBUFFER,Ga.__webglFramebuffer);for(la=0;la<ta.length;la++){ja.resolveDepthBuffer&&
(ja.depthBuffer&&(Pa|=a.DEPTH_BUFFER_BIT),ja.stencilBuffer&&ja.resolveStencilBuffer&&(Pa|=a.STENCIL_BUFFER_BIT));if(ya){a.framebufferRenderbuffer(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,Ga.__webglColorRenderbuffer[la]);const Ma=h.get(ta[la]).__webglTexture;a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,Ma,0)}a.blitFramebuffer(0,0,ha,ua,0,0,ha,ua,Pa,a.NEAREST);gb===!0&&(Wa.length=0,hb.length=0,Wa.push(a.COLOR_ATTACHMENT0+la),ja.depthBuffer&&ja.resolveDepthBuffer===
!1&&(Wa.push(oa),hb.push(oa),a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,hb)),a.invalidateFramebuffer(a.READ_FRAMEBUFFER,Wa))}d.bindFramebuffer(a.READ_FRAMEBUFFER,null);d.bindFramebuffer(a.DRAW_FRAMEBUFFER,null);if(ya)for(ja=0;ja<ta.length;ja++)d.bindFramebuffer(a.FRAMEBUFFER,Ga.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0+ja,a.RENDERBUFFER,Ga.__webglColorRenderbuffer[ja]),ha=h.get(ta[ja]).__webglTexture,d.bindFramebuffer(a.FRAMEBUFFER,Ga.__webglFramebuffer),
a.framebufferTexture2D(a.DRAW_FRAMEBUFFER,a.COLOR_ATTACHMENT0+ja,a.TEXTURE_2D,ha,0);d.bindFramebuffer(a.DRAW_FRAMEBUFFER,Ga.__webglMultisampledFramebuffer)}else ja.depthBuffer&&ja.resolveDepthBuffer===!1&&gb&&a.invalidateFramebuffer(a.DRAW_FRAMEBUFFER,[ja.stencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT])};this.setupDepthRenderbuffer=Ba;this.setupFrameBufferTexture=wa;this.useMultisampledRTT=Ca}function gh(a,b){return{convert:function(d,h=""){const n=$b.getTransfer(h);if(d===1009)return a.UNSIGNED_BYTE;
if(d===1017)return a.UNSIGNED_SHORT_4_4_4_4;if(d===1018)return a.UNSIGNED_SHORT_5_5_5_1;if(d===35902)return a.UNSIGNED_INT_5_9_9_9_REV;if(d===35899)return a.UNSIGNED_INT_10F_11F_11F_REV;if(d===1010)return a.BYTE;if(d===1011)return a.SHORT;if(d===1012)return a.UNSIGNED_SHORT;if(d===1013)return a.INT;if(d===1014)return a.UNSIGNED_INT;if(d===1015)return a.FLOAT;if(d===1016)return a.HALF_FLOAT;if(d===1021)return a.ALPHA;if(d===1022)return a.RGB;if(d===1023)return a.RGBA;if(d===1026)return a.DEPTH_COMPONENT;
if(d===1027)return a.DEPTH_STENCIL;if(d===1028)return a.RED;if(d===1029)return a.RED_INTEGER;if(d===1030)return a.RG;if(d===1031)return a.RG_INTEGER;if(d===1033)return a.RGBA_INTEGER;if(d===33776||d===33777||d===33778||d===33779)if(n==="srgb")if(h=b.get("WEBGL_compressed_texture_s3tc_srgb"),h!==null){if(d===33776)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(d===33777)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(d===33778)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(d===33779)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;
else if(h=b.get("WEBGL_compressed_texture_s3tc"),h!==null){if(d===33776)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(d===33777)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(d===33778)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(d===33779)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(d===35840||d===35841||d===35842||d===35843)if(h=b.get("WEBGL_compressed_texture_pvrtc"),h!==null){if(d===35840)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(d===35841)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(d===35842)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
if(d===35843)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(d===36196||d===37492||d===37496)if(h=b.get("WEBGL_compressed_texture_etc"),h!==null){if(d===36196||d===37492)return n==="srgb"?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(d===37496)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(d===37808||d===37809||d===37810||d===37811||d===37812||d===37813||d===37814||d===37815||d===37816||d===37817||d===37818||d===37819||d===37820||
d===37821)if(h=b.get("WEBGL_compressed_texture_astc"),h!==null){if(d===37808)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(d===37809)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(d===37810)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(d===37811)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(d===37812)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:
h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(d===37813)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(d===37814)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(d===37815)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(d===37816)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(d===37817)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:
h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(d===37818)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(d===37819)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(d===37820)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(d===37821)return n==="srgb"?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(d===36492||d===36494||d===36495)if(h=
b.get("EXT_texture_compression_bptc"),h!==null){if(d===36492)return n==="srgb"?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(d===36494)return h.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(d===36495)return h.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(d===36283||d===36284||d===36285||d===36286)if(h=b.get("EXT_texture_compression_rgtc"),h!==null){if(d===36283)return h.COMPRESSED_RED_RGTC1_EXT;if(d===36284)return h.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(d===36285)return h.COMPRESSED_RED_GREEN_RGTC2_EXT;
if(d===36286)return h.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return d===1020?a.UNSIGNED_INT_24_8:a[d]!==void 0?a[d]:null}}}function Ai(a,b){function d(n,u){n.matrixAutoUpdate===!0&&n.updateMatrix();u.value.copy(n.matrix)}function h(n,u){n.opacity.value=u.opacity;u.color&&n.diffuse.value.copy(u.color);u.emissive&&n.emissive.value.copy(u.emissive).multiplyScalar(u.emissiveIntensity);u.map&&(n.map.value=u.map,d(u.map,n.mapTransform));u.alphaMap&&(n.alphaMap.value=u.alphaMap,d(u.alphaMap,
n.alphaMapTransform));u.bumpMap&&(n.bumpMap.value=u.bumpMap,d(u.bumpMap,n.bumpMapTransform),n.bumpScale.value=u.bumpScale,u.side===1&&(n.bumpScale.value*=-1));u.normalMap&&(n.normalMap.value=u.normalMap,d(u.normalMap,n.normalMapTransform),n.normalScale.value.copy(u.normalScale),u.side===1&&n.normalScale.value.negate());u.displacementMap&&(n.displacementMap.value=u.displacementMap,d(u.displacementMap,n.displacementMapTransform),n.displacementScale.value=u.displacementScale,n.displacementBias.value=
u.displacementBias);u.emissiveMap&&(n.emissiveMap.value=u.emissiveMap,d(u.emissiveMap,n.emissiveMapTransform));u.specularMap&&(n.specularMap.value=u.specularMap,d(u.specularMap,n.specularMapTransform));u.alphaTest>0&&(n.alphaTest.value=u.alphaTest);var E=b.get(u);const F=E.envMap;E=E.envMapRotation;F&&(n.envMap.value=F,Ad.copy(E),Ad.x*=-1,Ad.y*=-1,Ad.z*=-1,F.isCubeTexture&&F.isRenderTargetTexture===!1&&(Ad.y*=-1,Ad.z*=-1),n.envMapRotation.value.setFromMatrix4(um.makeRotationFromEuler(Ad)),n.flipEnvMap.value=
F.isCubeTexture&&F.isRenderTargetTexture===!1?-1:1,n.reflectivity.value=u.reflectivity,n.ior.value=u.ior,n.refractionRatio.value=u.refractionRatio);u.lightMap&&(n.lightMap.value=u.lightMap,n.lightMapIntensity.value=u.lightMapIntensity,d(u.lightMap,n.lightMapTransform));u.aoMap&&(n.aoMap.value=u.aoMap,n.aoMapIntensity.value=u.aoMapIntensity,d(u.aoMap,n.aoMapTransform))}return{refreshFogUniforms:function(n,u){u.color.getRGB(n.fogColor.value,ba(a));u.isFog?(n.fogNear.value=u.near,n.fogFar.value=u.far):
u.isFogExp2&&(n.fogDensity.value=u.density)},refreshMaterialUniforms:function(n,u,E,F,H){u.isMeshBasicMaterial?h(n,u):u.isMeshLambertMaterial?h(n,u):u.isMeshToonMaterial?(h(n,u),u.gradientMap&&(n.gradientMap.value=u.gradientMap)):u.isMeshPhongMaterial?(h(n,u),n.specular.value.copy(u.specular),n.shininess.value=Math.max(u.shininess,1E-4)):u.isMeshStandardMaterial?(h(n,u),n.metalness.value=u.metalness,u.metalnessMap&&(n.metalnessMap.value=u.metalnessMap,d(u.metalnessMap,n.metalnessMapTransform)),n.roughness.value=
u.roughness,u.roughnessMap&&(n.roughnessMap.value=u.roughnessMap,d(u.roughnessMap,n.roughnessMapTransform)),u.envMap&&(n.envMapIntensity.value=u.envMapIntensity),u.isMeshPhysicalMaterial&&(n.ior.value=u.ior,u.sheen>0&&(n.sheenColor.value.copy(u.sheenColor).multiplyScalar(u.sheen),n.sheenRoughness.value=u.sheenRoughness,u.sheenColorMap&&(n.sheenColorMap.value=u.sheenColorMap,d(u.sheenColorMap,n.sheenColorMapTransform)),u.sheenRoughnessMap&&(n.sheenRoughnessMap.value=u.sheenRoughnessMap,d(u.sheenRoughnessMap,
n.sheenRoughnessMapTransform))),u.clearcoat>0&&(n.clearcoat.value=u.clearcoat,n.clearcoatRoughness.value=u.clearcoatRoughness,u.clearcoatMap&&(n.clearcoatMap.value=u.clearcoatMap,d(u.clearcoatMap,n.clearcoatMapTransform)),u.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap.value=u.clearcoatRoughnessMap,d(u.clearcoatRoughnessMap,n.clearcoatRoughnessMapTransform)),u.clearcoatNormalMap&&(n.clearcoatNormalMap.value=u.clearcoatNormalMap,d(u.clearcoatNormalMap,n.clearcoatNormalMapTransform),n.clearcoatNormalScale.value.copy(u.clearcoatNormalScale),
u.side===1&&n.clearcoatNormalScale.value.negate())),u.dispersion>0&&(n.dispersion.value=u.dispersion),u.iridescence>0&&(n.iridescence.value=u.iridescence,n.iridescenceIOR.value=u.iridescenceIOR,n.iridescenceThicknessMinimum.value=u.iridescenceThicknessRange[0],n.iridescenceThicknessMaximum.value=u.iridescenceThicknessRange[1],u.iridescenceMap&&(n.iridescenceMap.value=u.iridescenceMap,d(u.iridescenceMap,n.iridescenceMapTransform)),u.iridescenceThicknessMap&&(n.iridescenceThicknessMap.value=u.iridescenceThicknessMap,
d(u.iridescenceThicknessMap,n.iridescenceThicknessMapTransform))),u.transmission>0&&(n.transmission.value=u.transmission,n.transmissionSamplerMap.value=H.texture,n.transmissionSamplerSize.value.set(H.width,H.height),u.transmissionMap&&(n.transmissionMap.value=u.transmissionMap,d(u.transmissionMap,n.transmissionMapTransform)),n.thickness.value=u.thickness,u.thicknessMap&&(n.thicknessMap.value=u.thicknessMap,d(u.thicknessMap,n.thicknessMapTransform)),n.attenuationDistance.value=u.attenuationDistance,
n.attenuationColor.value.copy(u.attenuationColor)),u.anisotropy>0&&(n.anisotropyVector.value.set(u.anisotropy*Math.cos(u.anisotropyRotation),u.anisotropy*Math.sin(u.anisotropyRotation)),u.anisotropyMap&&(n.anisotropyMap.value=u.anisotropyMap,d(u.anisotropyMap,n.anisotropyMapTransform))),n.specularIntensity.value=u.specularIntensity,n.specularColor.value.copy(u.specularColor),u.specularColorMap&&(n.specularColorMap.value=u.specularColorMap,d(u.specularColorMap,n.specularColorMapTransform)),u.specularIntensityMap&&
(n.specularIntensityMap.value=u.specularIntensityMap,d(u.specularIntensityMap,n.specularIntensityMapTransform)))):u.isMeshMatcapMaterial?(h(n,u),u.matcap&&(n.matcap.value=u.matcap)):u.isMeshDepthMaterial?h(n,u):u.isMeshDistanceMaterial?(h(n,u),u=b.get(u).light,n.referencePosition.value.setFromMatrixPosition(u.matrixWorld),n.nearDistance.value=u.shadow.camera.near,n.farDistance.value=u.shadow.camera.far):u.isMeshNormalMaterial?h(n,u):u.isLineBasicMaterial?(n.diffuse.value.copy(u.color),n.opacity.value=
u.opacity,u.map&&(n.map.value=u.map,d(u.map,n.mapTransform)),u.isLineDashedMaterial&&(n.dashSize.value=u.dashSize,n.totalSize.value=u.dashSize+u.gapSize,n.scale.value=u.scale)):u.isPointsMaterial?(n.diffuse.value.copy(u.color),n.opacity.value=u.opacity,n.size.value=u.size*E,n.scale.value=F*.5,u.map&&(n.map.value=u.map,d(u.map,n.uvTransform)),u.alphaMap&&(n.alphaMap.value=u.alphaMap,d(u.alphaMap,n.alphaMapTransform)),u.alphaTest>0&&(n.alphaTest.value=u.alphaTest)):u.isSpriteMaterial?(n.diffuse.value.copy(u.color),
n.opacity.value=u.opacity,n.rotation.value=u.rotation,u.map&&(n.map.value=u.map,d(u.map,n.mapTransform)),u.alphaMap&&(n.alphaMap.value=u.alphaMap,d(u.alphaMap,n.alphaMapTransform)),u.alphaTest>0&&(n.alphaTest.value=u.alphaTest)):u.isShadowMaterial?(n.color.value.copy(u.color),n.opacity.value=u.opacity):u.isShaderMaterial&&(u.uniformsNeedUpdate=!1)}}}function Bi(a,b,d,h){function n(T){var X=T.uniforms;let ea=0;for(let da=0,U=X.length;da<U;da++){const ka=Array.isArray(X[da])?X[da]:[X[da]];for(let qa=
0,wa=ka.length;qa<wa;qa++){const sa=ka[qa],Aa=Array.isArray(sa.value)?sa.value:[sa.value];for(let Ba=0,Na=Aa.length;Ba<Na;Ba++){const Ca=u(Aa[Ba]);var aa=ea%16;const Ja=aa%Ca.boundary;aa+=Ja;ea+=Ja;aa!==0&&16-aa<Ca.storage&&(ea+=16-aa);sa.__data=new Float32Array(Ca.storage/Float32Array.BYTES_PER_ELEMENT);sa.__offset=ea;ea+=Ca.storage}}}X=ea%16;X>0&&(ea+=16-X);T.__size=ea;T.__cache={};return this}function u(T){const X={boundary:0,storage:0};typeof T==="number"||typeof T==="boolean"?(X.boundary=4,X.storage=
4):T.isVector2?(X.boundary=8,X.storage=8):T.isVector3||T.isColor?(X.boundary=16,X.storage=12):T.isVector4?(X.boundary=16,X.storage=16):T.isMatrix3?(X.boundary=48,X.storage=48):T.isMatrix4?(X.boundary=64,X.storage=64):T.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",T);return X}function E(T){T=T.target;T.removeEventListener("dispose",E);const X=M.indexOf(T.__bindingPointIndex);
M.splice(X,1);a.deleteBuffer(F[T.id]);delete F[T.id];delete H[T.id]}let F={},H={},M=[];const R=a.getParameter(a.MAX_UNIFORM_BUFFER_BINDINGS);return{bind:function(T,X){h.uniformBlockBinding(T,X.program)},update:function(T,X){var ea=F[T.id];if(ea===void 0){n(T);a:{for(ea=0;ea<R;ea++)if(M.indexOf(ea)===-1){M.push(ea);break a}console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached.");ea=0}T.__bindingPointIndex=ea;var aa=a.createBuffer(),da=T.__size,U=T.usage;
a.bindBuffer(a.UNIFORM_BUFFER,aa);a.bufferData(a.UNIFORM_BUFFER,da,U);a.bindBuffer(a.UNIFORM_BUFFER,null);a.bindBufferBase(a.UNIFORM_BUFFER,ea,aa);ea=aa;F[T.id]=ea;T.addEventListener("dispose",E)}h.updateUBOMapping(T,X.program);X=b.render.frame;if(H[T.id]!==X){ea=T.uniforms;aa=T.__cache;a.bindBuffer(a.UNIFORM_BUFFER,F[T.id]);for(let sa=0,Aa=ea.length;sa<Aa;sa++){da=Array.isArray(ea[sa])?ea[sa]:[ea[sa]];for(let Ba=0,Na=da.length;Ba<Na;Ba++){U=da[Ba];a:{var ka=U.value;var qa=sa+"_"+Ba;if(aa[qa]===void 0)aa[qa]=
typeof ka==="number"||typeof ka==="boolean"?ka:ka.clone(),ka=!0;else{var wa=aa[qa];if(typeof ka==="number"||typeof ka==="boolean"){if(wa!==ka){aa[qa]=ka;ka=!0;break a}}else if(wa.equals(ka)===!1){wa.copy(ka);ka=!0;break a}ka=!1}}if(ka===!0){ka=U.__offset;qa=Array.isArray(U.value)?U.value:[U.value];wa=0;for(let Ca=0;Ca<qa.length;Ca++){const Ja=qa[Ca],Qa=u(Ja);typeof Ja==="number"||typeof Ja==="boolean"?(U.__data[0]=Ja,a.bufferSubData(a.UNIFORM_BUFFER,ka+wa,U.__data)):Ja.isMatrix3?(U.__data[0]=Ja.elements[0],
U.__data[1]=Ja.elements[1],U.__data[2]=Ja.elements[2],U.__data[3]=0,U.__data[4]=Ja.elements[3],U.__data[5]=Ja.elements[4],U.__data[6]=Ja.elements[5],U.__data[7]=0,U.__data[8]=Ja.elements[6],U.__data[9]=Ja.elements[7],U.__data[10]=Ja.elements[8],U.__data[11]=0):(Ja.toArray(U.__data,wa),wa+=Qa.storage/Float32Array.BYTES_PER_ELEMENT)}a.bufferSubData(a.UNIFORM_BUFFER,ka,U.__data)}}}a.bindBuffer(a.UNIFORM_BUFFER,null);H[T.id]=X}},dispose:function(){for(const T in F)a.deleteBuffer(F[T]);M=[];F={};H={}}}}
class Bd{addEventListener(a,b){this._listeners===void 0&&(this._listeners={});const d=this._listeners;d[a]===void 0&&(d[a]=[]);d[a].indexOf(b)===-1&&d[a].push(b)}hasEventListener(a,b){const d=this._listeners;return d===void 0?!1:d[a]!==void 0&&d[a].indexOf(b)!==-1}removeEventListener(a,b){const d=this._listeners;d!==void 0&&(a=d[a],a!==void 0&&(b=a.indexOf(b),b!==-1&&a.splice(b,1)))}dispatchEvent(a){var b=this._listeners;if(b!==void 0&&(b=b[a.type],b!==void 0)){a.target=this;b=b.slice(0);for(let d=
0,h=b.length;d<h;d++)b[d].call(this,a);a.target=null}}}const Rc="00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f 40 41 42 43 44 45 46 47 48 49 4a 4b 4c 4d 4e 4f 50 51 52 53 54 55 56 57 58 59 5a 5b 5c 5d 5e 5f 60 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f 80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f 90 91 92 93 94 95 96 97 98 99 9a 9b 9c 9d 9e 9f a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 aa ab ac ad ae af b0 b1 b2 b3 b4 b5 b6 b7 b8 b9 ba bb bc bd be bf c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cb cc cd ce cf d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 da db dc dd de df e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff".split(" ");
let hh=1234567;const je=Math.PI/180,ye=180/Math.PI,Ci={DEG2RAD:je,RAD2DEG:ye,generateUUID:x,clamp:r,euclideanModulo:e,mapLinear:function(a,b,d,h,n){return h+(a-b)*(n-h)/(d-b)},inverseLerp:function(a,b,d){return a!==b?(d-a)/(b-a):0},lerp:g,damp:function(a,b,d,h){return g(a,b,1-Math.exp(-d*h))},pingpong:function(a,b=1){return b-Math.abs(e(a,b*2)-b)},smoothstep:function(a,b,d){if(a<=b)return 0;if(a>=d)return 1;a=(a-b)/(d-b);return a*a*(3-2*a)},smootherstep:function(a,b,d){if(a<=b)return 0;if(a>=d)return 1;
a=(a-b)/(d-b);return a*a*a*(a*(a*6-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},seededRandom:function(a){a!==void 0&&(hh=a);a=hh+=1831565813;a=Math.imul(a^a>>>15,a|1);a^=a+Math.imul(a^a>>>7,a|61);return((a^a>>>14)>>>0)/4294967296},degToRad:function(a){return a*je},radToDeg:function(a){return a*ye},isPowerOfTwo:function(a){return(a&a-1)===0&&a!==0},ceilPowerOfTwo:function(a){return Math.pow(2,
Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},setQuaternionFromProperEuler:function(a,b,d,h,n){var u=Math.cos;const E=Math.sin,F=u(d/2);d=E(d/2);const H=u((b+h)/2),M=E((b+h)/2),R=u((b-h)/2),T=E((b-h)/2);u=u((h-b)/2);b=E((h-b)/2);switch(n){case "XYX":a.set(F*M,d*R,d*T,F*H);break;case "YZY":a.set(d*T,F*M,d*R,F*H);break;case "ZXZ":a.set(d*R,d*T,F*M,F*H);break;case "XZX":a.set(F*M,d*b,d*u,F*H);break;case "YXY":a.set(d*u,F*M,d*b,F*H);
break;case "ZYZ":a.set(d*b,d*u,F*M,F*H);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}},normalize:k,denormalize:f};class Xa{constructor(a=0,b=0){Xa.prototype.isVector2=!0;this.x=a;this.y=b}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,b){this.x=a;this.y=b;return this}setScalar(a){this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setComponent(a,
b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y)}copy(a){this.x=a.x;this.y=a.y;return this}add(a){this.x+=a.x;this.y+=a.y;return this}addScalar(a){this.x+=a;this.y+=a;return this}addVectors(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this}addScaledVector(a,b){this.x+=
a.x*b;this.y+=a.y*b;return this}sub(a){this.x-=a.x;this.y-=a.y;return this}subScalar(a){this.x-=a;this.y-=a;return this}subVectors(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this}multiply(a){this.x*=a.x;this.y*=a.y;return this}multiplyScalar(a){this.x*=a;this.y*=a;return this}divide(a){this.x/=a.x;this.y/=a.y;return this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){const b=this.x,d=this.y;a=a.elements;this.x=a[0]*b+a[3]*d+a[6];this.y=a[1]*b+a[4]*d+a[7];return this}min(a){this.x=
Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this}clamp(a,b){this.x=r(this.x,a.x,b.x);this.y=r(this.y,a.y,b.y);return this}clampScalar(a,b){this.x=r(this.x,a,b);this.y=r(this.y,a,b);return this}clampLength(a,b){const d=this.length();return this.divideScalar(d||1).multiplyScalar(r(d,a,b))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);
return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);return this}negate(){this.x=-this.x;this.y=-this.y;return this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,
-this.x)+Math.PI}angleTo(a){const b=Math.sqrt(this.lengthSq()*a.lengthSq());if(b===0)return Math.PI/2;a=this.dot(a)/b;return Math.acos(r(a,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const b=this.x-a.x;a=this.y-a.y;return b*b+a*a}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this}lerpVectors(a,b,d){this.x=a.x+(b.x-
a.x)*d;this.y=a.y+(b.y-a.y)*d;return this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,b=0){this.x=a[b];this.y=a[b+1];return this}toArray(a=[],b=0){a[b]=this.x;a[b+1]=this.y;return a}fromBufferAttribute(a,b){this.x=a.getX(b);this.y=a.getY(b);return this}rotateAround(a,b){const d=Math.cos(b);b=Math.sin(b);const h=this.x-a.x,n=this.y-a.y;this.x=h*d-n*b+a.x;this.y=h*b+n*d+a.y;return this}random(){this.x=Math.random();this.y=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y}}
class dd{constructor(a=0,b=0,d=0,h=1){this.isQuaternion=!0;this._x=a;this._y=b;this._z=d;this._w=h}static slerpFlat(a,b,d,h,n,u,E){let F=d[h+0],H=d[h+1],M=d[h+2];d=d[h+3];h=n[u+0];const R=n[u+1],T=n[u+2];n=n[u+3];if(E===0)a[b+0]=F,a[b+1]=H,a[b+2]=M,a[b+3]=d;else if(E===1)a[b+0]=h,a[b+1]=R,a[b+2]=T,a[b+3]=n;else{if(d!==n||F!==h||H!==R||M!==T){u=1-E;var X=F*h+H*R+M*T+d*n,ea=X>=0?1:-1,aa=1-X*X;aa>Number.EPSILON&&(aa=Math.sqrt(aa),X=Math.atan2(aa,X*ea),u=Math.sin(u*X)/aa,E=Math.sin(E*X)/aa);ea*=E;F=F*
u+h*ea;H=H*u+R*ea;M=M*u+T*ea;d=d*u+n*ea;u===1-E&&(E=1/Math.sqrt(F*F+H*H+M*M+d*d),F*=E,H*=E,M*=E,d*=E)}a[b]=F;a[b+1]=H;a[b+2]=M;a[b+3]=d}}static multiplyQuaternionsFlat(a,b,d,h,n,u){const E=d[h],F=d[h+1],H=d[h+2];d=d[h+3];h=n[u];const M=n[u+1],R=n[u+2];n=n[u+3];a[b]=E*n+d*h+F*R-H*M;a[b+1]=F*n+d*M+H*h-E*R;a[b+2]=H*n+d*R+E*M-F*h;a[b+3]=d*n-E*h-F*M-H*R;return a}get x(){return this._x}set x(a){this._x=a;this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a;this._onChangeCallback()}get z(){return this._z}set z(a){this._z=
a;this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a;this._onChangeCallback()}set(a,b,d,h){this._x=a;this._y=b;this._z=d;this._w=h;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this._onChangeCallback();return this}setFromEuler(a,b=!0){var d=a._x,h=a._y,n=a._z;a=a._order;var u=Math.cos;const E=Math.sin,F=u(d/2),H=u(h/2);u=u(n/2);d=E(d/2);h=E(h/2);n=E(n/2);switch(a){case "XYZ":this._x=
d*H*u+F*h*n;this._y=F*h*u-d*H*n;this._z=F*H*n+d*h*u;this._w=F*H*u-d*h*n;break;case "YXZ":this._x=d*H*u+F*h*n;this._y=F*h*u-d*H*n;this._z=F*H*n-d*h*u;this._w=F*H*u+d*h*n;break;case "ZXY":this._x=d*H*u-F*h*n;this._y=F*h*u+d*H*n;this._z=F*H*n+d*h*u;this._w=F*H*u-d*h*n;break;case "ZYX":this._x=d*H*u-F*h*n;this._y=F*h*u+d*H*n;this._z=F*H*n-d*h*u;this._w=F*H*u+d*h*n;break;case "YZX":this._x=d*H*u+F*h*n;this._y=F*h*u+d*H*n;this._z=F*H*n-d*h*u;this._w=F*H*u-d*h*n;break;case "XZY":this._x=d*H*u-F*h*n;this._y=
F*h*u-d*H*n;this._z=F*H*n+d*h*u;this._w=F*H*u+d*h*n;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}b===!0&&this._onChangeCallback();return this}setFromAxisAngle(a,b){b/=2;const d=Math.sin(b);this._x=a.x*d;this._y=a.y*d;this._z=a.z*d;this._w=Math.cos(b);this._onChangeCallback();return this}setFromRotationMatrix(a){var b=a.elements,d=b[0];a=b[4];const h=b[8],n=b[1],u=b[5],E=b[9],F=b[2],H=b[6];b=b[10];const M=d+u+b;M>0?(d=.5/Math.sqrt(M+1),this._w=.25/
d,this._x=(H-E)*d,this._y=(h-F)*d,this._z=(n-a)*d):d>u&&d>b?(d=2*Math.sqrt(1+d-u-b),this._w=(H-E)/d,this._x=.25*d,this._y=(a+n)/d,this._z=(h+F)/d):u>b?(d=2*Math.sqrt(1+u-d-b),this._w=(h-F)/d,this._x=(a+n)/d,this._y=.25*d,this._z=(E+H)/d):(d=2*Math.sqrt(1+b-d-u),this._w=(n-a)/d,this._x=(h+F)/d,this._y=(E+H)/d,this._z=.25*d);this._onChangeCallback();return this}setFromUnitVectors(a,b){let d=a.dot(b)+1;d<1E-8?(d=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0):(this._x=0,this._y=-a.z,
this._z=a.y)):(this._x=a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x);this._w=d;return this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(r(this.dot(a),-1,1)))}rotateTowards(a,b){const d=this.angleTo(a);if(d===0)return this;this.slerp(a,Math.min(1,b/d));return this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){this._x*=-1;this._y*=-1;this._z*=-1;this._onChangeCallback();return this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*
a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();a===0?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this._onChangeCallback();return this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,b){const d=a._x,h=a._y,n=a._z;
a=a._w;const u=b._x,E=b._y,F=b._z;b=b._w;this._x=d*b+a*u+h*F-n*E;this._y=h*b+a*E+n*u-d*F;this._z=n*b+a*F+d*E-h*u;this._w=a*b-d*u-h*E-n*F;this._onChangeCallback();return this}slerp(a,b){if(b===0)return this;if(b===1)return this.copy(a);const d=this._x,h=this._y,n=this._z,u=this._w;var E=u*a._w+d*a._x+h*a._y+n*a._z;E<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,E=-E):this.copy(a);if(E>=1)return this._w=u,this._x=d,this._y=h,this._z=n,this;a=1-E*E;if(a<=Number.EPSILON)return E=1-b,this._w=
E*u+b*this._w,this._x=E*d+b*this._x,this._y=E*h+b*this._y,this._z=E*n+b*this._z,this.normalize(),this;a=Math.sqrt(a);const F=Math.atan2(a,E);E=Math.sin((1-b)*F)/a;b=Math.sin(b*F)/a;this._w=u*E+this._w*b;this._x=d*E+this._x*b;this._y=h*E+this._y*b;this._z=n*E+this._z*b;this._onChangeCallback();return this}slerpQuaternions(a,b,d){return this.copy(a).slerp(b,d)}random(){const a=2*Math.PI*Math.random(),b=2*Math.PI*Math.random();var d=Math.random();const h=Math.sqrt(1-d);d=Math.sqrt(d);return this.set(h*
Math.sin(a),h*Math.cos(a),d*Math.sin(b),d*Math.cos(b))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,b=0){this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this._onChangeCallback();return this}toArray(a=[],b=0){a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a}fromBufferAttribute(a,b){this._x=a.getX(b);this._y=a.getY(b);this._z=a.getZ(b);this._w=a.getW(b);this._onChangeCallback();return this}toJSON(){return this.toArray()}_onChange(a){this._onChangeCallback=
a;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._w}}class ma{constructor(a=0,b=0,d=0){ma.prototype.isVector3=!0;this.x=a;this.y=b;this.z=d}set(a,b,d){d===void 0&&(d=this.z);this.x=a;this.y=b;this.z=d;return this}setScalar(a){this.z=this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setZ(a){this.z=a;return this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;
default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){this.x=a.x;this.y=a.y;this.z=a.z;return this}add(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this}addScalar(a){this.x+=a;this.y+=a;this.z+=a;return this}addVectors(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this}addScaledVector(a,
b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this}sub(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this}subScalar(a){this.x-=a;this.y-=a;this.z-=a;return this}subVectors(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this}multiply(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this}multiplyScalar(a){this.x*=a;this.y*=a;this.z*=a;return this}multiplyVectors(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this}applyEuler(a){return this.applyQuaternion(ih.setFromEuler(a))}applyAxisAngle(a,
b){return this.applyQuaternion(ih.setFromAxisAngle(a,b))}applyMatrix3(a){const b=this.x,d=this.y,h=this.z;a=a.elements;this.x=a[0]*b+a[3]*d+a[6]*h;this.y=a[1]*b+a[4]*d+a[7]*h;this.z=a[2]*b+a[5]*d+a[8]*h;return this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){const b=this.x,d=this.y,h=this.z;a=a.elements;const n=1/(a[3]*b+a[7]*d+a[11]*h+a[15]);this.x=(a[0]*b+a[4]*d+a[8]*h+a[12])*n;this.y=(a[1]*b+a[5]*d+a[9]*h+a[13])*n;this.z=(a[2]*b+a[6]*d+a[10]*h+a[14])*n;return this}applyQuaternion(a){const b=
this.x,d=this.y,h=this.z,n=a.x,u=a.y,E=a.z;a=a.w;const F=2*(u*h-E*d),H=2*(E*b-n*h),M=2*(n*d-u*b);this.x=b+a*F+u*M-E*H;this.y=d+a*H+E*F-n*M;this.z=h+a*M+n*H-u*F;return this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){const b=this.x,d=this.y,h=this.z;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*h;this.y=a[1]*b+a[5]*d+a[9]*h;this.z=a[2]*b+a[6]*d+
a[10]*h;return this.normalize()}divide(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this}clamp(a,b){this.x=r(this.x,a.x,b.x);this.y=r(this.y,a.y,b.y);this.z=r(this.z,a.z,b.z);return this}clampScalar(a,b){this.x=r(this.x,a,b);this.y=r(this.y,a,b);
this.z=r(this.z,a,b);return this}clampLength(a,b){const d=this.length();return this.divideScalar(d||1).multiplyScalar(r(d,a,b))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);
return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=
(a.z-this.z)*b;return this}lerpVectors(a,b,d){this.x=a.x+(b.x-a.x)*d;this.y=a.y+(b.y-a.y)*d;this.z=a.z+(b.z-a.z)*d;return this}cross(a){return this.crossVectors(this,a)}crossVectors(a,b){const d=a.x,h=a.y;a=a.z;const n=b.x,u=b.y;b=b.z;this.x=h*b-a*u;this.y=a*n-d*b;this.z=d*u-h*n;return this}projectOnVector(a){var b=a.lengthSq();if(b===0)return this.set(0,0,0);b=a.dot(this)/b;return this.copy(a).multiplyScalar(b)}projectOnPlane(a){tg.copy(this).projectOnVector(a);return this.sub(tg)}reflect(a){return this.sub(tg.copy(a).multiplyScalar(2*
this.dot(a)))}angleTo(a){const b=Math.sqrt(this.lengthSq()*a.lengthSq());if(b===0)return Math.PI/2;a=this.dot(a)/b;return Math.acos(r(a,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){const b=this.x-a.x,d=this.y-a.y;a=this.z-a.z;return b*b+d*d+a*a}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,b,d){const h=Math.sin(b)*
a;this.x=h*Math.sin(d);this.y=Math.cos(b)*a;this.z=h*Math.cos(d);return this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,b,d){this.x=a*Math.sin(b);this.y=d;this.z=a*Math.cos(b);return this}setFromMatrixPosition(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this}setFromMatrixScale(a){const b=this.setFromMatrixColumn(a,0).length(),d=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;
this.y=d;this.z=a;return this}setFromMatrixColumn(a,b){return this.fromArray(a.elements,b*4)}setFromMatrix3Column(a,b){return this.fromArray(a.elements,b*3)}setFromEuler(a){this.x=a._x;this.y=a._y;this.z=a._z;return this}setFromColor(a){this.x=a.r;this.y=a.g;this.z=a.b;return this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,b=0){this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this}toArray(a=[],b=0){a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a}fromBufferAttribute(a,b){this.x=
a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();return this}randomDirection(){const a=Math.random()*Math.PI*2,b=Math.random()*2-1,d=Math.sqrt(1-b*b);this.x=d*Math.cos(a);this.y=b;this.z=d*Math.sin(a);return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z}}const tg=new ma,ih=new dd;class Lb{constructor(a,b,d,h,n,u,E,F,H){Lb.prototype.isMatrix3=!0;this.elements=[1,0,0,0,1,0,0,0,1];a!==void 0&&this.set(a,
b,d,h,n,u,E,F,H)}set(a,b,d,h,n,u,E,F,H){const M=this.elements;M[0]=a;M[1]=h;M[2]=E;M[3]=b;M[4]=n;M[5]=F;M[6]=d;M[7]=u;M[8]=H;return this}identity(){this.set(1,0,0,0,1,0,0,0,1);return this}copy(a){const b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this}extractBasis(a,b,d){a.setFromMatrix3Column(this,0);b.setFromMatrix3Column(this,1);d.setFromMatrix3Column(this,2);return this}setFromMatrix4(a){a=a.elements;this.set(a[0],
a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){var d=a.elements,h=b.elements;b=this.elements;a=d[0];const n=d[3],u=d[6],E=d[1],F=d[4],H=d[7],M=d[2],R=d[5];d=d[8];const T=h[0],X=h[3],ea=h[6],aa=h[1],da=h[4],U=h[7],ka=h[2],qa=h[5];h=h[8];b[0]=a*T+n*aa+u*ka;b[3]=a*X+n*da+u*qa;b[6]=a*ea+n*U+u*h;b[1]=E*T+F*aa+H*ka;b[4]=E*X+F*da+H*qa;b[7]=E*ea+F*U+H*h;b[2]=M*T+R*aa+d*ka;b[5]=
M*X+R*da+d*qa;b[8]=M*ea+R*U+d*h;return this}multiplyScalar(a){const b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this}determinant(){var a=this.elements;const b=a[0],d=a[1],h=a[2],n=a[3],u=a[4],E=a[5],F=a[6],H=a[7];a=a[8];return b*u*a-b*E*H-d*n*a+d*E*F+h*n*H-h*u*F}invert(){const a=this.elements,b=a[0],d=a[1],h=a[2],n=a[3],u=a[4],E=a[5],F=a[6],H=a[7],M=a[8],R=M*u-E*H,T=E*F-M*n,X=H*n-u*F;var ea=b*R+d*T+h*X;if(ea===0)return this.set(0,0,0,0,0,0,0,0,0);
ea=1/ea;a[0]=R*ea;a[1]=(h*H-M*d)*ea;a[2]=(E*d-h*u)*ea;a[3]=T*ea;a[4]=(M*b-h*F)*ea;a[5]=(h*n-E*b)*ea;a[6]=X*ea;a[7]=(d*F-H*b)*ea;a[8]=(u*b-d*n)*ea;return this}transpose(){let a;const b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){const b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this}setUvTransform(a,
b,d,h,n,u,E){const F=Math.cos(n);n=Math.sin(n);this.set(d*F,d*n,-d*(F*u+n*E)+u+a,-h*n,h*F,-h*(-n*u+F*E)+E+b,0,0,1);return this}scale(a,b){this.premultiply(ug.makeScale(a,b));return this}rotate(a){this.premultiply(ug.makeRotation(-a));return this}translate(a,b){this.premultiply(ug.makeTranslation(a,b));return this}makeTranslation(a,b){a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,b,0,0,1);return this}makeRotation(a){const b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,a,b,0,0,0,1);return this}makeScale(a,
b){this.set(a,0,0,0,b,0,0,0,1);return this}equals(a){const b=this.elements;a=a.elements;for(let d=0;d<9;d++)if(b[d]!==a[d])return!1;return!0}fromArray(a,b=0){for(let d=0;d<9;d++)this.elements[d]=a[d+b];return this}toArray(a=[],b=0){const d=this.elements;a[b]=d[0];a[b+1]=d[1];a[b+2]=d[2];a[b+3]=d[3];a[b+4]=d[4];a[b+5]=d[5];a[b+6]=d[6];a[b+7]=d[7];a[b+8]=d[8];return a}clone(){return(new this.constructor).fromArray(this.elements)}}const ug=new Lb,ze={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,
Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},Pg={},jh=(new Lb).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),kh=(new Lb).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715),$b=function(){const a={enabled:!0,workingColorSpace:"srgb-linear",spaces:{},convert:function(n,u,E){if(this.enabled===!1||u===E||!u||!E)return n;this.spaces[u].transfer==="srgb"&&(n.r=y(n.r),n.g=y(n.g),n.b=y(n.b));this.spaces[u].primaries!==
this.spaces[E].primaries&&(n.applyMatrix3(this.spaces[u].toXYZ),n.applyMatrix3(this.spaces[E].fromXYZ));this.spaces[E].transfer==="srgb"&&(n.r=B(n.r),n.g=B(n.g),n.b=B(n.b));return n},workingToColorSpace:function(n,u){return this.convert(n,this.workingColorSpace,u)},colorSpaceToWorking:function(n,u){return this.convert(n,u,this.workingColorSpace)},getPrimaries:function(n){return this.spaces[n].primaries},getTransfer:function(n){return n===""?"linear":this.spaces[n].transfer},getToneMappingMode:function(n){return this.spaces[n].outputColorSpaceConfig.toneMappingMode||
"standard"},getLuminanceCoefficients:function(n,u=this.workingColorSpace){return n.fromArray(this.spaces[u].luminanceCoefficients)},define:function(n){Object.assign(this.spaces,n)},_getMatrix:function(n,u,E){return n.copy(this.spaces[u].toXYZ).multiply(this.spaces[E].fromXYZ)},_getDrawingBufferColorSpace:function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace},
fromWorkingColorSpace:function(n,u){t("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace().");return a.workingToColorSpace(n,u)},toWorkingColorSpace:function(n,u){t("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking().");return a.colorSpaceToWorking(n,u)}},b=[.64,.33,.3,.6,.15,.06],d=[.2126,.7152,.0722],h=[.3127,.329];a.define({["srgb-linear"]:{primaries:b,whitePoint:h,transfer:"linear",toXYZ:jh,fromXYZ:kh,luminanceCoefficients:d,
workingColorSpaceConfig:{unpackColorSpace:"srgb"},outputColorSpaceConfig:{drawingBufferColorSpace:"srgb"}},srgb:{primaries:b,whitePoint:h,transfer:"srgb",toXYZ:jh,fromXYZ:kh,luminanceCoefficients:d,outputColorSpaceConfig:{drawingBufferColorSpace:"srgb"}}});return a}();let Ae;class Qg{static getDataURL(a,b="image/png"){if(/^data:/i.test(a.src)||typeof HTMLCanvasElement==="undefined")return a.src;if(!(a instanceof HTMLCanvasElement)){Ae===void 0&&(Ae=p("canvas"));Ae.width=a.width;Ae.height=a.height;
const d=Ae.getContext("2d");a instanceof ImageData?d.putImageData(a,0,0):d.drawImage(a,0,0,a.width,a.height);a=Ae}return a.toDataURL(b)}static sRGBToLinear(a){if(typeof HTMLImageElement!=="undefined"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement!=="undefined"&&a instanceof HTMLCanvasElement||typeof ImageBitmap!=="undefined"&&a instanceof ImageBitmap){var b=p("canvas");b.width=a.width;b.height=a.height;var d=b.getContext("2d");d.drawImage(a,0,0,a.width,a.height);a=d.getImageData(0,0,a.width,
a.height);const h=a.data;for(let n=0;n<h.length;n++)h[n]=y(h[n]/255)*255;d.putImageData(a,0,0);return b}if(a.data){b=a.data.slice(0);for(d=0;d<b.length;d++)b[d]=b instanceof Uint8Array||b instanceof Uint8ClampedArray?Math.floor(y(b[d]/255)*255):y(b[d]);return{data:b,width:a.width,height:a.height}}console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.");return a}}let Di=0;class Xd{constructor(a=null){this.isSource=!0;Object.defineProperty(this,"id",
{value:Di++});this.uuid=x();this.data=a;this.dataReady=!0;this.version=0}getSize(a){const b=this.data;typeof HTMLVideoElement!=="undefined"&&b instanceof HTMLVideoElement?a.set(b.videoWidth,b.videoHeight,0):b instanceof VideoFrame?a.set(b.displayHeight,b.displayWidth,0):b!==null?a.set(b.width,b.height,b.depth||0):a.set(0,0,0);return a}set needsUpdate(a){a===!0&&this.version++}toJSON(a){const b=a===void 0||typeof a==="string";if(!b&&a.images[this.uuid]!==void 0)return a.images[this.uuid];const d={uuid:this.uuid,
url:""},h=this.data;if(h!==null){let n;if(Array.isArray(h)){n=[];for(let u=0,E=h.length;u<E;u++)h[u].isDataTexture?n.push(D(h[u].image)):n.push(D(h[u]))}else n=D(h);d.url=n}b||(a.images[this.uuid]=d);return d}}let Ei=0;const vg=new ma;class Cc extends Bd{constructor(a=Cc.DEFAULT_IMAGE,b=Cc.DEFAULT_MAPPING,d=1001,h=1001,n=1006,u=1008,E=1023,F=1009,H=Cc.DEFAULT_ANISOTROPY,M=""){super();this.isTexture=!0;Object.defineProperty(this,"id",{value:Ei++});this.uuid=x();this.name="";this.source=new Xd(a);this.mipmaps=
[];this.mapping=b;this.channel=0;this.wrapS=d;this.wrapT=h;this.magFilter=n;this.minFilter=u;this.anisotropy=H;this.format=E;this.internalFormat=null;this.type=F;this.offset=new Xa(0,0);this.repeat=new Xa(1,1);this.center=new Xa(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new Lb;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.colorSpace=M;this.userData={};this.updateRanges=[];this.version=0;this.renderTarget=this.onUpdate=null;this.isRenderTargetTexture=
!1;this.isArrayTexture=a&&a.depth&&a.depth>1?!0:!1;this.pmremVersion=0}get width(){return this.source.getSize(vg).x}get height(){return this.source.getSize(vg).y}get depth(){return this.source.getSize(vg).z}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=
0}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name;this.source=a.source;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.channel=a.channel;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.internalFormat=a.internalFormat;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;
this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.colorSpace=a.colorSpace;this.renderTarget=a.renderTarget;this.isRenderTargetTexture=a.isRenderTargetTexture;this.isArrayTexture=a.isArrayTexture;this.userData=JSON.parse(JSON.stringify(a.userData));this.needsUpdate=!0;return this}setValues(a){for(const b in a){const d=a[b];if(d===void 0){console.warn(`THREE.Texture.setValues(): parameter '${b}' has value of undefined.`);
continue}const h=this[b];h===void 0?console.warn(`THREE.Texture.setValues(): property '${b}' does not exist.`):h&&d&&h.isVector2&&d.isVector2?h.copy(d):h&&d&&h.isVector3&&d.isVector3?h.copy(d):h&&d&&h.isMatrix3&&d.isMatrix3?h.copy(d):this[b]=d}}toJSON(a){const b=a===void 0||typeof a==="string";if(!b&&a.textures[this.uuid]!==void 0)return a.textures[this.uuid];const d={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,
channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};Object.keys(this.userData).length>
0&&(d.userData=this.userData);b||(a.textures[this.uuid]=d);return d}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(this.mapping!==300)return a;a.applyMatrix3(this.matrix);if(a.x<0||a.x>1)switch(this.wrapS){case 1E3:a.x-=Math.floor(a.x);break;case 1001:a.x=a.x<0?0:1;break;case 1002:a.x=Math.abs(Math.floor(a.x)%2)===1?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(a.y<0||a.y>1)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);break;case 1001:a.y=a.y<0?0:1;break;case 1002:a.y=Math.abs(Math.floor(a.y)%
2)===1?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y);return a}set needsUpdate(a){a===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(a){a===!0&&this.pmremVersion++}}Cc.DEFAULT_IMAGE=null;Cc.DEFAULT_MAPPING=300;Cc.DEFAULT_ANISOTROPY=1;class ec{constructor(a=0,b=0,d=0,h=1){ec.prototype.isVector4=!0;this.x=a;this.y=b;this.z=d;this.w=h}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,b,d,h){this.x=a;this.y=b;
this.z=d;this.w=h;return this}setScalar(a){this.w=this.z=this.y=this.x=a;return this}setX(a){this.x=a;return this}setY(a){this.y=a;return this}setZ(a){this.z=a;return this}setW(a){this.w=a;return this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+
a);}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w!==void 0?a.w:1;return this}add(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this}addScalar(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this}addVectors(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this}addScaledVector(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this}sub(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;
this.w-=a.w;return this}subScalar(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this}subVectors(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this}multiply(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w;return this}multiplyScalar(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this}applyMatrix4(a){const b=this.x,d=this.y,h=this.z,n=this.w;a=a.elements;this.x=a[0]*b+a[4]*d+a[8]*h+a[12]*n;this.y=a[1]*b+a[5]*d+a[9]*h+a[13]*n;this.z=a[2]*b+a[6]*d+a[10]*h+a[14]*n;this.w=
a[3]*b+a[7]*d+a[11]*h+a[15]*n;return this}divide(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;this.w/=a.w;return this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);const b=Math.sqrt(1-a.w*a.w);b<1E-4?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this}setAxisAngleFromRotationMatrix(a){a=a.elements;var b=a[0];var d=a[4];var h=a[8];const n=a[1];var u=a[5],E=a[9];var F=a[2];var H=a[6];var M=a[10];if(Math.abs(d-n)<.01&&Math.abs(h-
F)<.01&&Math.abs(E-H)<.01){if(Math.abs(d+n)<.1&&Math.abs(h+F)<.1&&Math.abs(E+H)<.1&&Math.abs(b+u+M-3)<.1)return this.set(1,0,0,0),this;a=Math.PI;b=(b+1)/2;u=(u+1)/2;M=(M+1)/2;d=(d+n)/4;h=(h+F)/4;E=(E+H)/4;b>u&&b>M?b<.01?(H=0,d=F=.707106781):(H=Math.sqrt(b),F=d/H,d=h/H):u>M?u<.01?(H=.707106781,F=0,d=.707106781):(F=Math.sqrt(u),H=d/F,d=E/F):M<.01?(F=H=.707106781,d=0):(d=Math.sqrt(M),H=h/d,F=E/d);this.set(H,F,d,a);return this}a=Math.sqrt((H-E)*(H-E)+(h-F)*(h-F)+(n-d)*(n-d));Math.abs(a)<.001&&(a=1);this.x=
(H-E)/a;this.y=(h-F)/a;this.z=(n-d)/a;this.w=Math.acos((b+u+M-1)/2);return this}setFromMatrixPosition(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];this.w=a[15];return this}min(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this}max(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this}clamp(a,b){this.x=r(this.x,a.x,b.x);this.y=r(this.y,a.y,b.y);
this.z=r(this.z,a.z,b.z);this.w=r(this.w,a.w,b.w);return this}clampScalar(a,b){this.x=r(this.x,a,b);this.y=r(this.y,a,b);this.z=r(this.z,a,b);this.w=r(this.w,a,b);return this}clampLength(a,b){const d=this.length();return this.divideScalar(d||1).multiplyScalar(r(d,a,b))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);
return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);this.w=Math.trunc(this.w);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this}lerpVectors(a,b,d){this.x=a.x+(b.x-a.x)*d;this.y=a.y+(b.y-a.y)*d;this.z=a.z+(b.z-a.z)*d;this.w=a.w+(b.w-a.w)*d;return this}equals(a){return a.x===
this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,b=0){this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this}toArray(a=[],b=0){a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a}fromBufferAttribute(a,b){this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=a.getW(b);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();this.w=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z;yield this.w}}class wg extends Bd{constructor(a=
1,b=1,d={}){super();d=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:1006,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},d);this.isRenderTarget=!0;this.width=a;this.height=b;this.depth=d.depth;this.scissor=new ec(0,0,a,b);this.scissorTest=!1;this.viewport=new ec(0,0,a,b);a=new Cc({width:a,height:b,depth:d.depth});this.textures=[];b=d.count;for(let h=0;h<b;h++)this.textures[h]=a.clone(),this.textures[h].isRenderTargetTexture=
!0,this.textures[h].renderTarget=this;this._setTextureOptions(d);this.depthBuffer=d.depthBuffer;this.stencilBuffer=d.stencilBuffer;this.resolveDepthBuffer=d.resolveDepthBuffer;this.resolveStencilBuffer=d.resolveStencilBuffer;this._depthTexture=null;this.depthTexture=d.depthTexture;this.samples=d.samples;this.multiview=d.multiview}_setTextureOptions(a={}){const b={minFilter:1006,generateMipmaps:!1,flipY:!1,internalFormat:null};a.mapping!==void 0&&(b.mapping=a.mapping);a.wrapS!==void 0&&(b.wrapS=a.wrapS);
a.wrapT!==void 0&&(b.wrapT=a.wrapT);a.wrapR!==void 0&&(b.wrapR=a.wrapR);a.magFilter!==void 0&&(b.magFilter=a.magFilter);a.minFilter!==void 0&&(b.minFilter=a.minFilter);a.format!==void 0&&(b.format=a.format);a.type!==void 0&&(b.type=a.type);a.anisotropy!==void 0&&(b.anisotropy=a.anisotropy);a.colorSpace!==void 0&&(b.colorSpace=a.colorSpace);a.flipY!==void 0&&(b.flipY=a.flipY);a.generateMipmaps!==void 0&&(b.generateMipmaps=a.generateMipmaps);a.internalFormat!==void 0&&(b.internalFormat=a.internalFormat);
for(a=0;a<this.textures.length;a++)this.textures[a].setValues(b)}get texture(){return this.textures[0]}set texture(a){this.textures[0]=a}set depthTexture(a){this._depthTexture!==null&&(this._depthTexture.renderTarget=null);a!==null&&(a.renderTarget=this);this._depthTexture=a}get depthTexture(){return this._depthTexture}setSize(a,b,d=1){if(this.width!==a||this.height!==b||this.depth!==d){this.width=a;this.height=b;this.depth=d;for(let h=0,n=this.textures.length;h<n;h++)this.textures[h].image.width=
a,this.textures[h].image.height=b,this.textures[h].image.depth=d,this.textures[h].isArrayTexture=this.textures[h].image.depth>1;this.dispose()}this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)}clone(){return(new this.constructor).copy(this)}copy(a){this.width=a.width;this.height=a.height;this.depth=a.depth;this.scissor.copy(a.scissor);this.scissorTest=a.scissorTest;this.viewport.copy(a.viewport);this.textures.length=0;for(let b=0,d=a.textures.length;b<d;b++){this.textures[b]=a.textures[b].clone();
this.textures[b].isRenderTargetTexture=!0;this.textures[b].renderTarget=this;const h=Object.assign({},a.textures[b].image);this.textures[b].source=new Xd(h)}this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.resolveDepthBuffer=a.resolveDepthBuffer;this.resolveStencilBuffer=a.resolveStencilBuffer;a.depthTexture!==null&&(this.depthTexture=a.depthTexture.clone());this.samples=a.samples;return this}dispose(){this.dispatchEvent({type:"dispose"})}}class zd extends wg{constructor(a=1,
b=1,d={}){super(a,b,d);this.isWebGLRenderTarget=!0}}class yf extends Cc{constructor(a=null,b=1,d=1,h=1){super(null);this.isDataArrayTexture=!0;this.image={data:a,width:b,height:d,depth:h};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1;this.layerUpdates=new Set}addLayerUpdate(a){this.layerUpdates.add(a)}clearLayerUpdates(){this.layerUpdates.clear()}}class Fi extends zd{constructor(a=1,b=1,d=1,h={}){super(a,b,h);this.isWebGLArrayRenderTarget=
!0;this.depth=d;this.texture=new yf(null,a,b,d);this._setTextureOptions(h);this.texture.isRenderTargetTexture=!0}}class Cf extends Cc{constructor(a=null,b=1,d=1,h=1){super(null);this.isData3DTexture=!0;this.image={data:a,width:b,height:d,depth:h};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}}class Gi extends zd{constructor(a=1,b=1,d=1,h={}){super(a,b,h);this.isWebGL3DRenderTarget=!0;this.depth=d;this.texture=new Cf(null,a,b,d);this._setTextureOptions(h);
this.texture.isRenderTargetTexture=!0}}class Sc{constructor(a=new ma(Infinity,Infinity,Infinity),b=new ma(-Infinity,-Infinity,-Infinity)){this.isBox3=!0;this.min=a;this.max=b}set(a,b){this.min.copy(a);this.max.copy(b);return this}setFromArray(a){this.makeEmpty();for(let b=0,d=a.length;b<d;b+=3)this.expandByPoint(wd.fromArray(a,b));return this}setFromBufferAttribute(a){this.makeEmpty();for(let b=0,d=a.count;b<d;b++)this.expandByPoint(wd.fromBufferAttribute(a,b));return this}setFromPoints(a){this.makeEmpty();
for(let b=0,d=a.length;b<d;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){b=wd.copy(b).multiplyScalar(.5);this.min.copy(a).sub(b);this.max.copy(a).add(b);return this}setFromObject(a,b=!1){this.makeEmpty();return this.expandByObject(a,b)}clone(){return(new this.constructor).copy(this)}copy(a){this.min.copy(a.min);this.max.copy(a.max);return this}makeEmpty(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this}isEmpty(){return this.max.x<
this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){this.min.min(a);this.max.max(a);return this}expandByVector(a){this.min.sub(a);this.max.add(a);return this}expandByScalar(a){this.min.addScalar(-a);this.max.addScalar(a);return this}expandByObject(a,b=!1){a.updateWorldMatrix(!1,!1);const d=a.geometry;
if(d!==void 0){const h=d.getAttribute("position");if(b===!0&&h!==void 0&&a.isInstancedMesh!==!0)for(let n=0,u=h.count;n<u;n++)a.isMesh===!0?a.getVertexPosition(n,wd):wd.fromBufferAttribute(h,n),wd.applyMatrix4(a.matrixWorld),this.expandByPoint(wd);else a.boundingBox!==void 0?(a.boundingBox===null&&a.computeBoundingBox(),Df.copy(a.boundingBox)):(d.boundingBox===null&&d.computeBoundingBox(),Df.copy(d.boundingBox)),Df.applyMatrix4(a.matrixWorld),this.union(Df)}a=a.children;for(let h=0,n=a.length;h<n;h++)this.expandByObject(a[h],
b);return this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y&&a.z>=this.min.z&&a.z<=this.max.z}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&
a.max.y>=this.min.y&&a.min.y<=this.max.y&&a.max.z>=this.min.z&&a.min.z<=this.max.z}intersectsSphere(a){this.clampPoint(a.center,wd);return wd.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let b,d;a.normal.x>0?(b=a.normal.x*this.min.x,d=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,d=a.normal.x*this.min.x);a.normal.y>0?(b+=a.normal.y*this.min.y,d+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,d+=a.normal.y*this.min.y);a.normal.z>0?(b+=a.normal.z*this.min.z,d+=a.normal.z*this.max.z):
(b+=a.normal.z*this.max.z,d+=a.normal.z*this.min.z);return b<=-a.constant&&d>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(Ze);Ef.subVectors(this.max,Ze);Be.subVectors(a.a,Ze);Ce.subVectors(a.b,Ze);De.subVectors(a.c,Ze);Yd.subVectors(Ce,Be);Zd.subVectors(De,Ce);ke.subVectors(Be,De);a=[0,-Yd.z,Yd.y,0,-Zd.z,Zd.y,0,-ke.z,ke.y,Yd.z,0,-Yd.x,Zd.z,0,-Zd.x,ke.z,0,-ke.x,-Yd.y,Yd.x,0,-Zd.y,Zd.x,0,-ke.y,ke.x,0];if(!G(a,Be,Ce,De,Ef))return!1;a=[1,0,0,0,1,0,0,0,1];if(!G(a,Be,Ce,
De,Ef))return!1;Ff.crossVectors(Yd,Zd);a=[Ff.x,Ff.y,Ff.z];return G(a,Be,Ce,De,Ef)}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,wd).distanceTo(a)}getBoundingSphere(a){this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=this.getSize(wd).length()*.5);return a}intersect(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this}union(a){this.min.min(a.min);this.max.max(a.max);return this}applyMatrix4(a){if(this.isEmpty())return this;
Ld[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a);Ld[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a);Ld[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a);Ld[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a);Ld[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a);Ld[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a);Ld[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a);Ld[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a);this.setFromPoints(Ld);
return this}translate(a){this.min.add(a);this.max.add(a);return this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(a){this.min.fromArray(a.min);this.max.fromArray(a.max);return this}}const Ld=[new ma,new ma,new ma,new ma,new ma,new ma,new ma,new ma],wd=new ma,Df=new Sc,Be=new ma,Ce=new ma,De=new ma,Yd=new ma,Zd=new ma,ke=new ma,Ze=new ma,Ef=new ma,Ff=new ma,he=new ma,Hi=new Sc,$e=new ma,xg=new ma;class Qc{constructor(a=
new ma,b=-1){this.isSphere=!0;this.center=a;this.radius=b}set(a,b){this.center.copy(a);this.radius=b;return this}setFromPoints(a,b){const d=this.center;b!==void 0?d.copy(b):Hi.setFromPoints(a).getCenter(d);b=0;for(let h=0,n=a.length;h<n;h++)b=Math.max(b,d.distanceToSquared(a[h]));this.radius=Math.sqrt(b);return this}copy(a){this.center.copy(a.center);this.radius=a.radius;return this}isEmpty(){return this.radius<0}makeEmpty(){this.center.set(0,0,0);this.radius=-1;return this}containsPoint(a){return a.distanceToSquared(this.center)<=
this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){const b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,b){const d=this.center.distanceToSquared(a);b.copy(a);d>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center));return b}getBoundingBox(a){if(this.isEmpty())return a.makeEmpty(),
a;a.set(this.center,this.center);a.expandByScalar(this.radius);return a}applyMatrix4(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this}translate(a){this.center.add(a);return this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;$e.subVectors(a,this.center);a=$e.lengthSq();if(a>this.radius*this.radius){a=Math.sqrt(a);const b=(a-this.radius)*.5;this.center.addScaledVector($e,b/a);this.radius+=b}return this}union(a){if(a.isEmpty())return this;
if(this.isEmpty())return this.copy(a),this;this.center.equals(a.center)===!0?this.radius=Math.max(this.radius,a.radius):(xg.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint($e.copy(a.center).add(xg)),this.expandByPoint($e.copy(a.center).sub(xg)));return this}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(a){this.radius=a.radius;this.center.fromArray(a.center);
return this}}const Md=new ma,yg=new ma,Gf=new ma,Ee=new ma,Ii=new ma,lh=new ma,Ji=new ma;class Hf{constructor(a=new ma,b=new ma(0,0,-1)){this.origin=a;this.direction=b}set(a,b){this.origin.copy(a);this.direction.copy(b);return this}copy(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this}at(a,b){return b.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){this.direction.copy(a).sub(this.origin).normalize();return this}recast(a){this.origin.copy(this.at(a,Md));return this}closestPointToPoint(a,
b){b.subVectors(a,this.origin);a=b.dot(this.direction);return a<0?b.copy(this.origin):b.copy(this.origin).addScaledVector(this.direction,a)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){const b=Md.subVectors(a,this.origin).dot(this.direction);if(b<0)return this.origin.distanceToSquared(a);Md.copy(this.origin).addScaledVector(this.direction,b);return Md.distanceToSquared(a)}distanceSqToSegment(a,b,d,h){yg.copy(a).add(b).multiplyScalar(.5);Gf.copy(b).sub(a).normalize();
Ee.copy(this.origin).sub(yg);var n=a.distanceTo(b)*.5,u=-this.direction.dot(Gf);const E=Ee.dot(this.direction),F=-Ee.dot(Gf),H=Ee.lengthSq(),M=Math.abs(1-u*u);let R;M>0?(a=u*F-E,b=u*E-F,R=n*M,a>=0?b>=-R?b<=R?(n=1/M,a*=n,b*=n,u=a*(a+u*b+2*E)+b*(u*a+b+2*F)+H):(b=n,a=Math.max(0,-(u*b+E)),u=-a*a+b*(b+2*F)+H):(b=-n,a=Math.max(0,-(u*b+E)),u=-a*a+b*(b+2*F)+H):b<=-R?(a=Math.max(0,-(-u*n+E)),b=a>0?-n:Math.min(Math.max(-n,-F),n),u=-a*a+b*(b+2*F)+H):b<=R?(a=0,b=Math.min(Math.max(-n,-F),n),u=b*(b+2*F)+H):(a=
Math.max(0,-(u*n+E)),b=a>0?n:Math.min(Math.max(-n,-F),n),u=-a*a+b*(b+2*F)+H)):(b=u>0?-n:n,a=Math.max(0,-(u*b+E)),u=-a*a+b*(b+2*F)+H);d&&d.copy(this.origin).addScaledVector(this.direction,a);h&&h.copy(yg).addScaledVector(Gf,b);return u}intersectSphere(a,b){Md.subVectors(a.center,this.origin);var d=Md.dot(this.direction),h=Md.dot(Md)-d*d;a=a.radius*a.radius;if(h>a)return null;a=Math.sqrt(a-h);h=d-a;d+=a;return d<0?null:h<0?this.at(d,b):this.at(h,b)}intersectsSphere(a){return a.radius<0?!1:this.distanceSqToPoint(a.center)<=
a.radius*a.radius}distanceToPlane(a){const b=a.normal.dot(this.direction);if(b===0)return a.distanceToPoint(this.origin)===0?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return a>=0?a:null}intersectPlane(a,b){a=this.distanceToPlane(a);return a===null?null:this.at(a,b)}intersectsPlane(a){const b=a.distanceToPoint(this.origin);return b===0||a.normal.dot(this.direction)*b<0?!0:!1}intersectBox(a,b){let d;var h=1/this.direction.x;var n=1/this.direction.y;const u=1/this.direction.z,E=this.origin;
h>=0?(d=(a.min.x-E.x)*h,h*=a.max.x-E.x):(d=(a.max.x-E.x)*h,h*=a.min.x-E.x);if(n>=0){var F=(a.min.y-E.y)*n;n*=a.max.y-E.y}else F=(a.max.y-E.y)*n,n*=a.min.y-E.y;if(d>n||F>h)return null;if(F>d||isNaN(d))d=F;if(n<h||isNaN(h))h=n;u>=0?(F=(a.min.z-E.z)*u,a=(a.max.z-E.z)*u):(F=(a.max.z-E.z)*u,a=(a.min.z-E.z)*u);if(d>a||F>h)return null;if(F>d||d!==d)d=F;if(a<h||h!==h)h=a;return h<0?null:this.at(d>=0?d:h,b)}intersectsBox(a){return this.intersectBox(a,Md)!==null}intersectTriangle(a,b,d,h,n){Ii.subVectors(b,
a);lh.subVectors(d,a);Ji.crossVectors(Ii,lh);b=this.direction.dot(Ji);if(b>0){if(h)return null;h=1}else if(b<0)h=-1,b=-b;else return null;Ee.subVectors(this.origin,a);a=h*this.direction.dot(lh.crossVectors(Ee,lh));if(a<0)return null;d=h*this.direction.dot(Ii.cross(Ee));if(d<0||a+d>b)return null;a=-h*Ee.dot(Ji);return a<0?null:this.at(a/b,n)}applyMatrix4(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}
class Gb{constructor(a,b,d,h,n,u,E,F,H,M,R,T,X,ea,aa,da){Gb.prototype.isMatrix4=!0;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a!==void 0&&this.set(a,b,d,h,n,u,E,F,H,M,R,T,X,ea,aa,da)}set(a,b,d,h,n,u,E,F,H,M,R,T,X,ea,aa,da){const U=this.elements;U[0]=a;U[4]=b;U[8]=d;U[12]=h;U[1]=n;U[5]=u;U[9]=E;U[13]=F;U[2]=H;U[6]=M;U[10]=R;U[14]=T;U[3]=X;U[7]=ea;U[11]=aa;U[15]=da;return this}identity(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this}clone(){return(new Gb).fromArray(this.elements)}copy(a){const b=
this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this}copyPosition(a){const b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this}setFromMatrix3(a){a=a.elements;this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1);return this}extractBasis(a,b,d){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);
d.setFromMatrixColumn(this,2);return this}makeBasis(a,b,d){this.set(a.x,b.x,d.x,0,a.y,b.y,d.y,0,a.z,b.z,d.z,0,0,0,0,1);return this}extractRotation(a){const b=this.elements,d=a.elements,h=1/If.setFromMatrixColumn(a,0).length(),n=1/If.setFromMatrixColumn(a,1).length();a=1/If.setFromMatrixColumn(a,2).length();b[0]=d[0]*h;b[1]=d[1]*h;b[2]=d[2]*h;b[3]=0;b[4]=d[4]*n;b[5]=d[5]*n;b[6]=d[6]*n;b[7]=0;b[8]=d[8]*a;b[9]=d[9]*a;b[10]=d[10]*a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this}makeRotationFromEuler(a){const b=
this.elements;var d=a.x,h=a.y,n=a.z;const u=Math.cos(d);d=Math.sin(d);const E=Math.cos(h);h=Math.sin(h);const F=Math.cos(n);n=Math.sin(n);if(a.order==="XYZ"){a=u*F;var H=u*n,M=d*F,R=d*n;b[0]=E*F;b[4]=-E*n;b[8]=h;b[1]=H+M*h;b[5]=a-R*h;b[9]=-d*E;b[2]=R-a*h;b[6]=M+H*h;b[10]=u*E}else a.order==="YXZ"?(a=E*F,H=E*n,M=h*F,R=h*n,b[0]=a+R*d,b[4]=M*d-H,b[8]=u*h,b[1]=u*n,b[5]=u*F,b[9]=-d,b[2]=H*d-M,b[6]=R+a*d,b[10]=u*E):a.order==="ZXY"?(a=E*F,H=E*n,M=h*F,R=h*n,b[0]=a-R*d,b[4]=-u*n,b[8]=M+H*d,b[1]=H+M*d,b[5]=
u*F,b[9]=R-a*d,b[2]=-u*h,b[6]=d,b[10]=u*E):a.order==="ZYX"?(a=u*F,H=u*n,M=d*F,R=d*n,b[0]=E*F,b[4]=M*h-H,b[8]=a*h+R,b[1]=E*n,b[5]=R*h+a,b[9]=H*h-M,b[2]=-h,b[6]=d*E,b[10]=u*E):a.order==="YZX"?(a=u*E,H=u*h,M=d*E,R=d*h,b[0]=E*F,b[4]=R-a*n,b[8]=M*n+H,b[1]=n,b[5]=u*F,b[9]=-d*F,b[2]=-h*F,b[6]=H*n+M,b[10]=a-R*n):a.order==="XZY"&&(a=u*E,H=u*h,M=d*E,R=d*h,b[0]=E*F,b[4]=-n,b[8]=h*F,b[1]=a*n+R,b[5]=u*F,b[9]=H*n-M,b[2]=M*n-H,b[6]=d*F,b[10]=R*n+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this}makeRotationFromQuaternion(a){return this.compose(vm,
a,wm)}lookAt(a,b,d){const h=this.elements;hd.subVectors(a,b);hd.lengthSq()===0&&(hd.z=1);hd.normalize();Fe.crossVectors(d,hd);Fe.lengthSq()===0&&(Math.abs(d.z)===1?hd.x+=1E-4:hd.z+=1E-4,hd.normalize(),Fe.crossVectors(d,hd));Fe.normalize();mh.crossVectors(hd,Fe);h[0]=Fe.x;h[4]=mh.x;h[8]=hd.x;h[1]=Fe.y;h[5]=mh.y;h[9]=hd.y;h[2]=Fe.z;h[6]=mh.z;h[10]=hd.z;return this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){var d=a.elements,
h=b.elements;b=this.elements;a=d[0];const n=d[4],u=d[8],E=d[12],F=d[1],H=d[5],M=d[9],R=d[13],T=d[2],X=d[6],ea=d[10],aa=d[14],da=d[3],U=d[7],ka=d[11];d=d[15];const qa=h[0],wa=h[4],sa=h[8],Aa=h[12],Ba=h[1],Na=h[5],Ca=h[9],Ja=h[13],Qa=h[2],Za=h[6],gb=h[10],cb=h[14],rb=h[3],Ya=h[7],nb=h[11];h=h[15];b[0]=a*qa+n*Ba+u*Qa+E*rb;b[4]=a*wa+n*Na+u*Za+E*Ya;b[8]=a*sa+n*Ca+u*gb+E*nb;b[12]=a*Aa+n*Ja+u*cb+E*h;b[1]=F*qa+H*Ba+M*Qa+R*rb;b[5]=F*wa+H*Na+M*Za+R*Ya;b[9]=F*sa+H*Ca+M*gb+R*nb;b[13]=F*Aa+H*Ja+M*cb+R*h;b[2]=
T*qa+X*Ba+ea*Qa+aa*rb;b[6]=T*wa+X*Na+ea*Za+aa*Ya;b[10]=T*sa+X*Ca+ea*gb+aa*nb;b[14]=T*Aa+X*Ja+ea*cb+aa*h;b[3]=da*qa+U*Ba+ka*Qa+d*rb;b[7]=da*wa+U*Na+ka*Za+d*Ya;b[11]=da*sa+U*Ca+ka*gb+d*nb;b[15]=da*Aa+U*Ja+ka*cb+d*h;return this}multiplyScalar(a){const b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this}determinant(){const a=this.elements,b=a[0],d=a[4],h=a[8],n=a[12],u=a[1],E=a[5],F=a[9],H=a[13],
M=a[2],R=a[6],T=a[10],X=a[14];return a[3]*(+n*F*R-h*H*R-n*E*T+d*H*T+h*E*X-d*F*X)+a[7]*(+b*F*X-b*H*T+n*u*T-h*u*X+h*H*M-n*F*M)+a[11]*(+b*H*R-b*E*X-n*u*R+d*u*X+n*E*M-d*H*M)+a[15]*(-h*E*M-b*F*R+b*E*T+h*u*R-d*u*T+d*F*M)}transpose(){const a=this.elements;let b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this}setPosition(a,b,d){const h=this.elements;a.isVector3?(h[12]=a.x,h[13]=a.y,h[14]=a.z):
(h[12]=a,h[13]=b,h[14]=d);return this}invert(){const a=this.elements,b=a[0],d=a[1],h=a[2],n=a[3],u=a[4],E=a[5],F=a[6],H=a[7],M=a[8],R=a[9],T=a[10],X=a[11],ea=a[12],aa=a[13],da=a[14],U=a[15],ka=R*da*H-aa*T*H+aa*F*X-E*da*X-R*F*U+E*T*U,qa=ea*T*H-M*da*H-ea*F*X+u*da*X+M*F*U-u*T*U,wa=M*aa*H-ea*R*H+ea*E*X-u*aa*X-M*E*U+u*R*U,sa=ea*R*F-M*aa*F-ea*E*T+u*aa*T+M*E*da-u*R*da;var Aa=b*ka+d*qa+h*wa+n*sa;if(Aa===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);Aa=1/Aa;a[0]=ka*Aa;a[1]=(aa*T*n-R*da*n-aa*h*X+d*da*
X+R*h*U-d*T*U)*Aa;a[2]=(E*da*n-aa*F*n+aa*h*H-d*da*H-E*h*U+d*F*U)*Aa;a[3]=(R*F*n-E*T*n-R*h*H+d*T*H+E*h*X-d*F*X)*Aa;a[4]=qa*Aa;a[5]=(M*da*n-ea*T*n+ea*h*X-b*da*X-M*h*U+b*T*U)*Aa;a[6]=(ea*F*n-u*da*n-ea*h*H+b*da*H+u*h*U-b*F*U)*Aa;a[7]=(u*T*n-M*F*n+M*h*H-b*T*H-u*h*X+b*F*X)*Aa;a[8]=wa*Aa;a[9]=(ea*R*n-M*aa*n-ea*d*X+b*aa*X+M*d*U-b*R*U)*Aa;a[10]=(u*aa*n-ea*E*n+ea*d*H-b*aa*H-u*d*U+b*E*U)*Aa;a[11]=(M*E*n-u*R*n-M*d*H+b*R*H+u*d*X-b*E*X)*Aa;a[12]=sa*Aa;a[13]=(M*aa*h-ea*R*h+ea*d*T-b*aa*T-M*d*da+b*R*da)*Aa;a[14]=
(ea*E*h-u*aa*h-ea*d*F+b*aa*F+u*d*da-b*E*da)*Aa;a[15]=(u*R*h-M*E*h+M*d*F-b*R*F-u*d*T+b*E*T)*Aa;return this}scale(a){const b=this.elements,d=a.x,h=a.y;a=a.z;b[0]*=d;b[4]*=h;b[8]*=a;b[1]*=d;b[5]*=h;b[9]*=a;b[2]*=d;b[6]*=h;b[10]*=a;b[3]*=d;b[7]*=h;b[11]*=a;return this}getMaxScaleOnAxis(){const a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,b,d){a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,
0,0,0,1):this.set(1,0,0,a,0,1,0,b,0,0,1,d,0,0,0,1);return this}makeRotationX(a){const b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this}makeRotationY(a){const b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this}makeRotationZ(a){const b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this}makeRotationAxis(a,b){const d=Math.cos(b);b=Math.sin(b);const h=1-d,n=a.x,u=a.y;a=a.z;const E=h*n,F=h*u;this.set(E*n+d,E*
u-b*a,E*a+b*u,0,E*u+b*a,F*u+d,F*a-b*n,0,E*a-b*u,F*a+b*n,h*a*a+d,0,0,0,0,1);return this}makeScale(a,b,d){this.set(a,0,0,0,0,b,0,0,0,0,d,0,0,0,0,1);return this}makeShear(a,b,d,h,n,u){this.set(1,d,n,0,a,1,u,0,b,h,1,0,0,0,0,1);return this}compose(a,b,d){const h=this.elements;var n=b._x,u=b._y,E=b._z,F=b._w,H=n+n,M=u+u,R=E+E;b=n*H;const T=n*M;n*=R;const X=u*M;u*=R;E*=R;H*=F;M*=F;F*=R;R=d.x;const ea=d.y;d=d.z;h[0]=(1-(X+E))*R;h[1]=(T+F)*R;h[2]=(n-M)*R;h[3]=0;h[4]=(T-F)*ea;h[5]=(1-(b+E))*ea;h[6]=(u+H)*ea;
h[7]=0;h[8]=(n+M)*d;h[9]=(u-H)*d;h[10]=(1-(b+X))*d;h[11]=0;h[12]=a.x;h[13]=a.y;h[14]=a.z;h[15]=1;return this}decompose(a,b,d){var h=this.elements;let n=If.set(h[0],h[1],h[2]).length();const u=If.set(h[4],h[5],h[6]).length(),E=If.set(h[8],h[9],h[10]).length();this.determinant()<0&&(n=-n);a.x=h[12];a.y=h[13];a.z=h[14];Mc.copy(this);a=1/n;h=1/u;const F=1/E;Mc.elements[0]*=a;Mc.elements[1]*=a;Mc.elements[2]*=a;Mc.elements[4]*=h;Mc.elements[5]*=h;Mc.elements[6]*=h;Mc.elements[8]*=F;Mc.elements[9]*=F;Mc.elements[10]*=
F;b.setFromRotationMatrix(Mc);d.x=n;d.y=u;d.z=E;return this}makePerspective(a,b,d,h,n,u,E=2E3,F=!1){const H=this.elements;if(F)E=n/(u-n),u=u*n/(u-n);else if(E===2E3)E=-(u+n)/(u-n),u=-2*u*n/(u-n);else if(E===2001)E=-u/(u-n),u=-u*n/(u-n);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+E);H[0]=2*n/(b-a);H[4]=0;H[8]=(b+a)/(b-a);H[12]=0;H[1]=0;H[5]=2*n/(d-h);H[9]=(d+h)/(d-h);H[13]=0;H[2]=0;H[6]=0;H[10]=E;H[14]=u;H[3]=0;H[7]=0;H[11]=-1;H[15]=0;return this}makeOrthographic(a,
b,d,h,n,u,E=2E3,F=!1){const H=this.elements;if(F)E=1/(u-n),n=u/(u-n);else if(E===2E3)E=-2/(u-n),n=-(u+n)/(u-n);else if(E===2001)E=-1/(u-n),n=-n/(u-n);else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+E);H[0]=2/(b-a);H[4]=0;H[8]=0;H[12]=-(b+a)/(b-a);H[1]=0;H[5]=2/(d-h);H[9]=0;H[13]=-(d+h)/(d-h);H[2]=0;H[6]=0;H[10]=E;H[14]=n;H[3]=0;H[7]=0;H[11]=0;H[15]=1;return this}equals(a){const b=this.elements;a=a.elements;for(let d=0;d<16;d++)if(b[d]!==a[d])return!1;return!0}fromArray(a,
b=0){for(let d=0;d<16;d++)this.elements[d]=a[d+b];return this}toArray(a=[],b=0){const d=this.elements;a[b]=d[0];a[b+1]=d[1];a[b+2]=d[2];a[b+3]=d[3];a[b+4]=d[4];a[b+5]=d[5];a[b+6]=d[6];a[b+7]=d[7];a[b+8]=d[8];a[b+9]=d[9];a[b+10]=d[10];a[b+11]=d[11];a[b+12]=d[12];a[b+13]=d[13];a[b+14]=d[14];a[b+15]=d[15];return a}}const If=new ma,Mc=new Gb,vm=new ma(0,0,0),wm=new ma(1,1,1),Fe=new ma,mh=new ma,hd=new ma,sk=new Gb,tk=new dd;class Cd{constructor(a=0,b=0,d=0,h=Cd.DEFAULT_ORDER){this.isEuler=!0;this._x=
a;this._y=b;this._z=d;this._order=h}get x(){return this._x}set x(a){this._x=a;this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a;this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a;this._onChangeCallback()}get order(){return this._order}set order(a){this._order=a;this._onChangeCallback()}set(a,b,d,h=this._order){this._x=a;this._y=b;this._z=d;this._order=h;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){this._x=
a._x;this._y=a._y;this._z=a._z;this._order=a._order;this._onChangeCallback();return this}setFromRotationMatrix(a,b=this._order,d=!0){var h=a.elements;a=h[0];const n=h[4],u=h[8],E=h[1],F=h[5],H=h[9],M=h[2],R=h[6];h=h[10];switch(b){case "XYZ":this._y=Math.asin(r(u,-1,1));Math.abs(u)<.9999999?(this._x=Math.atan2(-H,h),this._z=Math.atan2(-n,a)):(this._x=Math.atan2(R,F),this._z=0);break;case "YXZ":this._x=Math.asin(-r(H,-1,1));Math.abs(H)<.9999999?(this._y=Math.atan2(u,h),this._z=Math.atan2(E,F)):(this._y=
Math.atan2(-M,a),this._z=0);break;case "ZXY":this._x=Math.asin(r(R,-1,1));Math.abs(R)<.9999999?(this._y=Math.atan2(-M,h),this._z=Math.atan2(-n,F)):(this._y=0,this._z=Math.atan2(E,a));break;case "ZYX":this._y=Math.asin(-r(M,-1,1));Math.abs(M)<.9999999?(this._x=Math.atan2(R,h),this._z=Math.atan2(E,a)):(this._x=0,this._z=Math.atan2(-n,F));break;case "YZX":this._z=Math.asin(r(E,-1,1));Math.abs(E)<.9999999?(this._x=Math.atan2(-H,F),this._y=Math.atan2(-M,a)):(this._x=0,this._y=Math.atan2(u,h));break;case "XZY":this._z=
Math.asin(-r(n,-1,1));Math.abs(n)<.9999999?(this._x=Math.atan2(R,F),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-H,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}this._order=b;d===!0&&this._onChangeCallback();return this}setFromQuaternion(a,b,d){sk.makeRotationFromQuaternion(a);return this.setFromRotationMatrix(sk,b,d)}setFromVector3(a,b=this._order){return this.set(a.x,a.y,a.z,b)}reorder(a){tk.setFromEuler(this);return this.setFromQuaternion(tk,
a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){this._x=a[0];this._y=a[1];this._z=a[2];a[3]!==void 0&&(this._order=a[3]);this._onChangeCallback();return this}toArray(a=[],b=0){a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a}_onChange(a){this._onChangeCallback=a;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._order}}Cd.DEFAULT_ORDER="XYZ";class bh{constructor(){this.mask=
1}set(a){this.mask=(1<<a|0)>>>0}enable(a){this.mask|=1<<a|0}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a|0}disable(a){this.mask&=~(1<<a|0)}disableAll(){this.mask=0}test(a){return(this.mask&a.mask)!==0}isEnabled(a){return(this.mask&(1<<a|0))!==0}}let xm=0;const uk=new ma,Jf=new dd,le=new Gb,nh=new ma,zg=new ma,ym=new ma,zm=new dd,vk=new ma(1,0,0),wk=new ma(0,1,0),xk=new ma(0,0,1),yk={type:"added"},Am={type:"removed"},Kf={type:"childadded",child:null},Ki={type:"childremoved",child:null};class jc extends Bd{constructor(){super();
this.isObject3D=!0;Object.defineProperty(this,"id",{value:xm++});this.uuid=x();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=jc.DEFAULT_UP.clone();const a=new ma,b=new Cd,d=new dd,h=new ma(1,1,1);b._onChange(function(){d.setFromEuler(b,!1)});d._onChange(function(){b.setFromQuaternion(d,void 0,!1)});Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:d},
scale:{configurable:!0,enumerable:!0,value:h},modelViewMatrix:{value:new Gb},normalMatrix:{value:new Lb}});this.matrix=new Gb;this.matrixWorld=new Gb;this.matrixAutoUpdate=jc.DEFAULT_MATRIX_AUTO_UPDATE;this.matrixWorldAutoUpdate=jc.DEFAULT_MATRIX_WORLD_AUTO_UPDATE;this.matrixWorldNeedsUpdate=!1;this.layers=new bh;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.animations=[];this.customDistanceMaterial=this.customDepthMaterial=void 0;this.userData=
{}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix();this.matrix.premultiply(a);this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){this.quaternion.premultiply(a);return this}setRotationFromAxisAngle(a,b){this.quaternion.setFromAxisAngle(a,b)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,
b){Jf.setFromAxisAngle(a,b);this.quaternion.multiply(Jf);return this}rotateOnWorldAxis(a,b){Jf.setFromAxisAngle(a,b);this.quaternion.premultiply(Jf);return this}rotateX(a){return this.rotateOnAxis(vk,a)}rotateY(a){return this.rotateOnAxis(wk,a)}rotateZ(a){return this.rotateOnAxis(xk,a)}translateOnAxis(a,b){uk.copy(a).applyQuaternion(this.quaternion);this.position.add(uk.multiplyScalar(b));return this}translateX(a){return this.translateOnAxis(vk,a)}translateY(a){return this.translateOnAxis(wk,a)}translateZ(a){return this.translateOnAxis(xk,
a)}localToWorld(a){this.updateWorldMatrix(!0,!1);return a.applyMatrix4(this.matrixWorld)}worldToLocal(a){this.updateWorldMatrix(!0,!1);return a.applyMatrix4(le.copy(this.matrixWorld).invert())}lookAt(a,b,d){a.isVector3?nh.copy(a):nh.set(a,b,d);a=this.parent;this.updateWorldMatrix(!0,!1);zg.setFromMatrixPosition(this.matrixWorld);this.isCamera||this.isLight?le.lookAt(zg,nh,this.up):le.lookAt(nh,zg,this.up);this.quaternion.setFromRotationMatrix(le);a&&(le.extractRotation(a.matrixWorld),Jf.setFromRotationMatrix(le),
this.quaternion.premultiply(Jf.invert()))}add(a){if(arguments.length>1){for(let b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a&&a.isObject3D?(a.removeFromParent(),a.parent=this,this.children.push(a),a.dispatchEvent(yk),Kf.child=a,this.dispatchEvent(Kf),Kf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this}remove(a){if(arguments.length>
1){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);return this}b=this.children.indexOf(a);b!==-1&&(a.parent=null,this.children.splice(b,1),a.dispatchEvent(Am),Ki.child=a,this.dispatchEvent(Ki),Ki.child=null);return this}removeFromParent(){const a=this.parent;a!==null&&a.remove(this);return this}clear(){return this.remove(...this.children)}attach(a){this.updateWorldMatrix(!0,!1);le.copy(this.matrixWorld).invert();a.parent!==null&&(a.parent.updateWorldMatrix(!0,!1),le.multiply(a.parent.matrixWorld));
a.applyMatrix4(le);a.removeFromParent();a.parent=this;this.children.push(a);a.updateWorldMatrix(!1,!0);a.dispatchEvent(yk);Kf.child=a;this.dispatchEvent(Kf);Kf.child=null;return this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",a)}getObjectByProperty(a,b){if(this[a]===b)return this;for(let d=0,h=this.children.length;d<h;d++){const n=this.children[d].getObjectByProperty(a,b);if(n!==void 0)return n}}getObjectsByProperty(a,b,d=[]){this[a]===
b&&d.push(this);const h=this.children;for(let n=0,u=h.length;n<u;n++)h[n].getObjectsByProperty(a,b,d);return d}getWorldPosition(a){this.updateWorldMatrix(!0,!1);return a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){this.updateWorldMatrix(!0,!1);this.matrixWorld.decompose(zg,a,ym);return a}getWorldScale(a){this.updateWorldMatrix(!0,!1);this.matrixWorld.decompose(zg,zm,a);return a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);const b=this.matrixWorld.elements;return a.set(b[8],
b[9],b[10]).normalize()}raycast(){}traverse(a){a(this);const b=this.children;for(let d=0,h=b.length;d<h;d++)b[d].traverse(a)}traverseVisible(a){if(this.visible!==!1){a(this);var b=this.children;for(let d=0,h=b.length;d<h;d++)b[d].traverseVisible(a)}}traverseAncestors(a){const b=this.parent;b!==null&&(a(b),b.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix();
if(this.matrixWorldNeedsUpdate||a)this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,a=!0;const b=this.children;for(let d=0,h=b.length;d<h;d++)b[d].updateMatrixWorld(a)}updateWorldMatrix(a,b){const d=this.parent;a===!0&&d!==null&&d.updateWorldMatrix(!0,!1);this.matrixAutoUpdate&&this.updateMatrix();this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):
this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix));if(b===!0){a=this.children;for(let h=0,n=a.length;h<n;h++)a[h].updateWorldMatrix(!1,!0)}}toJSON(a){function b(F,H){F[H.uuid]===void 0&&(F[H.uuid]=H.toJSON(a));return H.uuid}function d(F){const H=[];for(const M in F){const R=F[M];delete R.metadata;H.push(R)}return H}var h=a===void 0||typeof a==="string";const n={};h&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata=
{version:4.7,type:"Object",generator:"Object3D.toJSON"});const u={};u.uuid=this.uuid;u.type=this.type;this.name!==""&&(u.name=this.name);this.castShadow===!0&&(u.castShadow=!0);this.receiveShadow===!0&&(u.receiveShadow=!0);this.visible===!1&&(u.visible=!1);this.frustumCulled===!1&&(u.frustumCulled=!1);this.renderOrder!==0&&(u.renderOrder=this.renderOrder);Object.keys(this.userData).length>0&&(u.userData=this.userData);u.layers=this.layers.mask;u.matrix=this.matrix.toArray();u.up=this.up.toArray();
this.matrixAutoUpdate===!1&&(u.matrixAutoUpdate=!1);this.isInstancedMesh&&(u.type="InstancedMesh",u.count=this.count,u.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(u.instanceColor=this.instanceColor.toJSON()));this.isBatchedMesh&&(u.type="BatchedMesh",u.perObjectFrustumCulled=this.perObjectFrustumCulled,u.sortObjects=this.sortObjects,u.drawRanges=this._drawRanges,u.reservedRanges=this._reservedRanges,u.geometryInfo=this._geometryInfo.map(F=>({...F,boundingBox:F.boundingBox?
F.boundingBox.toJSON():void 0,boundingSphere:F.boundingSphere?F.boundingSphere.toJSON():void 0})),u.instanceInfo=this._instanceInfo.map(F=>({...F})),u.availableInstanceIds=this._availableInstanceIds.slice(),u.availableGeometryIds=this._availableGeometryIds.slice(),u.nextIndexStart=this._nextIndexStart,u.nextVertexStart=this._nextVertexStart,u.geometryCount=this._geometryCount,u.maxInstanceCount=this._maxInstanceCount,u.maxVertexCount=this._maxVertexCount,u.maxIndexCount=this._maxIndexCount,u.geometryInitialized=
this._geometryInitialized,u.matricesTexture=this._matricesTexture.toJSON(a),u.indirectTexture=this._indirectTexture.toJSON(a),this._colorsTexture!==null&&(u.colorsTexture=this._colorsTexture.toJSON(a)),this.boundingSphere!==null&&(u.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(u.boundingBox=this.boundingBox.toJSON()));if(this.isScene)this.background&&(this.background.isColor?u.background=this.background.toJSON():this.background.isTexture&&(u.background=this.background.toJSON(a).uuid)),
this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(u.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){u.geometry=b(a.geometries,this.geometry);var E=this.geometry.parameters;if(E!==void 0&&E.shapes!==void 0)if(E=E.shapes,Array.isArray(E))for(let F=0,H=E.length;F<H;F++)b(a.shapes,E[F]);else b(a.shapes,E)}this.isSkinnedMesh&&(u.bindMode=this.bindMode,u.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(b(a.skeletons,
this.skeleton),u.skeleton=this.skeleton.uuid));if(this.material!==void 0)if(Array.isArray(this.material)){E=[];for(let F=0,H=this.material.length;F<H;F++)E.push(b(a.materials,this.material[F]));u.material=E}else u.material=b(a.materials,this.material);if(this.children.length>0)for(u.children=[],E=0;E<this.children.length;E++)u.children.push(this.children[E].toJSON(a).object);if(this.animations.length>0)for(u.animations=[],E=0;E<this.animations.length;E++)u.animations.push(b(a.animations,this.animations[E]));
if(h){h=d(a.geometries);E=d(a.materials);const F=d(a.textures),H=d(a.images),M=d(a.shapes),R=d(a.skeletons),T=d(a.animations),X=d(a.nodes);h.length>0&&(n.geometries=h);E.length>0&&(n.materials=E);F.length>0&&(n.textures=F);H.length>0&&(n.images=H);M.length>0&&(n.shapes=M);R.length>0&&(n.skeletons=R);T.length>0&&(n.animations=T);X.length>0&&(n.nodes=X)}n.object=u;return n}clone(a){return(new this.constructor).copy(this,a)}copy(a,b=!0){this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);
this.rotation.order=a.rotation.order;this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.animations=
a.animations.slice();this.userData=JSON.parse(JSON.stringify(a.userData));if(b===!0)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());return this}}jc.DEFAULT_UP=new ma(0,1,0);jc.DEFAULT_MATRIX_AUTO_UPDATE=!0;jc.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Nd=new ma,me=new ma,Li=new ma,ne=new ma,Lf=new ma,Mf=new ma,zk=new ma,Mi=new ma,Ni=new ma,Oi=new ma,Pi=new ec,Qi=new ec,Ri=new ec;class ud{constructor(a=new ma,b=new ma,d=new ma){this.a=a;this.b=b;this.c=d}static getNormal(a,b,d,h){h.subVectors(d,
b);Nd.subVectors(a,b);h.cross(Nd);a=h.lengthSq();return a>0?h.multiplyScalar(1/Math.sqrt(a)):h.set(0,0,0)}static getBarycoord(a,b,d,h,n){Nd.subVectors(h,b);me.subVectors(d,b);Li.subVectors(a,b);a=Nd.dot(Nd);b=Nd.dot(me);d=Nd.dot(Li);var u=me.dot(me);h=me.dot(Li);var E=a*u-b*b;if(E===0)return n.set(0,0,0),null;E=1/E;u=(u*d-b*h)*E;a=(a*h-b*d)*E;return n.set(1-u-a,a,u)}static containsPoint(a,b,d,h){return this.getBarycoord(a,b,d,h,ne)===null?!1:ne.x>=0&&ne.y>=0&&ne.x+ne.y<=1}static getInterpolation(a,
b,d,h,n,u,E,F){if(this.getBarycoord(a,b,d,h,ne)===null)return F.x=0,F.y=0,"z"in F&&(F.z=0),"w"in F&&(F.w=0),null;F.setScalar(0);F.addScaledVector(n,ne.x);F.addScaledVector(u,ne.y);F.addScaledVector(E,ne.z);return F}static getInterpolatedAttribute(a,b,d,h,n,u){Pi.setScalar(0);Qi.setScalar(0);Ri.setScalar(0);Pi.fromBufferAttribute(a,b);Qi.fromBufferAttribute(a,d);Ri.fromBufferAttribute(a,h);u.setScalar(0);u.addScaledVector(Pi,n.x);u.addScaledVector(Qi,n.y);u.addScaledVector(Ri,n.z);return u}static isFrontFacing(a,
b,d,h){Nd.subVectors(d,b);me.subVectors(a,b);return Nd.cross(me).dot(h)<0?!0:!1}set(a,b,d){this.a.copy(a);this.b.copy(b);this.c.copy(d);return this}setFromPointsAndIndices(a,b,d,h){this.a.copy(a[b]);this.b.copy(a[d]);this.c.copy(a[h]);return this}setFromAttributeAndIndices(a,b,d,h){this.a.fromBufferAttribute(a,b);this.b.fromBufferAttribute(a,d);this.c.fromBufferAttribute(a,h);return this}clone(){return(new this.constructor).copy(this)}copy(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this}getArea(){Nd.subVectors(this.c,
this.b);me.subVectors(this.a,this.b);return Nd.cross(me).length()*.5}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return ud.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,b){return ud.getBarycoord(a,this.a,this.b,this.c,b)}getInterpolation(a,b,d,h,n){return ud.getInterpolation(a,this.a,this.b,this.c,b,d,h,n)}containsPoint(a){return ud.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return ud.isFrontFacing(this.a,
this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,b){const d=this.a;var h=this.b,n=this.c;Lf.subVectors(h,d);Mf.subVectors(n,d);Mi.subVectors(a,d);var u=Lf.dot(Mi),E=Mf.dot(Mi);if(u<=0&&E<=0)return b.copy(d);Ni.subVectors(a,h);const F=Lf.dot(Ni),H=Mf.dot(Ni);if(F>=0&&H<=F)return b.copy(h);var M=u*H-F*E;if(M<=0&&u>=0&&F<=0)return h=u/(u-F),b.copy(d).addScaledVector(Lf,h);Oi.subVectors(a,n);a=Lf.dot(Oi);const R=Mf.dot(Oi);if(R>=0&&a<=R)return b.copy(n);u=a*E-
u*R;if(u<=0&&E>=0&&R<=0)return M=E/(E-R),b.copy(d).addScaledVector(Mf,M);E=F*R-a*H;if(E<=0&&H-F>=0&&a-R>=0)return zk.subVectors(n,h),M=(H-F)/(H-F+(a-R)),b.copy(h).addScaledVector(zk,M);n=1/(E+u+M);h=u*n;M*=n;return b.copy(d).addScaledVector(Lf,h).addScaledVector(Mf,M)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}const Ak={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,
blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,
darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,
lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,
mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,
rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ge={h:0,
s:0,l:0},oh={h:0,s:0,l:0};class pb{constructor(a,b,d){this.isColor=!0;this.b=this.g=this.r=1;return this.set(a,b,d)}set(a,b,d){b===void 0&&d===void 0?a&&a.isColor?this.copy(a):typeof a==="number"?this.setHex(a):typeof a==="string"&&this.setStyle(a):this.setRGB(a,b,d);return this}setScalar(a){this.b=this.g=this.r=a;return this}setHex(a,b="srgb"){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;$b.colorSpaceToWorking(this,b);return this}setRGB(a,b,d,h=$b.workingColorSpace){this.r=
a;this.g=b;this.b=d;$b.colorSpaceToWorking(this,h);return this}setHSL(a,b,d,h=$b.workingColorSpace){a=e(a,1);b=r(b,0,1);d=r(d,0,1);b===0?this.r=this.g=this.b=d:(b=d<=.5?d*(1+b):d+b-d*b,d=2*d-b,this.r=I(d,b,a+1/3),this.g=I(d,b,a),this.b=I(d,b,a-1/3));$b.colorSpaceToWorking(this,h);return this}setStyle(a,b="srgb"){function d(u){u!==void 0&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var h;if(h=/^(\w+)\(([^\)]*)\)/.exec(a)){var n=h[2];switch(h[1]){case "rgb":case "rgba":if(h=
/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return d(h[4]),this.setRGB(Math.min(255,parseInt(h[1],10))/255,Math.min(255,parseInt(h[2],10))/255,Math.min(255,parseInt(h[3],10))/255,b);if(h=/^\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return d(h[4]),this.setRGB(Math.min(100,parseInt(h[1],10))/100,Math.min(100,parseInt(h[2],10))/100,Math.min(100,parseInt(h[3],10))/100,b);break;case "hsl":case "hsla":if(h=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return d(h[4]),
this.setHSL(parseFloat(h[1])/360,parseFloat(h[2])/100,parseFloat(h[3])/100,b);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(h=/^#([A-Fa-f\d]+)$/.exec(a)){n=h[1];h=n.length;if(h===3)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,b);if(h===6)return this.setHex(parseInt(n,16),b);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&a.length>0)return this.setColorName(a,b);return this}setColorName(a,b="srgb"){const d=
Ak[a.toLowerCase()];d!==void 0?this.setHex(d,b):console.warn("THREE.Color: Unknown color "+a);return this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){this.r=a.r;this.g=a.g;this.b=a.b;return this}copySRGBToLinear(a){this.r=y(a.r);this.g=y(a.g);this.b=y(a.b);return this}copyLinearToSRGB(a){this.r=B(a.r);this.g=B(a.g);this.b=B(a.b);return this}convertSRGBToLinear(){this.copySRGBToLinear(this);return this}convertLinearToSRGB(){this.copyLinearToSRGB(this);return this}getHex(a="srgb"){$b.workingToColorSpace(ed.copy(this),
a);return Math.round(r(ed.r*255,0,255))*65536+Math.round(r(ed.g*255,0,255))*256+Math.round(r(ed.b*255,0,255))}getHexString(a="srgb"){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,b=$b.workingColorSpace){$b.workingToColorSpace(ed.copy(this),b);b=ed.r;const d=ed.g,h=ed.b,n=Math.max(b,d,h);var u=Math.min(b,d,h);let E;const F=(u+n)/2;if(u===n)u=E=0;else{const H=n-u;u=F<=.5?H/(n+u):H/(2-n-u);switch(n){case b:E=(d-h)/H+(d<h?6:0);break;case d:E=(h-b)/H+2;break;case h:E=(b-d)/H+4}E/=6}a.h=
E;a.s=u;a.l=F;return a}getRGB(a,b=$b.workingColorSpace){$b.workingToColorSpace(ed.copy(this),b);a.r=ed.r;a.g=ed.g;a.b=ed.b;return a}getStyle(a="srgb"){$b.workingToColorSpace(ed.copy(this),a);const b=ed.r,d=ed.g,h=ed.b;return a!=="srgb"?`color(${a} ${b.toFixed(3)} ${d.toFixed(3)} ${h.toFixed(3)})`:`rgb(${Math.round(b*255)},${Math.round(d*255)},${Math.round(h*255)})`}offsetHSL(a,b,d){this.getHSL(Ge);return this.setHSL(Ge.h+a,Ge.s+b,Ge.l+d)}add(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this}addColors(a,
b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this}addScalar(a){this.r+=a;this.g+=a;this.b+=a;return this}sub(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,this.g-a.g);this.b=Math.max(0,this.b-a.b);return this}multiply(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this}multiplyScalar(a){this.r*=a;this.g*=a;this.b*=a;return this}lerp(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this}lerpColors(a,b,d){this.r=a.r+(b.r-a.r)*d;this.g=a.g+(b.g-a.g)*d;this.b=
a.b+(b.b-a.b)*d;return this}lerpHSL(a,b){this.getHSL(Ge);a.getHSL(oh);a=g(Ge.h,oh.h,b);const d=g(Ge.s,oh.s,b);b=g(Ge.l,oh.l,b);this.setHSL(a,d,b);return this}setFromVector3(a){this.r=a.x;this.g=a.y;this.b=a.z;return this}applyMatrix3(a){const b=this.r,d=this.g,h=this.b;a=a.elements;this.r=a[0]*b+a[3]*d+a[6]*h;this.g=a[1]*b+a[4]*d+a[7]*h;this.b=a[2]*b+a[5]*d+a[8]*h;return this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,b=0){this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this}toArray(a=
[],b=0){a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a}fromBufferAttribute(a,b){this.r=a.getX(b);this.g=a.getY(b);this.b=a.getZ(b);return this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r;yield this.g;yield this.b}}const ed=new pb;pb.NAMES=Ak;let Bm=0;class fd extends Bd{constructor(){super();this.isMaterial=!0;Object.defineProperty(this,"id",{value:Bm++});this.uuid=x();this.name="";this.type="Material";this.blending=1;this.side=0;this.vertexColors=!1;this.opacity=1;this.alphaHash=
this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.blendColor=new pb(0,0,0);this.blendAlpha=0;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.stencilWriteMask=255;this.stencilFunc=519;this.stencilRef=0;this.stencilFuncMask=255;this.stencilZPass=this.stencilZFail=this.stencilFail=7680;this.stencilWrite=!1;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;
this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.forceSinglePass=this.premultipliedAlpha=this.alphaToCoverage=this.dithering=!1;this.toneMapped=this.visible=this.allowOverride=!0;this.userData={};this._alphaTest=this.version=0}get alphaTest(){return this._alphaTest}set alphaTest(a){this._alphaTest>0!==a>0&&this.version++;this._alphaTest=a}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(a){if(a!==
void 0)for(const b in a){const d=a[b];if(d===void 0){console.warn(`THREE.Material: parameter '${b}' has value of undefined.`);continue}const h=this[b];h===void 0?console.warn(`THREE.Material: '${b}' is not a property of THREE.${this.type}.`):h&&h.isColor?h.set(d):h&&h.isVector3&&d&&d.isVector3?h.copy(d):this[b]=d}}toJSON(a){function b(n){const u=[];for(const E in n){const F=n[E];delete F.metadata;u.push(F)}return u}var d=a===void 0||typeof a==="string";d&&(a={textures:{},images:{}});const h={metadata:{version:4.7,
type:"Material",generator:"Material.toJSON"}};h.uuid=this.uuid;h.type=this.type;this.name!==""&&(h.name=this.name);this.color&&this.color.isColor&&(h.color=this.color.getHex());this.roughness!==void 0&&(h.roughness=this.roughness);this.metalness!==void 0&&(h.metalness=this.metalness);this.sheen!==void 0&&(h.sheen=this.sheen);this.sheenColor&&this.sheenColor.isColor&&(h.sheenColor=this.sheenColor.getHex());this.sheenRoughness!==void 0&&(h.sheenRoughness=this.sheenRoughness);this.emissive&&this.emissive.isColor&&
(h.emissive=this.emissive.getHex());this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(h.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(h.specular=this.specular.getHex());this.specularIntensity!==void 0&&(h.specularIntensity=this.specularIntensity);this.specularColor&&this.specularColor.isColor&&(h.specularColor=this.specularColor.getHex());this.shininess!==void 0&&(h.shininess=this.shininess);this.clearcoat!==void 0&&(h.clearcoat=this.clearcoat);this.clearcoatRoughness!==
void 0&&(h.clearcoatRoughness=this.clearcoatRoughness);this.clearcoatMap&&this.clearcoatMap.isTexture&&(h.clearcoatMap=this.clearcoatMap.toJSON(a).uuid);this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(h.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid);this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(h.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,h.clearcoatNormalScale=this.clearcoatNormalScale.toArray());this.sheenColorMap&&this.sheenColorMap.isTexture&&
(h.sheenColorMap=this.sheenColorMap.toJSON(a).uuid);this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(h.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(a).uuid);this.dispersion!==void 0&&(h.dispersion=this.dispersion);this.iridescence!==void 0&&(h.iridescence=this.iridescence);this.iridescenceIOR!==void 0&&(h.iridescenceIOR=this.iridescenceIOR);this.iridescenceThicknessRange!==void 0&&(h.iridescenceThicknessRange=this.iridescenceThicknessRange);this.iridescenceMap&&this.iridescenceMap.isTexture&&
(h.iridescenceMap=this.iridescenceMap.toJSON(a).uuid);this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(h.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(a).uuid);this.anisotropy!==void 0&&(h.anisotropy=this.anisotropy);this.anisotropyRotation!==void 0&&(h.anisotropyRotation=this.anisotropyRotation);this.anisotropyMap&&this.anisotropyMap.isTexture&&(h.anisotropyMap=this.anisotropyMap.toJSON(a).uuid);this.map&&this.map.isTexture&&(h.map=this.map.toJSON(a).uuid);this.matcap&&
this.matcap.isTexture&&(h.matcap=this.matcap.toJSON(a).uuid);this.alphaMap&&this.alphaMap.isTexture&&(h.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&(h.lightMap=this.lightMap.toJSON(a).uuid,h.lightMapIntensity=this.lightMapIntensity);this.aoMap&&this.aoMap.isTexture&&(h.aoMap=this.aoMap.toJSON(a).uuid,h.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(h.bumpMap=this.bumpMap.toJSON(a).uuid,h.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&
(h.normalMap=this.normalMap.toJSON(a).uuid,h.normalMapType=this.normalMapType,h.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(h.displacementMap=this.displacementMap.toJSON(a).uuid,h.displacementScale=this.displacementScale,h.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(h.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(h.metalnessMap=this.metalnessMap.toJSON(a).uuid);
this.emissiveMap&&this.emissiveMap.isTexture&&(h.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(h.specularMap=this.specularMap.toJSON(a).uuid);this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(h.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid);this.specularColorMap&&this.specularColorMap.isTexture&&(h.specularColorMap=this.specularColorMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&(h.envMap=this.envMap.toJSON(a).uuid,
this.combine!==void 0&&(h.combine=this.combine));this.envMapRotation!==void 0&&(h.envMapRotation=this.envMapRotation.toArray());this.envMapIntensity!==void 0&&(h.envMapIntensity=this.envMapIntensity);this.reflectivity!==void 0&&(h.reflectivity=this.reflectivity);this.refractionRatio!==void 0&&(h.refractionRatio=this.refractionRatio);this.gradientMap&&this.gradientMap.isTexture&&(h.gradientMap=this.gradientMap.toJSON(a).uuid);this.transmission!==void 0&&(h.transmission=this.transmission);this.transmissionMap&&
this.transmissionMap.isTexture&&(h.transmissionMap=this.transmissionMap.toJSON(a).uuid);this.thickness!==void 0&&(h.thickness=this.thickness);this.thicknessMap&&this.thicknessMap.isTexture&&(h.thicknessMap=this.thicknessMap.toJSON(a).uuid);this.attenuationDistance!==void 0&&this.attenuationDistance!==Infinity&&(h.attenuationDistance=this.attenuationDistance);this.attenuationColor!==void 0&&(h.attenuationColor=this.attenuationColor.getHex());this.size!==void 0&&(h.size=this.size);this.shadowSide!==
null&&(h.shadowSide=this.shadowSide);this.sizeAttenuation!==void 0&&(h.sizeAttenuation=this.sizeAttenuation);this.blending!==1&&(h.blending=this.blending);this.side!==0&&(h.side=this.side);this.vertexColors===!0&&(h.vertexColors=!0);this.opacity<1&&(h.opacity=this.opacity);this.transparent===!0&&(h.transparent=!0);this.blendSrc!==204&&(h.blendSrc=this.blendSrc);this.blendDst!==205&&(h.blendDst=this.blendDst);this.blendEquation!==100&&(h.blendEquation=this.blendEquation);this.blendSrcAlpha!==null&&
(h.blendSrcAlpha=this.blendSrcAlpha);this.blendDstAlpha!==null&&(h.blendDstAlpha=this.blendDstAlpha);this.blendEquationAlpha!==null&&(h.blendEquationAlpha=this.blendEquationAlpha);this.blendColor&&this.blendColor.isColor&&(h.blendColor=this.blendColor.getHex());this.blendAlpha!==0&&(h.blendAlpha=this.blendAlpha);this.depthFunc!==3&&(h.depthFunc=this.depthFunc);this.depthTest===!1&&(h.depthTest=this.depthTest);this.depthWrite===!1&&(h.depthWrite=this.depthWrite);this.colorWrite===!1&&(h.colorWrite=
this.colorWrite);this.stencilWriteMask!==255&&(h.stencilWriteMask=this.stencilWriteMask);this.stencilFunc!==519&&(h.stencilFunc=this.stencilFunc);this.stencilRef!==0&&(h.stencilRef=this.stencilRef);this.stencilFuncMask!==255&&(h.stencilFuncMask=this.stencilFuncMask);this.stencilFail!==7680&&(h.stencilFail=this.stencilFail);this.stencilZFail!==7680&&(h.stencilZFail=this.stencilZFail);this.stencilZPass!==7680&&(h.stencilZPass=this.stencilZPass);this.stencilWrite===!0&&(h.stencilWrite=this.stencilWrite);
this.rotation!==void 0&&this.rotation!==0&&(h.rotation=this.rotation);this.polygonOffset===!0&&(h.polygonOffset=!0);this.polygonOffsetFactor!==0&&(h.polygonOffsetFactor=this.polygonOffsetFactor);this.polygonOffsetUnits!==0&&(h.polygonOffsetUnits=this.polygonOffsetUnits);this.linewidth!==void 0&&this.linewidth!==1&&(h.linewidth=this.linewidth);this.dashSize!==void 0&&(h.dashSize=this.dashSize);this.gapSize!==void 0&&(h.gapSize=this.gapSize);this.scale!==void 0&&(h.scale=this.scale);this.dithering===
!0&&(h.dithering=!0);this.alphaTest>0&&(h.alphaTest=this.alphaTest);this.alphaHash===!0&&(h.alphaHash=!0);this.alphaToCoverage===!0&&(h.alphaToCoverage=!0);this.premultipliedAlpha===!0&&(h.premultipliedAlpha=!0);this.forceSinglePass===!0&&(h.forceSinglePass=!0);this.wireframe===!0&&(h.wireframe=!0);this.wireframeLinewidth>1&&(h.wireframeLinewidth=this.wireframeLinewidth);this.wireframeLinecap!=="round"&&(h.wireframeLinecap=this.wireframeLinecap);this.wireframeLinejoin!=="round"&&(h.wireframeLinejoin=
this.wireframeLinejoin);this.flatShading===!0&&(h.flatShading=!0);this.visible===!1&&(h.visible=!1);this.toneMapped===!1&&(h.toneMapped=!1);this.fog===!1&&(h.fog=!1);Object.keys(this.userData).length>0&&(h.userData=this.userData);d&&(d=b(a.textures),a=b(a.images),d.length>0&&(h.textures=d),a.length>0&&(h.images=a));return h}clone(){return(new this.constructor).copy(this)}copy(a){this.name=a.name;this.blending=a.blending;this.side=a.side;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=
a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.blendColor.copy(a.blendColor);this.blendAlpha=a.blendAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.stencilWriteMask=a.stencilWriteMask;this.stencilFunc=a.stencilFunc;this.stencilRef=a.stencilRef;this.stencilFuncMask=a.stencilFuncMask;
this.stencilFail=a.stencilFail;this.stencilZFail=a.stencilZFail;this.stencilZPass=a.stencilZPass;this.stencilWrite=a.stencilWrite;const b=a.clippingPlanes;let d=null;if(b!==null){const h=b.length;d=Array(h);for(let n=0;n!==h;++n)d[n]=b[n].clone()}this.clippingPlanes=d;this.clipIntersection=a.clipIntersection;this.clipShadows=a.clipShadows;this.shadowSide=a.shadowSide;this.colorWrite=a.colorWrite;this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;
this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.alphaHash=a.alphaHash;this.alphaToCoverage=a.alphaToCoverage;this.premultipliedAlpha=a.premultipliedAlpha;this.forceSinglePass=a.forceSinglePass;this.visible=a.visible;this.toneMapped=a.toneMapped;this.userData=JSON.parse(JSON.stringify(a.userData));return this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(a){a===!0&&this.version++}}class He extends fd{constructor(a){super();this.isMeshBasicMaterial=
!0;this.type="MeshBasicMaterial";this.color=new pb(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Cd;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;
this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.fog=a.fog;return this}}const ie=
function(){var a=new ArrayBuffer(4);const b=new Float32Array(a);a=new Uint32Array(a);const d=new Uint32Array(512),h=new Uint32Array(512);for(var n=0;n<256;++n){var u=n-127;u<-27?(d[n]=0,d[n|256]=32768,h[n]=24,h[n|256]=24):u<-14?(d[n]=1024>>-u-14,d[n|256]=1024>>-u-14|32768,h[n]=-u-1,h[n|256]=-u-1):u<=15?(d[n]=u+15<<10,d[n|256]=u+15<<10|32768,h[n]=13,h[n|256]=13):u<128?(d[n]=31744,d[n|256]=64512,h[n]=24,h[n|256]=24):(d[n]=31744,d[n|256]=64512,h[n]=13,h[n|256]=13)}n=new Uint32Array(2048);u=new Uint32Array(64);
const E=new Uint32Array(64);for(var F=1;F<1024;++F){let H=F<<13,M=0;for(;(H&8388608)===0;)H<<=1,M-=8388608;H&=-8388609;M+=947912704;n[F]=H|M}for(F=1024;F<2048;++F)n[F]=939524096+(F-1024<<13);for(F=1;F<31;++F)u[F]=F<<23;u[31]=1199570944;u[32]=2147483648;for(F=33;F<63;++F)u[F]=2147483648+(F-32<<23);u[63]=3347054592;for(F=1;F<64;++F)F!==32&&(E[F]=1024);return{floatView:b,uint32View:a,baseTable:d,shiftTable:h,mantissaTable:n,exponentTable:u,offsetTable:E}}();class Cm{static toHalfFloat(a){return K(a)}static fromHalfFloat(a){return Q(a)}}
const Nc=new ma,ph=new Xa;let Dm=0;class sc{constructor(a,b,d=!1){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0;Object.defineProperty(this,"id",{value:Dm++});this.name="";this.array=a;this.itemSize=b;this.count=a!==void 0?a.length/b:0;this.normalized=d;this.usage=35044;this.updateRanges=[];this.gpuType=1015;this.version=0}onUploadCallback(){}set needsUpdate(a){a===!0&&this.version++}setUsage(a){this.usage=a;return this}addUpdateRange(a,
b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){this.name=a.name;this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=a.normalized;this.usage=a.usage;this.gpuType=a.gpuType;return this}copyAt(a,b,d){a*=this.itemSize;d*=b.itemSize;for(let h=0,n=this.itemSize;h<n;h++)this.array[a+h]=b.array[d+h];return this}copyArray(a){this.array.set(a);return this}applyMatrix3(a){if(this.itemSize===2)for(let b=0,
d=this.count;b<d;b++)ph.fromBufferAttribute(this,b),ph.applyMatrix3(a),this.setXY(b,ph.x,ph.y);else if(this.itemSize===3)for(let b=0,d=this.count;b<d;b++)Nc.fromBufferAttribute(this,b),Nc.applyMatrix3(a),this.setXYZ(b,Nc.x,Nc.y,Nc.z);return this}applyMatrix4(a){for(let b=0,d=this.count;b<d;b++)Nc.fromBufferAttribute(this,b),Nc.applyMatrix4(a),this.setXYZ(b,Nc.x,Nc.y,Nc.z);return this}applyNormalMatrix(a){for(let b=0,d=this.count;b<d;b++)Nc.fromBufferAttribute(this,b),Nc.applyNormalMatrix(a),this.setXYZ(b,
Nc.x,Nc.y,Nc.z);return this}transformDirection(a){for(let b=0,d=this.count;b<d;b++)Nc.fromBufferAttribute(this,b),Nc.transformDirection(a),this.setXYZ(b,Nc.x,Nc.y,Nc.z);return this}set(a,b=0){this.array.set(a,b);return this}getComponent(a,b){a=this.array[a*this.itemSize+b];this.normalized&&(a=f(a,this.array));return a}setComponent(a,b,d){this.normalized&&(d=k(d,this.array));this.array[a*this.itemSize+b]=d;return this}getX(a){a=this.array[a*this.itemSize];this.normalized&&(a=f(a,this.array));return a}setX(a,
b){this.normalized&&(b=k(b,this.array));this.array[a*this.itemSize]=b;return this}getY(a){a=this.array[a*this.itemSize+1];this.normalized&&(a=f(a,this.array));return a}setY(a,b){this.normalized&&(b=k(b,this.array));this.array[a*this.itemSize+1]=b;return this}getZ(a){a=this.array[a*this.itemSize+2];this.normalized&&(a=f(a,this.array));return a}setZ(a,b){this.normalized&&(b=k(b,this.array));this.array[a*this.itemSize+2]=b;return this}getW(a){a=this.array[a*this.itemSize+3];this.normalized&&(a=f(a,this.array));
return a}setW(a,b){this.normalized&&(b=k(b,this.array));this.array[a*this.itemSize+3]=b;return this}setXY(a,b,d){a*=this.itemSize;this.normalized&&(b=k(b,this.array),d=k(d,this.array));this.array[a+0]=b;this.array[a+1]=d;return this}setXYZ(a,b,d,h){a*=this.itemSize;this.normalized&&(b=k(b,this.array),d=k(d,this.array),h=k(h,this.array));this.array[a+0]=b;this.array[a+1]=d;this.array[a+2]=h;return this}setXYZW(a,b,d,h,n){a*=this.itemSize;this.normalized&&(b=k(b,this.array),d=k(d,this.array),h=k(h,
this.array),n=k(n,this.array));this.array[a+0]=b;this.array[a+1]=d;this.array[a+2]=h;this.array[a+3]=n;return this}onUpload(a){this.onUploadCallback=a;return this}clone(){return(new this.constructor(this.array,this.itemSize)).copy(this)}toJSON(){const a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};this.name!==""&&(a.name=this.name);this.usage!==35044&&(a.usage=this.usage);return a}}class Em extends sc{constructor(a,b,d){super(new Int8Array(a),
b,d)}}class Fm extends sc{constructor(a,b,d){super(new Uint8Array(a),b,d)}}class Gm extends sc{constructor(a,b,d){super(new Uint8ClampedArray(a),b,d)}}class Hm extends sc{constructor(a,b,d){super(new Int16Array(a),b,d)}}class ei extends sc{constructor(a,b,d){super(new Uint16Array(a),b,d)}}class Im extends sc{constructor(a,b,d){super(new Int32Array(a),b,d)}}class di extends sc{constructor(a,b,d){super(new Uint32Array(a),b,d)}}class Jm extends sc{constructor(a,b,d){super(new Uint16Array(a),b,d);this.isFloat16BufferAttribute=
!0}getX(a){a=Q(this.array[a*this.itemSize]);this.normalized&&(a=f(a,this.array));return a}setX(a,b){this.normalized&&(b=k(b,this.array));this.array[a*this.itemSize]=K(b);return this}getY(a){a=Q(this.array[a*this.itemSize+1]);this.normalized&&(a=f(a,this.array));return a}setY(a,b){this.normalized&&(b=k(b,this.array));this.array[a*this.itemSize+1]=K(b);return this}getZ(a){a=Q(this.array[a*this.itemSize+2]);this.normalized&&(a=f(a,this.array));return a}setZ(a,b){this.normalized&&(b=k(b,this.array));
this.array[a*this.itemSize+2]=K(b);return this}getW(a){a=Q(this.array[a*this.itemSize+3]);this.normalized&&(a=f(a,this.array));return a}setW(a,b){this.normalized&&(b=k(b,this.array));this.array[a*this.itemSize+3]=K(b);return this}setXY(a,b,d){a*=this.itemSize;this.normalized&&(b=k(b,this.array),d=k(d,this.array));this.array[a+0]=K(b);this.array[a+1]=K(d);return this}setXYZ(a,b,d,h){a*=this.itemSize;this.normalized&&(b=k(b,this.array),d=k(d,this.array),h=k(h,this.array));this.array[a+0]=K(b);this.array[a+
1]=K(d);this.array[a+2]=K(h);return this}setXYZW(a,b,d,h,n){a*=this.itemSize;this.normalized&&(b=k(b,this.array),d=k(d,this.array),h=k(h,this.array),n=k(n,this.array));this.array[a+0]=K(b);this.array[a+1]=K(d);this.array[a+2]=K(h);this.array[a+3]=K(n);return this}}class vb extends sc{constructor(a,b,d){super(new Float32Array(a),b,d)}}let Km=0;const Dd=new Gb,Si=new jc,Nf=new ma,xd=new Sc,Ag=new Sc,Tc=new ma;class Vb extends Bd{constructor(){super();this.isBufferGeometry=!0;Object.defineProperty(this,
"id",{value:Km++});this.uuid=x();this.name="";this.type="BufferGeometry";this.indirect=this.index=null;this.attributes={};this.morphAttributes={};this.morphTargetsRelative=!1;this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};this.userData={}}getIndex(){return this.index}setIndex(a){Array.isArray(a)?this.index=new (m(a)?di:ei)(a,1):this.index=a;return this}setIndirect(a){this.indirect=a;return this}getIndirect(){return this.indirect}getAttribute(a){return this.attributes[a]}setAttribute(a,
b){this.attributes[a]=b;return this}deleteAttribute(a){delete this.attributes[a];return this}hasAttribute(a){return this.attributes[a]!==void 0}addGroup(a,b,d=0){this.groups.push({start:a,count:b,materialIndex:d})}clearGroups(){this.groups=[]}setDrawRange(a,b){this.drawRange.start=a;this.drawRange.count=b}applyMatrix4(a){var b=this.attributes.position;b!==void 0&&(b.applyMatrix4(a),b.needsUpdate=!0);b=this.attributes.normal;if(b!==void 0){const d=(new Lb).getNormalMatrix(a);b.applyNormalMatrix(d);
b.needsUpdate=!0}b=this.attributes.tangent;b!==void 0&&(b.transformDirection(a),b.needsUpdate=!0);this.boundingBox!==null&&this.computeBoundingBox();this.boundingSphere!==null&&this.computeBoundingSphere();return this}applyQuaternion(a){Dd.makeRotationFromQuaternion(a);this.applyMatrix4(Dd);return this}rotateX(a){Dd.makeRotationX(a);this.applyMatrix4(Dd);return this}rotateY(a){Dd.makeRotationY(a);this.applyMatrix4(Dd);return this}rotateZ(a){Dd.makeRotationZ(a);this.applyMatrix4(Dd);return this}translate(a,
b,d){Dd.makeTranslation(a,b,d);this.applyMatrix4(Dd);return this}scale(a,b,d){Dd.makeScale(a,b,d);this.applyMatrix4(Dd);return this}lookAt(a){Si.lookAt(a);Si.updateMatrix();this.applyMatrix4(Si.matrix);return this}center(){this.computeBoundingBox();this.boundingBox.getCenter(Nf).negate();this.translate(Nf.x,Nf.y,Nf.z);return this}setFromPoints(a){var b=this.getAttribute("position");if(b===void 0){b=[];for(let h=0,n=a.length;h<n;h++){var d=a[h];b.push(d.x,d.y,d.z||0)}this.setAttribute("position",new vb(b,
3))}else{d=Math.min(a.length,b.count);for(let h=0;h<d;h++){const n=a[h];b.setXYZ(h,n.x,n.y,n.z||0)}a.length>b.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry.");b.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Sc);const a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",
this),this.boundingBox.set(new ma(-Infinity,-Infinity,-Infinity),new ma(Infinity,Infinity,Infinity));else{if(a!==void 0){if(this.boundingBox.setFromBufferAttribute(a),b)for(let d=0,h=b.length;d<h;d++)xd.setFromBufferAttribute(b[d]),this.morphTargetsRelative?(Tc.addVectors(this.boundingBox.min,xd.min),this.boundingBox.expandByPoint(Tc),Tc.addVectors(this.boundingBox.max,xd.max),this.boundingBox.expandByPoint(Tc)):(this.boundingBox.expandByPoint(xd.min),this.boundingBox.expandByPoint(xd.max))}else this.boundingBox.makeEmpty();
(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qc);const a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",
this),this.boundingSphere.set(new ma,Infinity);else if(a){const d=this.boundingSphere.center;xd.setFromBufferAttribute(a);if(b)for(let n=0,u=b.length;n<u;n++)Ag.setFromBufferAttribute(b[n]),this.morphTargetsRelative?(Tc.addVectors(xd.min,Ag.min),xd.expandByPoint(Tc),Tc.addVectors(xd.max,Ag.max),xd.expandByPoint(Tc)):(xd.expandByPoint(Ag.min),xd.expandByPoint(Ag.max));xd.getCenter(d);let h=0;for(let n=0,u=a.count;n<u;n++)Tc.fromBufferAttribute(a,n),h=Math.max(h,d.distanceToSquared(Tc));if(b)for(let n=
0,u=b.length;n<u;n++){const E=b[n],F=this.morphTargetsRelative;for(let H=0,M=E.count;H<M;H++)Tc.fromBufferAttribute(E,H),F&&(Nf.fromBufferAttribute(a,H),Tc.add(Nf)),h=Math.max(h,d.distanceToSquared(Tc))}this.boundingSphere.radius=Math.sqrt(h);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){function a(Ca,Ja,Qa){R.fromBufferAttribute(n,Ca);T.fromBufferAttribute(n,
Ja);X.fromBufferAttribute(n,Qa);ea.fromBufferAttribute(E,Ca);aa.fromBufferAttribute(E,Ja);da.fromBufferAttribute(E,Qa);T.sub(R);X.sub(R);aa.sub(ea);da.sub(ea);const Za=1/(aa.x*da.y-da.x*aa.y);isFinite(Za)&&(U.copy(T).multiplyScalar(da.y).addScaledVector(X,-aa.y).multiplyScalar(Za),ka.copy(X).multiplyScalar(aa.x).addScaledVector(T,-da.x).multiplyScalar(Za),H[Ca].add(U),H[Ja].add(U),H[Qa].add(U),M[Ca].add(ka),M[Ja].add(ka),M[Qa].add(ka))}function b(Ca){Ba.fromBufferAttribute(u,Ca);Na.copy(Ba);var Ja=
H[Ca];sa.copy(Ja);sa.sub(Ba.multiplyScalar(Ba.dot(Ja))).normalize();Aa.crossVectors(Na,Ja);Ja=Aa.dot(M[Ca]);F.setXYZW(Ca,sa.x,sa.y,sa.z,Ja<0?-1:1)}const d=this.index;var h=this.attributes;if(d===null||h.position===void 0||h.normal===void 0||h.uv===void 0)console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");else{var n=h.position,u=h.normal,E=h.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new sc(new Float32Array(4*
n.count),4));var F=this.getAttribute("tangent"),H=[],M=[];for(h=0;h<n.count;h++)H[h]=new ma,M[h]=new ma;var R=new ma,T=new ma,X=new ma,ea=new Xa,aa=new Xa,da=new Xa,U=new ma,ka=new ma;h=this.groups;h.length===0&&(h=[{start:0,count:d.count}]);for(let Ca=0,Ja=h.length;Ca<Ja;++Ca){var qa=h[Ca],wa=qa.start;qa=qa.count;for(let Qa=wa,Za=wa+qa;Qa<Za;Qa+=3)a(d.getX(Qa+0),d.getX(Qa+1),d.getX(Qa+2))}var sa=new ma,Aa=new ma,Ba=new ma,Na=new ma;for(let Ca=0,Ja=h.length;Ca<Ja;++Ca){qa=h[Ca];wa=qa.start;qa=qa.count;
for(let Qa=wa,Za=wa+qa;Qa<Za;Qa+=3)b(d.getX(Qa+0)),b(d.getX(Qa+1)),b(d.getX(Qa+2))}}}computeVertexNormals(){const a=this.index,b=this.getAttribute("position");if(b!==void 0){let d=this.getAttribute("normal");if(d===void 0)d=new sc(new Float32Array(b.count*3),3),this.setAttribute("normal",d);else for(let T=0,X=d.count;T<X;T++)d.setXYZ(T,0,0,0);const h=new ma,n=new ma,u=new ma,E=new ma,F=new ma,H=new ma,M=new ma,R=new ma;if(a)for(let T=0,X=a.count;T<X;T+=3){const ea=a.getX(T+0),aa=a.getX(T+1),da=a.getX(T+
2);h.fromBufferAttribute(b,ea);n.fromBufferAttribute(b,aa);u.fromBufferAttribute(b,da);M.subVectors(u,n);R.subVectors(h,n);M.cross(R);E.fromBufferAttribute(d,ea);F.fromBufferAttribute(d,aa);H.fromBufferAttribute(d,da);E.add(M);F.add(M);H.add(M);d.setXYZ(ea,E.x,E.y,E.z);d.setXYZ(aa,F.x,F.y,F.z);d.setXYZ(da,H.x,H.y,H.z)}else for(let T=0,X=b.count;T<X;T+=3)h.fromBufferAttribute(b,T+0),n.fromBufferAttribute(b,T+1),u.fromBufferAttribute(b,T+2),M.subVectors(u,n),R.subVectors(h,n),M.cross(R),d.setXYZ(T+
0,M.x,M.y,M.z),d.setXYZ(T+1,M.x,M.y,M.z),d.setXYZ(T+2,M.x,M.y,M.z);this.normalizeNormals();d.needsUpdate=!0}}normalizeNormals(){const a=this.attributes.normal;for(let b=0,d=a.count;b<d;b++)Tc.fromBufferAttribute(a,b),Tc.normalize(),a.setXYZ(b,Tc.x,Tc.y,Tc.z)}toNonIndexed(){function a(F,H){const M=F.array,R=F.itemSize,T=F.normalized,X=new M.constructor(H.length*R);let ea,aa=0;for(let da=0,U=H.length;da<U;da++){ea=F.isInterleavedBufferAttribute?H[da]*F.data.stride+F.offset:H[da]*R;for(let ka=0;ka<R;ka++)X[aa++]=
M[ea++]}return new sc(X,R,T)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const b=new Vb;var d=this.index.array,h=this.attributes;for(var n in h){var u=a(h[n],d);b.setAttribute(n,u)}h=this.morphAttributes;for(var E in h){n=[];u=h[E];for(let F=0,H=u.length;F<H;F++){const M=a(u[F],d);n.push(M)}b.morphAttributes[E]=n}b.morphTargetsRelative=this.morphTargetsRelative;d=this.groups;for(let F=0,H=d.length;F<H;F++)E=d[F],b.addGroup(E.start,
E.count,E.materialIndex);return b}toJSON(){const a={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;this.name!==""&&(a.name=this.name);Object.keys(this.userData).length>0&&(a.userData=this.userData);if(this.parameters!==void 0){var b=this.parameters;for(var d in b)b[d]!==void 0&&(a[d]=b[d]);return a}a.data={attributes:{}};d=this.index;d!==null&&(a.data.index={type:d.array.constructor.name,array:Array.prototype.slice.call(d.array)});
d=this.attributes;for(var h in d)a.data.attributes[h]=d[h].toJSON(a.data);h={};d=!1;for(b in this.morphAttributes){const n=this.morphAttributes[b],u=[];for(let E=0,F=n.length;E<F;E++)u.push(n[E].toJSON(a.data));u.length>0&&(h[b]=u,d=!0)}d&&(a.data.morphAttributes=h,a.data.morphTargetsRelative=this.morphTargetsRelative);b=this.groups;b.length>0&&(a.data.groups=JSON.parse(JSON.stringify(b)));b=this.boundingSphere;b!==null&&(a.data.boundingSphere=b.toJSON());return a}clone(){return(new this.constructor).copy(this)}copy(a){this.index=
null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;var b={};this.name=a.name;var d=a.index;d!==null&&this.setIndex(d.clone());d=a.attributes;for(var h in d)this.setAttribute(h,d[h].clone(b));h=a.morphAttributes;for(var n in h){d=[];const u=h[n];for(let E=0,F=u.length;E<F;E++)d.push(u[E].clone(b));this.morphAttributes[n]=d}this.morphTargetsRelative=a.morphTargetsRelative;b=a.groups;for(let u=0,E=b.length;u<E;u++)n=b[u],this.addGroup(n.start,n.count,
n.materialIndex);b=a.boundingBox;b!==null&&(this.boundingBox=b.clone());b=a.boundingSphere;b!==null&&(this.boundingSphere=b.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;this.userData=a.userData;return this}dispose(){this.dispatchEvent({type:"dispose"})}}const Bk=new Gb,af=new Hf,qh=new Qc,Ck=new ma,kg=new ma,lg=new ma,mg=new ma,Ti=new ma,rh=new ma,Rg=new ma,Sg=new ma;class Kc extends jc{constructor(a=new Vb,b=new He){super();this.isMesh=!0;this.type="Mesh";
this.geometry=a;this.material=b;this.morphTargetInfluences=this.morphTargetDictionary=void 0;this.count=1;this.updateMorphTargets()}copy(a,b){super.copy(a,b);a.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());a.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;return this}updateMorphTargets(){var a=this.geometry.morphAttributes,
b=Object.keys(a);if(b.length>0&&(a=a[b[0]],a!==void 0)){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let d=0,h=a.length;d<h;d++)b=a[d].name||String(d),this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=d}}getVertexPosition(a,b){var d=this.geometry;const h=d.morphAttributes.position,n=d.morphTargetsRelative;b.fromBufferAttribute(d.attributes.position,a);d=this.morphTargetInfluences;if(h&&d){rh.set(0,0,0);for(let u=0,E=h.length;u<E;u++){const F=d[u];F!==0&&(Ti.fromBufferAttribute(h[u],
a),n?rh.addScaledVector(Ti,F):rh.addScaledVector(Ti.sub(b),F))}b.add(rh)}return b}raycast(a,b){const d=this.geometry,h=this.matrixWorld;this.material!==void 0&&(d.boundingSphere===null&&d.computeBoundingSphere(),qh.copy(d.boundingSphere),qh.applyMatrix4(h),af.copy(a.ray).recast(a.near),qh.containsPoint(af.origin)===!1&&(af.intersectSphere(qh,Ck)===null||af.origin.distanceToSquared(Ck)>(a.far-a.near)**2)||(Bk.copy(h).invert(),af.copy(a.ray).applyMatrix4(Bk),d.boundingBox!==null&&af.intersectsBox(d.boundingBox)===
!1||this._computeIntersections(a,b,af)))}_computeIntersections(a,b,d){var h=this.geometry;const n=this.material;var u=h.index,E=h.attributes.position;const F=h.attributes.uv,H=h.attributes.uv1,M=h.attributes.normal;var R=h.groups;h=h.drawRange;if(u!==null)if(Array.isArray(n))for(let aa=0,da=R.length;aa<da;aa++){E=R[aa];var T=n[E.materialIndex];var X=Math.max(E.start,h.start);var ea=Math.min(u.count,Math.min(E.start+E.count,h.start+h.count));for(let U=X,ka=ea;U<ka;U+=3){X=u.getX(U);ea=u.getX(U+1);
const qa=u.getX(U+2);if(X=O(this,T,a,d,F,H,M,X,ea,qa))X.faceIndex=Math.floor(U/3),X.face.materialIndex=E.materialIndex,b.push(X)}}else{R=Math.max(0,h.start);h=Math.min(u.count,h.start+h.count);for(let aa=R,da=h;aa<da;aa+=3)if(h=u.getX(aa),R=u.getX(aa+1),E=u.getX(aa+2),X=O(this,n,a,d,F,H,M,h,R,E))X.faceIndex=Math.floor(aa/3),b.push(X)}else if(E!==void 0)if(Array.isArray(n))for(let aa=0,da=R.length;aa<da;aa++){u=R[aa];T=n[u.materialIndex];X=Math.max(u.start,h.start);ea=Math.min(E.count,Math.min(u.start+
u.count,h.start+h.count));for(let U=X,ka=ea;U<ka;U+=3)if(X=O(this,T,a,d,F,H,M,U,U+1,U+2))X.faceIndex=Math.floor(U/3),X.face.materialIndex=u.materialIndex,b.push(X)}else{u=Math.max(0,h.start);h=Math.min(E.count,h.start+h.count);for(let aa=u,da=h;aa<da;aa+=3)if(X=O(this,n,a,d,F,H,M,aa,aa+1,aa+2))X.faceIndex=Math.floor(aa/3),b.push(X)}}}class xf extends Vb{constructor(a=1,b=1,d=1,h=1,n=1,u=1){function E(aa,da,U,ka,qa,wa,sa,Aa,Ba,Na,Ca){const Ja=wa/Ba,Qa=sa/Na,Za=wa/2,gb=sa/2,cb=Aa/2;sa=Ba+1;const rb=
Na+1;let Ya=wa=0;const nb=new ma;for(let ob=0;ob<rb;ob++){const ub=ob*Qa-gb;for(let Cb=0;Cb<sa;Cb++)nb[aa]=(Cb*Ja-Za)*ka,nb[da]=ub*qa,nb[U]=cb,M.push(nb.x,nb.y,nb.z),nb[aa]=0,nb[da]=0,nb[U]=Aa>0?1:-1,R.push(nb.x,nb.y,nb.z),T.push(Cb/Ba),T.push(1-ob/Na),wa+=1}for(aa=0;aa<Na;aa++)for(da=0;da<Ba;da++)U=X+da+sa*(aa+1),ka=X+(da+1)+sa*(aa+1),qa=X+(da+1)+sa*aa,H.push(X+da+sa*aa,U,qa),H.push(U,ka,qa),Ya+=6;F.addGroup(ea,Ya,Ca);ea+=Ya;X+=wa}super();this.type="BoxGeometry";this.parameters={width:a,height:b,
depth:d,widthSegments:h,heightSegments:n,depthSegments:u};const F=this;h=Math.floor(h);n=Math.floor(n);u=Math.floor(u);const H=[],M=[],R=[],T=[];let X=0,ea=0;E("z","y","x",-1,-1,d,b,a,u,n,0);E("z","y","x",1,-1,d,b,-a,u,n,1);E("x","z","y",1,1,a,d,b,h,u,2);E("x","z","y",1,-1,a,d,-b,h,u,3);E("x","y","z",1,-1,a,b,d,h,n,4);E("x","y","z",-1,-1,a,b,-d,h,n,5);this.setIndex(H);this.setAttribute("position",new vb(M,3));this.setAttribute("normal",new vb(R,3));this.setAttribute("uv",new vb(T,2))}copy(a){super.copy(a);
this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new xf(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)}}const rk={clone:J,merge:W};class Jd extends fd{constructor(a){super();this.isShaderMaterial=!0;this.type="ShaderMaterial";this.defines={};this.uniforms={};this.uniformsGroups=[];this.vertexShader="void main() {\n\tgl_Position \x3d projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor \x3d vec4( 1.0, 0.0, 0.0, 1.0 );\n}";
this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.clipping=this.lights=this.fog=!1;this.forceSinglePass=!0;this.extensions={clipCullDistance:!1,multiDraw:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;this.glslVersion=null;a!==void 0&&this.setValues(a)}copy(a){super.copy(a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=J(a.uniforms);var b=a.uniformsGroups;const d=[];
for(let h=0;h<b.length;h++)d.push(b[h].clone());this.uniformsGroups=d;this.defines=Object.assign({},a.defines);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.fog=a.fog;this.lights=a.lights;this.clipping=a.clipping;this.extensions=Object.assign({},a.extensions);this.glslVersion=a.glslVersion;return this}toJSON(a){const b=super.toJSON(a);b.glslVersion=this.glslVersion;b.uniforms={};for(const d in this.uniforms){const h=this.uniforms[d].value;b.uniforms[d]=h&&h.isTexture?
{type:"t",value:h.toJSON(a).uuid}:h&&h.isColor?{type:"c",value:h.getHex()}:h&&h.isVector2?{type:"v2",value:h.toArray()}:h&&h.isVector3?{type:"v3",value:h.toArray()}:h&&h.isVector4?{type:"v4",value:h.toArray()}:h&&h.isMatrix3?{type:"m3",value:h.toArray()}:h&&h.isMatrix4?{type:"m4",value:h.toArray()}:{value:h}}Object.keys(this.defines).length>0&&(b.defines=this.defines);b.vertexShader=this.vertexShader;b.fragmentShader=this.fragmentShader;b.lights=this.lights;b.clipping=this.clipping;a={};for(const d in this.extensions)this.extensions[d]===
!0&&(a[d]=!0);Object.keys(a).length>0&&(b.extensions=a);return b}}class sh extends jc{constructor(){super();this.isCamera=!0;this.type="Camera";this.matrixWorldInverse=new Gb;this.projectionMatrix=new Gb;this.projectionMatrixInverse=new Gb;this.coordinateSystem=2E3;this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(a,b){super.copy(a,b);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);this.projectionMatrixInverse.copy(a.projectionMatrixInverse);
this.coordinateSystem=a.coordinateSystem;return this}getWorldDirection(a){return super.getWorldDirection(a).negate()}updateMatrixWorld(a){super.updateMatrixWorld(a);this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(a,b){super.updateWorldMatrix(a,b);this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Ie=new ma,Dk=new Xa,Ek=new Xa;class Yc extends sh{constructor(a=50,b=1,d=.1,h=2E3){super();this.isPerspectiveCamera=!0;
this.type="PerspectiveCamera";this.fov=a;this.zoom=1;this.near=d;this.far=h;this.focus=10;this.aspect=b;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}copy(a,b){super.copy(a,b);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=a.view===null?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this}setFocalLength(a){a=.5*this.getFilmHeight()/a;this.fov=ye*2*Math.atan(a);
this.updateProjectionMatrix()}getFocalLength(){const a=Math.tan(je*.5*this.fov);return.5*this.getFilmHeight()/a}getEffectiveFOV(){return ye*2*Math.atan(Math.tan(je*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(a,b,d){Ie.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse);b.set(Ie.x,Ie.y).multiplyScalar(-a/Ie.z);Ie.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse);d.set(Ie.x,
Ie.y).multiplyScalar(-a/Ie.z)}getViewSize(a,b){this.getViewBounds(a,Dk,Ek);return b.subVectors(Ek,Dk)}setViewOffset(a,b,d,h,n,u){this.aspect=a/b;this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=d;this.view.offsetY=h;this.view.width=n;this.view.height=u;this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1);this.updateProjectionMatrix()}updateProjectionMatrix(){const a=
this.near;let b=a*Math.tan(je*.5*this.fov)/this.zoom,d=2*b,h=this.aspect*d,n=-.5*h;var u=this.view;if(this.view!==null&&this.view.enabled){const E=u.fullWidth,F=u.fullHeight;n+=u.offsetX*h/E;b-=u.offsetY*d/F;h*=u.width/E;d*=u.height/F}u=this.filmOffset;u!==0&&(n+=a*u/this.getFilmWidth());this.projectionMatrix.makePerspective(n,n+h,b,b-d,a,this.far,this.coordinateSystem,this.reversedDepth);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){a=super.toJSON(a);a.object.fov=this.fov;
a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;this.view!==null&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a}}class Fk extends jc{constructor(a,b,d){super();this.type="CubeCamera";this.renderTarget=d;this.coordinateSystem=null;this.activeMipmapLevel=0;d=new Yc(-90,1,a,b);d.layers=this.layers;this.add(d);d=new Yc(-90,1,a,b);d.layers=this.layers;
this.add(d);d=new Yc(-90,1,a,b);d.layers=this.layers;this.add(d);d=new Yc(-90,1,a,b);d.layers=this.layers;this.add(d);d=new Yc(-90,1,a,b);d.layers=this.layers;this.add(d);a=new Yc(-90,1,a,b);a.layers=this.layers;this.add(a)}updateCoordinateSystem(){const a=this.coordinateSystem,b=this.children.concat(),[d,h,n,u,E,F]=b;for(const H of b)this.remove(H);if(a===2E3)d.up.set(0,1,0),d.lookAt(1,0,0),h.up.set(0,1,0),h.lookAt(-1,0,0),n.up.set(0,0,-1),n.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),E.up.set(0,
1,0),E.lookAt(0,0,1),F.up.set(0,1,0),F.lookAt(0,0,-1);else if(a===2001)d.up.set(0,-1,0),d.lookAt(-1,0,0),h.up.set(0,-1,0),h.lookAt(1,0,0),n.up.set(0,0,1),n.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),E.up.set(0,-1,0),E.lookAt(0,0,1),F.up.set(0,-1,0),F.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+a);for(const H of b)this.add(H),H.updateMatrixWorld()}update(a,b){this.parent===null&&this.updateMatrixWorld();const {renderTarget:d,activeMipmapLevel:h}=
this;this.coordinateSystem!==a.coordinateSystem&&(this.coordinateSystem=a.coordinateSystem,this.updateCoordinateSystem());const [n,u,E,F,H,M]=this.children,R=a.getRenderTarget(),T=a.getActiveCubeFace(),X=a.getActiveMipmapLevel(),ea=a.xr.enabled;a.xr.enabled=!1;const aa=d.texture.generateMipmaps;d.texture.generateMipmaps=!1;a.setRenderTarget(d,0,h);a.render(b,n);a.setRenderTarget(d,1,h);a.render(b,u);a.setRenderTarget(d,2,h);a.render(b,E);a.setRenderTarget(d,3,h);a.render(b,F);a.setRenderTarget(d,
4,h);a.render(b,H);d.texture.generateMipmaps=aa;a.setRenderTarget(d,5,h);a.render(b,M);a.setRenderTarget(R,T,X);a.xr.enabled=ea;d.texture.needsPMREMUpdate=!0}}class Bg extends Cc{constructor(a=[],b=301,d,h,n,u,E,F,H,M){super(a,b,d,h,n,u,E,F,H,M);this.isCubeTexture=!0;this.flipY=!1}get images(){return this.image}set images(a){this.image=a}}class ek extends zd{constructor(a=1,b={}){super(a,a,b);this.isWebGLCubeRenderTarget=!0;a={width:a,height:a,depth:1};this.texture=new Bg([a,a,a,a,a,a]);this._setTextureOptions(b);
this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(a,b){this.texture.type=b.type;this.texture.colorSpace=b.colorSpace;this.texture.generateMipmaps=b.generateMipmaps;this.texture.minFilter=b.minFilter;this.texture.magFilter=b.magFilter;var d=new xf(5,5,5),h=new Jd({name:"CubemapFromEquirect",uniforms:J({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include \x3cbegin_vertex\x3e\n\t\t\t\t\t#include \x3cproject_vertex\x3e\n\n\t\t\t\t}\n\t\t\t",
fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include \x3ccommon\x3e\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction \x3d normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV \x3d equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor \x3d texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:1,blending:0});h.uniforms.tEquirect.value=b;d=new Kc(d,h);h=b.minFilter;b.minFilter===1008&&(b.minFilter=1006);(new Fk(1,10,this)).update(a,
d);b.minFilter=h;d.geometry.dispose();d.material.dispose();return this}clear(a,b=!0,d=!0,h=!0){const n=a.getRenderTarget();for(let u=0;u<6;u++)a.setRenderTarget(this,u),a.clear(b,d,h);a.setRenderTarget(n)}}class Of extends jc{constructor(){super();this.isGroup=!0;this.type="Group"}}const Lm={type:"move"};class th{constructor(){this._hand=this._grip=this._targetRay=null}getHandSpace(){this._hand===null&&(this._hand=new Of,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState=
{pinching:!1});return this._hand}getTargetRaySpace(){this._targetRay===null&&(this._targetRay=new Of,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ma,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ma);return this._targetRay}getGripSpace(){this._grip===null&&(this._grip=new Of,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=
new ma,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ma);return this._grip}dispatchEvent(a){this._targetRay!==null&&this._targetRay.dispatchEvent(a);this._grip!==null&&this._grip.dispatchEvent(a);this._hand!==null&&this._hand.dispatchEvent(a);return this}connect(a){if(a&&a.hand){const b=this._hand;if(b)for(const d of a.hand.values())this._getHandJoint(b,d)}this.dispatchEvent({type:"connected",data:a});return this}disconnect(a){this.dispatchEvent({type:"disconnected",data:a});this._targetRay!==
null&&(this._targetRay.visible=!1);this._grip!==null&&(this._grip.visible=!1);this._hand!==null&&(this._hand.visible=!1);return this}update(a,b,d){let h=null,n=null,u=null;const E=this._targetRay,F=this._grip,H=this._hand;if(a&&b.session.visibilityState!=="visible-blurred"){if(H&&a.hand){u=!0;for(var M of a.hand.values()){const R=b.getJointPose(M,d),T=this._getHandJoint(H,M);R!==null&&(T.matrix.fromArray(R.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=
!0,T.jointRadius=R.radius);T.visible=R!==null}M=H.joints["index-finger-tip"].position.distanceTo(H.joints["thumb-tip"].position);H.inputState.pinching&&M>.025?(H.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!H.inputState.pinching&&M<=.015&&(H.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else F!==null&&a.gripSpace&&(n=b.getPose(a.gripSpace,d),n!==null&&(F.matrix.fromArray(n.transform.matrix),
F.matrix.decompose(F.position,F.rotation,F.scale),F.matrixWorldNeedsUpdate=!0,n.linearVelocity?(F.hasLinearVelocity=!0,F.linearVelocity.copy(n.linearVelocity)):F.hasLinearVelocity=!1,n.angularVelocity?(F.hasAngularVelocity=!0,F.angularVelocity.copy(n.angularVelocity)):F.hasAngularVelocity=!1));E!==null&&(h=b.getPose(a.targetRaySpace,d),h===null&&n!==null&&(h=n),h!==null&&(E.matrix.fromArray(h.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,h.linearVelocity?
(E.hasLinearVelocity=!0,E.linearVelocity.copy(h.linearVelocity)):E.hasLinearVelocity=!1,h.angularVelocity?(E.hasAngularVelocity=!0,E.angularVelocity.copy(h.angularVelocity)):E.hasAngularVelocity=!1,this.dispatchEvent(Lm)))}E!==null&&(E.visible=h!==null);F!==null&&(F.visible=n!==null);H!==null&&(H.visible=u!==null);return this}_getHandJoint(a,b){if(a.joints[b.jointName]===void 0){const d=new Of;d.matrixAutoUpdate=!1;d.visible=!1;a.joints[b.jointName]=d;a.add(d)}return a.joints[b.jointName]}}class Ui{constructor(a,
b=2.5E-4){this.isFogExp2=!0;this.name="";this.color=new pb(a);this.density=b}clone(){return new Ui(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Vi{constructor(a,b=1,d=1E3){this.isFog=!0;this.name="";this.color=new pb(a);this.near=b;this.far=d}clone(){return new Vi(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Gk extends jc{constructor(){super();
this.isScene=!0;this.type="Scene";this.fog=this.environment=this.background=null;this.backgroundBlurriness=0;this.backgroundIntensity=1;this.backgroundRotation=new Cd;this.environmentIntensity=1;this.environmentRotation=new Cd;this.overrideMaterial=null;typeof __THREE_DEVTOOLS__!=="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(a,b){super.copy(a,b);a.background!==null&&(this.background=a.background.clone());a.environment!==null&&(this.environment=a.environment.clone());
a.fog!==null&&(this.fog=a.fog.clone());this.backgroundBlurriness=a.backgroundBlurriness;this.backgroundIntensity=a.backgroundIntensity;this.backgroundRotation.copy(a.backgroundRotation);this.environmentIntensity=a.environmentIntensity;this.environmentRotation.copy(a.environmentRotation);a.overrideMaterial!==null&&(this.overrideMaterial=a.overrideMaterial.clone());this.matrixAutoUpdate=a.matrixAutoUpdate;return this}toJSON(a){a=super.toJSON(a);this.fog!==null&&(a.object.fog=this.fog.toJSON());this.backgroundBlurriness>
0&&(a.object.backgroundBlurriness=this.backgroundBlurriness);this.backgroundIntensity!==1&&(a.object.backgroundIntensity=this.backgroundIntensity);a.object.backgroundRotation=this.backgroundRotation.toArray();this.environmentIntensity!==1&&(a.object.environmentIntensity=this.environmentIntensity);a.object.environmentRotation=this.environmentRotation.toArray();return a}}class uh{constructor(a,b){this.isInterleavedBuffer=!0;this.array=a;this.stride=b;this.count=a!==void 0?a.length/b:0;this.usage=35044;
this.updateRanges=[];this.version=0;this.uuid=x()}onUploadCallback(){}set needsUpdate(a){a===!0&&this.version++}setUsage(a){this.usage=a;return this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){this.array=new a.array.constructor(a.array);this.count=a.count;this.stride=a.stride;this.usage=a.usage;return this}copyAt(a,b,d){a*=this.stride;d*=b.stride;for(let h=0,n=this.stride;h<n;h++)this.array[a+h]=b.array[d+h];return this}set(a,
b=0){this.array.set(a,b);return this}clone(a){a.arrayBuffers===void 0&&(a.arrayBuffers={});this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=x());a.arrayBuffers[this.array.buffer._uuid]===void 0&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);a=new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]);a=new this.constructor(a,this.stride);a.setUsage(this.usage);return a}onUpload(a){this.onUploadCallback=a;return this}toJSON(a){a.arrayBuffers===void 0&&(a.arrayBuffers=
{});this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=x());a.arrayBuffers[this.array.buffer._uuid]===void 0&&(a.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer)));return{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const id=new ma;class Pf{constructor(a,b,d,h=!1){this.isInterleavedBufferAttribute=!0;this.name="";this.data=a;this.itemSize=b;this.offset=d;this.normalized=h}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(a){this.data.needsUpdate=
a}applyMatrix4(a){for(let b=0,d=this.data.count;b<d;b++)id.fromBufferAttribute(this,b),id.applyMatrix4(a),this.setXYZ(b,id.x,id.y,id.z);return this}applyNormalMatrix(a){for(let b=0,d=this.count;b<d;b++)id.fromBufferAttribute(this,b),id.applyNormalMatrix(a),this.setXYZ(b,id.x,id.y,id.z);return this}transformDirection(a){for(let b=0,d=this.count;b<d;b++)id.fromBufferAttribute(this,b),id.transformDirection(a),this.setXYZ(b,id.x,id.y,id.z);return this}getComponent(a,b){a=this.array[a*this.data.stride+
this.offset+b];this.normalized&&(a=f(a,this.array));return a}setComponent(a,b,d){this.normalized&&(d=k(d,this.array));this.data.array[a*this.data.stride+this.offset+b]=d;return this}setX(a,b){this.normalized&&(b=k(b,this.array));this.data.array[a*this.data.stride+this.offset]=b;return this}setY(a,b){this.normalized&&(b=k(b,this.array));this.data.array[a*this.data.stride+this.offset+1]=b;return this}setZ(a,b){this.normalized&&(b=k(b,this.array));this.data.array[a*this.data.stride+this.offset+2]=b;
return this}setW(a,b){this.normalized&&(b=k(b,this.array));this.data.array[a*this.data.stride+this.offset+3]=b;return this}getX(a){a=this.data.array[a*this.data.stride+this.offset];this.normalized&&(a=f(a,this.array));return a}getY(a){a=this.data.array[a*this.data.stride+this.offset+1];this.normalized&&(a=f(a,this.array));return a}getZ(a){a=this.data.array[a*this.data.stride+this.offset+2];this.normalized&&(a=f(a,this.array));return a}getW(a){a=this.data.array[a*this.data.stride+this.offset+3];this.normalized&&
(a=f(a,this.array));return a}setXY(a,b,d){a=a*this.data.stride+this.offset;this.normalized&&(b=k(b,this.array),d=k(d,this.array));this.data.array[a+0]=b;this.data.array[a+1]=d;return this}setXYZ(a,b,d,h){a=a*this.data.stride+this.offset;this.normalized&&(b=k(b,this.array),d=k(d,this.array),h=k(h,this.array));this.data.array[a+0]=b;this.data.array[a+1]=d;this.data.array[a+2]=h;return this}setXYZW(a,b,d,h,n){a=a*this.data.stride+this.offset;this.normalized&&(b=k(b,this.array),d=k(d,this.array),h=k(h,
this.array),n=k(n,this.array));this.data.array[a+0]=b;this.data.array[a+1]=d;this.data.array[a+2]=h;this.data.array[a+3]=n;return this}clone(a){if(a===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");a=[];for(let b=0;b<this.count;b++){const d=b*this.data.stride+this.offset;for(let h=0;h<this.itemSize;h++)a.push(this.data.array[d+h])}return new sc(new this.array.constructor(a),this.itemSize,this.normalized)}a.interleavedBuffers===
void 0&&(a.interleavedBuffers={});a.interleavedBuffers[this.data.uuid]===void 0&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a));return new Pf(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(a){if(a===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");a=[];for(let b=0;b<this.count;b++){const d=b*this.data.stride+this.offset;for(let h=0;h<this.itemSize;h++)a.push(this.data.array[d+
h])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}a.interleavedBuffers===void 0&&(a.interleavedBuffers={});a.interleavedBuffers[this.data.uuid]===void 0&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a));return{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Wi extends fd{constructor(a){super();this.isSpriteMaterial=!0;this.type="SpriteMaterial";this.color=
new pb(16777215);this.alphaMap=this.map=null;this.rotation=0;this.fog=this.transparent=this.sizeAttenuation=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.alphaMap=a.alphaMap;this.rotation=a.rotation;this.sizeAttenuation=a.sizeAttenuation;this.fog=a.fog;return this}}let Qf;const Cg=new ma,Rf=new ma,Sf=new ma,wf=new Xa,ng=new Xa,ck=new Gb,vh=new ma,Dg=new ma,wh=new ma,Hk=new Xa,Xi=new Xa,Ik=new Xa;class Jk extends jc{constructor(a=new Wi){super();this.isSprite=
!0;this.type="Sprite";if(Qf===void 0){Qf=new Vb;var b=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);b=new uh(b,5);Qf.setIndex([0,1,2,0,2,3]);Qf.setAttribute("position",new Pf(b,3,0,!1));Qf.setAttribute("uv",new Pf(b,2,3,!1))}this.geometry=Qf;this.material=a;this.center=new Xa(.5,.5);this.count=1}raycast(a,b){a.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.');Rf.setFromMatrixScale(this.matrixWorld);ck.copy(a.camera.matrixWorld);
this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld);Sf.setFromMatrixPosition(this.modelViewMatrix);a.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Rf.multiplyScalar(-Sf.z);var d=this.material.rotation;let h;if(d!==0){h=Math.cos(d);var n=Math.sin(d)}d=this.center;Y(vh.set(-.5,-.5,0),Sf,d,Rf,n,h);Y(Dg.set(.5,-.5,0),Sf,d,Rf,n,h);Y(wh.set(.5,.5,0),Sf,d,Rf,n,h);Hk.set(0,0);Xi.set(1,0);Ik.set(1,1);let u=a.ray.intersectTriangle(vh,Dg,wh,!1,Cg);if(u===null&&
(Y(Dg.set(-.5,.5,0),Sf,d,Rf,n,h),Xi.set(0,1),u=a.ray.intersectTriangle(vh,wh,Dg,!1,Cg),u===null))return;n=a.ray.origin.distanceTo(Cg);n<a.near||n>a.far||b.push({distance:n,point:Cg.clone(),uv:ud.getInterpolation(Cg,vh,Dg,wh,Hk,Xi,Ik,new Xa),face:null,object:this})}copy(a,b){super.copy(a,b);a.center!==void 0&&this.center.copy(a.center);this.material=a.material;return this}}const xh=new ma,Kk=new ma;class Lk extends jc{constructor(){super();this.isLOD=!0;this._currentLevel=0;this.type="LOD";Object.defineProperties(this,
{levels:{enumerable:!0,value:[]}});this.autoUpdate=!0}copy(a){super.copy(a,!1);const b=a.levels;for(let d=0,h=b.length;d<h;d++){const n=b[d];this.addLevel(n.object.clone(),n.distance,n.hysteresis)}this.autoUpdate=a.autoUpdate;return this}addLevel(a,b=0,d=0){b=Math.abs(b);const h=this.levels;let n;for(n=0;n<h.length&&!(b<h[n].distance);n++);h.splice(n,0,{distance:b,hysteresis:d,object:a});this.add(a);return this}removeLevel(a){const b=this.levels;for(let d=0;d<b.length;d++)if(b[d].distance===a)return a=
b.splice(d,1),this.remove(a[0].object),!0;return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(a){const b=this.levels;if(b.length>0){let d,h;d=1;for(h=b.length;d<h;d++){let n=b[d].distance;b[d].object.visible&&(n-=n*b[d].hysteresis);if(a<n)break}return b[d-1].object}return null}raycast(a,b){if(this.levels.length>0){xh.setFromMatrixPosition(this.matrixWorld);const d=a.ray.origin.distanceTo(xh);this.getObjectForDistance(d).raycast(a,b)}}update(a){const b=this.levels;if(b.length>
1){xh.setFromMatrixPosition(a.matrixWorld);Kk.setFromMatrixPosition(this.matrixWorld);a=xh.distanceTo(Kk)/a.zoom;b[0].object.visible=!0;let d,h;d=1;for(h=b.length;d<h;d++){let n=b[d].distance;b[d].object.visible&&(n-=n*b[d].hysteresis);if(a>=n)b[d-1].object.visible=!1,b[d].object.visible=!0;else break}for(this._currentLevel=d-1;d<h;d++)b[d].object.visible=!1}}toJSON(a){a=super.toJSON(a);this.autoUpdate===!1&&(a.object.autoUpdate=!1);a.object.levels=[];const b=this.levels;for(let d=0,h=b.length;d<
h;d++){const n=b[d];a.object.levels.push({object:n.object.uuid,distance:n.distance,hysteresis:n.hysteresis})}return a}}const Mk=new ma,Nk=new ec,Ok=new ec,Mm=new ma,Pk=new Gb,yh=new ma,Yi=new Qc,Qk=new Gb,Zi=new Hf;class Rk extends Kc{constructor(a,b){super(a,b);this.isSkinnedMesh=!0;this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new Gb;this.bindMatrixInverse=new Gb;this.boundingSphere=this.boundingBox=null}computeBoundingBox(){var a=this.geometry;this.boundingBox===null&&(this.boundingBox=
new Sc);this.boundingBox.makeEmpty();a=a.getAttribute("position");for(let b=0;b<a.count;b++)this.getVertexPosition(b,yh),this.boundingBox.expandByPoint(yh)}computeBoundingSphere(){var a=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Qc);this.boundingSphere.makeEmpty();a=a.getAttribute("position");for(let b=0;b<a.count;b++)this.getVertexPosition(b,yh),this.boundingSphere.expandByPoint(yh)}copy(a,b){super.copy(a,b);this.bindMode=a.bindMode;this.bindMatrix.copy(a.bindMatrix);this.bindMatrixInverse.copy(a.bindMatrixInverse);
this.skeleton=a.skeleton;a.boundingBox!==null&&(this.boundingBox=a.boundingBox.clone());a.boundingSphere!==null&&(this.boundingSphere=a.boundingSphere.clone());return this}raycast(a,b){const d=this.matrixWorld;this.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Yi.copy(this.boundingSphere),Yi.applyMatrix4(d),a.ray.intersectsSphere(Yi)!==!1&&(Qk.copy(d).invert(),Zi.copy(a.ray).applyMatrix4(Qk),this.boundingBox!==null&&Zi.intersectsBox(this.boundingBox)===!1||this._computeIntersections(a,
b,Zi)))}getVertexPosition(a,b){super.getVertexPosition(a,b);this.applyBoneTransform(a,b);return b}bind(a,b){this.skeleton=a;b===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.copy(b).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const a=new ec,b=this.geometry.attributes.skinWeight;for(let d=0,h=b.count;d<h;d++){a.fromBufferAttribute(b,d);const n=1/a.manhattanLength();n!==Infinity?a.multiplyScalar(n):
a.set(1,0,0,0);b.setXYZW(d,a.x,a.y,a.z,a.w)}}updateMatrixWorld(a){super.updateMatrixWorld(a);this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(a,b){const d=this.skeleton;var h=this.geometry;Nk.fromBufferAttribute(h.attributes.skinIndex,a);Ok.fromBufferAttribute(h.attributes.skinWeight,a);Mk.copy(b).applyMatrix4(this.bindMatrix);
b.set(0,0,0);for(a=0;a<4;a++)if(h=Ok.getComponent(a),h!==0){const n=Nk.getComponent(a);Pk.multiplyMatrices(d.bones[n].matrixWorld,d.boneInverses[n]);b.addScaledVector(Mm.copy(Mk).applyMatrix4(Pk),h)}return b.applyMatrix4(this.bindMatrixInverse)}}class $i extends jc{constructor(){super();this.isBone=!0;this.type="Bone"}}class $d extends Cc{constructor(a=null,b=1,d=1,h,n,u,E,F,H=1003,M=1003,R,T){super(null,u,E,F,H,M,h,n,R,T);this.isDataTexture=!0;this.image={data:a,width:b,height:d};this.flipY=this.generateMipmaps=
!1;this.unpackAlignment=1}}const Sk=new Gb,Nm=new Gb;class aj{constructor(a=[],b=[]){this.uuid=x();this.bones=a.slice(0);this.boneInverses=b;this.boneTexture=this.boneMatrices=null;this.init()}init(){const a=this.bones,b=this.boneInverses;this.boneMatrices=new Float32Array(a.length*16);if(b.length===0)this.calculateInverses();else if(a.length!==b.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.");this.boneInverses=[];for(let d=0,h=this.bones.length;d<
h;d++)this.boneInverses.push(new Gb)}}calculateInverses(){this.boneInverses.length=0;for(let a=0,b=this.bones.length;a<b;a++){const d=new Gb;this.bones[a]&&d.copy(this.bones[a].matrixWorld).invert();this.boneInverses.push(d)}}pose(){for(let b=0,d=this.bones.length;b<d;b++){var a=this.bones[b];a&&a.matrixWorld.copy(this.boneInverses[b]).invert()}for(let b=0,d=this.bones.length;b<d;b++)if(a=this.bones[b])a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):
a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)}update(){const a=this.bones,b=this.boneInverses,d=this.boneMatrices,h=this.boneTexture;for(let n=0,u=a.length;n<u;n++)Sk.multiplyMatrices(a[n]?a[n].matrixWorld:Nm,b[n]),Sk.toArray(d,n*16);h!==null&&(h.needsUpdate=!0)}clone(){return new aj(this.bones,this.boneInverses)}computeBoneTexture(){var a=Math.sqrt(this.bones.length*4);a=Math.ceil(a/4)*4;a=Math.max(a,4);const b=new Float32Array(a*a*4);b.set(this.boneMatrices);a=
new $d(b,a,a,1023,1015);a.needsUpdate=!0;this.boneMatrices=b;this.boneTexture=a;return this}getBoneByName(a){for(let b=0,d=this.bones.length;b<d;b++){const h=this.bones[b];if(h.name===a)return h}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(a,b){this.uuid=a.uuid;for(let d=0,h=a.bones.length;d<h;d++){const n=a.bones[d];let u=b[n];u===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),u=new $i);this.bones.push(u);this.boneInverses.push((new Gb).fromArray(a.boneInverses[d]))}this.init();
return this}toJSON(){const a={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};a.uuid=this.uuid;const b=this.bones,d=this.boneInverses;for(let h=0,n=b.length;h<n;h++)a.bones.push(b[h].uuid),a.boneInverses.push(d[h].toArray());return a}}class Tf extends sc{constructor(a,b,d,h=1){super(a,b,d);this.isInstancedBufferAttribute=!0;this.meshPerAttribute=h}copy(a){super.copy(a);this.meshPerAttribute=a.meshPerAttribute;return this}toJSON(){const a=super.toJSON();
a.meshPerAttribute=this.meshPerAttribute;a.isInstancedBufferAttribute=!0;return a}}const Uf=new Gb,Tk=new Gb,zh=[],Uk=new Sc,Om=new Gb,Eg=new Kc,Fg=new Qc;class Vk extends Kc{constructor(a,b,d){super(a,b);this.isInstancedMesh=!0;this.instanceMatrix=new Tf(new Float32Array(d*16),16);this.morphTexture=this.instanceColor=null;this.count=d;this.boundingSphere=this.boundingBox=null;for(a=0;a<d;a++)this.setMatrixAt(a,Om)}computeBoundingBox(){const a=this.geometry,b=this.count;this.boundingBox===null&&(this.boundingBox=
new Sc);a.boundingBox===null&&a.computeBoundingBox();this.boundingBox.makeEmpty();for(let d=0;d<b;d++)this.getMatrixAt(d,Uf),Uk.copy(a.boundingBox).applyMatrix4(Uf),this.boundingBox.union(Uk)}computeBoundingSphere(){const a=this.geometry,b=this.count;this.boundingSphere===null&&(this.boundingSphere=new Qc);a.boundingSphere===null&&a.computeBoundingSphere();this.boundingSphere.makeEmpty();for(let d=0;d<b;d++)this.getMatrixAt(d,Uf),Fg.copy(a.boundingSphere).applyMatrix4(Uf),this.boundingSphere.union(Fg)}copy(a,
b){super.copy(a,b);this.instanceMatrix.copy(a.instanceMatrix);a.morphTexture!==null&&(this.morphTexture=a.morphTexture.clone());a.instanceColor!==null&&(this.instanceColor=a.instanceColor.clone());this.count=a.count;a.boundingBox!==null&&(this.boundingBox=a.boundingBox.clone());a.boundingSphere!==null&&(this.boundingSphere=a.boundingSphere.clone());return this}getColorAt(a,b){b.fromArray(this.instanceColor.array,a*3)}getMatrixAt(a,b){b.fromArray(this.instanceMatrix.array,a*16)}getMorphAt(a,b){b=b.morphTargetInfluences;
const d=this.morphTexture.source.data.data;a=a*(b.length+1)+1;for(let h=0;h<b.length;h++)b[h]=d[a+h]}raycast(a,b){const d=this.matrixWorld,h=this.count;Eg.geometry=this.geometry;Eg.material=this.material;if(Eg.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Fg.copy(this.boundingSphere),Fg.applyMatrix4(d),a.ray.intersectsSphere(Fg)!==!1))for(let n=0;n<h;n++){this.getMatrixAt(n,Uf);Tk.multiplyMatrices(d,Uf);Eg.matrixWorld=Tk;Eg.raycast(a,zh);for(let u=0,E=zh.length;u<E;u++){const F=
zh[u];F.instanceId=n;F.object=this;b.push(F)}zh.length=0}}setColorAt(a,b){this.instanceColor===null&&(this.instanceColor=new Tf((new Float32Array(this.instanceMatrix.count*3)).fill(1),3));b.toArray(this.instanceColor.array,a*3)}setMatrixAt(a,b){b.toArray(this.instanceMatrix.array,a*16)}setMorphAt(a,b){b=b.morphTargetInfluences;const d=b.length+1;this.morphTexture===null&&(this.morphTexture=new $d(new Float32Array(d*this.count),d,this.count,1028,1015));const h=this.morphTexture.source.data.data;let n=
0;for(let u=0;u<b.length;u++)n+=b[u];a*=d;h[a]=this.geometry.morphTargetsRelative?1:1-n;h.set(b,a+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"});this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const bj=new ma,Pm=new ma,Qm=new Lb;class xe{constructor(a=new ma(1,0,0),b=0){this.isPlane=!0;this.normal=a;this.constant=b}set(a,b){this.normal.copy(a);this.constant=b;return this}setComponents(a,b,d,h){this.normal.set(a,b,d);this.constant=h;return this}setFromNormalAndCoplanarPoint(a,
b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this}setFromCoplanarPoints(a,b,d){b=bj.subVectors(d,b).cross(Pm.subVectors(a,b)).normalize();this.setFromNormalAndCoplanarPoint(b,a);return this}copy(a){this.normal.copy(a.normal);this.constant=a.constant;return this}normalize(){const a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this}negate(){this.constant*=-1;this.normal.negate();return this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-
a.radius}projectPoint(a,b){return b.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,b){const d=a.delta(bj);var h=this.normal.dot(d);if(h===0)return this.distanceToPoint(a.start)===0?b.copy(a.start):null;h=-(a.start.dot(this.normal)+this.constant)/h;return h<0||h>1?null:b.copy(a.start).addScaledVector(d,h)}intersectsLine(a){const b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return b<0&&a>0||a<0&&b>0}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,
b){b=b||Qm.getNormalMatrix(a);a=this.coplanarPoint(bj).applyMatrix4(a);b=this.normal.applyMatrix3(b).normalize();this.constant=-a.dot(b);return this}translate(a){this.constant-=a.dot(this.normal);return this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const bf=new Qc,Rm=new Xa(.5,.5),Ah=new ma;class Bf{constructor(a=new xe,b=new xe,d=new xe,h=new xe,n=new xe,u=new xe){this.planes=[a,b,d,h,n,u]}set(a,b,d,h,n,u){const E=
this.planes;E[0].copy(a);E[1].copy(b);E[2].copy(d);E[3].copy(h);E[4].copy(n);E[5].copy(u);return this}copy(a){const b=this.planes;for(let d=0;d<6;d++)b[d].copy(a.planes[d]);return this}setFromProjectionMatrix(a,b=2E3,d=!1){const h=this.planes;var n=a.elements;a=n[0];const u=n[1],E=n[2],F=n[3],H=n[4],M=n[5],R=n[6],T=n[7],X=n[8],ea=n[9],aa=n[10],da=n[11],U=n[12],ka=n[13],qa=n[14];n=n[15];h[0].setComponents(F-a,T-H,da-X,n-U).normalize();h[1].setComponents(F+a,T+H,da+X,n+U).normalize();h[2].setComponents(F+
u,T+M,da+ea,n+ka).normalize();h[3].setComponents(F-u,T-M,da-ea,n-ka).normalize();if(d)h[4].setComponents(E,R,aa,qa).normalize(),h[5].setComponents(F-E,T-R,da-aa,n-qa).normalize();else if(h[4].setComponents(F-E,T-R,da-aa,n-qa).normalize(),b===2E3)h[5].setComponents(F+E,T+R,da+aa,n+qa).normalize();else if(b===2001)h[5].setComponents(E,R,aa,qa).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+b);return this}intersectsObject(a){if(a.boundingSphere!==
void 0)a.boundingSphere===null&&a.computeBoundingSphere(),bf.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{const b=a.geometry;b.boundingSphere===null&&b.computeBoundingSphere();bf.copy(b.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(bf)}intersectsSprite(a){bf.center.set(0,0,0);const b=Rm.distanceTo(a.center);bf.radius=.7071067811865476+b;bf.applyMatrix4(a.matrixWorld);return this.intersectsSphere(bf)}intersectsSphere(a){const b=this.planes,d=a.center;a=-a.radius;
for(let h=0;h<6;h++)if(b[h].distanceToPoint(d)<a)return!1;return!0}intersectsBox(a){const b=this.planes;for(let d=0;d<6;d++){const h=b[d];Ah.x=h.normal.x>0?a.max.x:a.min.x;Ah.y=h.normal.y>0?a.max.y:a.min.y;Ah.z=h.normal.z>0?a.max.z:a.min.z;if(h.distanceToPoint(Ah)<0)return!1}return!0}containsPoint(a){const b=this.planes;for(let d=0;d<6;d++)if(b[d].distanceToPoint(a)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const ae=new Gb,be=new Bf;class cj{constructor(){this.coordinateSystem=
2E3}intersectsObject(a,b){if(!b.isArrayCamera||b.cameras.length===0)return!1;for(let d=0;d<b.cameras.length;d++){const h=b.cameras[d];ae.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse);be.setFromProjectionMatrix(ae,h.coordinateSystem,h.reversedDepth);if(be.intersectsObject(a))return!0}return!1}intersectsSprite(a,b){if(!b||!b.cameras||b.cameras.length===0)return!1;for(let d=0;d<b.cameras.length;d++){const h=b.cameras[d];ae.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse);be.setFromProjectionMatrix(ae,
h.coordinateSystem,h.reversedDepth);if(be.intersectsSprite(a))return!0}return!1}intersectsSphere(a,b){if(!b||!b.cameras||b.cameras.length===0)return!1;for(let d=0;d<b.cameras.length;d++){const h=b.cameras[d];ae.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse);be.setFromProjectionMatrix(ae,h.coordinateSystem,h.reversedDepth);if(be.intersectsSphere(a))return!0}return!1}intersectsBox(a,b){if(!b||!b.cameras||b.cameras.length===0)return!1;for(let d=0;d<b.cameras.length;d++){const h=b.cameras[d];
ae.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse);be.setFromProjectionMatrix(ae,h.coordinateSystem,h.reversedDepth);if(be.intersectsBox(a))return!0}return!1}containsPoint(a,b){if(!b||!b.cameras||b.cameras.length===0)return!1;for(let d=0;d<b.cameras.length;d++){const h=b.cameras[d];ae.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse);be.setFromProjectionMatrix(ae,h.coordinateSystem,h.reversedDepth);if(be.containsPoint(a))return!0}return!1}clone(){return new cj}}class Sm{constructor(){this.index=
0;this.pool=[];this.list=[]}push(a,b,d,h){var n=this.pool;const u=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1,index:-1});n=n[this.index];u.push(n);this.index++;n.start=a;n.count=b;n.z=d;n.index=h}reset(){this.index=this.list.length=0}}const od=new Gb,Tm=new pb(1,1,1),Wk=new Bf,Um=new cj,Bh=new Sc,cf=new Qc,Gg=new ma,Xk=new ma,Vm=new ma,dj=new Sm,gd=new Kc,Ch=[];class Yk extends Kc{constructor(a,b,d=b*2,h){super(new Vb,h);this.sortObjects=this.perObjectFrustumCulled=this.isBatchedMesh=
!0;this.customSort=this.boundingSphere=this.boundingBox=null;this._instanceInfo=[];this._geometryInfo=[];this._availableInstanceIds=[];this._availableGeometryIds=[];this._geometryCount=this._nextVertexStart=this._nextIndexStart=0;this._visibilityChanged=!0;this._geometryInitialized=!1;this._maxInstanceCount=a;this._maxVertexCount=b;this._maxIndexCount=d;this._multiDrawCounts=new Int32Array(a);this._multiDrawStarts=new Int32Array(a);this._multiDrawCount=0;this._colorsTexture=this._indirectTexture=
this._matricesTexture=this._multiDrawInstances=null;this._initMatricesTexture();this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let a=Math.sqrt(this._maxInstanceCount*4);a=Math.ceil(a/4)*4;a=Math.max(a,4);const b=
new Float32Array(a*a*4);this._matricesTexture=new $d(b,a,a,1023,1015)}_initIndirectTexture(){let a=Math.sqrt(this._maxInstanceCount);a=Math.ceil(a);const b=new Uint32Array(a*a);this._indirectTexture=new $d(b,a,a,1029,1014)}_initColorsTexture(){var a=Math.sqrt(this._maxInstanceCount);a=Math.ceil(a);const b=(new Float32Array(a*a*4)).fill(1);a=new $d(b,a,a,1023,1015);a.colorSpace=$b.workingColorSpace;this._colorsTexture=a}_initializeGeometry(a){const b=this.geometry,d=this._maxVertexCount,h=this._maxIndexCount;
if(this._geometryInitialized===!1){for(const u in a.attributes){var n=a.getAttribute(u);const {array:E,itemSize:F,normalized:H}=n;n=new E.constructor(d*F);n=new sc(n,F,H);b.setAttribute(u,n)}a.getIndex()!==null&&(a=d>65535?new Uint32Array(h):new Uint16Array(h),b.setIndex(new sc(a,1)));this._geometryInitialized=!0}}_validateGeometry(a){const b=this.geometry;if(!!a.getIndex()!==!!b.getIndex())throw Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const d in b.attributes){if(!a.hasAttribute(d))throw Error(`THREE.BatchedMesh: Added geometry missing "${d}". All geometries must have consistent attributes.`);
const h=a.getAttribute(d),n=b.getAttribute(d);if(h.itemSize!==n.itemSize||h.normalized!==n.normalized)throw Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.");}}validateInstanceId(a){const b=this._instanceInfo;if(a<0||a>=b.length||b[a].active===!1)throw Error(`THREE.BatchedMesh: Invalid instanceId ${a}. Instance is either out of range or has been deleted.`);}validateGeometryId(a){const b=this._geometryInfo;if(a<0||a>=b.length||b[a].active===!1)throw Error(`THREE.BatchedMesh: Invalid geometryId ${a}. Geometry is either out of range or has been deleted.`);
}setCustomSort(a){this.customSort=a;return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Sc);const a=this.boundingBox,b=this._instanceInfo;a.makeEmpty();for(let d=0,h=b.length;d<h;d++){if(b[d].active===!1)continue;const n=b[d].geometryIndex;this.getMatrixAt(d,od);this.getBoundingBoxAt(n,Bh).applyMatrix4(od);a.union(Bh)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qc);const a=this.boundingSphere,b=this._instanceInfo;a.makeEmpty();for(let d=
0,h=b.length;d<h;d++){if(b[d].active===!1)continue;const n=b[d].geometryIndex;this.getMatrixAt(d,od);this.getBoundingSphereAt(n,cf).applyMatrix4(od);a.union(cf)}}addInstance(a){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw Error("THREE.BatchedMesh: Maximum item count reached.");var b={visible:!0,active:!0,geometryIndex:a};this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(S),a=this._availableInstanceIds.shift(),this._instanceInfo[a]=
b):(a=this._instanceInfo.length,this._instanceInfo.push(b));b=this._matricesTexture;od.identity().toArray(b.image.data,a*16);b.needsUpdate=!0;if(b=this._colorsTexture)Tm.toArray(b.image.data,a*4),b.needsUpdate=!0;this._visibilityChanged=!0;return a}addGeometry(a,b=-1,d=-1){this._initializeGeometry(a);this._validateGeometry(a);const h={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},
n=this._geometryInfo;h.vertexStart=this._nextVertexStart;h.reservedVertexCount=b===-1?a.getAttribute("position").count:b;b=a.getIndex();b!==null&&(h.indexStart=this._nextIndexStart,h.reservedIndexCount=d===-1?b.count:d);if(h.indexStart!==-1&&h.indexStart+h.reservedIndexCount>this._maxIndexCount||h.vertexStart+h.reservedVertexCount>this._maxVertexCount)throw Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(S),
d=this._availableGeometryIds.shift(),n[d]=h):(d=this._geometryCount,this._geometryCount++,n.push(h));this.setGeometryAt(d,a);this._nextIndexStart=h.indexStart+h.reservedIndexCount;this._nextVertexStart=h.vertexStart+h.reservedVertexCount;return d}setGeometryAt(a,b){if(a>=this._geometryCount)throw Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(b);var d=this.geometry;const h=d.getIndex()!==null,n=d.getIndex(),u=b.getIndex(),E=this._geometryInfo[a];if(h&&u.count>E.reservedIndexCount||
b.attributes.position.count>E.reservedVertexCount)throw Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const F=E.vertexStart;var H=E.reservedVertexCount;E.vertexCount=b.getAttribute("position").count;for(var M in d.attributes){var R=b.getAttribute(M);const T=d.getAttribute(M);xa(R,T,F);const X=R.itemSize;for(let ea=R.count,aa=H;ea<aa;ea++){R=F+ea;for(let da=0;da<X;da++)T.setComponent(R,da,0)}T.needsUpdate=!0;T.addUpdateRange(F*X,H*X)}if(h){d=E.indexStart;H=E.reservedIndexCount;
E.indexCount=b.getIndex().count;for(M=0;M<u.count;M++)n.setX(d+M,F+u.getX(M));for(let T=u.count,X=H;T<X;T++)n.setX(d+T,F);n.needsUpdate=!0;n.addUpdateRange(d,E.reservedIndexCount)}E.start=h?E.indexStart:E.vertexStart;E.count=h?E.indexCount:E.vertexCount;E.boundingBox=null;b.boundingBox!==null&&(E.boundingBox=b.boundingBox.clone());E.boundingSphere=null;b.boundingSphere!==null&&(E.boundingSphere=b.boundingSphere.clone());this._visibilityChanged=!0;return a}deleteGeometry(a){const b=this._geometryInfo;
if(a>=b.length||b[a].active===!1)return this;const d=this._instanceInfo;for(let h=0,n=d.length;h<n;h++)d[h].active&&d[h].geometryIndex===a&&this.deleteInstance(h);b[a].active=!1;this._availableGeometryIds.push(a);this._visibilityChanged=!0;return this}deleteInstance(a){this.validateInstanceId(a);this._instanceInfo[a].active=!1;this._availableInstanceIds.push(a);this._visibilityChanged=!0;return this}optimize(){let a=0,b=0;const d=this._geometryInfo,h=d.map((F,H)=>H).sort((F,H)=>d[F].vertexStart-d[H].vertexStart),
n=this.geometry;for(let F=0,H=d.length;F<H;F++){const M=d[h[F]];if(M.active!==!1){if(n.index!==null){if(M.indexStart!==b){const {indexStart:R,vertexStart:T,reservedIndexCount:X}=M;var u=n.index,E=u.array;const ea=a-T;for(let aa=R;aa<R+X;aa++)E[aa]+=ea;u.array.copyWithin(b,R,R+X);u.addUpdateRange(b,X);M.indexStart=b}b+=M.reservedIndexCount}if(M.vertexStart!==a){const {vertexStart:R,reservedVertexCount:T}=M;u=n.attributes;for(const X in u){E=u[X];const {array:ea,itemSize:aa}=E;ea.copyWithin(a*aa,R*
aa,(R+T)*aa);E.addUpdateRange(a*aa,T*aa)}M.vertexStart=a}a+=M.reservedVertexCount;M.start=n.index?M.indexStart:M.vertexStart;this._nextIndexStart=n.index?M.indexStart+M.reservedIndexCount:0;this._nextVertexStart=M.vertexStart+M.reservedVertexCount}}return this}getBoundingBoxAt(a,b){if(a>=this._geometryCount)return null;var d=this.geometry;a=this._geometryInfo[a];if(a.boundingBox===null){const h=new Sc,n=d.index;d=d.attributes.position;for(let u=a.start,E=a.start+a.count;u<E;u++){let F=u;n&&(F=n.getX(F));
h.expandByPoint(Gg.fromBufferAttribute(d,F))}a.boundingBox=h}b.copy(a.boundingBox);return b}getBoundingSphereAt(a,b){if(a>=this._geometryCount)return null;var d=this.geometry;const h=this._geometryInfo[a];if(h.boundingSphere===null){const n=new Qc;this.getBoundingBoxAt(a,Bh);Bh.getCenter(n.center);a=d.index;d=d.attributes.position;let u=0;for(let E=h.start,F=h.start+h.count;E<F;E++){let H=E;a&&(H=a.getX(H));Gg.fromBufferAttribute(d,H);u=Math.max(u,n.center.distanceToSquared(Gg))}n.radius=Math.sqrt(u);
h.boundingSphere=n}b.copy(h.boundingSphere);return b}setMatrixAt(a,b){this.validateInstanceId(a);const d=this._matricesTexture;b.toArray(this._matricesTexture.image.data,a*16);d.needsUpdate=!0;return this}getMatrixAt(a,b){this.validateInstanceId(a);return b.fromArray(this._matricesTexture.image.data,a*16)}setColorAt(a,b){this.validateInstanceId(a);this._colorsTexture===null&&this._initColorsTexture();b.toArray(this._colorsTexture.image.data,a*4);this._colorsTexture.needsUpdate=!0;return this}getColorAt(a,
b){this.validateInstanceId(a);return b.fromArray(this._colorsTexture.image.data,a*4)}setVisibleAt(a,b){this.validateInstanceId(a);if(this._instanceInfo[a].visible===b)return this;this._instanceInfo[a].visible=b;this._visibilityChanged=!0;return this}getVisibleAt(a){this.validateInstanceId(a);return this._instanceInfo[a].visible}setGeometryIdAt(a,b){this.validateInstanceId(a);this.validateGeometryId(b);this._instanceInfo[a].geometryIndex=b;return this}getGeometryIdAt(a){this.validateInstanceId(a);
return this._instanceInfo[a].geometryIndex}getGeometryRangeAt(a,b={}){this.validateGeometryId(a);a=this._geometryInfo[a];b.vertexStart=a.vertexStart;b.vertexCount=a.vertexCount;b.reservedVertexCount=a.reservedVertexCount;b.indexStart=a.indexStart;b.indexCount=a.indexCount;b.reservedIndexCount=a.reservedIndexCount;b.start=a.start;b.count=a.count;return b}setInstanceCount(a){var b=this._availableInstanceIds,d=this._instanceInfo;for(b.sort(S);b[b.length-1]===d.length-1;)d.pop(),b.pop();if(a<d.length)throw Error(`BatchedMesh: Instance ids outside the range ${a} are being used. Cannot shrink instance count.`);
b=new Int32Array(a);d=new Int32Array(a);na(this._multiDrawCounts,b);na(this._multiDrawStarts,d);this._multiDrawCounts=b;this._multiDrawStarts=d;this._maxInstanceCount=a;a=this._indirectTexture;b=this._matricesTexture;d=this._colorsTexture;a.dispose();this._initIndirectTexture();na(a.image.data,this._indirectTexture.image.data);b.dispose();this._initMatricesTexture();na(b.image.data,this._matricesTexture.image.data);d&&(d.dispose(),this._initColorsTexture(),na(d.image.data,this._colorsTexture.image.data))}setGeometrySize(a,
b){var d=[...this._geometryInfo].filter(h=>h.active);if(Math.max(...d.map(h=>h.vertexStart+h.reservedVertexCount))>a)throw Error(`BatchedMesh: Geometry vertex values are being used outside the range ${b}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...d.map(h=>h.indexStart+h.reservedIndexCount))>b)throw Error(`BatchedMesh: Geometry index values are being used outside the range ${b}. Cannot shrink further.`);d=this.geometry;d.dispose();this._maxVertexCount=a;this._maxIndexCount=b;this._geometryInitialized&&
(this._geometryInitialized=!1,this.geometry=new Vb,this._initializeGeometry(d));a=this.geometry;d.index&&na(d.index.array,a.index.array);for(const h in d.attributes)na(d.attributes[h].array,a.attributes[h].array)}raycast(a,b){const d=this._instanceInfo,h=this._geometryInfo,n=this.matrixWorld;var u=this.geometry;gd.material=this.material;gd.geometry.index=u.index;gd.geometry.attributes=u.attributes;gd.geometry.boundingBox===null&&(gd.geometry.boundingBox=new Sc);gd.geometry.boundingSphere===null&&
(gd.geometry.boundingSphere=new Qc);for(let E=0,F=d.length;E<F;E++){if(!d[E].visible||!d[E].active)continue;u=d[E].geometryIndex;const H=h[u];gd.geometry.setDrawRange(H.start,H.count);this.getMatrixAt(E,gd.matrixWorld).premultiply(n);this.getBoundingBoxAt(u,gd.geometry.boundingBox);this.getBoundingSphereAt(u,gd.geometry.boundingSphere);gd.raycast(a,Ch);for(let M=0,R=Ch.length;M<R;M++)u=Ch[M],u.object=this,u.batchId=E,b.push(u);Ch.length=0}gd.material=null;gd.geometry.index=null;gd.geometry.attributes=
{};gd.geometry.setDrawRange(0,Infinity)}copy(a){super.copy(a);this.geometry=a.geometry.clone();this.perObjectFrustumCulled=a.perObjectFrustumCulled;this.sortObjects=a.sortObjects;this.boundingBox=a.boundingBox!==null?a.boundingBox.clone():null;this.boundingSphere=a.boundingSphere!==null?a.boundingSphere.clone():null;this._geometryInfo=a._geometryInfo.map(b=>({...b,boundingBox:b.boundingBox!==null?b.boundingBox.clone():null,boundingSphere:b.boundingSphere!==null?b.boundingSphere.clone():null}));this._instanceInfo=
a._instanceInfo.map(b=>({...b}));this._availableInstanceIds=a._availableInstanceIds.slice();this._availableGeometryIds=a._availableGeometryIds.slice();this._nextIndexStart=a._nextIndexStart;this._nextVertexStart=a._nextVertexStart;this._geometryCount=a._geometryCount;this._maxInstanceCount=a._maxInstanceCount;this._maxVertexCount=a._maxVertexCount;this._maxIndexCount=a._maxIndexCount;this._geometryInitialized=a._geometryInitialized;this._multiDrawCounts=a._multiDrawCounts.slice();this._multiDrawStarts=
a._multiDrawStarts.slice();this._indirectTexture=a._indirectTexture.clone();this._indirectTexture.image.data=this._indirectTexture.image.data.slice();this._matricesTexture=a._matricesTexture.clone();this._matricesTexture.image.data=this._matricesTexture.image.data.slice();this._colorsTexture!==null&&(this._colorsTexture=a._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice());return this}dispose(){this.geometry.dispose();this._matricesTexture.dispose();this._matricesTexture=
null;this._indirectTexture.dispose();this._indirectTexture=null;this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(a,b,d,h,n){if(this._visibilityChanged||this.perObjectFrustumCulled||this.sortObjects){a=h.getIndex();a=a===null?1:a.array.BYTES_PER_ELEMENT;var u=this._instanceInfo;b=this._multiDrawStarts;h=this._multiDrawCounts;var E=this._geometryInfo,F=this.perObjectFrustumCulled,H=this._indirectTexture,M=H.image.data,R=d.isArrayCamera?Um:Wk;F&&!d.isArrayCamera&&
(od.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse).multiply(this.matrixWorld),Wk.setFromProjectionMatrix(od,d.coordinateSystem,d.reversedDepth));var T=0;if(this.sortObjects){od.copy(this.matrixWorld).invert();Gg.setFromMatrixPosition(d.matrixWorld).applyMatrix4(od);Xk.set(0,0,-1).transformDirection(d.matrixWorld).transformDirection(od);for(let aa=0,da=u.length;aa<da;aa++)if(u[aa].visible&&u[aa].active){var X=u[aa].geometryIndex;this.getMatrixAt(aa,od);this.getBoundingSphereAt(X,cf).applyMatrix4(od);
var ea=!1;F&&(ea=!R.intersectsSphere(cf,d));ea||(X=E[X],ea=Vm.subVectors(cf.center,Gg).dot(Xk),dj.push(X.start,X.count,ea,aa))}u=dj.list;E=this.customSort;E===null?u.sort(n.transparent?V:ca):E.call(this,u,d);for(let aa=0,da=u.length;aa<da;aa++)d=u[aa],b[T]=d.start*a,h[T]=d.count,M[T]=d.index,T++;dj.reset()}else for(let aa=0,da=u.length;aa<da;aa++)u[aa].visible&&u[aa].active&&(n=u[aa].geometryIndex,X=!1,F&&(this.getMatrixAt(aa,od),this.getBoundingSphereAt(n,cf).applyMatrix4(od),X=!R.intersectsSphere(cf,
d)),X||(n=E[n],b[T]=n.start*a,h[T]=n.count,M[T]=aa,T++));H.needsUpdate=!0;this._multiDrawCount=T;this._visibilityChanged=!1}}onBeforeShadow(a,b,d,h,n,u){this.onBeforeRender(a,null,h,n,u)}}class jd extends fd{constructor(a){super();this.isLineBasicMaterial=!0;this.type="LineBasicMaterial";this.color=new pb(16777215);this.map=null;this.linewidth=1;this.linejoin=this.linecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.linewidth=a.linewidth;
this.linecap=a.linecap;this.linejoin=a.linejoin;this.fog=a.fog;return this}}const Tg=new ma,Ug=new ma,Zk=new Gb,Hg=new Hf,Ig=new Qc,$h=new ma,dk=new ma;class Je extends jc{constructor(a=new Vb,b=new jd){super();this.isLine=!0;this.type="Line";this.geometry=a;this.material=b;this.morphTargetInfluences=this.morphTargetDictionary=void 0;this.updateMorphTargets()}copy(a,b){super.copy(a,b);this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;return this}computeLineDistances(){const a=
this.geometry;if(a.index===null){const b=a.attributes.position,d=[0];for(let h=1,n=b.count;h<n;h++)Tg.fromBufferAttribute(b,h-1),Ug.fromBufferAttribute(b,h),d[h]=d[h-1],d[h]+=Tg.distanceTo(Ug);a.setAttribute("lineDistance",new vb(d,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(a,b){var d=this.geometry,h=this.matrixWorld,n=a.params.Line.threshold,u=d.drawRange;d.boundingSphere===null&&d.computeBoundingSphere();
Ig.copy(d.boundingSphere);Ig.applyMatrix4(h);Ig.radius+=n;if(a.ray.intersectsSphere(Ig)!==!1){Zk.copy(h).invert();Hg.copy(a.ray).applyMatrix4(Zk);h=n/((this.scale.x+this.scale.y+this.scale.z)/3);h*=h;n=this.isLineSegments?2:1;var E=d.index;d=d.attributes.position;if(E!==null){d=Math.max(0,u.start);u=Math.min(E.count,u.start+u.count);for(let H=d,M=u-1;H<M;H+=n){var F=E.getX(H);const R=E.getX(H+1);(F=N(this,a,Hg,h,F,R,H))&&b.push(F)}this.isLineLoop&&(n=E.getX(u-1),E=E.getX(d),(a=N(this,a,Hg,h,n,E,u-
1))&&b.push(a))}else{E=Math.max(0,u.start);u=Math.min(d.count,u.start+u.count);for(let H=E,M=u-1;H<M;H+=n)(d=N(this,a,Hg,h,H,H+1,H))&&b.push(d);this.isLineLoop&&(a=N(this,a,Hg,h,u-1,E,u-1))&&b.push(a)}}}updateMorphTargets(){var a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0&&(a=a[b[0]],a!==void 0)){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let d=0,h=a.length;d<h;d++)b=a[d].name||String(d),this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=d}}}const $k=
new ma,al=new ma;class ce extends Je{constructor(a,b){super(a,b);this.isLineSegments=!0;this.type="LineSegments"}computeLineDistances(){const a=this.geometry;if(a.index===null){const b=a.attributes.position,d=[];for(let h=0,n=b.count;h<n;h+=2)$k.fromBufferAttribute(b,h),al.fromBufferAttribute(b,h+1),d[h]=h===0?0:d[h-1],d[h+1]=d[h]+$k.distanceTo(al);a.setAttribute("lineDistance",new vb(d,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
return this}}class bl extends Je{constructor(a,b){super(a,b);this.isLineLoop=!0;this.type="LineLoop"}}class ej extends fd{constructor(a){super();this.isPointsMaterial=!0;this.type="PointsMaterial";this.color=new pb(16777215);this.alphaMap=this.map=null;this.size=1;this.fog=this.sizeAttenuation=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.alphaMap=a.alphaMap;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.fog=a.fog;return this}}const cl=new Gb,
ai=new Hf,Jg=new Qc,Dh=new ma;class dl extends jc{constructor(a=new Vb,b=new ej){super();this.isPoints=!0;this.type="Points";this.geometry=a;this.material=b;this.morphTargetInfluences=this.morphTargetDictionary=void 0;this.updateMorphTargets()}copy(a,b){super.copy(a,b);this.material=Array.isArray(a.material)?a.material.slice():a.material;this.geometry=a.geometry;return this}raycast(a,b){var d=this.geometry;const h=this.matrixWorld;var n=a.params.Points.threshold,u=d.drawRange;d.boundingSphere===null&&
d.computeBoundingSphere();Jg.copy(d.boundingSphere);Jg.applyMatrix4(h);Jg.radius+=n;if(a.ray.intersectsSphere(Jg)!==!1){cl.copy(h).invert();ai.copy(a.ray).applyMatrix4(cl);n/=(this.scale.x+this.scale.y+this.scale.z)/3;n*=n;var E=d.index;d=d.attributes.position;if(E!==null){const F=Math.max(0,u.start);u=Math.min(E.count,u.start+u.count);for(let H=F,M=u;H<M;H++)u=E.getX(H),Dh.fromBufferAttribute(d,u),pa(Dh,u,n,h,a,b,this)}else{E=Math.max(0,u.start);u=Math.min(d.count,u.start+u.count);for(let F=E,H=
u;F<H;F++)Dh.fromBufferAttribute(d,F),pa(Dh,F,n,h,a,b,this)}}}updateMorphTargets(){var a=this.geometry.morphAttributes,b=Object.keys(a);if(b.length>0&&(a=a[b[0]],a!==void 0)){this.morphTargetInfluences=[];this.morphTargetDictionary={};for(let d=0,h=a.length;d<h;d++)b=a[d].name||String(d),this.morphTargetInfluences.push(0),this.morphTargetDictionary[b]=d}}}class el extends Cc{constructor(a,b,d,h,n=1006,u=1006,E,F,H){function M(){R.needsUpdate=!0;R._requestVideoFrameCallbackId=a.requestVideoFrameCallback(M)}
super(a,b,d,h,n,u,E,F,H);this.isVideoTexture=!0;this.generateMipmaps=!1;this._requestVideoFrameCallbackId=0;const R=this;"requestVideoFrameCallback"in a&&(this._requestVideoFrameCallbackId=a.requestVideoFrameCallback(M))}clone(){return(new this.constructor(this.image)).copy(this)}update(){const a=this.image;"requestVideoFrameCallback"in a===!1&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId);
super.dispose()}}class Wm extends el{constructor(a,b,d,h,n,u,E,F){super({},a,b,d,h,n,u,E,F);this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(a){this.image=a;this.needsUpdate=!0}}class Xm extends Cc{constructor(a,b){super({width:a,height:b});this.isFramebufferTexture=!0;this.minFilter=this.magFilter=1003;this.generateMipmaps=!1;this.needsUpdate=!0}}class Eh extends Cc{constructor(a,b,d,h,n,u,E,F,H,M,R,T){super(null,u,E,F,H,M,h,n,R,T);this.isCompressedTexture=
!0;this.image={width:b,height:d};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}}class Ym extends Eh{constructor(a,b,d,h,n,u){super(a,b,d,n,u);this.isCompressedArrayTexture=!0;this.image.depth=h;this.wrapR=1001;this.layerUpdates=new Set}addLayerUpdate(a){this.layerUpdates.add(a)}clearLayerUpdates(){this.layerUpdates.clear()}}class Zm extends Eh{constructor(a,b,d){super(void 0,a[0].width,a[0].height,b,d,301);this.isCubeTexture=this.isCompressedCubeTexture=!0;this.image=a}}class $m extends Cc{constructor(a,
b,d,h,n,u,E,F,H){super(a,b,d,h,n,u,E,F,H);this.needsUpdate=this.isCanvasTexture=!0}}class fj extends Cc{constructor(a,b,d=1014,h,n,u,E=1003,F=1003,H,M=1026,R=1){if(M!==1026&&M!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:a,height:b,depth:R},h,n,u,E,F,M,d,H);this.isDepthTexture=!0;this.generateMipmaps=this.flipY=!1;this.compareFunction=null}copy(a){super.copy(a);this.source=new Xd(Object.assign({},a.image));this.compareFunction=
a.compareFunction;return this}toJSON(a){a=super.toJSON(a);this.compareFunction!==null&&(a.compareFunction=this.compareFunction);return a}}class gj extends Cc{constructor(a=null){super();this.sourceTexture=a;this.isExternalTexture=!0}copy(a){super.copy(a);this.sourceTexture=a.sourceTexture;return this}}class hj extends Vb{constructor(a=1,b=1,d=4,h=8,n=1){super();this.type="CapsuleGeometry";this.parameters={radius:a,height:b,capSegments:d,radialSegments:h,heightSegments:n};b=Math.max(0,b);d=Math.max(1,
Math.floor(d));h=Math.max(3,Math.floor(h));n=Math.max(1,Math.floor(n));const u=[],E=[],F=[],H=[],M=b/2,R=Math.PI/2*a,T=b,X=2*R+T,ea=d*2+n,aa=h+1,da=new ma,U=new ma;for(let Na=0;Na<=ea;Na++){var ka=void 0,qa=void 0,wa=void 0,sa=void 0;Na<=d?(ka=Na/d,sa=ka*Math.PI/2,qa=-M-a*Math.cos(sa),wa=a*Math.sin(sa),sa=-a*Math.cos(sa),ka*=R):Na<=d+n?(ka=(Na-d)/n,qa=-M+ka*b,wa=a,sa=0,ka=R+ka*T):(ka=(Na-d-n)/d,sa=ka*Math.PI/2,qa=M+a*Math.sin(sa),wa=a*Math.cos(sa),sa=a*Math.sin(sa),ka=R+T+ka*R);ka=Math.max(0,Math.min(1,
ka/X));var Aa=0;Na===0?Aa=.5/h:Na===ea&&(Aa=-.5/h);for(let Ca=0;Ca<=h;Ca++){const Ja=Ca/h;var Ba=Ja*Math.PI*2;const Qa=Math.sin(Ba);Ba=Math.cos(Ba);U.x=-wa*Ba;U.y=qa;U.z=wa*Qa;E.push(U.x,U.y,U.z);da.set(-wa*Ba,sa,wa*Qa);da.normalize();F.push(da.x,da.y,da.z);H.push(Ja+Aa,ka)}if(Na>0)for(qa=(Na-1)*aa,wa=0;wa<h;wa++)sa=qa+wa+1,ka=Na*aa+wa,Aa=Na*aa+wa+1,u.push(qa+wa,sa,ka),u.push(sa,Aa,ka)}this.setIndex(u);this.setAttribute("position",new vb(E,3));this.setAttribute("normal",new vb(F,3));this.setAttribute("uv",
new vb(H,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new hj(a.radius,a.height,a.capSegments,a.radialSegments,a.heightSegments)}}class ij extends Vb{constructor(a=1,b=32,d=0,h=Math.PI*2){super();this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:d,thetaLength:h};b=Math.max(3,b);const n=[],u=[],E=[],F=[],H=new ma,M=new Xa;u.push(0,0,0);E.push(0,0,1);F.push(.5,.5);for(let R=0,T=3;R<=b;R++,T+=3){const X=d+R/b*h;
H.x=a*Math.cos(X);H.y=a*Math.sin(X);u.push(H.x,H.y,H.z);E.push(0,0,1);M.x=(u[T]/a+1)/2;M.y=(u[T+1]/a+1)/2;F.push(M.x,M.y)}for(a=1;a<=b;a++)n.push(a,a+1,0);this.setIndex(n);this.setAttribute("position",new vb(u,3));this.setAttribute("normal",new vb(E,3));this.setAttribute("uv",new vb(F,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new ij(a.radius,a.segments,a.thetaStart,a.thetaLength)}}class Fh extends Vb{constructor(a=1,b=1,d=1,h=32,
n=1,u=!1,E=0,F=Math.PI*2){function H(qa){const wa=aa;var sa=new Xa,Aa=new ma;let Ba=0;var Na=qa===!0?a:b;const Ca=qa===!0?1:-1;for(var Ja=1;Ja<=h;Ja++)T.push(0,U*Ca,0),X.push(0,Ca,0),ea.push(.5,.5),aa++;Ja=aa;for(let Za=0;Za<=h;Za++){var Qa=Za/h*F+E;const gb=Math.cos(Qa);Qa=Math.sin(Qa);Aa.x=Na*Qa;Aa.y=U*Ca;Aa.z=Na*gb;T.push(Aa.x,Aa.y,Aa.z);X.push(0,Ca,0);sa.x=gb*.5+.5;sa.y=Qa*.5*Ca+.5;ea.push(sa.x,sa.y);aa++}for(sa=0;sa<h;sa++)Aa=wa+sa,Na=Ja+sa,qa===!0?R.push(Na,Na+1,Aa):R.push(Na+1,Na,Aa),Ba+=3;
M.addGroup(ka,Ba,qa===!0?1:2);ka+=Ba}super();this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:d,radialSegments:h,heightSegments:n,openEnded:u,thetaStart:E,thetaLength:F};const M=this;h=Math.floor(h);n=Math.floor(n);const R=[],T=[],X=[],ea=[];let aa=0;const da=[],U=d/2;let ka=0;(function(){var qa=new ma,wa=new ma;let sa=0;var Aa=(b-a)/d;for(var Ba=0;Ba<=n;Ba++){var Na=[],Ca=Ba/n;const Qa=Ca*(b-a)+a;for(let Za=0;Za<=h;Za++){const gb=Za/h;var Ja=gb*F+E;const cb=Math.sin(Ja);
Ja=Math.cos(Ja);wa.x=Qa*cb;wa.y=-Ca*d+U;wa.z=Qa*Ja;T.push(wa.x,wa.y,wa.z);qa.set(cb,Aa,Ja).normalize();X.push(qa.x,qa.y,qa.z);ea.push(gb,1-Ca);Na.push(aa++)}da.push(Na)}for(qa=0;qa<h;qa++)for(wa=0;wa<n;wa++){Aa=da[wa][qa];Ba=da[wa+1][qa];Na=da[wa+1][qa+1];Ca=da[wa][qa+1];if(a>0||wa!==0)R.push(Aa,Ba,Ca),sa+=3;if(b>0||wa!==n-1)R.push(Ba,Na,Ca),sa+=3}M.addGroup(ka,sa,0);ka+=sa})();u===!1&&(a>0&&H(!0),b>0&&H(!1));this.setIndex(R);this.setAttribute("position",new vb(T,3));this.setAttribute("normal",new vb(X,
3));this.setAttribute("uv",new vb(ea,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Fh(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class Gh extends Fh{constructor(a=1,b=1,d=32,h=1,n=!1,u=0,E=Math.PI*2){super(0,a,b,d,h,n,u,E);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:d,heightSegments:h,openEnded:n,thetaStart:u,thetaLength:E}}static fromJSON(a){return new Gh(a.radius,
a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)}}class df extends Vb{constructor(a=[],b=[],d=1,h=0){function n(M){F.push(M.x,M.y,M.z)}function u(M,R){M*=3;R.x=a[M+0];R.y=a[M+1];R.z=a[M+2]}function E(M,R,T,X){X<0&&M.x===1&&(H[R]=M.x-1);T.x===0&&T.z===0&&(H[R]=X/2/Math.PI+.5)}super();this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:d,detail:h};const F=[],H=[];(function(M){const R=new ma,T=new ma,X=new ma;for(let U=0;U<b.length;U+=3){u(b[U+
0],R);u(b[U+1],T);u(b[U+2],X);const ka=M+1,qa=[];for(var ea=0;ea<=ka;ea++){qa[ea]=[];var aa=R.clone().lerp(X,ea/ka),da=T.clone().lerp(X,ea/ka);const wa=ka-ea;for(let sa=0;sa<=wa;sa++)qa[ea][sa]=sa===0&&ea===ka?aa:aa.clone().lerp(da,sa/wa)}for(ea=0;ea<ka;ea++)for(aa=0;aa<2*(ka-ea)-1;aa++)da=Math.floor(aa/2),aa%2===0?(n(qa[ea][da+1]),n(qa[ea+1][da]),n(qa[ea][da])):(n(qa[ea][da+1]),n(qa[ea+1][da+1]),n(qa[ea+1][da]))}})(h);(function(M){const R=new ma;for(let T=0;T<F.length;T+=3)R.x=F[T+0],R.y=F[T+1],
R.z=F[T+2],R.normalize().multiplyScalar(M),F[T+0]=R.x,F[T+1]=R.y,F[T+2]=R.z})(d);(function(){var M=new ma;for(var R=0;R<F.length;R+=3)M.x=F[R+0],M.y=F[R+1],M.z=F[R+2],H.push(Math.atan2(M.z,-M.x)/2/Math.PI+.5,1-(Math.atan2(-M.y,Math.sqrt(M.x*M.x+M.z*M.z))/Math.PI+.5));M=new ma;R=new ma;var T=new ma,X=new ma,ea=new Xa;const aa=new Xa,da=new Xa;for(let U=0,ka=0;U<F.length;U+=9,ka+=6){M.set(F[U+0],F[U+1],F[U+2]);R.set(F[U+3],F[U+4],F[U+5]);T.set(F[U+6],F[U+7],F[U+8]);ea.set(H[ka+0],H[ka+1]);aa.set(H[ka+
2],H[ka+3]);da.set(H[ka+4],H[ka+5]);X.copy(M).add(R).add(T).divideScalar(3);const qa=Math.atan2(X.z,-X.x);E(ea,ka+0,M,qa);E(aa,ka+2,R,qa);E(da,ka+4,T,qa)}for(M=0;M<H.length;M+=6)R=H[M+0],T=H[M+2],X=H[M+4],ea=Math.min(R,T,X),Math.max(R,T,X)>.9&&ea<.1&&(R<.2&&(H[M+0]+=1),T<.2&&(H[M+2]+=1),X<.2&&(H[M+4]+=1))})();this.setAttribute("position",new vb(F,3));this.setAttribute("normal",new vb(F.slice(),3));this.setAttribute("uv",new vb(H,2));h===0?this.computeVertexNormals():this.normalizeNormals()}copy(a){super.copy(a);
this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new df(a.vertices,a.indices,a.radius,a.details)}}class jj extends df{constructor(a=1,b=0){const d=(1+Math.sqrt(5))/2,h=1/d;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-h,-d,0,-h,d,0,h,-d,0,h,d,-h,-d,0,-h,d,0,h,-d,0,h,d,0,-d,0,-h,d,0,-h,-d,0,h,d,0,h],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,
2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b}}static fromJSON(a){return new jj(a.radius,a.detail)}}const Hh=new ma,Ih=new ma,kj=new ma,Jh=new ud;class fl extends Vb{constructor(a=null,b=1){super();this.type="EdgesGeometry";this.parameters={geometry:a,thresholdAngle:b};if(a!==null){b=Math.cos(je*b);const h=a.getIndex();a=a.getAttribute("position");
const n=h?h.count:a.count,u=[0,0,0],E=["a","b","c"],F=Array(3),H={},M=[];for(let R=0;R<n;R+=3){h?(u[0]=h.getX(R),u[1]=h.getX(R+1),u[2]=h.getX(R+2)):(u[0]=R,u[1]=R+1,u[2]=R+2);const {a:T,b:X,c:ea}=Jh;T.fromBufferAttribute(a,u[0]);X.fromBufferAttribute(a,u[1]);ea.fromBufferAttribute(a,u[2]);Jh.getNormal(kj);F[0]=`${Math.round(T.x*1E4)},${Math.round(T.y*1E4)},${Math.round(T.z*1E4)}`;F[1]=`${Math.round(X.x*1E4)},${Math.round(X.y*1E4)},${Math.round(X.z*1E4)}`;F[2]=`${Math.round(ea.x*1E4)},${Math.round(ea.y*
1E4)},${Math.round(ea.z*1E4)}`;if(F[0]!==F[1]&&F[1]!==F[2]&&F[2]!==F[0])for(let aa=0;aa<3;aa++){const da=(aa+1)%3;var d=F[aa];const U=F[da],ka=Jh[E[aa]],qa=Jh[E[da]],wa=`${d}_${U}`;d=`${U}_${d}`;d in H&&H[d]?(kj.dot(H[d].normal)<=b&&(M.push(ka.x,ka.y,ka.z),M.push(qa.x,qa.y,qa.z)),H[d]=null):wa in H||(H[wa]={index0:u[aa],index1:u[da],normal:kj.clone()})}}for(const R in H)if(H[R]){const {index0:T,index1:X}=H[R];Hh.fromBufferAttribute(a,T);Ih.fromBufferAttribute(a,X);M.push(Hh.x,Hh.y,Hh.z);M.push(Ih.x,
Ih.y,Ih.z)}this.setAttribute("position",new vb(M,3))}}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}}class Od{constructor(){this.type="Curve";this.arcLengthDivisions=200;this.needsUpdate=!1;this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(a,b){a=this.getUtoTmapping(a);return this.getPoint(a,b)}getPoints(a=5){const b=[];for(let d=0;d<=a;d++)b.push(this.getPoint(d/a));return b}getSpacedPoints(a=5){const b=[];
for(let d=0;d<=a;d++)b.push(this.getPointAt(d/a));return b}getLength(){const a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const b=[];let d,h=this.getPoint(0),n=0;b.push(0);for(let u=1;u<=a;u++)d=this.getPoint(u/a),n+=d.distanceTo(h),b.push(n),h=d;return this.cacheArcLengths=b}updateArcLengths(){this.needsUpdate=!0;this.getLengths()}getUtoTmapping(a,
b=null){const d=this.getLengths(),h=d.length;b=b?b:a*d[h-1];var n=0;let u=h-1,E;for(;n<=u;)if(a=Math.floor(n+(u-n)/2),E=d[a]-b,E<0)n=a+1;else if(E>0)u=a-1;else{u=a;break}a=u;if(d[a]===b)return a/(h-1);n=d[a];return(a+(b-n)/(d[a+1]-n))/(h-1)}getTangent(a,b){var d=a-1E-4;a+=1E-4;d<0&&(d=0);a>1&&(a=1);d=this.getPoint(d);a=this.getPoint(a);b=b||(d.isVector2?new Xa:new ma);b.copy(a).sub(d).normalize();return b}getTangentAt(a,b){a=this.getUtoTmapping(a);return this.getTangent(a,b)}computeFrenetFrames(a,
b=!1){var d=new ma;const h=[],n=[],u=[];var E=new ma;const F=new Gb;for(var H=0;H<=a;H++)h[H]=this.getTangentAt(H/a,new ma);n[0]=new ma;u[0]=new ma;H=Number.MAX_VALUE;const M=Math.abs(h[0].x),R=Math.abs(h[0].y),T=Math.abs(h[0].z);M<=H&&(H=M,d.set(1,0,0));R<=H&&(H=R,d.set(0,1,0));T<=H&&d.set(0,0,1);E.crossVectors(h[0],d).normalize();n[0].crossVectors(h[0],E);u[0].crossVectors(h[0],n[0]);for(d=1;d<=a;d++)n[d]=n[d-1].clone(),u[d]=u[d-1].clone(),E.crossVectors(h[d-1],h[d]),E.length()>Number.EPSILON&&
(E.normalize(),H=Math.acos(r(h[d-1].dot(h[d]),-1,1)),n[d].applyMatrix4(F.makeRotationAxis(E,H))),u[d].crossVectors(h[d],n[d]);if(b===!0)for(b=Math.acos(r(n[0].dot(n[a]),-1,1)),b/=a,h[0].dot(E.crossVectors(n[0],n[a]))>0&&(b=-b),E=1;E<=a;E++)n[E].applyMatrix4(F.makeRotationAxis(h[E],b*E)),u[E].crossVectors(h[E],n[E]);return{tangents:h,normals:n,binormals:u}}clone(){return(new this.constructor).copy(this)}copy(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}toJSON(){const a={metadata:{version:4.7,
type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a}fromJSON(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}}class Kh extends Od{constructor(a=0,b=0,d=1,h=1,n=0,u=Math.PI*2,E=!1,F=0){super();this.isEllipseCurve=!0;this.type="EllipseCurve";this.aX=a;this.aY=b;this.xRadius=d;this.yRadius=h;this.aStartAngle=n;this.aEndAngle=u;this.aClockwise=E;this.aRotation=F}getPoint(a,b=new Xa){for(var d=Math.PI*2,h=this.aEndAngle-this.aStartAngle,
n=Math.abs(h)<Number.EPSILON;h<0;)h+=d;for(;h>d;)h-=d;h<Number.EPSILON&&(h=n?0:d);this.aClockwise!==!0||n||(h=h===d?-d:h-d);d=this.aStartAngle+a*h;a=this.aX+this.xRadius*Math.cos(d);var u=this.aY+this.yRadius*Math.sin(d);this.aRotation!==0&&(d=Math.cos(this.aRotation),h=Math.sin(this.aRotation),n=a-this.aX,u-=this.aY,a=n*d-u*h+this.aX,u=n*h+u*d+this.aY);return b.set(a,u)}copy(a){super.copy(a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=
a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this}toJSON(){const a=super.toJSON();a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=this.aStartAngle;a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=this.aRotation;return a}fromJSON(a){super.fromJSON(a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=
a.aRotation;return this}}class gl extends Kh{constructor(a,b,d,h,n,u){super(a,b,d,d,h,n,u);this.isArcCurve=!0;this.type="ArcCurve"}}const Lh=new ma,lj=new ra,mj=new ra,nj=new ra;class hl extends Od{constructor(a=[],b=!1,d="centripetal",h=.5){super();this.isCatmullRomCurve3=!0;this.type="CatmullRomCurve3";this.points=a;this.closed=b;this.curveType=d;this.tension=h}getPoint(a,b=new ma){var d=this.points,h=d.length;a*=h-(this.closed?0:1);var n=Math.floor(a);a-=n;this.closed?n+=n>0?0:(Math.floor(Math.abs(n)/
h)+1)*h:a===0&&n===h-1&&(n=h-2,a=1);let u;this.closed||n>0?u=d[(n-1)%h]:(Lh.subVectors(d[0],d[1]).add(d[0]),u=Lh);const E=d[n%h],F=d[(n+1)%h];this.closed||n+2<h?d=d[(n+2)%h]:(Lh.subVectors(d[h-1],d[h-2]).add(d[h-1]),d=Lh);if(this.curveType==="centripetal"||this.curveType==="chordal"){var H=this.curveType==="chordal"?.5:.25;h=Math.pow(u.distanceToSquared(E),H);n=Math.pow(E.distanceToSquared(F),H);H=Math.pow(F.distanceToSquared(d),H);n<1E-4&&(n=1);h<1E-4&&(h=n);H<1E-4&&(H=n);lj.initNonuniformCatmullRom(u.x,
E.x,F.x,d.x,h,n,H);mj.initNonuniformCatmullRom(u.y,E.y,F.y,d.y,h,n,H);nj.initNonuniformCatmullRom(u.z,E.z,F.z,d.z,h,n,H)}else this.curveType==="catmullrom"&&(lj.initCatmullRom(u.x,E.x,F.x,d.x,this.tension),mj.initCatmullRom(u.y,E.y,F.y,d.y,this.tension),nj.initCatmullRom(u.z,E.z,F.z,d.z,this.tension));b.set(lj.calc(a),mj.calc(a),nj.calc(a));return b}copy(a){super.copy(a);this.points=[];for(let b=0,d=a.points.length;b<d;b++)this.points.push(a.points[b].clone());this.closed=a.closed;this.curveType=
a.curveType;this.tension=a.tension;return this}toJSON(){const a=super.toJSON();a.points=[];for(let b=0,d=this.points.length;b<d;b++)a.points.push(this.points[b].toArray());a.closed=this.closed;a.curveType=this.curveType;a.tension=this.tension;return a}fromJSON(a){super.fromJSON(a);this.points=[];for(let b=0,d=a.points.length;b<d;b++){const h=a.points[b];this.points.push((new ma).fromArray(h))}this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this}}class oj extends Od{constructor(a=
new Xa,b=new Xa,d=new Xa,h=new Xa){super();this.isCubicBezierCurve=!0;this.type="CubicBezierCurve";this.v0=a;this.v1=b;this.v2=d;this.v3=h}getPoint(a,b=new Xa){const d=this.v0,h=this.v1,n=this.v2,u=this.v3;b.set(jb(a,d.x,h.x,n.x,u.x),jb(a,d.y,h.y,n.y,u.y));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a}fromJSON(a){super.fromJSON(a);
this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this}}class il extends Od{constructor(a=new ma,b=new ma,d=new ma,h=new ma){super();this.isCubicBezierCurve3=!0;this.type="CubicBezierCurve3";this.v0=a;this.v1=b;this.v2=d;this.v3=h}getPoint(a,b=new ma){const d=this.v0,h=this.v1,n=this.v2,u=this.v3;b.set(jb(a,d.x,h.x,n.x,u.x),jb(a,d.y,h.y,n.y,u.y),jb(a,d.z,h.z,n.z,u.z));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);
this.v3.copy(a.v3);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this}}class pj extends Od{constructor(a=new Xa,b=new Xa){super();this.isLineCurve=!0;this.type="LineCurve";this.v1=a;this.v2=b}getPoint(a,b=new Xa){a===1?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));
return b}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new Xa){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){super.copy(a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class jl extends Od{constructor(a=new ma,b=new ma){super();this.isLineCurve3=!0;this.type=
"LineCurve3";this.v1=a;this.v2=b}getPoint(a,b=new ma){a===1?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new ma){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){super.copy(a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v1.fromArray(a.v1);
this.v2.fromArray(a.v2);return this}}class qj extends Od{constructor(a=new Xa,b=new Xa,d=new Xa){super();this.isQuadraticBezierCurve=!0;this.type="QuadraticBezierCurve";this.v0=a;this.v1=b;this.v2=d}getPoint(a,b=new Xa){const d=this.v0,h=this.v1,n=this.v2;b.set(Ua(a,d.x,h.x,n.x),Ua(a,d.y,h.y,n.y));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);
this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class rj extends Od{constructor(a=new ma,b=new ma,d=new ma){super();this.isQuadraticBezierCurve3=!0;this.type="QuadraticBezierCurve3";this.v0=a;this.v1=b;this.v2=d}getPoint(a,b=new ma){const d=this.v0,h=this.v1,n=this.v2;b.set(Ua(a,d.x,h.x,n.x),Ua(a,d.y,h.y,n.y),Ua(a,d.z,h.z,n.z));return b}copy(a){super.copy(a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this}toJSON(){const a=super.toJSON();a.v0=
this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a}fromJSON(a){super.fromJSON(a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this}}class sj extends Od{constructor(a=[]){super();this.isSplineCurve=!0;this.type="SplineCurve";this.points=a}getPoint(a,b=new Xa){var d=this.points,h=(d.length-1)*a;a=Math.floor(h);h-=a;const n=d[a===0?a:a-1],u=d[a],E=d[a>d.length-2?d.length-1:a+1];d=d[a>d.length-3?d.length-1:a+2];b.set(Ea(h,n.x,u.x,E.x,d.x),Ea(h,n.y,
u.y,E.y,d.y));return b}copy(a){super.copy(a);this.points=[];for(let b=0,d=a.points.length;b<d;b++)this.points.push(a.points[b].clone());return this}toJSON(){const a=super.toJSON();a.points=[];for(let b=0,d=this.points.length;b<d;b++)a.points.push(this.points[b].toArray());return a}fromJSON(a){super.fromJSON(a);this.points=[];for(let b=0,d=a.points.length;b<d;b++){const h=a.points[b];this.points.push((new Xa).fromArray(h))}return this}}var Mh=Object.freeze({__proto__:null,ArcCurve:gl,CatmullRomCurve3:hl,
CubicBezierCurve:oj,CubicBezierCurve3:il,EllipseCurve:Kh,LineCurve:pj,LineCurve3:jl,QuadraticBezierCurve:qj,QuadraticBezierCurve3:rj,SplineCurve:sj});class kl extends Od{constructor(){super();this.type="CurvePath";this.curves=[];this.autoClose=!1}add(a){this.curves.push(a)}closePath(){const a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new Mh[a.isVector2===!0?"LineCurve":"LineCurve3"](b,a));return this}getPoint(a,b){var d=a*this.getLength(),
h=this.getCurveLengths();for(a=0;a<h.length;){if(h[a]>=d)return d=h[a]-d,a=this.curves[a],h=a.getLength(),a.getPointAt(h===0?0:1-d/h,b);a++}return null}getLength(){const a=this.getCurveLengths();return a[a.length-1]}updateArcLengths(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const a=[];let b=0;for(let d=0,h=this.curves.length;d<h;d++)b+=this.curves[d].getLength(),
a.push(b);return this.cacheLengths=a}getSpacedPoints(a=40){const b=[];for(let d=0;d<=a;d++)b.push(this.getPoint(d/a));this.autoClose&&b.push(b[0]);return b}getPoints(a=12){const b=[];let d;for(let n=0,u=this.curves;n<u.length;n++){var h=u[n];h=h.getPoints(h.isEllipseCurve?a*2:h.isLineCurve||h.isLineCurve3?1:h.isSplineCurve?a*h.points.length:a);for(let E=0;E<h.length;E++){const F=h[E];d&&d.equals(F)||(b.push(F),d=F)}}this.autoClose&&b.length>1&&!b[b.length-1].equals(b[0])&&b.push(b[0]);return b}copy(a){super.copy(a);
this.curves=[];for(let b=0,d=a.curves.length;b<d;b++)this.curves.push(a.curves[b].clone());this.autoClose=a.autoClose;return this}toJSON(){const a=super.toJSON();a.autoClose=this.autoClose;a.curves=[];for(let b=0,d=this.curves.length;b<d;b++)a.curves.push(this.curves[b].toJSON());return a}fromJSON(a){super.fromJSON(a);this.autoClose=a.autoClose;this.curves=[];for(let b=0,d=a.curves.length;b<d;b++){const h=a.curves[b];this.curves.push((new Mh[h.type]).fromJSON(h))}return this}}class Nh extends kl{constructor(a){super();
this.type="Path";this.currentPoint=new Xa;a&&this.setFromPoints(a)}setFromPoints(a){this.moveTo(a[0].x,a[0].y);for(let b=1,d=a.length;b<d;b++)this.lineTo(a[b].x,a[b].y);return this}moveTo(a,b){this.currentPoint.set(a,b);return this}lineTo(a,b){const d=new pj(this.currentPoint.clone(),new Xa(a,b));this.curves.push(d);this.currentPoint.set(a,b);return this}quadraticCurveTo(a,b,d,h){a=new qj(this.currentPoint.clone(),new Xa(a,b),new Xa(d,h));this.curves.push(a);this.currentPoint.set(d,h);return this}bezierCurveTo(a,
b,d,h,n,u){a=new oj(this.currentPoint.clone(),new Xa(a,b),new Xa(d,h),new Xa(n,u));this.curves.push(a);this.currentPoint.set(n,u);return this}splineThru(a){var b=[this.currentPoint.clone()].concat(a);b=new sj(b);this.curves.push(b);this.currentPoint.copy(a[a.length-1]);return this}arc(a,b,d,h,n,u){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,d,h,n,u);return this}absarc(a,b,d,h,n,u){this.absellipse(a,b,d,d,h,n,u);return this}ellipse(a,b,d,h,n,u,E,F){this.absellipse(a+this.currentPoint.x,
b+this.currentPoint.y,d,h,n,u,E,F);return this}absellipse(a,b,d,h,n,u,E,F){a=new Kh(a,b,d,h,n,u,E,F);this.curves.length>0&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);this.currentPoint.copy(a);return this}copy(a){super.copy(a);this.currentPoint.copy(a.currentPoint);return this}toJSON(){const a=super.toJSON();a.currentPoint=this.currentPoint.toArray();return a}fromJSON(a){super.fromJSON(a);this.currentPoint.fromArray(a.currentPoint);return this}}
class ef extends Nh{constructor(a){super(a);this.uuid=x();this.type="Shape";this.holes=[]}getPointsHoles(a){const b=[];for(let d=0,h=this.holes.length;d<h;d++)b[d]=this.holes[d].getPoints(a);return b}extractPoints(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}}copy(a){super.copy(a);this.holes=[];for(let b=0,d=a.holes.length;b<d;b++)this.holes.push(a.holes[b].clone());return this}toJSON(){const a=super.toJSON();a.uuid=this.uuid;a.holes=[];for(let b=0,d=this.holes.length;b<d;b++)a.holes.push(this.holes[b].toJSON());
return a}fromJSON(a){super.fromJSON(a);this.uuid=a.uuid;this.holes=[];for(let b=0,d=a.holes.length;b<d;b++){const h=a.holes[b];this.holes.push((new Nh).fromJSON(h))}return this}}class an{static triangulate(a,b,d=2){return eb(a,b,d)}}class de{static area(a){const b=a.length;let d=0;for(let h=b-1,n=0;n<b;h=n++)d+=a[h].x*a[n].y-a[n].x*a[h].y;return d*.5}static isClockWise(a){return de.area(a)<0}static triangulateShape(a,b){var d=[];const h=[],n=[];Dc(a);pc(d,a);a=a.length;b.forEach(Dc);for(let u=0;u<
b.length;u++)h.push(a),a+=b[u].length,pc(d,b[u]);b=an.triangulate(d,h);for(d=0;d<b.length;d+=3)n.push(b.slice(d,d+3));return n}}class tj extends Vb{constructor(a=new ef([new Xa(.5,.5),new Xa(-.5,.5),new Xa(-.5,-.5),new Xa(.5,-.5)]),b={}){function d(E){function F(la){const ta=1E-10*1E-10;let ua=la[0];for(let Pa=1;Pa<=la.length;Pa++){const oa=Pa%la.length,Ga=la[oa],ya=Ga.x-ua.x,Ma=Ga.y-ua.y,Ta=Math.max(Math.abs(Ga.x),Math.abs(Ga.y),Math.abs(ua.x),Math.abs(ua.y));ya*ya+Ma*Ma<=ta*Ta*Ta?(la.splice(oa,
1),Pa--):ua=Ga}}function H(la,ta,ua){ta||console.error("THREE.ExtrudeGeometry: vec does not exist");return la.clone().addScaledVector(ta,ua)}function M(la,ta,ua){var Pa=la.x-ta.x;var oa=la.y-ta.y;var Ga=ua.x-la.x;var ya=ua.y-la.y,Ma=Pa*Pa+oa*oa;if(Math.abs(Pa*ya-oa*Ga)>Number.EPSILON){const Ta=Math.sqrt(Ma),Sa=Math.sqrt(Ga*Ga+ya*ya);Ma=ta.x-oa/Ta;ta=ta.y+Pa/Ta;ya=((ua.x-ya/Sa-Ma)*ya-(ua.y+Ga/Sa-ta)*Ga)/(Pa*ya-oa*Ga);Ga=Ma+Pa*ya-la.x;Pa=ta+oa*ya-la.y;oa=Ga*Ga+Pa*Pa;if(oa<=2)return new Xa(Ga,Pa);oa=
Math.sqrt(oa/2)}else la=!1,Pa>Number.EPSILON?Ga>Number.EPSILON&&(la=!0):Pa<-Number.EPSILON?Ga<-Number.EPSILON&&(la=!0):Math.sign(oa)===Math.sign(ya)&&(la=!0),la?(Ga=-oa,oa=Math.sqrt(Ma)):(Ga=Pa,Pa=oa,oa=Math.sqrt(Ma/2));return new Xa(Ga/oa,Pa/oa)}function R(la,ta){let ua=la.length;for(;--ua>=0;){const Ga=ua;let ya=ua-1;ya<0&&(ya=la.length-1);for(let Ma=0,Ta=ka+Na*2;Ma<Ta;Ma++){var Pa=Cb*Ma,oa=Cb*(Ma+1);const Sa=ta+ya+Pa,$a=ta+ya+oa;oa=ta+Ga+oa;ea(ta+Ga+Pa);ea(Sa);ea(oa);ea(Sa);ea($a);ea(oa);Pa=n.length/
3;Pa=Ja.generateSideWallUV(h,n,Pa-6,Pa-3,Pa-2,Pa-1);aa(Pa[0]);aa(Pa[1]);aa(Pa[3]);aa(Pa[1]);aa(Pa[2]);aa(Pa[3])}}}function T(la,ta,ua){da.push(la);da.push(ta);da.push(ua)}function X(la,ta,ua){ea(la);ea(ta);ea(ua);la=n.length/3;la=Ja.generateTopUV(h,n,la-3,la-2,la-1);aa(la[0]);aa(la[1]);aa(la[2])}function ea(la){n.push(da[la*3]);n.push(da[la*3+1]);n.push(da[la*3+2])}function aa(la){u.push(la.x);u.push(la.y)}const da=[];var U=b.curveSegments!==void 0?b.curveSegments:12;const ka=b.steps!==void 0?b.steps:
1,qa=b.depth!==void 0?b.depth:1;let wa=b.bevelEnabled!==void 0?b.bevelEnabled:!0,sa=b.bevelThickness!==void 0?b.bevelThickness:.2,Aa=b.bevelSize!==void 0?b.bevelSize:sa-.1,Ba=b.bevelOffset!==void 0?b.bevelOffset:0,Na=b.bevelSegments!==void 0?b.bevelSegments:3;var Ca=b.extrudePath;const Ja=b.UVGenerator!==void 0?b.UVGenerator:bn;let Qa,Za=!1;if(Ca){Qa=Ca.getSpacedPoints(ka);Za=!0;wa=!1;var gb=Ca.computeFrenetFrames(ka,!1);var cb=new ma;var rb=new ma;var Ya=new ma}wa||(Ba=Aa=sa=Na=0);E=E.extractPoints(U);
Ca=E.shape;const nb=E.holes;if(!de.isClockWise(Ca)){Ca=Ca.reverse();for(let la=0,ta=nb.length;la<ta;la++)E=nb[la],de.isClockWise(E)&&(nb[la]=E.reverse())}F(Ca);nb.forEach(F);var ob=nb.length;const ub=Ca;for(E=0;E<ob;E++)Ca=Ca.concat(nb[E]);const Cb=Ca.length;E=[];for(let la=0,ta=ub.length,ua=ta-1,Pa=la+1;la<ta;la++,ua++,Pa++)ua===ta&&(ua=0),Pa===ta&&(Pa=0),E[la]=M(ub[la],ub[ua],ub[Pa]);U=[];let sb=E.concat();for(let la=0,ta=ob;la<ta;la++){var Mb=nb[la];var Wa=[];for(let ua=0,Pa=Mb.length,oa=Pa-1,
Ga=ua+1;ua<Pa;ua++,oa++,Ga++)oa===Pa&&(oa=0),Ga===Pa&&(Ga=0),Wa[ua]=M(Mb[ua],Mb[oa],Mb[Ga]);U.push(Wa);sb=sb.concat(Wa)}let hb;if(Na===0)hb=de.triangulateShape(ub,nb);else{Mb=[];var ja=[];for(let la=0;la<Na;la++){const ta=la/Na,ua=sa*Math.cos(ta*Math.PI/2),Pa=Aa*Math.sin(ta*Math.PI/2)+Ba;for(let oa=0,Ga=ub.length;oa<Ga;oa++)Wa=H(ub[oa],E[oa],Pa),T(Wa.x,Wa.y,-ua),ta===0&&Mb.push(Wa);for(let oa=0,Ga=ob;oa<Ga;oa++){const ya=nb[oa];Wa=U[oa];const Ma=[];for(let Ta=0,Sa=ya.length;Ta<Sa;Ta++){const $a=H(ya[Ta],
Wa[Ta],Pa);T($a.x,$a.y,-ua);ta===0&&Ma.push($a)}ta===0&&ja.push(Ma)}}hb=de.triangulateShape(Mb,ja)}const ha=hb.length;Wa=Aa+Ba;for(ob=0;ob<Cb;ob++)Mb=wa?H(Ca[ob],sb[ob],Wa):Ca[ob],Za?(rb.copy(gb.normals[0]).multiplyScalar(Mb.x),cb.copy(gb.binormals[0]).multiplyScalar(Mb.y),Ya.copy(Qa[0]).add(rb).add(cb),T(Ya.x,Ya.y,Ya.z)):T(Mb.x,Mb.y,0);for(ob=1;ob<=ka;ob++)for(Mb=0;Mb<Cb;Mb++)ja=wa?H(Ca[Mb],sb[Mb],Wa):Ca[Mb],Za?(rb.copy(gb.normals[ob]).multiplyScalar(ja.x),cb.copy(gb.binormals[ob]).multiplyScalar(ja.y),
Ya.copy(Qa[ob]).add(rb).add(cb),T(Ya.x,Ya.y,Ya.z)):T(ja.x,ja.y,qa/ka*ob);for(gb=Na-1;gb>=0;gb--){rb=gb/Na;cb=sa*Math.cos(rb*Math.PI/2);rb=Aa*Math.sin(rb*Math.PI/2)+Ba;for(let la=0,ta=ub.length;la<ta;la++)Ya=H(ub[la],E[la],rb),T(Ya.x,Ya.y,qa+cb);for(let la=0,ta=nb.length;la<ta;la++){Ya=nb[la];Wa=U[la];for(let ua=0,Pa=Ya.length;ua<Pa;ua++)Ca=H(Ya[ua],Wa[ua],rb),Za?T(Ca.x,Ca.y+Qa[ka-1].y,Qa[ka-1].x+cb):T(Ca.x,Ca.y,qa+cb)}}(function(){const la=n.length/3;if(wa){var ta=Cb*0;for(var ua=0;ua<ha;ua++){var Pa=
hb[ua];X(Pa[2]+ta,Pa[1]+ta,Pa[0]+ta)}ta=Cb*(ka+Na*2);for(ua=0;ua<ha;ua++)Pa=hb[ua],X(Pa[0]+ta,Pa[1]+ta,Pa[2]+ta)}else{for(ta=0;ta<ha;ta++)ua=hb[ta],X(ua[2],ua[1],ua[0]);for(ta=0;ta<ha;ta++)ua=hb[ta],X(ua[0]+Cb*ka,ua[1]+Cb*ka,ua[2]+Cb*ka)}h.addGroup(la,n.length/3-la,0)})();(function(){const la=n.length/3;let ta=0;R(ub,ta);ta+=ub.length;for(let ua=0,Pa=nb.length;ua<Pa;ua++){const oa=nb[ua];R(oa,ta);ta+=oa.length}h.addGroup(la,n.length/3-la,1)})()}super();this.type="ExtrudeGeometry";this.parameters=
{shapes:a,options:b};a=Array.isArray(a)?a:[a];const h=this,n=[],u=[];for(let E=0,F=a.length;E<F;E++)d(a[E]);this.setAttribute("position",new vb(n,3));this.setAttribute("uv",new vb(u,2));this.computeVertexNormals()}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON(),b=this.parameters.shapes,d=this.parameters.options;a.shapes=[];if(Array.isArray(b))for(let h=0,n=b.length;h<n;h++)a.shapes.push(b[h].uuid);else a.shapes.push(b.uuid);a.options=
Object.assign({},d);d.extrudePath!==void 0&&(a.options.extrudePath=d.extrudePath.toJSON());return a}static fromJSON(a,b){const d=[];for(let h=0,n=a.shapes.length;h<n;h++)d.push(b[a.shapes[h]]);b=a.options.extrudePath;b!==void 0&&(a.options.extrudePath=(new Mh[b.type]).fromJSON(b));return new tj(d,a.options)}}const bn={generateTopUV:function(a,b,d,h,n){a=b[h*3];h=b[h*3+1];const u=b[n*3];n=b[n*3+1];return[new Xa(b[d*3],b[d*3+1]),new Xa(a,h),new Xa(u,n)]},generateSideWallUV:function(a,b,d,h,n,u){a=b[d*
3];const E=b[d*3+1];d=b[d*3+2];const F=b[h*3],H=b[h*3+1];h=b[h*3+2];const M=b[n*3],R=b[n*3+1];n=b[n*3+2];const T=b[u*3],X=b[u*3+1];b=b[u*3+2];return Math.abs(E-H)<Math.abs(a-F)?[new Xa(a,1-d),new Xa(F,1-h),new Xa(M,1-n),new Xa(T,1-b)]:[new Xa(E,1-d),new Xa(H,1-h),new Xa(R,1-n),new Xa(X,1-b)]}};class uj extends df{constructor(a=1,b=0){const d=(1+Math.sqrt(5))/2;super([-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,
4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b}}static fromJSON(a){return new uj(a.radius,a.detail)}}class vj extends Vb{constructor(a=[new Xa(0,-.5),new Xa(.5,0),new Xa(0,.5)],b=12,d=0,h=Math.PI*2){super();this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:d,phiLength:h};b=Math.floor(b);h=r(h,0,Math.PI*2);const n=[],u=[],E=[];var F=[];const H=[];var M=1/b,R=new ma,T=
new Xa,X=new ma,ea=new ma,aa=new ma;let da;for(let ka=0;ka<=a.length-1;ka++)switch(ka){case 0:var U=a[ka+1].x-a[ka].x;da=a[ka+1].y-a[ka].y;X.x=da*1;X.y=-U;X.z=da*0;aa.copy(X);X.normalize();F.push(X.x,X.y,X.z);break;case a.length-1:F.push(aa.x,aa.y,aa.z);break;default:U=a[ka+1].x-a[ka].x,da=a[ka+1].y-a[ka].y,X.x=da*1,X.y=-U,X.z=da*0,ea.copy(X),X.x+=aa.x,X.y+=aa.y,X.z+=aa.z,X.normalize(),F.push(X.x,X.y,X.z),aa.copy(ea)}for(X=0;X<=b;X++)for(aa=d+X*M*h,ea=Math.sin(aa),aa=Math.cos(aa),U=0;U<=a.length-
1;U++)R.x=a[U].x*ea,R.y=a[U].y,R.z=a[U].x*aa,u.push(R.x,R.y,R.z),T.x=X/b,T.y=U/(a.length-1),E.push(T.x,T.y),H.push(F[3*U]*ea,F[3*U+1],F[3*U]*aa);for(d=0;d<b;d++)for(h=0;h<a.length-1;h++)F=h+d*a.length,M=F+a.length,R=F+a.length+1,T=F+1,n.push(F,M,T),n.push(R,T,M);this.setIndex(n);this.setAttribute("position",new vb(u,3));this.setAttribute("uv",new vb(E,2));this.setAttribute("normal",new vb(H,3))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new vj(a.points,
a.segments,a.phiStart,a.phiLength)}}class Oh extends df{constructor(a=1,b=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b}}static fromJSON(a){return new Oh(a.radius,a.detail)}}class rg extends Vb{constructor(a=1,b=1,d=1,h=1){super();this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:d,heightSegments:h};var n=a/2,u=b/2;d=Math.floor(d);h=Math.floor(h);const E=
d+1;var F=h+1,H=a/d,M=b/h;b=[];a=[];const R=[],T=[];for(let X=0;X<F;X++){const ea=X*M-u;for(let aa=0;aa<E;aa++)a.push(aa*H-n,-ea,0),R.push(0,0,1),T.push(aa/d),T.push(1-X/h)}for(n=0;n<h;n++)for(u=0;u<d;u++)F=u+E*(n+1),H=u+1+E*(n+1),M=u+1+E*n,b.push(u+E*n,F,M),b.push(F,H,M);this.setIndex(b);this.setAttribute("position",new vb(a,3));this.setAttribute("normal",new vb(R,3));this.setAttribute("uv",new vb(T,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new rg(a.width,
a.height,a.widthSegments,a.heightSegments)}}class wj extends Vb{constructor(a=.5,b=1,d=32,h=1,n=0,u=Math.PI*2){super();this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:d,phiSegments:h,thetaStart:n,thetaLength:u};d=Math.max(3,d);h=Math.max(1,h);const E=[],F=[],H=[],M=[];var R=a;a=(b-a)/h;var T=new ma,X=new Xa;for(let ea=0;ea<=h;ea++){for(let aa=0;aa<=d;aa++){const da=n+aa/d*u;T.x=R*Math.cos(da);T.y=R*Math.sin(da);F.push(T.x,T.y,T.z);H.push(0,0,1);X.x=(T.x/b+1)/2;
X.y=(T.y/b+1)/2;M.push(X.x,X.y)}R+=a}for(b=0;b<h;b++)for(n=b*(d+1),u=0;u<d;u++)R=u+n,a=R+d+1,T=R+d+2,X=R+1,E.push(R,a,X),E.push(a,T,X);this.setIndex(E);this.setAttribute("position",new vb(F,3));this.setAttribute("normal",new vb(H,3));this.setAttribute("uv",new vb(M,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new wj(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)}}class xj extends Vb{constructor(a=
new ef([new Xa(0,.5),new Xa(-.5,-.5),new Xa(.5,-.5)]),b=12){function d(M){const R=n.length/3;var T=M.extractPoints(b);M=T.shape;var X=T.holes;de.isClockWise(M)===!1&&(M=M.reverse());for(let ea=0,aa=X.length;ea<aa;ea++)T=X[ea],de.isClockWise(T)===!0&&(X[ea]=T.reverse());T=de.triangulateShape(M,X);for(let ea=0,aa=X.length;ea<aa;ea++)M=M.concat(X[ea]);for(let ea=0,aa=M.length;ea<aa;ea++)X=M[ea],n.push(X.x,X.y,0),u.push(0,0,1),E.push(X.x,X.y);for(let ea=0,aa=T.length;ea<aa;ea++)M=T[ea],h.push(M[0]+R,
M[1]+R,M[2]+R),H+=3}super();this.type="ShapeGeometry";this.parameters={shapes:a,curveSegments:b};const h=[],n=[],u=[],E=[];let F=0,H=0;if(Array.isArray(a)===!1)d(a);else for(let M=0;M<a.length;M++)d(a[M]),this.addGroup(F,H,M),F+=H,H=0;this.setIndex(h);this.setAttribute("position",new vb(n,3));this.setAttribute("normal",new vb(u,3));this.setAttribute("uv",new vb(E,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON(),b=this.parameters.shapes;
a.shapes=[];if(Array.isArray(b))for(let d=0,h=b.length;d<h;d++)a.shapes.push(b[d].uuid);else a.shapes.push(b.uuid);return a}static fromJSON(a,b){const d=[];for(let h=0,n=a.shapes.length;h<n;h++)d.push(b[a.shapes[h]]);return new xj(d,a.curveSegments)}}class Ph extends Vb{constructor(a=1,b=32,d=16,h=0,n=Math.PI*2,u=0,E=Math.PI){super();this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:d,phiStart:h,phiLength:n,thetaStart:u,thetaLength:E};b=Math.max(3,Math.floor(b));
d=Math.max(2,Math.floor(d));const F=Math.min(u+E,Math.PI);var H=0;const M=[];var R=new ma;const T=new ma,X=[],ea=[],aa=[],da=[];for(let U=0;U<=d;U++){const ka=[],qa=U/d;let wa=0;U===0&&u===0?wa=.5/b:U===d&&F===Math.PI&&(wa=-.5/b);for(let sa=0;sa<=b;sa++){const Aa=sa/b;R.x=-a*Math.cos(h+Aa*n)*Math.sin(u+qa*E);R.y=a*Math.cos(u+qa*E);R.z=a*Math.sin(h+Aa*n)*Math.sin(u+qa*E);ea.push(R.x,R.y,R.z);T.copy(R).normalize();aa.push(T.x,T.y,T.z);da.push(Aa+wa,1-qa);ka.push(H++)}M.push(ka)}for(a=0;a<d;a++)for(h=
0;h<b;h++)n=M[a][h+1],E=M[a][h],H=M[a+1][h],R=M[a+1][h+1],(a!==0||u>0)&&X.push(n,E,R),(a!==d-1||F<Math.PI)&&X.push(E,H,R);this.setIndex(X);this.setAttribute("position",new vb(ea,3));this.setAttribute("normal",new vb(aa,3));this.setAttribute("uv",new vb(da,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Ph(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)}}class yj extends df{constructor(a=
1,b=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b}}static fromJSON(a){return new yj(a.radius,a.detail)}}class zj extends Vb{constructor(a=1,b=.4,d=12,h=48,n=Math.PI*2){super();this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:d,tubularSegments:h,arc:n};d=Math.floor(d);h=Math.floor(h);const u=[],E=[],F=[],H=[];var M=new ma,R=new ma;const T=new ma;for(let X=0;X<=d;X++)for(let ea=0;ea<=
h;ea++){const aa=ea/h*n,da=X/d*Math.PI*2;R.x=(a+b*Math.cos(da))*Math.cos(aa);R.y=(a+b*Math.cos(da))*Math.sin(aa);R.z=b*Math.sin(da);E.push(R.x,R.y,R.z);M.x=a*Math.cos(aa);M.y=a*Math.sin(aa);T.subVectors(R,M).normalize();F.push(T.x,T.y,T.z);H.push(ea/h);H.push(X/d)}for(a=1;a<=d;a++)for(b=1;b<=h;b++)n=(h+1)*(a-1)+b-1,M=(h+1)*(a-1)+b,R=(h+1)*a+b,u.push((h+1)*a+b-1,n,R),u.push(n,M,R);this.setIndex(u);this.setAttribute("position",new vb(E,3));this.setAttribute("normal",new vb(F,3));this.setAttribute("uv",
new vb(H,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new zj(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc)}}class Aj extends Vb{constructor(a=1,b=.4,d=64,h=8,n=2,u=3){function E(sa,Aa,Ba,Na,Ca){const Ja=Math.sin(sa);Aa=Ba/Aa*sa;Ba=Math.cos(Aa);Ca.x=Na*(2+Ba)*.5*Math.cos(sa);Ca.y=Na*(2+Ba)*Ja*.5;Ca.z=Na*Math.sin(Aa)*.5}super();this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,tubularSegments:d,radialSegments:h,
p:n,q:u};d=Math.floor(d);h=Math.floor(h);const F=[],H=[],M=[],R=[];var T=new ma;const X=new ma,ea=new ma,aa=new ma,da=new ma,U=new ma,ka=new ma;for(let sa=0;sa<=d;++sa){var qa=sa/d*n*Math.PI*2;E(qa,n,u,a,ea);E(qa+.01,n,u,a,aa);U.subVectors(aa,ea);ka.addVectors(aa,ea);da.crossVectors(U,ka);ka.crossVectors(da,U);da.normalize();ka.normalize();for(qa=0;qa<=h;++qa){var wa=qa/h*Math.PI*2;const Aa=-b*Math.cos(wa);wa=b*Math.sin(wa);T.x=ea.x+(Aa*ka.x+wa*da.x);T.y=ea.y+(Aa*ka.y+wa*da.y);T.z=ea.z+(Aa*ka.z+wa*
da.z);H.push(T.x,T.y,T.z);X.subVectors(T,ea).normalize();M.push(X.x,X.y,X.z);R.push(sa/d);R.push(qa/h)}}for(a=1;a<=d;a++)for(b=1;b<=h;b++)n=(h+1)*a+(b-1),u=(h+1)*a+b,T=(h+1)*(a-1)+b,F.push((h+1)*(a-1)+(b-1),n,T),F.push(n,u,T);this.setIndex(F);this.setAttribute("position",new vb(H,3));this.setAttribute("normal",new vb(M,3));this.setAttribute("uv",new vb(R,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}static fromJSON(a){return new Aj(a.radius,a.tube,a.tubularSegments,
a.radialSegments,a.p,a.q)}}class Bj extends Vb{constructor(a=new rj(new ma(-1,-1,0),new ma(-1,1,0),new ma(1,1,0)),b=64,d=1,h=8,n=!1){function u(da){R=a.getPointAt(da/b,R);const U=E.normals[da];da=E.binormals[da];for(let qa=0;qa<=h;qa++){var ka=qa/h*Math.PI*2;const wa=Math.sin(ka);ka=-Math.cos(ka);H.x=ka*U.x+wa*da.x;H.y=ka*U.y+wa*da.y;H.z=ka*U.z+wa*da.z;H.normalize();X.push(H.x,H.y,H.z);F.x=R.x+d*H.x;F.y=R.y+d*H.y;F.z=R.z+d*H.z;T.push(F.x,F.y,F.z)}}super();this.type="TubeGeometry";this.parameters=
{path:a,tubularSegments:b,radius:d,radialSegments:h,closed:n};const E=a.computeFrenetFrames(b,n);this.tangents=E.tangents;this.normals=E.normals;this.binormals=E.binormals;const F=new ma,H=new ma,M=new Xa;let R=new ma;const T=[],X=[],ea=[],aa=[];(function(){for(var da=0;da<b;da++)u(da);u(n===!1?b:0);for(da=0;da<=b;da++)for(var U=0;U<=h;U++)M.x=da/b,M.y=U/h,ea.push(M.x,M.y);for(da=1;da<=b;da++)for(U=1;U<=h;U++){const ka=(h+1)*da+(U-1),qa=(h+1)*da+U,wa=(h+1)*(da-1)+U;aa.push((h+1)*(da-1)+(U-1),ka,wa);
aa.push(ka,qa,wa)}})();this.setIndex(aa);this.setAttribute("position",new vb(T,3));this.setAttribute("normal",new vb(X,3));this.setAttribute("uv",new vb(ea,2))}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}toJSON(){const a=super.toJSON();a.path=this.parameters.path.toJSON();return a}static fromJSON(a){return new Bj((new Mh[a.path.type]).fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed)}}class ll extends Vb{constructor(a=null){super();this.type=
"WireframeGeometry";this.parameters={geometry:a};if(a!==null){const u=[],E=new Set,F=new ma,H=new ma;if(a.index!==null){var b=a.attributes.position,d=a.index;a=a.groups;a.length===0&&(a=[{start:0,count:d.count,materialIndex:0}]);for(let M=0,R=a.length;M<R;++M){var h=a[M],n=h.start;h=h.count;for(let T=n,X=n+h;T<X;T+=3)for(n=0;n<3;n++){h=d.getX(T+n);const ea=d.getX(T+(n+1)%3);F.fromBufferAttribute(b,h);H.fromBufferAttribute(b,ea);Qd(F,H,E)===!0&&(u.push(F.x,F.y,F.z),u.push(H.x,H.y,H.z))}}}else{b=a.attributes.position;
for(let M=0,R=b.count/3;M<R;M++)for(d=0;d<3;d++)a=3*M+(d+1)%3,F.fromBufferAttribute(b,3*M+d),H.fromBufferAttribute(b,a),Qd(F,H,E)===!0&&(u.push(F.x,F.y,F.z),u.push(H.x,H.y,H.z))}this.setAttribute("position",new vb(u,3))}}copy(a){super.copy(a);this.parameters=Object.assign({},a.parameters);return this}}var ml=Object.freeze({__proto__:null,BoxGeometry:xf,CapsuleGeometry:hj,CircleGeometry:ij,ConeGeometry:Gh,CylinderGeometry:Fh,DodecahedronGeometry:jj,EdgesGeometry:fl,ExtrudeGeometry:tj,IcosahedronGeometry:uj,
LatheGeometry:vj,OctahedronGeometry:Oh,PlaneGeometry:rg,PolyhedronGeometry:df,RingGeometry:wj,ShapeGeometry:xj,SphereGeometry:Ph,TetrahedronGeometry:yj,TorusGeometry:zj,TorusKnotGeometry:Aj,TubeGeometry:Bj,WireframeGeometry:ll});class nl extends fd{constructor(a){super();this.isShadowMaterial=!0;this.type="ShadowMaterial";this.color=new pb(0);this.fog=this.transparent=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.fog=a.fog;return this}}class ol extends Jd{constructor(a){super(a);
this.isRawShaderMaterial=!0;this.type="RawShaderMaterial"}}class Cj extends fd{constructor(a){super();this.isMeshStandardMaterial=!0;this.type="MeshStandardMaterial";this.defines={STANDARD:""};this.color=new pb(16777215);this.roughness=1;this.metalness=0;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new pb(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=
new Xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapRotation=new Cd;this.envMapIntensity=1;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.defines={STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=
a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=
a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.envMapIntensity=a.envMapIntensity;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class pl extends Cj{constructor(a){super();this.isMeshPhysicalMaterial=!0;this.defines={STANDARD:"",PHYSICAL:""};
this.type="MeshPhysicalMaterial";this.anisotropyRotation=0;this.clearcoatMap=this.anisotropyMap=null;this.clearcoatRoughness=0;this.clearcoatRoughnessMap=null;this.clearcoatNormalScale=new Xa(1,1);this.clearcoatNormalMap=null;this.ior=1.5;Object.defineProperty(this,"reflectivity",{get:function(){return r(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(b){this.ior=(1+.4*b)/(1-.4*b)}});this.iridescenceMap=null;this.iridescenceIOR=1.3;this.iridescenceThicknessRange=[100,400];this.iridescenceThicknessMap=
null;this.sheenColor=new pb(0);this.sheenColorMap=null;this.sheenRoughness=1;this.transmissionMap=this.sheenRoughnessMap=null;this.thickness=0;this.thicknessMap=null;this.attenuationDistance=Infinity;this.attenuationColor=new pb(1,1,1);this.specularIntensity=1;this.specularIntensityMap=null;this.specularColor=new pb(1,1,1);this.specularColorMap=null;this._transmission=this._sheen=this._iridescence=this._dispersion=this._clearcoat=this._anisotropy=0;this.setValues(a)}get anisotropy(){return this._anisotropy}set anisotropy(a){this._anisotropy>
0!==a>0&&this.version++;this._anisotropy=a}get clearcoat(){return this._clearcoat}set clearcoat(a){this._clearcoat>0!==a>0&&this.version++;this._clearcoat=a}get iridescence(){return this._iridescence}set iridescence(a){this._iridescence>0!==a>0&&this.version++;this._iridescence=a}get dispersion(){return this._dispersion}set dispersion(a){this._dispersion>0!==a>0&&this.version++;this._dispersion=a}get sheen(){return this._sheen}set sheen(a){this._sheen>0!==a>0&&this.version++;this._sheen=a}get transmission(){return this._transmission}set transmission(a){this._transmission>
0!==a>0&&this.version++;this._transmission=a}copy(a){super.copy(a);this.defines={STANDARD:"",PHYSICAL:""};this.anisotropy=a.anisotropy;this.anisotropyRotation=a.anisotropyRotation;this.anisotropyMap=a.anisotropyMap;this.clearcoat=a.clearcoat;this.clearcoatMap=a.clearcoatMap;this.clearcoatRoughness=a.clearcoatRoughness;this.clearcoatRoughnessMap=a.clearcoatRoughnessMap;this.clearcoatNormalMap=a.clearcoatNormalMap;this.clearcoatNormalScale.copy(a.clearcoatNormalScale);this.dispersion=a.dispersion;this.ior=
a.ior;this.iridescence=a.iridescence;this.iridescenceMap=a.iridescenceMap;this.iridescenceIOR=a.iridescenceIOR;this.iridescenceThicknessRange=[...a.iridescenceThicknessRange];this.iridescenceThicknessMap=a.iridescenceThicknessMap;this.sheen=a.sheen;this.sheenColor.copy(a.sheenColor);this.sheenColorMap=a.sheenColorMap;this.sheenRoughness=a.sheenRoughness;this.sheenRoughnessMap=a.sheenRoughnessMap;this.transmission=a.transmission;this.transmissionMap=a.transmissionMap;this.thickness=a.thickness;this.thicknessMap=
a.thicknessMap;this.attenuationDistance=a.attenuationDistance;this.attenuationColor.copy(a.attenuationColor);this.specularIntensity=a.specularIntensity;this.specularIntensityMap=a.specularIntensityMap;this.specularColor.copy(a.specularColor);this.specularColorMap=a.specularColorMap;return this}}class ql extends fd{constructor(a){super();this.isMeshPhongMaterial=!0;this.type="MeshPhongMaterial";this.color=new pb(16777215);this.specular=new pb(1118481);this.shininess=30;this.lightMap=this.map=null;
this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new pb(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Cd;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=
this.wireframeLinecap="round";this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;
this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=
a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class rl extends fd{constructor(a){super();this.isMeshToonMaterial=!0;this.defines={TOON:""};this.type="MeshToonMaterial";this.color=new pb(16777215);this.lightMap=this.gradientMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new pb(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=
0;this.normalScale=new Xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.gradientMap=a.gradientMap;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=
a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.alphaMap=a.alphaMap;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;
this.fog=a.fog;return this}}class sl extends fd{constructor(a){super();this.isMeshNormalMaterial=!0;this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.flatShading=!1;this.setValues(a)}copy(a){super.copy(a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=
a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.flatShading=a.flatShading;return this}}class tl extends fd{constructor(a){super();this.isMeshLambertMaterial=!0;this.type="MeshLambertMaterial";this.color=new pb(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=
1;this.emissive=new pb(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.envMapRotation=new Cd;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.flatShading=!1;this.fog=
!0;this.setValues(a)}copy(a){super.copy(a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=
a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapRotation.copy(a.envMapRotation);this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class wi extends fd{constructor(a){super();
this.isMeshDepthMaterial=!0;this.type="MeshDepthMaterial";this.depthPacking=3200;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(a)}copy(a){super.copy(a);this.depthPacking=a.depthPacking;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=
a.wireframeLinewidth;return this}}class xi extends fd{constructor(a){super();this.isMeshDistanceMaterial=!0;this.type="MeshDistanceMaterial";this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.setValues(a)}copy(a){super.copy(a);this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this}}class ul extends fd{constructor(a){super();this.isMeshMatcapMaterial=
!0;this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new pb(16777215);this.bumpMap=this.map=this.matcap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new Xa(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.flatShading=!1;this.fog=!0;this.setValues(a)}copy(a){super.copy(a);this.defines={MATCAP:""};this.color.copy(a.color);this.matcap=a.matcap;this.map=a.map;this.bumpMap=a.bumpMap;this.bumpScale=
a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.alphaMap=a.alphaMap;this.flatShading=a.flatShading;this.fog=a.fog;return this}}class vl extends jd{constructor(a){super();this.isLineDashedMaterial=!0;this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}copy(a){super.copy(a);
this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;return this}}class cn{static convertArray(a,b){return Ec(a,b)}static isTypedArray(a){return te(a)}static getKeyframeOrder(a){return ue(a)}static sortedArray(a,b,d){return fe(a,b,d)}static flattenJSON(a,b,d,h){ge(a,b,d,h)}static subclip(a,b,d,h,n=30){return ve(a,b,d,h,n)}static makeClipAdditive(a,b=0,d=a,h=30){return Rd(a,b,d,h)}}class Kg{constructor(a,b,d,h){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=h!==void 0?
h:new b.constructor(d);this.sampleValues=b;this.valueSize=d;this.settings=null;this.DefaultSettings_={}}evaluate(a){const b=this.parameterPositions;let d=this._cachedIndex;var h=b[d],n=b[d-1];a:{b:{c:{d:if(!(a<h)){for(var u=d+2;;){if(h===void 0){if(a<n)break d;this._cachedIndex=d=b.length;return this.copySampleValue_(d-1)}if(d===u)break;n=h;h=b[++d];if(a<h)break b}n=b.length;break c}if(a>=n)break a;else{h=b[1];a<h&&(d=2,n=h);for(u=d-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);
if(d===u)break;h=n;n=b[--d-1];if(a>=n)break b}n=d;d=0}}for(;d<n;)h=d+n>>>1,a<b[h]?n=h:d=h+1;h=b[d];n=b[d-1];if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(h===void 0)return this._cachedIndex=d=b.length,this.copySampleValue_(d-1)}this._cachedIndex=d;this.intervalChanged_(d,n,h)}return this.interpolate_(d,n,a,h)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){const b=this.resultBuffer,d=this.sampleValues,h=this.valueSize;a*=h;for(let n=0;n!==h;++n)b[n]=
d[a+n];return b}interpolate_(){throw Error("call to abstract method");}intervalChanged_(){}}class wl extends Kg{constructor(a,b,d,h){super(a,b,d,h);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0;this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(a,b,d){var h=this.parameterPositions;let n=a-2,u=a+1,E=h[n],F=h[u];if(E===void 0)switch(this.getSettings_().endingStart){case 2401:n=a;E=2*b-d;break;case 2402:n=h.length-2;E=b+h[n]-h[n+1];break;default:n=a,E=d}if(F===
void 0)switch(this.getSettings_().endingEnd){case 2401:u=a;F=2*d-b;break;case 2402:u=1;F=d+h[1]-h[0];break;default:u=a-1,F=b}a=(d-b)*.5;h=this.valueSize;this._weightPrev=a/(b-E);this._weightNext=a/(F-d);this._offsetPrev=n*h;this._offsetNext=u*h}interpolate_(a,b,d,h){const n=this.resultBuffer,u=this.sampleValues,E=this.valueSize;a*=E;const F=a-E,H=this._offsetPrev,M=this._offsetNext;var R=this._weightPrev,T=this._weightNext,X=(d-b)/(h-b);d=X*X;h=d*X;b=-R*h+2*R*d-R*X;R=(1+R)*h+(-1.5-2*R)*d+(-.5+R)*
X+1;X=(-1-T)*h+(1.5+T)*d+.5*X;T=T*h-T*d;for(d=0;d!==E;++d)n[d]=b*u[H+d]+R*u[F+d]+X*u[a+d]+T*u[M+d];return n}}class Dj extends Kg{constructor(a,b,d,h){super(a,b,d,h)}interpolate_(a,b,d,h){const n=this.resultBuffer,u=this.sampleValues,E=this.valueSize;a*=E;const F=a-E;b=(d-b)/(h-b);d=1-b;for(h=0;h!==E;++h)n[h]=u[F+h]*d+u[a+h]*b;return n}}class xl extends Kg{constructor(a,b,d,h){super(a,b,d,h)}interpolate_(a){return this.copySampleValue_(a-1)}}class Ed{constructor(a,b,d,h){if(a===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");
if(b===void 0||b.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=Ec(b,this.TimeBufferType);this.values=Ec(d,this.ValueBufferType);this.setInterpolation(h||this.DefaultInterpolation)}static toJSON(a){var b=a.constructor;if(b.toJSON!==this.toJSON)b=b.toJSON(a);else{b={name:a.name,times:Ec(a.times,Array),values:Ec(a.values,Array)};const d=a.getInterpolation();d!==a.DefaultInterpolation&&(b.interpolation=d)}b.type=a.ValueTypeName;return b}InterpolantFactoryMethodDiscrete(a){return new xl(this.times,
this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new Dj(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new wl(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(b===void 0){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+
this.name;if(this.createInterpolant===void 0)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);console.warn("THREE.KeyframeTrack:",b);return this}this.createInterpolant=b;return this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(a){if(a!==
0){const b=this.times;for(let d=0,h=b.length;d!==h;++d)b[d]+=a}return this}scale(a){if(a!==1){const b=this.times;for(let d=0,h=b.length;d!==h;++d)b[d]*=a}return this}trim(a,b){const d=this.times,h=d.length;let n=0,u=h-1;for(;n!==h&&d[n]<a;)++n;for(;u!==-1&&d[u]>b;)--u;++u;if(n!==0||u!==h)n>=u&&(u=Math.max(u,1),n=u-1),a=this.getValueSize(),this.times=d.slice(n,u),this.values=this.values.slice(n*a,u*a);return this}validate(){let a=!0;var b=this.getValueSize();b-Math.floor(b)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",
this),a=!1);var d=this.times;b=this.values;const h=d.length;h===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);let n=null;for(let u=0;u!==h;u++){const E=d[u];if(typeof E==="number"&&isNaN(E)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,E);a=!1;break}if(n!==null&&n>E){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,E,n);a=!1;break}n=E}if(b!==void 0&&te(b))for(let u=0,E=b.length;u!==E;++u)if(d=b[u],isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",
this,u,d);a=!1;break}return a}optimize(){const a=this.times.slice(),b=this.values.slice(),d=this.getValueSize(),h=this.getInterpolation()===2302,n=a.length-1;let u=1;for(let M=1;M<n;++M){var E=!1,F=a[M];if(F!==a[M+1]&&(M!==1||F!==a[0]))if(h)E=!0;else{F=M*d;var H=F-d;const R=F+d;for(let T=0;T!==d;++T){const X=b[F+T];if(X!==b[H+T]||X!==b[R+T]){E=!0;break}}}if(E){if(M!==u)for(a[u]=a[M],E=M*d,F=u*d,H=0;H!==d;++H)b[F+H]=b[E+H];++u}}if(n>0){a[u]=a[n];for(let M=n*d,R=u*d,T=0;T!==d;++T)b[R+T]=b[M+T];++u}u!==
a.length?(this.times=a.slice(0,u),this.values=b.slice(0,u*d)):(this.times=a,this.values=b);return this}clone(){var a=this.times.slice();const b=this.values.slice();a=new this.constructor(this.name,a,b);a.createInterpolant=this.createInterpolant;return a}}Ed.prototype.ValueTypeName="";Ed.prototype.TimeBufferType=Float32Array;Ed.prototype.ValueBufferType=Float32Array;Ed.prototype.DefaultInterpolation=2301;class Ve extends Ed{constructor(a,b,d){super(a,b,d)}}Ve.prototype.ValueTypeName="bool";Ve.prototype.ValueBufferType=
Array;Ve.prototype.DefaultInterpolation=2300;Ve.prototype.InterpolantFactoryMethodLinear=void 0;Ve.prototype.InterpolantFactoryMethodSmooth=void 0;class bi extends Ed{constructor(a,b,d,h){super(a,b,d,h)}}bi.prototype.ValueTypeName="color";class og extends Ed{constructor(a,b,d,h){super(a,b,d,h)}}og.prototype.ValueTypeName="number";class yl extends Kg{constructor(a,b,d,h){super(a,b,d,h)}interpolate_(a,b,d,h){const n=this.resultBuffer,u=this.sampleValues,E=this.valueSize;b=(d-b)/(h-b);a*=E;for(d=a+E;a!==
d;a+=4)dd.slerpFlat(n,0,u,a-E,u,a,b);return n}}class qg extends Ed{constructor(a,b,d,h){super(a,b,d,h)}InterpolantFactoryMethodLinear(a){return new yl(this.times,this.values,this.getValueSize(),a)}}qg.prototype.ValueTypeName="quaternion";qg.prototype.InterpolantFactoryMethodSmooth=void 0;class We extends Ed{constructor(a,b,d){super(a,b,d)}}We.prototype.ValueTypeName="string";We.prototype.ValueBufferType=Array;We.prototype.DefaultInterpolation=2300;We.prototype.InterpolantFactoryMethodLinear=void 0;
We.prototype.InterpolantFactoryMethodSmooth=void 0;class pg extends Ed{constructor(a,b,d,h){super(a,b,d,h)}}pg.prototype.ValueTypeName="vector";class Lg{constructor(a="",b=-1,d=[],h=2500){this.name=a;this.tracks=d;this.duration=b;this.blendMode=h;this.uuid=x();this.userData={};this.duration<0&&this.resetDuration()}static parse(a){var b=[];const d=a.tracks,h=1/(a.fps||1);for(let F=0,H=d.length;F!==H;++F){var n=b,u=n.push;{var E=d[F];if(E.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");
const M=md(E.type);if(E.times===void 0){const R=[],T=[];ge(E.keys,R,T,"value");E.times=R;E.values=T}E=M.parse!==void 0?M.parse(E):new M(E.name,E.times,E.values,E.interpolation)}u.call(n,E.scale(h))}b=new this(a.name,a.duration,b,a.blendMode);b.uuid=a.uuid;b.userData=JSON.parse(a.userData||"{}");return b}static toJSON(a){const b=[],d=a.tracks;a={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid,blendMode:a.blendMode,userData:JSON.stringify(a.userData)};for(let h=0,n=d.length;h!==n;++h)b.push(Ed.toJSON(d[h]));
return a}static CreateFromMorphTargetSequence(a,b,d,h){const n=b.length,u=[];for(let E=0;E<n;E++){let F=[],H=[];F.push((E+n-1)%n,E,(E+1)%n);H.push(0,1,0);const M=ue(F);F=fe(F,1,M);H=fe(H,1,M);h||F[0]!==0||(F.push(n),H.push(H[0]));u.push((new og(".morphTargetInfluences["+b[E].name+"]",F,H)).scale(1/d))}return new this(a,-1,u)}static findByName(a,b){let d=a;Array.isArray(a)||(d=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<d.length;a++)if(d[a].name===b)return d[a];return null}static CreateClipsFromMorphTargetSequences(a,
b,d){const h={},n=/^([\w-]*?)([\d]+)$/;for(let E=0,F=a.length;E<F;E++){const H=a[E];var u=H.name.match(n);if(u&&u.length>1){u=u[1];let M=h[u];M||(h[u]=M=[]);M.push(H)}}a=[];for(const E in h)a.push(this.CreateFromMorphTargetSequence(E,h[E],b,d));return a}static parseAnimation(a,b){console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185");if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const d=function(R,T,X,ea,aa){if(X.length!==
0){const da=[],U=[];ge(X,da,U,ea);da.length!==0&&aa.push(new R(T,da,U))}},h=[],n=a.name||"default",u=a.fps||30,E=a.blendMode;var F=a.length||-1;a=a.hierarchy||[];for(let R=0;R<a.length;R++){const T=a[R].keys;if(T&&T.length!==0)if(T[0].morphTargets){F={};var H=void 0;for(H=0;H<T.length;H++)if(T[H].morphTargets)for(var M=0;M<T[H].morphTargets.length;M++)F[T[H].morphTargets[M]]=-1;for(const X in F){M=[];const ea=[];for(let aa=0;aa!==T[H].morphTargets.length;++aa){const da=T[H];M.push(da.time);ea.push(da.morphTarget===
X?1:0)}h.push(new og(".morphTargetInfluence["+X+"]",M,ea))}F=F.length*u}else H=".bones["+b[R].name+"]",d(pg,H+".position",T,"pos",h),d(qg,H+".quaternion",T,"rot",h),d(pg,H+".scale",T,"scl",h)}return h.length===0?null:new this(n,F,h,E)}resetDuration(){var a=this.tracks;let b=0;for(let d=0,h=a.length;d!==h;++d)a=this.tracks[d],b=Math.max(b,a.times[a.times.length-1]);this.duration=b;return this}trim(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this}validate(){let a=
!0;for(let b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a}optimize(){for(let a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}clone(){var a=[];for(let b=0;b<this.tracks.length;b++)a.push(this.tracks[b].clone());a=new this.constructor(this.name,this.duration,a,this.blendMode);a.userData=JSON.parse(JSON.stringify(this.userData));return a}toJSON(){return this.constructor.toJSON(this)}}const ee={enabled:!1,files:{},add:function(a,b){this.enabled!==!1&&(this.files[a]=
b)},get:function(a){if(this.enabled!==!1)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class Ej{constructor(a,b,d){const h=this;let n=!1,u=0,E=0,F=void 0;const H=[];this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=d;this.abortController=new AbortController;this.itemStart=function(M){E++;if(n===!1&&h.onStart!==void 0)h.onStart(M,u,E);n=!0};this.itemEnd=function(M){u++;if(h.onProgress!==void 0)h.onProgress(M,u,E);if(u===E&&(n=!1,h.onLoad!==
void 0))h.onLoad()};this.itemError=function(M){if(h.onError!==void 0)h.onError(M)};this.resolveURL=function(M){return F?F(M):M};this.setURLModifier=function(M){F=M;return this};this.addHandler=function(M,R){H.push(M,R);return this};this.removeHandler=function(M){M=H.indexOf(M);M!==-1&&H.splice(M,2);return this};this.getHandler=function(M){for(let R=0,T=H.length;R<T;R+=2){const X=H[R],ea=H[R+1];X.global&&(X.lastIndex=0);if(X.test(M))return ea}return null};this.abort=function(){this.abortController.abort();
this.abortController=new AbortController;return this}}}const zl=new Ej;class pd{constructor(a){this.manager=a!==void 0?a:zl;this.crossOrigin="anonymous";this.withCredentials=!1;this.resourcePath=this.path="";this.requestHeader={}}load(){}loadAsync(a,b){const d=this;return new Promise(function(h,n){d.load(a,h,b,n)})}parse(){}setCrossOrigin(a){this.crossOrigin=a;return this}setWithCredentials(a){this.withCredentials=a;return this}setPath(a){this.path=a;return this}setResourcePath(a){this.resourcePath=
a;return this}setRequestHeader(a){this.requestHeader=a;return this}abort(){return this}}pd.DEFAULT_MATERIAL_NAME="__DEFAULT";const oe={};class dn extends Error{constructor(a,b){super(a);this.response=b}}class pe extends pd{constructor(a){super(a);this.responseType=this.mimeType="";this._abortController=new AbortController}load(a,b,d,h){a===void 0&&(a="");this.path!==void 0&&(a=this.path+a);a=this.manager.resolveURL(a);const n=ee.get(`file:${a}`);if(n!==void 0)return this.manager.itemStart(a),setTimeout(()=>
{b&&b(n);this.manager.itemEnd(a)},0),n;if(oe[a]!==void 0)oe[a].push({onLoad:b,onProgress:d,onError:h});else{oe[a]=[];oe[a].push({onLoad:b,onProgress:d,onError:h});d=new Request(a,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any==="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal});var u=this.mimeType,E=this.responseType;fetch(d).then(F=>{if(F.status===
200||F.status===0){F.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received.");if(typeof ReadableStream==="undefined"||F.body===void 0||F.body.getReader===void 0)return F;const H=oe[a],M=F.body.getReader(),R=(F=F.headers.get("X-File-Size")||F.headers.get("Content-Length"))?parseInt(F):0,T=R!==0;let X=0;F=new ReadableStream({start(ea){function aa(){M.read().then(({done:da,value:U})=>{if(da)ea.close();else{X+=U.byteLength;da=new ProgressEvent("progress",{lengthComputable:T,loaded:X,total:R});
for(let ka=0,qa=H.length;ka<qa;ka++){const wa=H[ka];if(wa.onProgress)wa.onProgress(da)}ea.enqueue(U);aa()}},da=>{ea.error(da)})}aa()}});return new Response(F)}throw new dn(`fetch for "${F.url}" responded with ${F.status}: ${F.statusText}`,F);}).then(F=>{switch(E){case "arraybuffer":return F.arrayBuffer();case "blob":return F.blob();case "document":return F.text().then(R=>(new DOMParser).parseFromString(R,u));case "json":return F.json();default:if(u==="")return F.text();var H=/charset="?([^;"\s]*)"?/i.exec(u);
H=H&&H[1]?H[1].toLowerCase():void 0;const M=new TextDecoder(H);return F.arrayBuffer().then(R=>M.decode(R))}}).then(F=>{ee.add(`file:${a}`,F);const H=oe[a];delete oe[a];for(let M=0,R=H.length;M<R;M++){const T=H[M];if(T.onLoad)T.onLoad(F)}}).catch(F=>{const H=oe[a];if(H===void 0)throw this.manager.itemError(a),F;delete oe[a];for(let M=0,R=H.length;M<R;M++){const T=H[M];if(T.onError)T.onError(F)}this.manager.itemError(a)}).finally(()=>{this.manager.itemEnd(a)});this.manager.itemStart(a)}}setResponseType(a){this.responseType=
a;return this}setMimeType(a){this.mimeType=a;return this}abort(){this._abortController.abort();this._abortController=new AbortController;return this}}class en extends pd{constructor(a){super(a)}load(a,b,d,h){const n=this,u=new pe(this.manager);u.setPath(this.path);u.setRequestHeader(this.requestHeader);u.setWithCredentials(this.withCredentials);u.load(a,function(E){try{b(n.parse(JSON.parse(E)))}catch(F){h?h(F):console.error(F),n.manager.itemError(a)}},d,h)}parse(a){const b=[];for(let d=0;d<a.length;d++){const h=
Lg.parse(a[d]);b.push(h)}return b}}class fn extends pd{constructor(a){super(a)}load(a,b,d,h){function n(R){H.load(a[R],function(T){T=u.parse(T,!0);E[R]={width:T.width,height:T.height,format:T.format,mipmaps:T.mipmaps};M+=1;M===6&&(T.mipmapCount===1&&(F.minFilter=1006),F.image=E,F.format=T.format,F.needsUpdate=!0,b&&b(F))},d,h)}const u=this,E=[],F=new Eh,H=new pe(this.manager);H.setPath(this.path);H.setResponseType("arraybuffer");H.setRequestHeader(this.requestHeader);H.setWithCredentials(u.withCredentials);
let M=0;if(Array.isArray(a))for(let R=0,T=a.length;R<T;++R)n(R);else H.load(a,function(R){R=u.parse(R,!0);if(R.isCubemap){const T=R.mipmaps.length/R.mipmapCount;for(let X=0;X<T;X++){E[X]={mipmaps:[]};for(let ea=0;ea<R.mipmapCount;ea++)E[X].mipmaps.push(R.mipmaps[X*R.mipmapCount+ea]),E[X].format=R.format,E[X].width=R.width,E[X].height=R.height}F.image=E}else F.image.width=R.width,F.image.height=R.height,F.mipmaps=R.mipmaps;R.mipmapCount===1&&(F.minFilter=1006);F.format=R.format;F.needsUpdate=!0;b&&
b(F)},d,h);return F}}const Vf=new WeakMap;class Mg extends pd{constructor(a){super(a)}load(a,b,d,h){function n(){E();b&&b(this);const R=Vf.get(this)||[];for(let T=0;T<R.length;T++){const X=R[T];if(X.onLoad)X.onLoad(this)}Vf.delete(this);F.manager.itemEnd(a)}function u(R){E();h&&h(R);ee.remove(`image:${a}`);const T=Vf.get(this)||[];for(let X=0;X<T.length;X++){const ea=T[X];if(ea.onError)ea.onError(R)}Vf.delete(this);F.manager.itemError(a);F.manager.itemEnd(a)}function E(){M.removeEventListener("load",
n,!1);M.removeEventListener("error",u,!1)}this.path!==void 0&&(a=this.path+a);a=this.manager.resolveURL(a);const F=this,H=ee.get(`image:${a}`);if(H!==void 0)return H.complete===!0?(F.manager.itemStart(a),setTimeout(function(){b&&b(H);F.manager.itemEnd(a)},0)):(d=Vf.get(H),d===void 0&&(d=[],Vf.set(H,d)),d.push({onLoad:b,onError:h})),H;const M=p("img");M.addEventListener("load",n,!1);M.addEventListener("error",u,!1);a.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(M.crossOrigin=this.crossOrigin);
ee.add(`image:${a}`,M);F.manager.itemStart(a);M.src=a;return M}}class gn extends pd{constructor(a){super(a)}load(a,b,d,h){function n(H){E.load(a[H],function(M){u.images[H]=M;F++;F===6&&(u.needsUpdate=!0,b&&b(u))},void 0,h)}const u=new Bg;u.colorSpace="srgb";const E=new Mg(this.manager);E.setCrossOrigin(this.crossOrigin);E.setPath(this.path);let F=0;for(d=0;d<a.length;++d)n(d);return u}}class hn extends pd{constructor(a){super(a)}load(a,b,d,h){const n=this,u=new $d,E=new pe(this.manager);E.setResponseType("arraybuffer");
E.setRequestHeader(this.requestHeader);E.setPath(this.path);E.setWithCredentials(n.withCredentials);E.load(a,function(F){let H;try{H=n.parse(F)}catch(M){if(h!==void 0)h(M);else{console.error(M);return}}H.image!==void 0?u.image=H.image:H.data!==void 0&&(u.image.width=H.width,u.image.height=H.height,u.image.data=H.data);u.wrapS=H.wrapS!==void 0?H.wrapS:1001;u.wrapT=H.wrapT!==void 0?H.wrapT:1001;u.magFilter=H.magFilter!==void 0?H.magFilter:1006;u.minFilter=H.minFilter!==void 0?H.minFilter:1006;u.anisotropy=
H.anisotropy!==void 0?H.anisotropy:1;H.colorSpace!==void 0&&(u.colorSpace=H.colorSpace);H.flipY!==void 0&&(u.flipY=H.flipY);H.format!==void 0&&(u.format=H.format);H.type!==void 0&&(u.type=H.type);H.mipmaps!==void 0&&(u.mipmaps=H.mipmaps,u.minFilter=1008);H.mipmapCount===1&&(u.minFilter=1006);H.generateMipmaps!==void 0&&(u.generateMipmaps=H.generateMipmaps);u.needsUpdate=!0;b&&b(u,H)},d,h);return u}}class jn extends pd{constructor(a){super(a)}load(a,b,d,h){const n=new Cc,u=new Mg(this.manager);u.setCrossOrigin(this.crossOrigin);
u.setPath(this.path);u.load(a,function(E){n.image=E;n.needsUpdate=!0;b!==void 0&&b(n)},d,h);return n}}class Ke extends jc{constructor(a,b=1){super();this.isLight=!0;this.type="Light";this.color=new pb(a);this.intensity=b}dispose(){}copy(a,b){super.copy(a,b);this.color.copy(a.color);this.intensity=a.intensity;return this}toJSON(a){a=super.toJSON(a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;this.groundColor!==void 0&&(a.object.groundColor=this.groundColor.getHex());this.distance!==
void 0&&(a.object.distance=this.distance);this.angle!==void 0&&(a.object.angle=this.angle);this.decay!==void 0&&(a.object.decay=this.decay);this.penumbra!==void 0&&(a.object.penumbra=this.penumbra);this.shadow!==void 0&&(a.object.shadow=this.shadow.toJSON());this.target!==void 0&&(a.object.target=this.target.uuid);return a}}class Al extends Ke{constructor(a,b,d){super(a,d);this.isHemisphereLight=!0;this.type="HemisphereLight";this.position.copy(jc.DEFAULT_UP);this.updateMatrix();this.groundColor=
new pb(b)}copy(a,b){super.copy(a,b);this.groundColor.copy(a.groundColor);return this}}const Fj=new Gb,Bl=new ma,Cl=new ma;class Gj{constructor(a){this.camera=a;this.intensity=1;this.normalBias=this.bias=0;this.radius=1;this.blurSamples=8;this.mapSize=new Xa(512,512);this.mapType=1009;this.mapPass=this.map=null;this.matrix=new Gb;this.autoUpdate=!0;this.needsUpdate=!1;this._frustum=new Bf;this._frameExtents=new Xa(1,1);this._viewportCount=1;this._viewports=[new ec(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(a){const b=
this.camera,d=this.matrix;Bl.setFromMatrixPosition(a.matrixWorld);b.position.copy(Bl);Cl.setFromMatrixPosition(a.target.matrixWorld);b.lookAt(Cl);b.updateMatrixWorld();Fj.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);this._frustum.setFromProjectionMatrix(Fj,b.coordinateSystem,b.reversedDepth);b.reversedDepth?d.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);d.multiply(Fj)}getViewport(a){return this._viewports[a]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&
this.map.dispose();this.mapPass&&this.mapPass.dispose()}copy(a){this.camera=a.camera.clone();this.intensity=a.intensity;this.bias=a.bias;this.radius=a.radius;this.autoUpdate=a.autoUpdate;this.needsUpdate=a.needsUpdate;this.normalBias=a.normalBias;this.blurSamples=a.blurSamples;this.mapSize.copy(a.mapSize);return this}clone(){return(new this.constructor).copy(this)}toJSON(){const a={};this.intensity!==1&&(a.intensity=this.intensity);this.bias!==0&&(a.bias=this.bias);this.normalBias!==0&&(a.normalBias=
this.normalBias);this.radius!==1&&(a.radius=this.radius);if(this.mapSize.x!==512||this.mapSize.y!==512)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;return a}}class kn extends Gj{constructor(){super(new Yc(50,1,.5,500));this.isSpotLightShadow=!0;this.aspect=this.focus=1}updateMatrices(a){const b=this.camera,d=ye*2*a.angle*this.focus,h=this.mapSize.width/this.mapSize.height*this.aspect,n=a.distance||b.far;if(d!==b.fov||h!==b.aspect||n!==b.far)b.fov=
d,b.aspect=h,b.far=n,b.updateProjectionMatrix();super.updateMatrices(a)}copy(a){super.copy(a);this.focus=a.focus;return this}}class Dl extends Ke{constructor(a,b,d=0,h=Math.PI/3,n=0,u=2){super(a,b);this.isSpotLight=!0;this.type="SpotLight";this.position.copy(jc.DEFAULT_UP);this.updateMatrix();this.target=new jc;this.distance=d;this.angle=h;this.penumbra=n;this.decay=u;this.map=null;this.shadow=new kn}get power(){return this.intensity*Math.PI}set power(a){this.intensity=a/Math.PI}dispose(){this.shadow.dispose()}copy(a,
b){super.copy(a,b);this.distance=a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this}}const El=new Gb,Ng=new ma,Hj=new ma;class ln extends Gj{constructor(){super(new Yc(90,1,.5,500));this.isPointLightShadow=!0;this._frameExtents=new Xa(4,2);this._viewportCount=6;this._viewports=[new ec(2,1,1,1),new ec(0,1,1,1),new ec(3,1,1,1),new ec(1,1,1,1),new ec(3,0,1,1),new ec(1,0,1,1)];this._cubeDirections=[new ma(1,0,
0),new ma(-1,0,0),new ma(0,0,1),new ma(0,0,-1),new ma(0,1,0),new ma(0,-1,0)];this._cubeUps=[new ma(0,1,0),new ma(0,1,0),new ma(0,1,0),new ma(0,1,0),new ma(0,0,1),new ma(0,0,-1)]}updateMatrices(a,b=0){const d=this.camera,h=this.matrix,n=a.distance||d.far;n!==d.far&&(d.far=n,d.updateProjectionMatrix());Ng.setFromMatrixPosition(a.matrixWorld);d.position.copy(Ng);Hj.copy(d.position);Hj.add(this._cubeDirections[b]);d.up.copy(this._cubeUps[b]);d.lookAt(Hj);d.updateMatrixWorld();h.makeTranslation(-Ng.x,
-Ng.y,-Ng.z);El.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse);this._frustum.setFromProjectionMatrix(El,d.coordinateSystem,d.reversedDepth)}}class Fl extends Ke{constructor(a,b,d=0,h=2){super(a,b);this.isPointLight=!0;this.type="PointLight";this.distance=d;this.decay=h;this.shadow=new ln}get power(){return this.intensity*4*Math.PI}set power(a){this.intensity=a/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(a,b){super.copy(a,b);this.distance=a.distance;this.decay=a.decay;this.shadow=a.shadow.clone();
return this}}class Qh extends sh{constructor(a=-1,b=1,d=1,h=-1,n=.1,u=2E3){super();this.isOrthographicCamera=!0;this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=a;this.right=b;this.top=d;this.bottom=h;this.near=n;this.far=u;this.updateProjectionMatrix()}copy(a,b){super.copy(a,b);this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=a.view===null?null:Object.assign({},a.view);return this}setViewOffset(a,
b,d,h,n,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=d;this.view.offsetY=h;this.view.width=n;this.view.height=u;this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1);this.updateProjectionMatrix()}updateProjectionMatrix(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/
2,h=(this.top+this.bottom)/2;let n=d-a;d+=a;a=h+b;b=h-b;this.view!==null&&this.view.enabled&&(h=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom,n+=h*this.view.offsetX,d=n+h*this.view.width,a-=b*this.view.offsetY,b=a-b*this.view.height);this.projectionMatrix.makeOrthographic(n,d,a,b,this.near,this.far,this.coordinateSystem,this.reversedDepth);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(a){a=super.toJSON(a);a.object.zoom=
this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;a.object.far=this.far;this.view!==null&&(a.object.view=Object.assign({},this.view));return a}}class mn extends Gj{constructor(){super(new Qh(-5,5,5,-5,.5,500));this.isDirectionalLightShadow=!0}}class Gl extends Ke{constructor(a,b){super(a,b);this.isDirectionalLight=!0;this.type="DirectionalLight";this.position.copy(jc.DEFAULT_UP);this.updateMatrix();this.target=new jc;
this.shadow=new mn}dispose(){this.shadow.dispose()}copy(a){super.copy(a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this}}class Hl extends Ke{constructor(a,b){super(a,b);this.isAmbientLight=!0;this.type="AmbientLight"}}class Il extends Ke{constructor(a,b,d=10,h=10){super(a,b);this.isRectAreaLight=!0;this.type="RectAreaLight";this.width=d;this.height=h}get power(){return this.intensity*this.width*this.height*Math.PI}set power(a){this.intensity=a/(this.width*this.height*Math.PI)}copy(a){super.copy(a);
this.width=a.width;this.height=a.height;return this}toJSON(a){a=super.toJSON(a);a.object.width=this.width;a.object.height=this.height;return a}}class Jl{constructor(){this.isSphericalHarmonics3=!0;this.coefficients=[];for(let a=0;a<9;a++)this.coefficients.push(new ma)}set(a){for(let b=0;b<9;b++)this.coefficients[b].copy(a[b]);return this}zero(){for(let a=0;a<9;a++)this.coefficients[a].set(0,0,0);return this}getAt(a,b){const d=a.x,h=a.y;a=a.z;const n=this.coefficients;b.copy(n[0]).multiplyScalar(.282095);
b.addScaledVector(n[1],.488603*h);b.addScaledVector(n[2],.488603*a);b.addScaledVector(n[3],.488603*d);b.addScaledVector(n[4],d*h*1.092548);b.addScaledVector(n[5],h*a*1.092548);b.addScaledVector(n[6],.315392*(3*a*a-1));b.addScaledVector(n[7],d*a*1.092548);b.addScaledVector(n[8],.546274*(d*d-h*h));return b}getIrradianceAt(a,b){const d=a.x,h=a.y;a=a.z;const n=this.coefficients;b.copy(n[0]).multiplyScalar(.886227);b.addScaledVector(n[1],1.023328*h);b.addScaledVector(n[2],1.023328*a);b.addScaledVector(n[3],
1.023328*d);b.addScaledVector(n[4],.858086*d*h);b.addScaledVector(n[5],.858086*h*a);b.addScaledVector(n[6],.743125*a*a-.247708);b.addScaledVector(n[7],.858086*d*a);b.addScaledVector(n[8],.429043*(d*d-h*h));return b}add(a){for(let b=0;b<9;b++)this.coefficients[b].add(a.coefficients[b]);return this}addScaledSH(a,b){for(let d=0;d<9;d++)this.coefficients[d].addScaledVector(a.coefficients[d],b);return this}scale(a){for(let b=0;b<9;b++)this.coefficients[b].multiplyScalar(a);return this}lerp(a,b){for(let d=
0;d<9;d++)this.coefficients[d].lerp(a.coefficients[d],b);return this}equals(a){for(let b=0;b<9;b++)if(!this.coefficients[b].equals(a.coefficients[b]))return!1;return!0}copy(a){return this.set(a.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(a,b=0){const d=this.coefficients;for(let h=0;h<9;h++)d[h].fromArray(a,b+h*3);return this}toArray(a=[],b=0){const d=this.coefficients;for(let h=0;h<9;h++)d[h].toArray(a,b+h*3);return a}static getBasisAt(a,b){const d=a.x,h=a.y;a=a.z;b[0]=
.282095;b[1]=.488603*h;b[2]=.488603*a;b[3]=.488603*d;b[4]=1.092548*d*h;b[5]=1.092548*h*a;b[6]=.315392*(3*a*a-1);b[7]=1.092548*d*a;b[8]=.546274*(d*d-h*h)}}class Kl extends Ke{constructor(a=new Jl,b=1){super(void 0,b);this.isLightProbe=!0;this.sh=a}copy(a){super.copy(a);this.sh.copy(a.sh);return this}fromJSON(a){this.intensity=a.intensity;this.sh.fromArray(a.sh);return this}toJSON(a){a=super.toJSON(a);a.object.sh=this.sh.toArray();return a}}class Ij extends pd{constructor(a){super(a);this.textures=
{}}load(a,b,d,h){const n=this,u=new pe(n.manager);u.setPath(n.path);u.setRequestHeader(n.requestHeader);u.setWithCredentials(n.withCredentials);u.load(a,function(E){try{b(n.parse(JSON.parse(E)))}catch(F){h?h(F):console.error(F),n.manager.itemError(a)}},d,h)}parse(a){function b(u){d[u]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",u);return d[u]}const d=this.textures,h=this.createMaterialFromType(a.type);a.uuid!==void 0&&(h.uuid=a.uuid);a.name!==void 0&&(h.name=a.name);a.color!==
void 0&&h.color!==void 0&&h.color.setHex(a.color);a.roughness!==void 0&&(h.roughness=a.roughness);a.metalness!==void 0&&(h.metalness=a.metalness);a.sheen!==void 0&&(h.sheen=a.sheen);a.sheenColor!==void 0&&(h.sheenColor=(new pb).setHex(a.sheenColor));a.sheenRoughness!==void 0&&(h.sheenRoughness=a.sheenRoughness);a.emissive!==void 0&&h.emissive!==void 0&&h.emissive.setHex(a.emissive);a.specular!==void 0&&h.specular!==void 0&&h.specular.setHex(a.specular);a.specularIntensity!==void 0&&(h.specularIntensity=
a.specularIntensity);a.specularColor!==void 0&&h.specularColor!==void 0&&h.specularColor.setHex(a.specularColor);a.shininess!==void 0&&(h.shininess=a.shininess);a.clearcoat!==void 0&&(h.clearcoat=a.clearcoat);a.clearcoatRoughness!==void 0&&(h.clearcoatRoughness=a.clearcoatRoughness);a.dispersion!==void 0&&(h.dispersion=a.dispersion);a.iridescence!==void 0&&(h.iridescence=a.iridescence);a.iridescenceIOR!==void 0&&(h.iridescenceIOR=a.iridescenceIOR);a.iridescenceThicknessRange!==void 0&&(h.iridescenceThicknessRange=
a.iridescenceThicknessRange);a.transmission!==void 0&&(h.transmission=a.transmission);a.thickness!==void 0&&(h.thickness=a.thickness);a.attenuationDistance!==void 0&&(h.attenuationDistance=a.attenuationDistance);a.attenuationColor!==void 0&&h.attenuationColor!==void 0&&h.attenuationColor.setHex(a.attenuationColor);a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy);a.anisotropyRotation!==void 0&&(h.anisotropyRotation=a.anisotropyRotation);a.fog!==void 0&&(h.fog=a.fog);a.flatShading!==void 0&&(h.flatShading=
a.flatShading);a.blending!==void 0&&(h.blending=a.blending);a.combine!==void 0&&(h.combine=a.combine);a.side!==void 0&&(h.side=a.side);a.shadowSide!==void 0&&(h.shadowSide=a.shadowSide);a.opacity!==void 0&&(h.opacity=a.opacity);a.transparent!==void 0&&(h.transparent=a.transparent);a.alphaTest!==void 0&&(h.alphaTest=a.alphaTest);a.alphaHash!==void 0&&(h.alphaHash=a.alphaHash);a.depthFunc!==void 0&&(h.depthFunc=a.depthFunc);a.depthTest!==void 0&&(h.depthTest=a.depthTest);a.depthWrite!==void 0&&(h.depthWrite=
a.depthWrite);a.colorWrite!==void 0&&(h.colorWrite=a.colorWrite);a.blendSrc!==void 0&&(h.blendSrc=a.blendSrc);a.blendDst!==void 0&&(h.blendDst=a.blendDst);a.blendEquation!==void 0&&(h.blendEquation=a.blendEquation);a.blendSrcAlpha!==void 0&&(h.blendSrcAlpha=a.blendSrcAlpha);a.blendDstAlpha!==void 0&&(h.blendDstAlpha=a.blendDstAlpha);a.blendEquationAlpha!==void 0&&(h.blendEquationAlpha=a.blendEquationAlpha);a.blendColor!==void 0&&h.blendColor!==void 0&&h.blendColor.setHex(a.blendColor);a.blendAlpha!==
void 0&&(h.blendAlpha=a.blendAlpha);a.stencilWriteMask!==void 0&&(h.stencilWriteMask=a.stencilWriteMask);a.stencilFunc!==void 0&&(h.stencilFunc=a.stencilFunc);a.stencilRef!==void 0&&(h.stencilRef=a.stencilRef);a.stencilFuncMask!==void 0&&(h.stencilFuncMask=a.stencilFuncMask);a.stencilFail!==void 0&&(h.stencilFail=a.stencilFail);a.stencilZFail!==void 0&&(h.stencilZFail=a.stencilZFail);a.stencilZPass!==void 0&&(h.stencilZPass=a.stencilZPass);a.stencilWrite!==void 0&&(h.stencilWrite=a.stencilWrite);
a.wireframe!==void 0&&(h.wireframe=a.wireframe);a.wireframeLinewidth!==void 0&&(h.wireframeLinewidth=a.wireframeLinewidth);a.wireframeLinecap!==void 0&&(h.wireframeLinecap=a.wireframeLinecap);a.wireframeLinejoin!==void 0&&(h.wireframeLinejoin=a.wireframeLinejoin);a.rotation!==void 0&&(h.rotation=a.rotation);a.linewidth!==void 0&&(h.linewidth=a.linewidth);a.dashSize!==void 0&&(h.dashSize=a.dashSize);a.gapSize!==void 0&&(h.gapSize=a.gapSize);a.scale!==void 0&&(h.scale=a.scale);a.polygonOffset!==void 0&&
(h.polygonOffset=a.polygonOffset);a.polygonOffsetFactor!==void 0&&(h.polygonOffsetFactor=a.polygonOffsetFactor);a.polygonOffsetUnits!==void 0&&(h.polygonOffsetUnits=a.polygonOffsetUnits);a.dithering!==void 0&&(h.dithering=a.dithering);a.alphaToCoverage!==void 0&&(h.alphaToCoverage=a.alphaToCoverage);a.premultipliedAlpha!==void 0&&(h.premultipliedAlpha=a.premultipliedAlpha);a.forceSinglePass!==void 0&&(h.forceSinglePass=a.forceSinglePass);a.visible!==void 0&&(h.visible=a.visible);a.toneMapped!==void 0&&
(h.toneMapped=a.toneMapped);a.userData!==void 0&&(h.userData=a.userData);a.vertexColors!==void 0&&(h.vertexColors=typeof a.vertexColors==="number"?a.vertexColors>0?!0:!1:a.vertexColors);if(a.uniforms!==void 0)for(var n in a.uniforms){const u=a.uniforms[n];h.uniforms[n]={};switch(u.type){case "t":h.uniforms[n].value=b(u.value);break;case "c":h.uniforms[n].value=(new pb).setHex(u.value);break;case "v2":h.uniforms[n].value=(new Xa).fromArray(u.value);break;case "v3":h.uniforms[n].value=(new ma).fromArray(u.value);
break;case "v4":h.uniforms[n].value=(new ec).fromArray(u.value);break;case "m3":h.uniforms[n].value=(new Lb).fromArray(u.value);break;case "m4":h.uniforms[n].value=(new Gb).fromArray(u.value);break;default:h.uniforms[n].value=u.value}}a.defines!==void 0&&(h.defines=a.defines);a.vertexShader!==void 0&&(h.vertexShader=a.vertexShader);a.fragmentShader!==void 0&&(h.fragmentShader=a.fragmentShader);a.glslVersion!==void 0&&(h.glslVersion=a.glslVersion);if(a.extensions!==void 0)for(const u in a.extensions)h.extensions[u]=
a.extensions[u];a.lights!==void 0&&(h.lights=a.lights);a.clipping!==void 0&&(h.clipping=a.clipping);a.size!==void 0&&(h.size=a.size);a.sizeAttenuation!==void 0&&(h.sizeAttenuation=a.sizeAttenuation);a.map!==void 0&&(h.map=b(a.map));a.matcap!==void 0&&(h.matcap=b(a.matcap));a.alphaMap!==void 0&&(h.alphaMap=b(a.alphaMap));a.bumpMap!==void 0&&(h.bumpMap=b(a.bumpMap));a.bumpScale!==void 0&&(h.bumpScale=a.bumpScale);a.normalMap!==void 0&&(h.normalMap=b(a.normalMap));a.normalMapType!==void 0&&(h.normalMapType=
a.normalMapType);a.normalScale!==void 0&&(n=a.normalScale,Array.isArray(n)===!1&&(n=[n,n]),h.normalScale=(new Xa).fromArray(n));a.displacementMap!==void 0&&(h.displacementMap=b(a.displacementMap));a.displacementScale!==void 0&&(h.displacementScale=a.displacementScale);a.displacementBias!==void 0&&(h.displacementBias=a.displacementBias);a.roughnessMap!==void 0&&(h.roughnessMap=b(a.roughnessMap));a.metalnessMap!==void 0&&(h.metalnessMap=b(a.metalnessMap));a.emissiveMap!==void 0&&(h.emissiveMap=b(a.emissiveMap));
a.emissiveIntensity!==void 0&&(h.emissiveIntensity=a.emissiveIntensity);a.specularMap!==void 0&&(h.specularMap=b(a.specularMap));a.specularIntensityMap!==void 0&&(h.specularIntensityMap=b(a.specularIntensityMap));a.specularColorMap!==void 0&&(h.specularColorMap=b(a.specularColorMap));a.envMap!==void 0&&(h.envMap=b(a.envMap));a.envMapRotation!==void 0&&h.envMapRotation.fromArray(a.envMapRotation);a.envMapIntensity!==void 0&&(h.envMapIntensity=a.envMapIntensity);a.reflectivity!==void 0&&(h.reflectivity=
a.reflectivity);a.refractionRatio!==void 0&&(h.refractionRatio=a.refractionRatio);a.lightMap!==void 0&&(h.lightMap=b(a.lightMap));a.lightMapIntensity!==void 0&&(h.lightMapIntensity=a.lightMapIntensity);a.aoMap!==void 0&&(h.aoMap=b(a.aoMap));a.aoMapIntensity!==void 0&&(h.aoMapIntensity=a.aoMapIntensity);a.gradientMap!==void 0&&(h.gradientMap=b(a.gradientMap));a.clearcoatMap!==void 0&&(h.clearcoatMap=b(a.clearcoatMap));a.clearcoatRoughnessMap!==void 0&&(h.clearcoatRoughnessMap=b(a.clearcoatRoughnessMap));
a.clearcoatNormalMap!==void 0&&(h.clearcoatNormalMap=b(a.clearcoatNormalMap));a.clearcoatNormalScale!==void 0&&(h.clearcoatNormalScale=(new Xa).fromArray(a.clearcoatNormalScale));a.iridescenceMap!==void 0&&(h.iridescenceMap=b(a.iridescenceMap));a.iridescenceThicknessMap!==void 0&&(h.iridescenceThicknessMap=b(a.iridescenceThicknessMap));a.transmissionMap!==void 0&&(h.transmissionMap=b(a.transmissionMap));a.thicknessMap!==void 0&&(h.thicknessMap=b(a.thicknessMap));a.anisotropyMap!==void 0&&(h.anisotropyMap=
b(a.anisotropyMap));a.sheenColorMap!==void 0&&(h.sheenColorMap=b(a.sheenColorMap));a.sheenRoughnessMap!==void 0&&(h.sheenRoughnessMap=b(a.sheenRoughnessMap));return h}setTextures(a){this.textures=a;return this}createMaterialFromType(a){return Ij.createMaterialFromType(a)}static createMaterialFromType(a){return new {ShadowMaterial:nl,SpriteMaterial:Wi,RawShaderMaterial:ol,ShaderMaterial:Jd,PointsMaterial:ej,MeshPhysicalMaterial:pl,MeshStandardMaterial:Cj,MeshPhongMaterial:ql,MeshToonMaterial:rl,MeshNormalMaterial:sl,
MeshLambertMaterial:tl,MeshDepthMaterial:wi,MeshDistanceMaterial:xi,MeshBasicMaterial:He,MeshMatcapMaterial:ul,LineDashedMaterial:vl,LineBasicMaterial:jd,Material:fd}[a]}}class Jj{static extractUrlBase(a){const b=a.lastIndexOf("/");return b===-1?"./":a.slice(0,b+1)}static resolveURL(a,b){if(typeof a!=="string"||a==="")return"";/^https?:\/\//i.test(b)&&/^\//.test(a)&&(b=b.replace(/(^https?:\/\/[^\/]+).*/i,"$1"));return/^(https?:)?\/\//i.test(a)||/^data:.*,.*$/i.test(a)||/^blob:.*$/i.test(a)?a:b+a}}
class Ll extends Vb{constructor(){super();this.isInstancedBufferGeometry=!0;this.type="InstancedBufferGeometry";this.instanceCount=Infinity}copy(a){super.copy(a);this.instanceCount=a.instanceCount;return this}toJSON(){const a=super.toJSON();a.instanceCount=this.instanceCount;a.isInstancedBufferGeometry=!0;return a}}class Ml extends pd{constructor(a){super(a)}load(a,b,d,h){const n=this,u=new pe(n.manager);u.setPath(n.path);u.setRequestHeader(n.requestHeader);u.setWithCredentials(n.withCredentials);
u.load(a,function(E){try{b(n.parse(JSON.parse(E)))}catch(F){h?h(F):console.error(F),n.manager.itemError(a)}},d,h)}parse(a){function b(T,X){if(d[X]!==void 0)return d[X];const ea=T.interleavedBuffers[X];var aa=ea.buffer;h[aa]!==void 0?aa=h[aa]:(T=(new Uint32Array(T.arrayBuffers[aa])).buffer,aa=h[aa]=T);aa=new ze[ea.type](aa);aa=new uh(aa,ea.stride);aa.uuid=ea.uuid;return d[X]=aa}const d={},h={},n=a.isInstancedBufferGeometry?new Ll:new Vb;var u=a.data.index;u!==void 0&&(u=new ze[u.type](u.array),n.setIndex(new sc(u,
1)));u=a.data.attributes;for(var E in u){var F=u[E],H=void 0;F.isInterleavedBufferAttribute?(H=b(a.data,F.data),H=new Pf(H,F.itemSize,F.offset,F.normalized)):(H=new ze[F.type](F.array),H=new (F.isInstancedBufferAttribute?Tf:sc)(H,F.itemSize,F.normalized));F.name!==void 0&&(H.name=F.name);F.usage!==void 0&&H.setUsage(F.usage);n.setAttribute(E,H)}if(E=a.data.morphAttributes)for(var M in E){u=E[M];F=[];for(let T=0,X=u.length;T<X;T++){H=u[T];var R=void 0;H.isInterleavedBufferAttribute?(R=b(a.data,H.data),
R=new Pf(R,H.itemSize,H.offset,H.normalized)):(R=new ze[H.type](H.array),R=new sc(R,H.itemSize,H.normalized));H.name!==void 0&&(R.name=H.name);F.push(R)}n.morphAttributes[M]=F}a.data.morphTargetsRelative&&(n.morphTargetsRelative=!0);M=a.data.groups||a.data.drawcalls||a.data.offsets;if(M!==void 0)for(let T=0,X=M.length;T!==X;++T)E=M[T],n.addGroup(E.start,E.count,E.materialIndex);M=a.data.boundingSphere;M!==void 0&&(n.boundingSphere=(new Qc).fromJSON(M));a.name&&(n.name=a.name);a.userData&&(n.userData=
a.userData);return n}}class nn extends pd{constructor(a){super(a)}load(a,b,d,h){const n=this;var u=this.path===""?Jj.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||u;u=new pe(this.manager);u.setPath(this.path);u.setRequestHeader(this.requestHeader);u.setWithCredentials(this.withCredentials);u.load(a,function(E){let F=null;try{F=JSON.parse(E)}catch(H){h!==void 0&&h(H);console.error("THREE:ObjectLoader: Can't parse "+a+".",H.message);return}E=F.metadata;E===void 0||E.type===void 0||
E.type.toLowerCase()==="geometry"?(h!==void 0&&h(Error("THREE.ObjectLoader: Can't load "+a)),console.error("THREE.ObjectLoader: Can't load "+a)):n.parse(F,b)},d,h)}async loadAsync(a,b){var d=this.path===""?Jj.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||d;d=new pe(this.manager);d.setPath(this.path);d.setRequestHeader(this.requestHeader);d.setWithCredentials(this.withCredentials);b=await d.loadAsync(a,b);b=JSON.parse(b);d=b.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()===
"geometry")throw Error("THREE.ObjectLoader: Can't load "+a);return await this.parseAsync(b)}parse(a,b){const d=this.parseAnimations(a.animations);var h=this.parseShapes(a.shapes);const n=this.parseGeometries(a.geometries,h);h=this.parseImages(a.images,function(){b!==void 0&&b(F)});const u=this.parseTextures(a.textures,h),E=this.parseMaterials(a.materials,u),F=this.parseObject(a.object,n,E,u,d);a=this.parseSkeletons(a.skeletons,F);this.bindSkeletons(F,a);this.bindLightTargets(F);if(b!==void 0){a=!1;
for(const H in h)if(h[H].data instanceof HTMLImageElement){a=!0;break}a===!1&&b(F)}return F}async parseAsync(a){var b=this.parseAnimations(a.animations),d=this.parseShapes(a.shapes);d=this.parseGeometries(a.geometries,d);var h=await this.parseImagesAsync(a.images);h=this.parseTextures(a.textures,h);const n=this.parseMaterials(a.materials,h);b=this.parseObject(a.object,d,n,h,b);a=this.parseSkeletons(a.skeletons,b);this.bindSkeletons(b,a);this.bindLightTargets(b);return b}parseShapes(a){const b={};
if(a!==void 0)for(let d=0,h=a.length;d<h;d++){const n=(new ef).fromJSON(a[d]);b[n.uuid]=n}return b}parseSkeletons(a,b){const d={},h={};b.traverse(function(n){n.isBone&&(h[n.uuid]=n)});if(a!==void 0)for(let n=0,u=a.length;n<u;n++)b=(new aj).fromJSON(a[n],h),d[b.uuid]=b;return d}parseGeometries(a,b){const d={};if(a!==void 0){const h=new Ml;for(let n=0,u=a.length;n<u;n++){let E;const F=a[n];switch(F.type){case "BufferGeometry":case "InstancedBufferGeometry":E=h.parse(F);break;default:F.type in ml?E=
ml[F.type].fromJSON(F,b):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${F.type}"`)}E.uuid=F.uuid;F.name!==void 0&&(E.name=F.name);F.userData!==void 0&&(E.userData=F.userData);d[F.uuid]=E}}return d}parseMaterials(a,b){const d={},h={};if(a!==void 0){const n=new Ij;n.setTextures(b);for(let u=0,E=a.length;u<E;u++)b=a[u],d[b.uuid]===void 0&&(d[b.uuid]=n.parse(b)),h[b.uuid]=d[b.uuid]}return h}parseAnimations(a){const b={};if(a!==void 0)for(let d=0;d<a.length;d++){const h=Lg.parse(a[d]);
b[h.uuid]=h}return b}parseImages(a,b){function d(H){n.manager.itemStart(H);return E.load(H,function(){n.manager.itemEnd(H)},void 0,function(){n.manager.itemError(H);n.manager.itemEnd(H)})}function h(H){return typeof H==="string"?(H=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(H)?H:n.resourcePath+H,d(H)):H.data?{data:new ze[H.type](H.data),width:H.width,height:H.height}:null}const n=this,u={};let E;if(a!==void 0&&a.length>0){b=new Ej(b);E=new Mg(b);E.setCrossOrigin(this.crossOrigin);for(let H=0,M=a.length;H<M;H++){b=
a[H];var F=b.url;if(Array.isArray(F)){const R=[];for(let T=0,X=F.length;T<X;T++){const ea=h(F[T]);ea!==null&&(ea instanceof HTMLImageElement?R.push(ea):R.push(new $d(ea.data,ea.width,ea.height)))}u[b.uuid]=new Xd(R)}else F=h(b.url),u[b.uuid]=new Xd(F)}}return u}async parseImagesAsync(a){async function b(E){return typeof E==="string"?(E=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(E)?E:d.resourcePath+E,await n.loadAsync(E)):E.data?{data:new ze[E.type](E.data),width:E.width,height:E.height}:null}const d=this,h=
{};let n;if(a!==void 0&&a.length>0){n=new Mg(this.manager);n.setCrossOrigin(this.crossOrigin);for(let E=0,F=a.length;E<F;E++){const H=a[E];var u=H.url;if(Array.isArray(u)){const M=[];for(let R=0,T=u.length;R<T;R++){const X=await b(u[R]);X!==null&&(X instanceof HTMLImageElement?M.push(X):M.push(new $d(X.data,X.width,X.height)))}h[H.uuid]=new Xd(M)}else u=await b(H.url),h[H.uuid]=new Xd(u)}}return h}parseTextures(a,b){function d(n,u){if(typeof n==="number")return n;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",
n);return u[n]}const h={};if(a!==void 0)for(let n=0,u=a.length;n<u;n++){const E=a[n];E.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',E.uuid);b[E.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",E.image);const F=b[E.image],H=F.data;let M;Array.isArray(H)?(M=new Bg,H.length===6&&(M.needsUpdate=!0)):(M=H&&H.data?new $d:new Cc,H&&(M.needsUpdate=!0));M.source=F;M.uuid=E.uuid;E.name!==void 0&&(M.name=E.name);E.mapping!==void 0&&(M.mapping=d(E.mapping,on));
E.channel!==void 0&&(M.channel=E.channel);E.offset!==void 0&&M.offset.fromArray(E.offset);E.repeat!==void 0&&M.repeat.fromArray(E.repeat);E.center!==void 0&&M.center.fromArray(E.center);E.rotation!==void 0&&(M.rotation=E.rotation);E.wrap!==void 0&&(M.wrapS=d(E.wrap[0],Nl),M.wrapT=d(E.wrap[1],Nl));E.format!==void 0&&(M.format=E.format);E.internalFormat!==void 0&&(M.internalFormat=E.internalFormat);E.type!==void 0&&(M.type=E.type);E.colorSpace!==void 0&&(M.colorSpace=E.colorSpace);E.minFilter!==void 0&&
(M.minFilter=d(E.minFilter,Ol));E.magFilter!==void 0&&(M.magFilter=d(E.magFilter,Ol));E.anisotropy!==void 0&&(M.anisotropy=E.anisotropy);E.flipY!==void 0&&(M.flipY=E.flipY);E.generateMipmaps!==void 0&&(M.generateMipmaps=E.generateMipmaps);E.premultiplyAlpha!==void 0&&(M.premultiplyAlpha=E.premultiplyAlpha);E.unpackAlignment!==void 0&&(M.unpackAlignment=E.unpackAlignment);E.compareFunction!==void 0&&(M.compareFunction=E.compareFunction);E.userData!==void 0&&(M.userData=E.userData);h[E.uuid]=M}return h}parseObject(a,
b,d,h,n){function u(T){b[T]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",T);return b[T]}function E(T){if(T!==void 0){if(Array.isArray(T)){const X=[];for(let ea=0,aa=T.length;ea<aa;ea++){const da=T[ea];d[da]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",da);X.push(d[da])}return X}d[T]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",T);return d[T]}}function F(T){h[T]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",T);return h[T]}switch(a.type){case "Scene":var H=
new Gk;a.background!==void 0&&(Number.isInteger(a.background)?H.background=new pb(a.background):H.background=F(a.background));a.environment!==void 0&&(H.environment=F(a.environment));a.fog!==void 0&&(a.fog.type==="Fog"?H.fog=new Vi(a.fog.color,a.fog.near,a.fog.far):a.fog.type==="FogExp2"&&(H.fog=new Ui(a.fog.color,a.fog.density)),a.fog.name!==""&&(H.fog.name=a.fog.name));a.backgroundBlurriness!==void 0&&(H.backgroundBlurriness=a.backgroundBlurriness);a.backgroundIntensity!==void 0&&(H.backgroundIntensity=
a.backgroundIntensity);a.backgroundRotation!==void 0&&H.backgroundRotation.fromArray(a.backgroundRotation);a.environmentIntensity!==void 0&&(H.environmentIntensity=a.environmentIntensity);a.environmentRotation!==void 0&&H.environmentRotation.fromArray(a.environmentRotation);break;case "PerspectiveCamera":H=new Yc(a.fov,a.aspect,a.near,a.far);a.focus!==void 0&&(H.focus=a.focus);a.zoom!==void 0&&(H.zoom=a.zoom);a.filmGauge!==void 0&&(H.filmGauge=a.filmGauge);a.filmOffset!==void 0&&(H.filmOffset=a.filmOffset);
a.view!==void 0&&(H.view=Object.assign({},a.view));break;case "OrthographicCamera":H=new Qh(a.left,a.right,a.top,a.bottom,a.near,a.far);a.zoom!==void 0&&(H.zoom=a.zoom);a.view!==void 0&&(H.view=Object.assign({},a.view));break;case "AmbientLight":H=new Hl(a.color,a.intensity);break;case "DirectionalLight":H=new Gl(a.color,a.intensity);H.target=a.target||"";break;case "PointLight":H=new Fl(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":H=new Il(a.color,a.intensity,a.width,a.height);
break;case "SpotLight":H=new Dl(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);H.target=a.target||"";break;case "HemisphereLight":H=new Al(a.color,a.groundColor,a.intensity);break;case "LightProbe":H=(new Kl).fromJSON(a);break;case "SkinnedMesh":var M=u(a.geometry);H=E(a.material);H=new Rk(M,H);a.bindMode!==void 0&&(H.bindMode=a.bindMode);a.bindMatrix!==void 0&&H.bindMatrix.fromArray(a.bindMatrix);a.skeleton!==void 0&&(H.skeleton=a.skeleton);break;case "Mesh":M=u(a.geometry);H=E(a.material);
H=new Kc(M,H);break;case "InstancedMesh":M=u(a.geometry);H=E(a.material);var R=a.instanceMatrix;const T=a.instanceColor;H=new Vk(M,H,a.count);H.instanceMatrix=new Tf(new Float32Array(R.array),16);T!==void 0&&(H.instanceColor=new Tf(new Float32Array(T.array),T.itemSize));break;case "BatchedMesh":M=u(a.geometry);H=E(a.material);H=new Yk(a.maxInstanceCount,a.maxVertexCount,a.maxIndexCount,H);H.geometry=M;H.perObjectFrustumCulled=a.perObjectFrustumCulled;H.sortObjects=a.sortObjects;H._drawRanges=a.drawRanges;
H._reservedRanges=a.reservedRanges;H._geometryInfo=a.geometryInfo.map(X=>{let ea=null,aa=null;X.boundingBox!==void 0&&(ea=(new Sc).fromJSON(X.boundingBox));X.boundingSphere!==void 0&&(aa=(new Qc).fromJSON(X.boundingSphere));return{...X,boundingBox:ea,boundingSphere:aa}});H._instanceInfo=a.instanceInfo;H._availableInstanceIds=a._availableInstanceIds;H._availableGeometryIds=a._availableGeometryIds;H._nextIndexStart=a.nextIndexStart;H._nextVertexStart=a.nextVertexStart;H._geometryCount=a.geometryCount;
H._maxInstanceCount=a.maxInstanceCount;H._maxVertexCount=a.maxVertexCount;H._maxIndexCount=a.maxIndexCount;H._geometryInitialized=a.geometryInitialized;H._matricesTexture=F(a.matricesTexture.uuid);H._indirectTexture=F(a.indirectTexture.uuid);a.colorsTexture!==void 0&&(H._colorsTexture=F(a.colorsTexture.uuid));a.boundingSphere!==void 0&&(H.boundingSphere=(new Qc).fromJSON(a.boundingSphere));a.boundingBox!==void 0&&(H.boundingBox=(new Sc).fromJSON(a.boundingBox));break;case "LOD":H=new Lk;break;case "Line":H=
new Je(u(a.geometry),E(a.material));break;case "LineLoop":H=new bl(u(a.geometry),E(a.material));break;case "LineSegments":H=new ce(u(a.geometry),E(a.material));break;case "PointCloud":case "Points":H=new dl(u(a.geometry),E(a.material));break;case "Sprite":H=new Jk(E(a.material));break;case "Group":H=new Of;break;case "Bone":H=new $i;break;default:H=new jc}H.uuid=a.uuid;a.name!==void 0&&(H.name=a.name);a.matrix!==void 0?(H.matrix.fromArray(a.matrix),a.matrixAutoUpdate!==void 0&&(H.matrixAutoUpdate=
a.matrixAutoUpdate),H.matrixAutoUpdate&&H.matrix.decompose(H.position,H.quaternion,H.scale)):(a.position!==void 0&&H.position.fromArray(a.position),a.rotation!==void 0&&H.rotation.fromArray(a.rotation),a.quaternion!==void 0&&H.quaternion.fromArray(a.quaternion),a.scale!==void 0&&H.scale.fromArray(a.scale));a.up!==void 0&&H.up.fromArray(a.up);a.castShadow!==void 0&&(H.castShadow=a.castShadow);a.receiveShadow!==void 0&&(H.receiveShadow=a.receiveShadow);a.shadow&&(a.shadow.intensity!==void 0&&(H.shadow.intensity=
a.shadow.intensity),a.shadow.bias!==void 0&&(H.shadow.bias=a.shadow.bias),a.shadow.normalBias!==void 0&&(H.shadow.normalBias=a.shadow.normalBias),a.shadow.radius!==void 0&&(H.shadow.radius=a.shadow.radius),a.shadow.mapSize!==void 0&&H.shadow.mapSize.fromArray(a.shadow.mapSize),a.shadow.camera!==void 0&&(H.shadow.camera=this.parseObject(a.shadow.camera)));a.visible!==void 0&&(H.visible=a.visible);a.frustumCulled!==void 0&&(H.frustumCulled=a.frustumCulled);a.renderOrder!==void 0&&(H.renderOrder=a.renderOrder);
a.userData!==void 0&&(H.userData=a.userData);a.layers!==void 0&&(H.layers.mask=a.layers);if(a.children!==void 0)for(M=a.children,R=0;R<M.length;R++)H.add(this.parseObject(M[R],b,d,h,n));if(a.animations!==void 0)for(M=a.animations,R=0;R<M.length;R++)H.animations.push(n[M[R]]);if(a.type==="LOD")for(a.autoUpdate!==void 0&&(H.autoUpdate=a.autoUpdate),a=a.levels,n=0;n<a.length;n++)M=a[n],R=H.getObjectByProperty("uuid",M.object),R!==void 0&&H.addLevel(R,M.distance,M.hysteresis);return H}bindSkeletons(a,
b){Object.keys(b).length!==0&&a.traverse(function(d){if(d.isSkinnedMesh===!0&&d.skeleton!==void 0){const h=b[d.skeleton];h===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",d.skeleton):d.bind(h,d.bindMatrix)}})}bindLightTargets(a){a.traverse(function(b){if(b.isDirectionalLight||b.isSpotLight){const d=a.getObjectByProperty("uuid",b.target);b.target=d!==void 0?d:new jc}})}}const on={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,
EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306},Nl={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Ol={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008},Kj=new WeakMap;class pn extends pd{constructor(a){super(a);this.isImageBitmapLoader=!0;typeof createImageBitmap==="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");
typeof fetch==="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");this.options={premultiplyAlpha:"none"};this._abortController=new AbortController}setOptions(a){this.options=a;return this}load(a,b,d,h){a===void 0&&(a="");this.path!==void 0&&(a=this.path+a);a=this.manager.resolveURL(a);const n=this,u=ee.get(`image-bitmap:${a}`);if(u!==void 0){n.manager.itemStart(a);if(u.then){u.then(F=>{if(Kj.has(u)===!0)h&&h(Kj.get(u)),n.manager.itemError(a),n.manager.itemEnd(a);else return b&&
b(F),n.manager.itemEnd(a),F});return}setTimeout(function(){b&&b(u);n.manager.itemEnd(a)},0);return u}d={};d.credentials=this.crossOrigin==="anonymous"?"same-origin":"include";d.headers=this.requestHeader;d.signal=typeof AbortSignal.any==="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const E=fetch(a,d).then(function(F){return F.blob()}).then(function(F){return createImageBitmap(F,Object.assign(n.options,{colorSpaceConversion:"none"}))}).then(function(F){ee.add(`image-bitmap:${a}`,
F);b&&b(F);n.manager.itemEnd(a);return F}).catch(function(F){h&&h(F);Kj.set(E,F);ee.remove(`image-bitmap:${a}`);n.manager.itemError(a);n.manager.itemEnd(a)});ee.add(`image-bitmap:${a}`,E);n.manager.itemStart(a)}abort(){this._abortController.abort();this._abortController=new AbortController;return this}}let Rh;class Lj{static getContext(){Rh===void 0&&(Rh=new (window.AudioContext||window.webkitAudioContext));return Rh}static setContext(a){Rh=a}}class qn extends pd{constructor(a){super(a)}load(a,b,
d,h){function n(F){h?h(F):console.error(F);u.manager.itemError(a)}const u=this,E=new pe(this.manager);E.setResponseType("arraybuffer");E.setPath(this.path);E.setRequestHeader(this.requestHeader);E.setWithCredentials(this.withCredentials);E.load(a,function(F){try{const H=F.slice(0);Lj.getContext().decodeAudioData(H,function(M){b(M)}).catch(n)}catch(H){n(H)}},d,h)}}const Pl=new Gb,Ql=new Gb,ff=new Gb;class rn{constructor(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new Yc;
this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new Yc;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1;this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(a){const b=this._cache;if(b.focus!==a.focus||b.fov!==a.fov||b.aspect!==a.aspect*this.aspect||b.near!==a.near||b.far!==a.far||b.zoom!==a.zoom||b.eyeSep!==this.eyeSep){b.focus=a.focus;b.fov=a.fov;b.aspect=a.aspect*this.aspect;b.near=a.near;b.far=a.far;b.zoom=a.zoom;
b.eyeSep=this.eyeSep;ff.copy(a.projectionMatrix);var d=b.eyeSep/2;const h=d*b.near/b.focus,n=b.near*Math.tan(je*b.fov*.5)/b.zoom;let u;Ql.elements[12]=-d;Pl.elements[12]=d;d=-n*b.aspect+h;u=n*b.aspect+h;ff.elements[0]=2*b.near/(u-d);ff.elements[8]=(u+d)/(u-d);this.cameraL.projectionMatrix.copy(ff);d=-n*b.aspect-h;u=n*b.aspect-h;ff.elements[0]=2*b.near/(u-d);ff.elements[8]=(u+d)/(u-d);this.cameraR.projectionMatrix.copy(ff)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(Ql);this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(Pl)}}
class Rl extends Yc{constructor(a=[]){super();this.isArrayCamera=!0;this.isMultiViewCamera=!1;this.cameras=a}}class Sl{constructor(a=!0){this.autoStart=a;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}start(){this.oldTime=this.startTime=performance.now();this.elapsedTime=0;this.running=!0}stop(){this.getElapsedTime();this.autoStart=this.running=!1}getElapsedTime(){this.getDelta();return this.elapsedTime}getDelta(){let a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const b=
performance.now();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}}const gf=new ma,Mj=new dd,sn=new ma,hf=new ma,jf=new ma;class tn extends jc{constructor(){super();this.type="AudioListener";this.context=Lj.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null;this.timeDelta=0;this._clock=new Sl}getInput(){return this.gain}removeFilter(){this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),
this.gain.connect(this.context.destination),this.filter=null);return this}getFilter(){return this.filter}setFilter(a){this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}updateMatrixWorld(a){super.updateMatrixWorld(a);
a=this.context.listener;this.timeDelta=this._clock.getDelta();this.matrixWorld.decompose(gf,Mj,sn);hf.set(0,0,-1).applyQuaternion(Mj);jf.set(0,1,0).applyQuaternion(Mj);if(a.positionX){const b=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(gf.x,b);a.positionY.linearRampToValueAtTime(gf.y,b);a.positionZ.linearRampToValueAtTime(gf.z,b);a.forwardX.linearRampToValueAtTime(hf.x,b);a.forwardY.linearRampToValueAtTime(hf.y,b);a.forwardZ.linearRampToValueAtTime(hf.z,b);a.upX.linearRampToValueAtTime(jf.x,
b);a.upY.linearRampToValueAtTime(jf.y,b);a.upZ.linearRampToValueAtTime(jf.z,b)}else a.setPosition(gf.x,gf.y,gf.z),a.setOrientation(hf.x,hf.y,hf.z,jf.x,jf.y,jf.z)}}class Tl extends jc{constructor(a){super();this.type="Audio";this.listener=a;this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=!1;this.buffer=null;this.detune=0;this.loop=!1;this.offset=this.loopEnd=this.loopStart=0;this.duration=void 0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=
!0;this.source=null;this.sourceType="empty";this._progress=this._startedAt=0;this._connected=!1;this.filters=[]}getOutput(){return this.gain}setNodeSource(a){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=a;this.connect();return this}setMediaElementSource(a){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(a);this.connect();return this}setMediaStreamSource(a){this.hasPlaybackControl=!1;this.sourceType="mediaStreamNode";this.source=
this.context.createMediaStreamSource(a);this.connect();return this}setBuffer(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();return this}play(a=0){if(this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+a,a=this.context.createBufferSource(),a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,
a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||
this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(a=0){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+a),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-
1].connect(this.getOutput())}else this.source.connect(this.getOutput());this._connected=!0;return this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());this._connected=!1;return this}}getFilters(){return this.filters}setFilters(a){a||(a=[]);this._connected===
!0?(this.disconnect(),this.filters=a.slice(),this.connect()):this.filters=a.slice();return this}setDetune(a){this.detune=a;this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01);return this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(a){return this.setFilters(a?[a]:[])}setPlaybackRate(a){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=
a,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1;this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(a){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=a,this.isPlaying===!0&&(this.source.loop=
this.loop),this}setLoopStart(a){this.loopStart=a;return this}setLoopEnd(a){this.loopEnd=a;return this}getVolume(){return this.gain.gain.value}setVolume(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}copy(a,b){super.copy(a,b);if(a.sourceType!=="buffer")return console.warn("THREE.Audio: Audio source type cannot be copied."),this;this.autoplay=a.autoplay;this.buffer=a.buffer;this.detune=a.detune;this.loop=a.loop;this.loopStart=a.loopStart;this.loopEnd=a.loopEnd;this.offset=
a.offset;this.duration=a.duration;this.playbackRate=a.playbackRate;this.hasPlaybackControl=a.hasPlaybackControl;this.sourceType=a.sourceType;this.filters=a.filters.slice();return this}clone(a){return(new this.constructor(this.listener)).copy(this,a)}}const kf=new ma,Ul=new dd,un=new ma,lf=new ma;class vn extends Tl{constructor(a){super(a);this.panner=this.context.createPanner();this.panner.panningModel="HRTF";this.panner.connect(this.gain)}connect(){super.connect();this.panner.connect(this.gain);
return this}disconnect(){super.disconnect();this.panner.disconnect(this.gain);return this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(a){this.panner.refDistance=a;return this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(a){this.panner.rolloffFactor=a;return this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(a){this.panner.distanceModel=a;return this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(a){this.panner.maxDistance=
a;return this}setDirectionalCone(a,b,d){this.panner.coneInnerAngle=a;this.panner.coneOuterAngle=b;this.panner.coneOuterGain=d;return this}updateMatrixWorld(a){super.updateMatrixWorld(a);if(this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(kf,Ul,un),lf.set(0,0,1).applyQuaternion(Ul),a=this.panner,a.positionX){const b=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(kf.x,b);a.positionY.linearRampToValueAtTime(kf.y,b);a.positionZ.linearRampToValueAtTime(kf.z,
b);a.orientationX.linearRampToValueAtTime(lf.x,b);a.orientationY.linearRampToValueAtTime(lf.y,b);a.orientationZ.linearRampToValueAtTime(lf.z,b)}else a.setPosition(kf.x,kf.y,kf.z),a.setOrientation(lf.x,lf.y,lf.z)}}class wn{constructor(a,b=2048){this.analyser=a.context.createAnalyser();this.analyser.fftSize=b;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}getFrequencyData(){this.analyser.getByteFrequencyData(this.data);return this.data}getAverageFrequency(){let a=
0;const b=this.getFrequencyData();for(let d=0;d<b.length;d++)a+=b[d];return a/b.length}}class Vl{constructor(a,b,d){this.binding=a;this.valueSize=d;let h;switch(b){case "quaternion":a=this._slerp;b=this._slerpAdditive;h=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(d*6);this._workIndex=5;break;case "string":case "bool":b=a=this._select;h=this._setAdditiveIdentityOther;this.buffer=Array(d*5);break;default:a=this._lerp,b=this._lerpAdditive,h=this._setAdditiveIdentityNumeric,this.buffer=
new Float64Array(d*5)}this._mixBufferRegion=a;this._mixBufferRegionAdditive=b;this._setIdentity=h;this._origIndex=3;this._addIndex=4;this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}accumulate(a,b){const d=this.buffer,h=this.valueSize;a=a*h+h;var n=this.cumulativeWeight;if(n===0){for(n=0;n!==h;++n)d[a+n]=d[n];n=b}else n+=b,this._mixBufferRegion(d,a,0,b/n,h);this.cumulativeWeight=n}accumulateAdditive(a){const b=this.buffer,d=this.valueSize,h=d*this._addIndex;
this.cumulativeWeightAdditive===0&&this._setIdentity();this._mixBufferRegionAdditive(b,h,0,a,d);this.cumulativeWeightAdditive+=a}apply(a){const b=this.valueSize,d=this.buffer;a=a*b+b;const h=this.cumulativeWeight,n=this.cumulativeWeightAdditive,u=this.binding;this.cumulativeWeightAdditive=this.cumulativeWeight=0;h<1&&this._mixBufferRegion(d,a,b*this._origIndex,1-h,b);n>0&&this._mixBufferRegionAdditive(d,a,this._addIndex*b,1,b);for(let E=b,F=b+b;E!==F;++E)if(d[E]!==d[E+b]){u.setValue(d,a);break}}saveOriginalState(){const a=
this.buffer,b=this.valueSize,d=b*this._origIndex;this.binding.getValue(a,d);for(let h=b,n=d;h!==n;++h)a[h]=a[d+h%b];this._setIdentity();this.cumulativeWeightAdditive=this.cumulativeWeight=0}restoreOriginalState(){this.binding.setValue(this.buffer,this.valueSize*3)}_setAdditiveIdentityNumeric(){var a=this._addIndex*this.valueSize;const b=a+this.valueSize;for(;a<b;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric();this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const a=
this._origIndex*this.valueSize,b=this._addIndex*this.valueSize;for(let d=0;d<this.valueSize;d++)this.buffer[b+d]=this.buffer[a+d]}_select(a,b,d,h,n){if(h>=.5)for(h=0;h!==n;++h)a[b+h]=a[d+h]}_slerp(a,b,d,h){dd.slerpFlat(a,b,a,b,a,d,h)}_slerpAdditive(a,b,d,h,n){n*=this._workIndex;dd.multiplyQuaternionsFlat(a,n,a,b,a,d);dd.slerpFlat(a,b,a,b,a,n,h)}_lerp(a,b,d,h,n){const u=1-h;for(let E=0;E!==n;++E){const F=b+E;a[F]=a[F]*u+a[d+E]*h}}_lerpAdditive(a,b,d,h,n){for(let u=0;u!==n;++u){const E=b+u;a[E]+=a[d+
u]*h}}}const xn=RegExp("[\\[\\]\\.:\\/]","g"),yn=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),zn=/(WCOD+)?/.source.replace("WCOD","[^\\[\\]:\\/]"),An=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Bn=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Cn=new RegExp("^"+yn+zn+An+Bn+"$"),Dn=["material","materials","bones","map"];class En{constructor(a,b,d){d=d||kc.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,d)}getValue(a,b){this.bind();
const d=this._bindings[this._targetGroup.nCachedObjects_];d!==void 0&&d.getValue(a,b)}setValue(a,b){const d=this._bindings;for(let h=this._targetGroup.nCachedObjects_,n=d.length;h!==n;++h)d[h].setValue(a,b)}bind(){const a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,d=a.length;b!==d;++b)a[b].bind()}unbind(){const a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,d=a.length;b!==d;++b)a[b].unbind()}}class kc{constructor(a,b,d){this.path=b;this.parsedPath=d||kc.parseTrackName(b);
this.node=kc.findNode(a,this.parsedPath.nodeName);this.rootNode=a;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}static create(a,b,d){return a&&a.isAnimationObjectGroup?new kc.Composite(a,b,d):new kc(a,b,d)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(xn,"")}static parseTrackName(a){var b=Cn.exec(a);if(b===null)throw Error("PropertyBinding: Cannot parse trackName: "+a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]};
const d=b.nodeName&&b.nodeName.lastIndexOf(".");if(d!==void 0&&d!==-1){const h=b.nodeName.substring(d+1);Dn.indexOf(h)!==-1&&(b.nodeName=b.nodeName.substring(0,d),b.objectName=h)}if(b.propertyName===null||b.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}static findNode(a,b){if(b===void 0||b===""||b==="."||b===-1||b===a.name||b===a.uuid)return a;if(a.skeleton){const d=a.skeleton.getBoneByName(b);if(d!==void 0)return d}if(a.children){const d=
function(h){for(let u=0;u<h.length;u++){var n=h[u];if(n.name===b||n.uuid===b||(n=d(n.children)))return n}return null};if(a=d(a.children))return a}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,b){a[b]=this.targetObject[this.propertyName]}_getValue_array(a,b){const d=this.resolvedProperty;for(let h=0,n=d.length;h!==n;++h)a[b++]=d[h]}_getValue_arrayElement(a,b){a[b]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,b){this.resolvedProperty.toArray(a,b)}_setValue_direct(a,
b){this.targetObject[this.propertyName]=a[b]}_setValue_direct_setNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,b){const d=this.resolvedProperty;for(let h=0,n=d.length;h!==n;++h)d[h]=a[b++]}_setValue_array_setNeedsUpdate(a,b){const d=this.resolvedProperty;for(let h=0,n=d.length;h!==n;++h)d[h]=a[b++];this.targetObject.needsUpdate=
!0}_setValue_array_setMatrixWorldNeedsUpdate(a,b){const d=this.resolvedProperty;for(let h=0,n=d.length;h!==n;++h)d[h]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,b){this.resolvedProperty[this.propertyIndex]=a[b]}_setValue_arrayElement_setNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=
!0}_setValue_fromArray(a,b){this.resolvedProperty.fromArray(a,b)}_setValue_fromArray_setNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,b){this.bind();this.getValue(a,b)}_setValue_unbound(a,b){this.bind();this.setValue(a,b)}bind(){let a=this.node;var b=this.parsedPath,d=b.objectName;const h=b.propertyName;let n=
b.propertyIndex;a||(this.node=a=kc.findNode(this.rootNode,b.nodeName));this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(a){if(d){var u=b.objectIndex;switch(d){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=
a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}a=a.skeleton.bones;for(d=0;d<a.length;d++)if(a[d].name===u){u=d;break}break;case "map":if("map"in a){a=a.map;break}if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",
this);return}a=a.material.map;break;default:if(a[d]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[d]}if(u!==void 0){if(a[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[u]}}u=a[h];if(u===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+h+" but it wasn't found.",a);else{b=this.Versioning.None;this.targetObject=
a;a.isMaterial===!0?b=this.Versioning.NeedsUpdate:a.isObject3D===!0&&(b=this.Versioning.MatrixWorldNeedsUpdate);d=this.BindingType.Direct;if(n!==void 0){if(h==="morphTargetInfluences"){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}a.morphTargetDictionary[n]!==
void 0&&(n=a.morphTargetDictionary[n])}d=this.BindingType.ArrayElement;this.resolvedProperty=u;this.propertyIndex=n}else u.fromArray!==void 0&&u.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(d=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=h;this.getValue=this.GetterByBindingType[d];this.setValue=this.SetterByBindingTypeAndVersioning[d][b]}}else console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+
".")}unbind(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}}kc.Composite=En;kc.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};kc.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};kc.prototype.GetterByBindingType=[kc.prototype._getValue_direct,kc.prototype._getValue_array,kc.prototype._getValue_arrayElement,kc.prototype._getValue_toArray];kc.prototype.SetterByBindingTypeAndVersioning=[[kc.prototype._setValue_direct,
kc.prototype._setValue_direct_setNeedsUpdate,kc.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[kc.prototype._setValue_array,kc.prototype._setValue_array_setNeedsUpdate,kc.prototype._setValue_array_setMatrixWorldNeedsUpdate],[kc.prototype._setValue_arrayElement,kc.prototype._setValue_arrayElement_setNeedsUpdate,kc.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[kc.prototype._setValue_fromArray,kc.prototype._setValue_fromArray_setNeedsUpdate,kc.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];
class Fn{constructor(){this.isAnimationObjectGroup=!0;this.uuid=x();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;const a={};this._indicesByUUID=a;for(let d=0,h=arguments.length;d!==h;++d)a[arguments[d].uuid]=d;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};const b=this;this.stats={objects:{get total(){return b._objects.length},get inUse(){return this.total-b.nCachedObjects_}},get bindingsPerObject(){return b._bindings.length}}}add(){const a=
this._objects,b=this._indicesByUUID,d=this._paths,h=this._parsedPaths,n=this._bindings,u=n.length;let E=void 0,F=a.length,H=this.nCachedObjects_;for(let T=0,X=arguments.length;T!==X;++T){const ea=arguments[T];var M=ea.uuid;let aa=b[M];if(aa===void 0){aa=F++;b[M]=aa;a.push(ea);for(let da=0,U=u;da!==U;++da)n[da].push(new kc(ea,d[da],h[da]))}else if(aa<H){E=a[aa];const da=--H;var R=a[da];b[R.uuid]=aa;a[aa]=R;b[M]=da;a[da]=ea;for(let U=0,ka=u;U!==ka;++U)M=n[U],R=M[aa],M[aa]=M[da],R===void 0&&(R=new kc(ea,
d[U],h[U])),M[da]=R}else a[aa]!==E&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=H}remove(){const a=this._objects,b=this._indicesByUUID,d=this._bindings,h=d.length;let n=this.nCachedObjects_;for(let F=0,H=arguments.length;F!==H;++F){var u=arguments[F],E=u.uuid;const M=b[E];if(M!==void 0&&M>=n){const R=n++,T=a[R];b[T.uuid]=M;a[M]=T;b[E]=R;a[R]=u;for(let X=0,ea=
h;X!==ea;++X)u=d[X],E=u[M],u[M]=u[R],u[R]=E}}this.nCachedObjects_=n}uncache(){const a=this._objects,b=this._indicesByUUID,d=this._bindings,h=d.length;let n=this.nCachedObjects_,u=a.length;for(let R=0,T=arguments.length;R!==T;++R){var E=arguments[R].uuid;const X=b[E];if(X!==void 0)if(delete b[E],X<n){E=--n;var F=a[E],H=--u,M=a[H];b[F.uuid]=X;a[X]=F;b[M.uuid]=E;a[E]=M;a.pop();for(let ea=0,aa=h;ea!==aa;++ea)F=d[ea],M=F[H],F[X]=F[E],F[E]=M,F.pop()}else{E=--u;H=a[E];E>0&&(b[H.uuid]=X);a[X]=H;a.pop();for(let ea=
0,aa=h;ea!==aa;++ea)H=d[ea],H[X]=H[E],H.pop()}}this.nCachedObjects_=n}subscribe_(a,b){const d=this._bindingsIndicesByPath;let h=d[a];const n=this._bindings;if(h!==void 0)return n[h];const u=this._paths,E=this._parsedPaths,F=this._objects,H=this.nCachedObjects_,M=Array(F.length);h=n.length;d[a]=h;u.push(a);E.push(b);n.push(M);for(let R=H,T=F.length;R!==T;++R)M[R]=new kc(F[R],a,b);return M}unsubscribe_(a){const b=this._bindingsIndicesByPath,d=b[a];if(d!==void 0){const h=this._paths,n=this._parsedPaths,
u=this._bindings,E=u.length-1,F=u[E];b[a[E]]=d;u[d]=F;u.pop();n[d]=n[E];n.pop();h[d]=h[E];h.pop()}}}class Wl{constructor(a,b,d=null,h=b.blendMode){this._mixer=a;this._clip=b;this._localRoot=d;this.blendMode=h;a=b.tracks;b=a.length;d=Array(b);h={endingStart:2400,endingEnd:2400};for(let n=0;n!==b;++n){const u=a[n].createInterpolant(null);d[n]=u;u.settings=h}this._interpolantSettings=h;this._interpolants=d;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=
this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}play(){this._mixer._activateAction(this);return this}stop(){this._mixer._deactivateAction(this);return this.reset()}reset(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()}isRunning(){return this.enabled&&
!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(a){this._startTime=a;return this}setLoop(a,b){this.loop=a;this.repetitions=b;return this}setEffectiveWeight(a){this.weight=a;this._effectiveWeight=this.enabled?a:0;return this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(a){return this._scheduleFading(a,0,1)}fadeOut(a){return this._scheduleFading(a,1,0)}crossFadeFrom(a,
b,d=!1){a.fadeOut(b);this.fadeIn(b);if(d===!0){d=this._clip.duration;const h=a._clip.duration,n=d/h;a.warp(1,h/d,b);this.warp(n,1,b)}return this}crossFadeTo(a,b,d=!1){return a.crossFadeFrom(this,b,d)}stopFading(){const a=this._weightInterpolant;a!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this}setEffectiveTimeScale(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(a){this.timeScale=
this._clip.duration/a;return this.stopWarping()}syncWith(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()}halt(a){return this.warp(this._effectiveTimeScale,0,a)}warp(a,b,d){var h=this._mixer;const n=h.time,u=this.timeScale;var E=this._timeScaleInterpolant;E===null&&(this._timeScaleInterpolant=E=h._lendControlInterpolant());h=E.parameterPositions;E=E.sampleValues;h[0]=n;h[1]=n+d;E[0]=a/u;E[1]=b/u;return this}stopWarping(){const a=this._timeScaleInterpolant;a!==null&&(this._timeScaleInterpolant=
null,this._mixer._takeBackControlInterpolant(a));return this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(a,b,d,h){if(this.enabled){var n=this._startTime;n!==null&&(b=(a-n)*d,b<0||d===0?b=0:(this._startTime=null,b*=d));b*=this._updateTimeScale(a);d=this._updateTime(b);a=this._updateWeight(a);if(a>0)switch(b=this._interpolants,n=this._propertyBindings,this.blendMode){case 2501:for(let u=0,E=b.length;u!==E;++u)b[u].evaluate(d),
n[u].accumulateAdditive(a);break;default:for(let u=0,E=b.length;u!==E;++u)b[u].evaluate(d),n[u].accumulate(h,a)}}else this._updateWeight(a)}_updateWeight(a){let b=0;if(this.enabled){b=this.weight;const d=this._weightInterpolant;if(d!==null){const h=d.evaluate(a)[0];b*=h;a>d.parameterPositions[1]&&(this.stopFading(),h===0&&(this.enabled=!1))}}return this._effectiveWeight=b}_updateTimeScale(a){let b=0;if(!this.paused){b=this.timeScale;const d=this._timeScaleInterpolant;if(d!==null){const h=d.evaluate(a)[0];
b*=h;a>d.parameterPositions[1]&&(this.stopWarping(),b===0?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b}_updateTime(a){const b=this._clip.duration;var d=this.loop;let h=this.time+a,n=this._loopCount;const u=d===2202;if(a===0)return n===-1?h:u&&(n&1)===1?b-h:h;if(d===2200)a:{if(n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),h>=b)h=b;else if(h<0)h=0;else{this.time=h;break a}this.clampWhenFinished?this.paused=!0:this.enabled=!1;this.time=h;this._mixer.dispatchEvent({type:"finished",
action:this,direction:a<0?-1:1})}else{n===-1&&(a>=0?(n=0,this._setEndings(!0,this.repetitions===0,u)):this._setEndings(this.repetitions===0,!0,u));if(h>=b||h<0){d=Math.floor(h/b);h-=b*d;n+=Math.abs(d);const E=this.repetitions-n;E<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=h=a>0?b:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:a>0?1:-1})):(E===1?(a=a<0,this._setEndings(a,!a,u)):this._setEndings(!1,!1,u),this._loopCount=n,this.time=h,this._mixer.dispatchEvent({type:"loop",
action:this,loopDelta:d}))}else this.time=h;if(u&&(n&1)===1)return b-h}return h}_setEndings(a,b,d){const h=this._interpolantSettings;d?(h.endingStart=2401,h.endingEnd=2401):(h.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,h.endingEnd=b?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(a,b,d){var h=this._mixer;const n=h.time;var u=this._weightInterpolant;u===null&&(this._weightInterpolant=u=h._lendControlInterpolant());h=u.parameterPositions;u=u.sampleValues;h[0]=n;u[0]=b;h[1]=n+a;u[1]=d;return this}}
const Gn=new Float32Array(1);class Hn extends Bd{constructor(a){super();this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}_bindAction(a,b){const d=a._localRoot||this._root,h=a._clip.tracks,n=h.length,u=a._propertyBindings;a=a._interpolants;const E=d.uuid;var F=this._bindingsByRootAndName;let H=F[E];H===void 0&&(H={},F[E]=H);for(F=0;F!==n;++F){const M=h[F],R=M.name;let T=H[R];if(T!==void 0)++T.referenceCount;else{T=u[F];if(T!==void 0){T._cacheIndex===null&&(++T.referenceCount,
this._addInactiveBinding(T,E,R));continue}T=new Vl(kc.create(d,R,b&&b._propertyBindings[F].binding.parsedPath),M.ValueTypeName,M.getValueSize());++T.referenceCount;this._addInactiveBinding(T,E,R)}u[F]=T;a[F].resultBuffer=T.buffer}}_activateAction(a){if(!this._isActiveAction(a)){if(a._cacheIndex===null){var b=(a._localRoot||this._root).uuid,d=a._clip.uuid;const h=this._actionsByClip[d];this._bindAction(a,h&&h.knownActions[0]);this._addInactiveAction(a,d,b)}b=a._propertyBindings;for(let h=0,n=b.length;h!==
n;++h)d=b[h],d.useCount++===0&&(this._lendBinding(d),d.saveOriginalState());this._lendAction(a)}}_deactivateAction(a){if(this._isActiveAction(a)){const b=a._propertyBindings;for(let d=0,h=b.length;d!==h;++d){const n=b[d];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(a)}}_initMemoryManager(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];
this._nActiveControlInterpolants=0;const a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}}_isActiveAction(a){a=a._cacheIndex;return a!==null&&a<this._nActiveActions}_addInactiveAction(a,b,d){const h=this._actions,n=this._actionsByClip;
let u=n[b];u===void 0?(u={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,n[b]=u):(b=u.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=h.length;h.push(a);u.actionByRoot[d]=a}_removeInactiveAction(a){var b=this._actions,d=b[b.length-1],h=a._cacheIndex;d._cacheIndex=h;b[h]=d;b.pop();a._cacheIndex=null;b=a._clip.uuid;d=this._actionsByClip;h=d[b];const n=h.knownActions,u=n[n.length-1],E=a._byClipCacheIndex;u._byClipCacheIndex=E;n[E]=u;n.pop();a._byClipCacheIndex=null;delete h.actionByRoot[(a._localRoot||
this._root).uuid];n.length===0&&delete d[b];this._removeInactiveBindingsForAction(a)}_removeInactiveBindingsForAction(a){a=a._propertyBindings;for(let b=0,d=a.length;b!==d;++b){const h=a[b];--h.referenceCount===0&&this._removeInactiveBinding(h)}}_lendAction(a){const b=this._actions,d=a._cacheIndex,h=this._nActiveActions++,n=b[h];a._cacheIndex=h;b[h]=a;n._cacheIndex=d;b[d]=n}_takeBackAction(a){const b=this._actions,d=a._cacheIndex,h=--this._nActiveActions,n=b[h];a._cacheIndex=h;b[h]=a;n._cacheIndex=
d;b[d]=n}_addInactiveBinding(a,b,d){const h=this._bindingsByRootAndName,n=this._bindings;let u=h[b];u===void 0&&(u={},h[b]=u);u[d]=a;a._cacheIndex=n.length;n.push(a)}_removeInactiveBinding(a){const b=this._bindings;var d=a.binding;const h=d.rootNode.uuid;d=d.path;const n=this._bindingsByRootAndName,u=n[h],E=b[b.length-1];a=a._cacheIndex;E._cacheIndex=a;b[a]=E;b.pop();delete u[d];Object.keys(u).length===0&&delete n[h]}_lendBinding(a){const b=this._bindings,d=a._cacheIndex,h=this._nActiveBindings++,
n=b[h];a._cacheIndex=h;b[h]=a;n._cacheIndex=d;b[d]=n}_takeBackBinding(a){const b=this._bindings,d=a._cacheIndex,h=--this._nActiveBindings,n=b[h];a._cacheIndex=h;b[h]=a;n._cacheIndex=d;b[d]=n}_lendControlInterpolant(){const a=this._controlInterpolants,b=this._nActiveControlInterpolants++;let d=a[b];d===void 0&&(d=new Dj(new Float32Array(2),new Float32Array(2),1,Gn),d.__cacheIndex=b,a[b]=d);return d}_takeBackControlInterpolant(a){const b=this._controlInterpolants,d=a.__cacheIndex,h=--this._nActiveControlInterpolants,
n=b[h];a.__cacheIndex=h;b[h]=a;n.__cacheIndex=d;b[d]=n}clipAction(a,b,d){var h=b||this._root;const n=h.uuid;h=typeof a==="string"?Lg.findByName(h,a):a;a=h!==null?h.uuid:a;const u=this._actionsByClip[a];var E=null;d===void 0&&(d=h!==null?h.blendMode:2500);if(u!==void 0){E=u.actionByRoot[n];if(E!==void 0&&E.blendMode===d)return E;E=u.knownActions[0];h===null&&(h=E._clip)}if(h===null)return null;b=new Wl(this,h,b,d);this._bindAction(b,E);this._addInactiveAction(b,a,n);return b}existingAction(a,b){var d=
b||this._root;b=d.uuid;d=typeof a==="string"?Lg.findByName(d,a):a;a=this._actionsByClip[d?d.uuid:a];return a!==void 0?a.actionByRoot[b]||null:null}stopAllAction(){const a=this._actions;var b=this._nActiveActions;for(--b;b>=0;--b)a[b].stop();return this}update(a){a*=this.timeScale;var b=this._actions,d=this._nActiveActions;const h=this.time+=a,n=Math.sign(a),u=this._accuIndex^=1;for(let E=0;E!==d;++E)b[E]._update(h,a,n,u);a=this._bindings;b=this._nActiveBindings;for(d=0;d!==b;++d)a[d].apply(u);return this}setTime(a){this.time=
0;for(let b=0;b<this._actions.length;b++)this._actions[b].time=0;return this.update(a)}getRoot(){return this._root}uncacheClip(a){const b=this._actions;a=a.uuid;const d=this._actionsByClip;var h=d[a];if(h!==void 0){h=h.knownActions;for(let n=0,u=h.length;n!==u;++n){const E=h[n];this._deactivateAction(E);const F=E._cacheIndex,H=b[b.length-1];E._cacheIndex=null;E._byClipCacheIndex=null;H._cacheIndex=F;b[F]=H;b.pop();this._removeInactiveBindingsForAction(E)}delete d[a]}}uncacheRoot(a){a=a.uuid;const b=
this._actionsByClip;for(var d in b){const h=b[d].actionByRoot[a];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}d=this._bindingsByRootAndName[a];if(d!==void 0)for(const h in d)a=d[h],a.restoreOriginalState(),this._removeInactiveBinding(a)}uncacheAction(a,b){a=this.existingAction(a,b);a!==null&&(this._deactivateAction(a),this._removeInactiveAction(a))}}class In extends wg{constructor(a=1,b=1,d=1,h={}){super(a,b,h);this.isRenderTarget3D=!0;this.depth=d;this.texture=new Cf(null,
a,b,d);this._setTextureOptions(h);this.texture.isRenderTargetTexture=!0}}class Xl{constructor(a){this.value=a}clone(){return new Xl(this.value.clone===void 0?this.value:this.value.clone())}}let Jn=0;class Kn extends Bd{constructor(){super();this.isUniformsGroup=!0;Object.defineProperty(this,"id",{value:Jn++});this.name="";this.usage=35044;this.uniforms=[]}add(a){this.uniforms.push(a);return this}remove(a){a=this.uniforms.indexOf(a);a!==-1&&this.uniforms.splice(a,1);return this}setName(a){this.name=
a;return this}setUsage(a){this.usage=a;return this}dispose(){this.dispatchEvent({type:"dispose"})}copy(a){this.name=a.name;this.usage=a.usage;a=a.uniforms;this.uniforms.length=0;for(let b=0,d=a.length;b<d;b++){const h=Array.isArray(a[b])?a[b]:[a[b]];for(let n=0;n<h.length;n++)this.uniforms.push(h[n].clone())}return this}clone(){return(new this.constructor).copy(this)}}class Ln extends uh{constructor(a,b,d=1){super(a,b);this.isInstancedInterleavedBuffer=!0;this.meshPerAttribute=d}copy(a){super.copy(a);
this.meshPerAttribute=a.meshPerAttribute;return this}clone(a){a=super.clone(a);a.meshPerAttribute=this.meshPerAttribute;return a}toJSON(a){a=super.toJSON(a);a.isInstancedInterleavedBuffer=!0;a.meshPerAttribute=this.meshPerAttribute;return a}}class Mn{constructor(a,b,d,h,n,u=!1){this.isGLBufferAttribute=!0;this.name="";this.buffer=a;this.type=b;this.itemSize=d;this.elementSize=h;this.count=n;this.normalized=u;this.version=0}set needsUpdate(a){a===!0&&this.version++}setBuffer(a){this.buffer=a;return this}setType(a,
b){this.type=a;this.elementSize=b;return this}setItemSize(a){this.itemSize=a;return this}setCount(a){this.count=a;return this}}const Yl=new Gb;class Nn{constructor(a,b,d=0,h=Infinity){this.ray=new Hf(a,b);this.near=d;this.far=h;this.camera=null;this.layers=new bh;this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(a,b){this.ray.set(a,b)}setFromCamera(a,b){b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize(),
this.camera=b):b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld),this.camera=b):console.error("THREE.Raycaster: Unsupported camera type: "+b.type)}setFromXRController(a){Yl.identity().extractRotation(a.matrixWorld);this.ray.origin.setFromMatrixPosition(a.matrixWorld);this.ray.direction.set(0,0,-1).applyMatrix4(Yl);return this}intersectObject(a,b=!0,d=[]){Ic(a,this,d,b);d.sort(Hd);return d}intersectObjects(a,
b=!0,d=[]){for(let h=0,n=a.length;h<n;h++)Ic(a[h],this,d,b);d.sort(Hd);return d}}class On{constructor(){this._currentTime=this._previousTime=0;this._startTime=performance.now();this._elapsed=this._delta=0;this._timescale=1;this._pageVisibilityHandler=this._document=null}connect(a){this._document=a;a.hidden!==void 0&&(this._pageVisibilityHandler=qd.bind(this),a.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",
this._pageVisibilityHandler),this._pageVisibilityHandler=null);this._document=null}getDelta(){return this._delta/1E3}getElapsed(){return this._elapsed/1E3}getTimescale(){return this._timescale}setTimescale(a){this._timescale=a;return this}reset(){this._currentTime=performance.now()-this._startTime;return this}dispose(){this.disconnect()}update(a){this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(a!==void 0?a:performance.now())-
this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta);return this}}class Pn{constructor(a=1,b=0,d=0){this.radius=a;this.phi=b;this.theta=d}set(a,b,d){this.radius=a;this.phi=b;this.theta=d;return this}copy(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this}makeSafe(){this.phi=r(this.phi,1E-6,Math.PI-1E-6);return this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,b,d){this.radius=
Math.sqrt(a*a+b*b+d*d);this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(a,d),this.phi=Math.acos(r(b/this.radius,-1,1)));return this}clone(){return(new this.constructor).copy(this)}}class Qn{constructor(a=1,b=0,d=0){this.radius=a;this.theta=b;this.y=d}set(a,b,d){this.radius=a;this.theta=b;this.y=d;return this}copy(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this}setFromVector3(a){return this.setFromCartesianCoords(a.x,a.y,a.z)}setFromCartesianCoords(a,b,d){this.radius=
Math.sqrt(a*a+d*d);this.theta=Math.atan2(a,d);this.y=b;return this}clone(){return(new this.constructor).copy(this)}}class Zl{constructor(a,b,d,h){Zl.prototype.isMatrix2=!0;this.elements=[1,0,0,1];a!==void 0&&this.set(a,b,d,h)}identity(){this.set(1,0,0,1);return this}fromArray(a,b=0){for(let d=0;d<4;d++)this.elements[d]=a[d+b];return this}set(a,b,d,h){const n=this.elements;n[0]=a;n[2]=b;n[1]=d;n[3]=h;return this}}const $l=new Xa;class Rn{constructor(a=new Xa(Infinity,Infinity),b=new Xa(-Infinity,-Infinity)){this.isBox2=
!0;this.min=a;this.max=b}set(a,b){this.min.copy(a);this.max.copy(b);return this}setFromPoints(a){this.makeEmpty();for(let b=0,d=a.length;b<d;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){b=$l.copy(b).multiplyScalar(.5);this.min.copy(a).sub(b);this.max.copy(a).add(b);return this}clone(){return(new this.constructor).copy(this)}copy(a){this.min.copy(a.min);this.max.copy(a.max);return this}makeEmpty(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this}isEmpty(){return this.max.x<
this.min.x||this.max.y<this.min.y}getCenter(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)}expandByPoint(a){this.min.min(a);this.max.max(a);return this}expandByVector(a){this.min.sub(a);this.max.add(a);return this}expandByScalar(a){this.min.addScalar(-a);this.max.addScalar(a);return this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y}containsBox(a){return this.min.x<=
a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&a.max.y>=this.min.y&&a.min.y<=this.max.y}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,$l).distanceTo(a)}intersect(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this}union(a){this.min.min(a.min);
this.max.max(a.max);return this}translate(a){this.min.add(a);this.max.add(a);return this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}const am=new ma,Sh=new ma,Wf=new ma,Xf=new ma,Nj=new ma,Sn=new ma,Tn=new ma;class Un{constructor(a=new ma,b=new ma){this.start=a;this.end=b}set(a,b){this.start.copy(a);this.end.copy(b);return this}copy(a){this.start.copy(a.start);this.end.copy(a.end);return this}getCenter(a){return a.addVectors(this.start,this.end).multiplyScalar(.5)}delta(a){return a.subVectors(this.end,
this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(a,b){return this.delta(b).multiplyScalar(a).add(this.start)}closestPointToPointParameter(a,b){am.subVectors(a,this.start);Sh.subVectors(this.end,this.start);a=Sh.dot(Sh);a=Sh.dot(am)/a;b&&(a=r(a,0,1));return a}closestPointToPoint(a,b,d){a=this.closestPointToPointParameter(a,b);return this.delta(d).multiplyScalar(a).add(this.start)}distanceSqToLine3(a,b=Sn,d=Tn){var h=1E-8*1E-8;
const n=this.start,u=a.start;a=a.end;Wf.subVectors(this.end,n);Xf.subVectors(a,u);Nj.subVectors(n,u);a=Wf.dot(Wf);var E=Xf.dot(Xf);const F=Xf.dot(Nj);if(a<=h&&E<=h)return b.copy(n),d.copy(u),b.sub(d),b.dot(b);if(a<=h){var H=0;E=r(F/E,0,1)}else{const M=Wf.dot(Nj);E<=h?(E=0,H=r(-M/a,0,1)):(h=Wf.dot(Xf),H=a*E-h*h,H=H!==0?r((h*F-M*E)/H,0,1):0,E=(h*H+F)/E,E<0?(E=0,H=r(-M/a,0,1)):E>1&&(E=1,H=r((h-M)/a,0,1)))}b.copy(n).add(Wf.multiplyScalar(H));d.copy(u).add(Xf.multiplyScalar(E));b.sub(d);return b.dot(b)}applyMatrix4(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this}equals(a){return a.start.equals(this.start)&&a.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const bm=new ma;class Vn extends jc{constructor(a,b){super();this.light=a;this.matrixAutoUpdate=!1;this.color=b;this.type="SpotLightHelper";a=new Vb;b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let d=0,h=1,n=32;d<n;d++,h++){const u=d/n*Math.PI*2,E=h/n*Math.PI*2;b.push(Math.cos(u),Math.sin(u),1,Math.cos(E),Math.sin(E),1)}a.setAttribute("position",
new vb(b,3));b=new jd({fog:!1,toneMapped:!1});this.cone=new ce(a,b);this.add(this.cone);this.update()}dispose(){this.cone.geometry.dispose();this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);this.light.target.updateWorldMatrix(!0,!1);this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld);this.matrixWorld.copy(this.light.matrixWorld);const a=this.light.distance?
this.light.distance:1E3,b=a*Math.tan(this.light.angle);this.cone.scale.set(b,b,a);bm.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(bm);this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Le=new ma,Th=new Gb,Oj=new Gb;class Wn extends ce{constructor(a){var b=ld(a);const d=new Vb;var h=[];const n=[];for(let u=0;u<b.length;u++){const E=b[u];E.parent&&E.parent.isBone&&(h.push(0,0,0),h.push(0,0,0),n.push(0,0,0),n.push(0,
0,0))}d.setAttribute("position",new vb(h,3));d.setAttribute("color",new vb(n,3));h=new jd({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(d,h);this.isSkeletonHelper=!0;this.type="SkeletonHelper";this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;a=new pb(255);b=new pb(65280);this.setColors(a,b)}updateMatrixWorld(a){const b=this.bones,d=this.geometry,h=d.getAttribute("position");Oj.copy(this.root.matrixWorld).invert();for(let n=0,u=0;n<b.length;n++){const E=
b[n];E.parent&&E.parent.isBone&&(Th.multiplyMatrices(Oj,E.matrixWorld),Le.setFromMatrixPosition(Th),h.setXYZ(u,Le.x,Le.y,Le.z),Th.multiplyMatrices(Oj,E.parent.matrixWorld),Le.setFromMatrixPosition(Th),h.setXYZ(u+1,Le.x,Le.y,Le.z),u+=2)}d.getAttribute("position").needsUpdate=!0;super.updateMatrixWorld(a)}setColors(a,b){const d=this.geometry.getAttribute("color");for(let h=0;h<d.count;h+=2)d.setXYZ(h,a.r,a.g,a.b),d.setXYZ(h+1,b.r,b.g,b.b);d.needsUpdate=!0;return this}dispose(){this.geometry.dispose();
this.material.dispose()}}class Xn extends Kc{constructor(a,b,d){b=new Ph(b,4,2);const h=new He({wireframe:!0,fog:!1,toneMapped:!1});super(b,h);this.light=a;this.color=d;this.type="PointLightHelper";this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}dispose(){this.geometry.dispose();this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Yn=new ma,cm=new pb,
dm=new pb;class Zn extends jc{constructor(a,b,d){super();this.light=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=d;this.type="HemisphereLightHelper";a=new Oh(b);a.rotateY(Math.PI*.5);this.material=new He({wireframe:!0,fog:!1,toneMapped:!1});this.color===void 0&&(this.material.vertexColors=!0);b=a.getAttribute("position");b=new Float32Array(b.count*3);a.setAttribute("color",new sc(b,3));this.add(new Kc(a,this.material));this.update()}dispose(){this.children[0].geometry.dispose();
this.children[0].material.dispose()}update(){const a=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const b=a.geometry.getAttribute("color");cm.copy(this.light.color);dm.copy(this.light.groundColor);for(let d=0,h=b.count;d<h;d++){const n=d<h/2?cm:dm;b.setXYZ(d,n.r,n.g,n.b)}b.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1);a.lookAt(Yn.setFromMatrixPosition(this.light.matrixWorld).negate())}}class $n extends ce{constructor(a=10,b=10,d=4473924,h=8947848){d=new pb(d);
h=new pb(h);const n=b/2,u=a/b,E=a/2;a=[];const F=[];for(let H=0,M=0,R=-E;H<=b;H++,R+=u){a.push(-E,0,R,E,0,R);a.push(R,0,-E,R,0,E);const T=H===n?d:h;T.toArray(F,M);M+=3;T.toArray(F,M);M+=3;T.toArray(F,M);M+=3;T.toArray(F,M);M+=3}b=new Vb;b.setAttribute("position",new vb(a,3));b.setAttribute("color",new vb(F,3));d=new jd({vertexColors:!0,toneMapped:!1});super(b,d);this.type="GridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}class ao extends ce{constructor(a=10,b=16,d=8,h=64,n=4473924,
u=8947848){n=new pb(n);u=new pb(u);var E=[];const F=[];if(b>1)for(var H=0;H<b;H++){var M=H/b*(Math.PI*2),R=Math.sin(M)*a;M=Math.cos(M)*a;E.push(0,0,0);E.push(R,0,M);R=H&1?n:u;F.push(R.r,R.g,R.b);F.push(R.r,R.g,R.b)}for(b=0;b<d;b++)for(H=b&1?n:u,R=a-a/d*b,M=0;M<h;M++){var T=M/h*(Math.PI*2);let X=Math.sin(T)*R;T=Math.cos(T)*R;E.push(X,0,T);F.push(H.r,H.g,H.b);T=(M+1)/h*(Math.PI*2);X=Math.sin(T)*R;T=Math.cos(T)*R;E.push(X,0,T);F.push(H.r,H.g,H.b)}a=new Vb;a.setAttribute("position",new vb(E,3));a.setAttribute("color",
new vb(F,3));E=new jd({vertexColors:!0,toneMapped:!1});super(a,E);this.type="PolarGridHelper"}dispose(){this.geometry.dispose();this.material.dispose()}}const em=new ma,Uh=new ma,fm=new ma;class bo extends jc{constructor(a,b,d){super();this.light=a;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=d;this.type="DirectionalLightHelper";b===void 0&&(b=1);a=new Vb;a.setAttribute("position",new vb([-b,b,0,b,b,0,b,-b,0,-b,-b,0,-b,b,0],3));b=new jd({fog:!1,toneMapped:!1});this.lightPlane=new Je(a,
b);this.add(this.lightPlane);a=new Vb;a.setAttribute("position",new vb([0,0,0,0,0,1],3));this.targetLine=new Je(a,b);this.add(this.targetLine);this.update()}dispose(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1);this.light.target.updateWorldMatrix(!0,!1);em.setFromMatrixPosition(this.light.matrixWorld);Uh.setFromMatrixPosition(this.light.target.matrixWorld);fm.subVectors(Uh,
em);this.lightPlane.lookAt(Uh);this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(Uh);this.targetLine.scale.z=fm.length()}}const Vg=new ma,Gc=new sh;class co extends ce{constructor(a){function b(R,T){d(R);d(T)}function d(R){u.push(0,0,0);E.push(0,0,0);F[R]===void 0&&(F[R]=[]);F[R].push(u.length/3-1)}var h=
new Vb,n=new jd({color:16777215,vertexColors:!0,toneMapped:!1});const u=[],E=[],F={};b("n1","n2");b("n2","n4");b("n4","n3");b("n3","n1");b("f1","f2");b("f2","f4");b("f4","f3");b("f3","f1");b("n1","f1");b("n2","f2");b("n3","f3");b("n4","f4");b("p","n1");b("p","n2");b("p","n3");b("p","n4");b("u1","u2");b("u2","u3");b("u3","u1");b("c","t");b("p","c");b("cn1","cn2");b("cn3","cn4");b("cf1","cf2");b("cf3","cf4");h.setAttribute("position",new vb(u,3));h.setAttribute("color",new vb(E,3));super(h,n);this.type=
"CameraHelper";this.camera=a;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=F;this.update();a=new pb(16755200);h=new pb(16711680);n=new pb(43775);const H=new pb(16777215),M=new pb(3355443);this.setColors(a,h,n,H,M)}setColors(a,b,d,h,n){const u=this.geometry.getAttribute("color");u.setXYZ(0,a.r,a.g,a.b);u.setXYZ(1,a.r,a.g,a.b);u.setXYZ(2,a.r,a.g,a.b);u.setXYZ(3,a.r,a.g,a.b);u.setXYZ(4,a.r,a.g,a.b);u.setXYZ(5,
a.r,a.g,a.b);u.setXYZ(6,a.r,a.g,a.b);u.setXYZ(7,a.r,a.g,a.b);u.setXYZ(8,a.r,a.g,a.b);u.setXYZ(9,a.r,a.g,a.b);u.setXYZ(10,a.r,a.g,a.b);u.setXYZ(11,a.r,a.g,a.b);u.setXYZ(12,a.r,a.g,a.b);u.setXYZ(13,a.r,a.g,a.b);u.setXYZ(14,a.r,a.g,a.b);u.setXYZ(15,a.r,a.g,a.b);u.setXYZ(16,a.r,a.g,a.b);u.setXYZ(17,a.r,a.g,a.b);u.setXYZ(18,a.r,a.g,a.b);u.setXYZ(19,a.r,a.g,a.b);u.setXYZ(20,a.r,a.g,a.b);u.setXYZ(21,a.r,a.g,a.b);u.setXYZ(22,a.r,a.g,a.b);u.setXYZ(23,a.r,a.g,a.b);u.setXYZ(24,b.r,b.g,b.b);u.setXYZ(25,b.r,b.g,
b.b);u.setXYZ(26,b.r,b.g,b.b);u.setXYZ(27,b.r,b.g,b.b);u.setXYZ(28,b.r,b.g,b.b);u.setXYZ(29,b.r,b.g,b.b);u.setXYZ(30,b.r,b.g,b.b);u.setXYZ(31,b.r,b.g,b.b);u.setXYZ(32,d.r,d.g,d.b);u.setXYZ(33,d.r,d.g,d.b);u.setXYZ(34,d.r,d.g,d.b);u.setXYZ(35,d.r,d.g,d.b);u.setXYZ(36,d.r,d.g,d.b);u.setXYZ(37,d.r,d.g,d.b);u.setXYZ(38,h.r,h.g,h.b);u.setXYZ(39,h.r,h.g,h.b);u.setXYZ(40,n.r,n.g,n.b);u.setXYZ(41,n.r,n.g,n.b);u.setXYZ(42,n.r,n.g,n.b);u.setXYZ(43,n.r,n.g,n.b);u.setXYZ(44,n.r,n.g,n.b);u.setXYZ(45,n.r,n.g,n.b);
u.setXYZ(46,n.r,n.g,n.b);u.setXYZ(47,n.r,n.g,n.b);u.setXYZ(48,n.r,n.g,n.b);u.setXYZ(49,n.r,n.g,n.b);u.needsUpdate=!0;return this}update(){const a=this.geometry,b=this.pointMap;let d,h;Gc.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);if(this.camera.reversedDepth===!0)d=1,h=0;else if(this.camera.coordinateSystem===2E3)d=-1,h=1;else if(this.camera.coordinateSystem===2001)d=0,h=1;else throw Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);
ic("c",b,a,Gc,0,0,d);ic("t",b,a,Gc,0,0,h);ic("n1",b,a,Gc,-1,-1,d);ic("n2",b,a,Gc,1,-1,d);ic("n3",b,a,Gc,-1,1,d);ic("n4",b,a,Gc,1,1,d);ic("f1",b,a,Gc,-1,-1,h);ic("f2",b,a,Gc,1,-1,h);ic("f3",b,a,Gc,-1,1,h);ic("f4",b,a,Gc,1,1,h);ic("u1",b,a,Gc,.7,1.1,d);ic("u2",b,a,Gc,-.7,1.1,d);ic("u3",b,a,Gc,0,2,d);ic("cf1",b,a,Gc,-1,0,h);ic("cf2",b,a,Gc,1,0,h);ic("cf3",b,a,Gc,0,-1,h);ic("cf4",b,a,Gc,0,1,h);ic("cn1",b,a,Gc,-1,0,d);ic("cn2",b,a,Gc,1,0,d);ic("cn3",b,a,Gc,0,-1,d);ic("cn4",b,a,Gc,0,1,d);a.getAttribute("position").needsUpdate=
!0}dispose(){this.geometry.dispose();this.material.dispose()}}const Vh=new Sc;class eo extends ce{constructor(a,b=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),h=new Float32Array(24),n=new Vb;n.setIndex(new sc(d,1));n.setAttribute("position",new sc(h,3));super(n,new jd({color:b,toneMapped:!1}));this.object=a;this.type="BoxHelper";this.matrixAutoUpdate=!1;this.update()}update(){this.object!==void 0&&Vh.setFromObject(this.object);if(!Vh.isEmpty()){var a=Vh.min,
b=Vh.max,d=this.geometry.attributes.position,h=d.array;h[0]=b.x;h[1]=b.y;h[2]=b.z;h[3]=a.x;h[4]=b.y;h[5]=b.z;h[6]=a.x;h[7]=a.y;h[8]=b.z;h[9]=b.x;h[10]=a.y;h[11]=b.z;h[12]=b.x;h[13]=b.y;h[14]=a.z;h[15]=a.x;h[16]=b.y;h[17]=a.z;h[18]=a.x;h[19]=a.y;h[20]=a.z;h[21]=b.x;h[22]=a.y;h[23]=a.z;d.needsUpdate=!0;this.geometry.computeBoundingSphere()}}setFromObject(a){this.object=a;this.update();return this}copy(a,b){super.copy(a,b);this.object=a.object;return this}dispose(){this.geometry.dispose();this.material.dispose()}}
class fo extends ce{constructor(a,b=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),h=new Vb;h.setIndex(new sc(d,1));h.setAttribute("position",new vb([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));super(h,new jd({color:b,toneMapped:!1}));this.box=a;this.type="Box3Helper";this.geometry.computeBoundingSphere()}updateMatrixWorld(a){const b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(a))}dispose(){this.geometry.dispose();
this.material.dispose()}}class go extends Je{constructor(a,b=1,d=16776960){const h=new Vb;h.setAttribute("position",new vb([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3));h.computeBoundingSphere();super(h,new jd({color:d,toneMapped:!1}));this.type="PlaneHelper";this.plane=a;this.size=b;a=new Vb;a.setAttribute("position",new vb([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3));a.computeBoundingSphere();this.add(new Kc(a,new He({color:d,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(a){this.position.set(0,
0,0);this.scale.set(.5*this.size,.5*this.size,1);this.lookAt(this.plane.normal);this.translateZ(-this.plane.constant);super.updateMatrixWorld(a)}dispose(){this.geometry.dispose();this.material.dispose();this.children[0].geometry.dispose();this.children[0].material.dispose()}}const gm=new ma;let Wh,Pj;class ho extends jc{constructor(a=new ma(0,0,1),b=new ma(0,0,0),d=1,h=16776960,n=d*.2,u=n*.2){super();this.type="ArrowHelper";Wh===void 0&&(Wh=new Vb,Wh.setAttribute("position",new vb([0,0,0,0,1,0],3)),
Pj=new Gh(.5,1,5,1),Pj.translate(0,-.5,0));this.position.copy(b);this.line=new Je(Wh,new jd({color:h,toneMapped:!1}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new Kc(Pj,new He({color:h,toneMapped:!1}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(d,n,u)}setDirection(a){a.y>.99999?this.quaternion.set(0,0,0,1):a.y<-.99999?this.quaternion.set(1,0,0,0):(gm.set(a.z,0,-a.x).normalize(),this.quaternion.setFromAxisAngle(gm,Math.acos(a.y)))}setLength(a,
b=a*.2,d=b*.2){this.line.scale.set(1,Math.max(1E-4,a-b),1);this.line.updateMatrix();this.cone.scale.set(d,b,d);this.cone.position.y=a;this.cone.updateMatrix()}setColor(a){this.line.material.color.set(a);this.cone.material.color.set(a)}copy(a){super.copy(a,!1);this.line.copy(a.line);this.cone.copy(a.cone);return this}dispose(){this.line.geometry.dispose();this.line.material.dispose();this.cone.geometry.dispose();this.cone.material.dispose()}}class io extends ce{constructor(a=1){var b=[0,0,0,a,0,0,
0,0,0,0,a,0,0,0,0,0,0,a];a=new Vb;a.setAttribute("position",new vb(b,3));a.setAttribute("color",new vb([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));b=new jd({vertexColors:!0,toneMapped:!1});super(a,b);this.type="AxesHelper"}setColors(a,b,d){const h=new pb,n=this.geometry.attributes.color.array;h.set(a);h.toArray(n,0);h.toArray(n,3);h.set(b);h.toArray(n,6);h.toArray(n,9);h.set(d);h.toArray(n,12);h.toArray(n,15);this.geometry.attributes.color.needsUpdate=!0;return this}dispose(){this.geometry.dispose();
this.material.dispose()}}class jo{constructor(){this.type="ShapePath";this.color=new pb;this.subPaths=[];this.currentPath=null}moveTo(a,b){this.currentPath=new Nh;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,b);return this}lineTo(a,b){this.currentPath.lineTo(a,b);return this}quadraticCurveTo(a,b,d,h){this.currentPath.quadraticCurveTo(a,b,d,h);return this}bezierCurveTo(a,b,d,h,n,u){this.currentPath.bezierCurveTo(a,b,d,h,n,u);return this}splineThru(a){this.currentPath.splineThru(a);
return this}toShapes(a){function b(aa){const da=[];for(let U=0,ka=aa.length;U<ka;U++){const qa=aa[U],wa=new ef;wa.curves=qa.curves;da.push(wa)}return da}function d(aa,da){const U=da.length;let ka=!1;for(let wa=U-1,sa=0;sa<U;wa=sa++){var qa=da[wa];let Aa=da[sa],Ba=Aa.x-qa.x,Na=Aa.y-qa.y;if(Math.abs(Na)>Number.EPSILON){if(Na<0&&(qa=da[sa],Ba=-Ba,Aa=da[wa],Na=-Na),!(aa.y<qa.y||aa.y>Aa.y))if(aa.y===qa.y){if(aa.x===qa.x)return!0}else{qa=Na*(aa.x-qa.x)-Ba*(aa.y-qa.y);if(qa===0)return!0;qa<0||(ka=!ka)}}else if(aa.y===
qa.y&&(Aa.x<=aa.x&&aa.x<=qa.x||qa.x<=aa.x&&aa.x<=Aa.x))return!0}return ka}var h=de.isClockWise,n=this.subPaths;if(n.length===0)return[];const u=[];if(n.length===1){var E=n[0];var F=new ef;F.curves=E.curves;u.push(F);return u}var H=!h(n[0].getPoints());H=a?!H:H;F=[];const M=[];let R=[];var T=0;let X;M[T]=void 0;R[T]=[];for(let aa=0,da=n.length;aa<da;aa++){E=n[aa];X=E.getPoints();var ea=h(X);(ea=a?!ea:ea)?(!H&&M[T]&&T++,M[T]={s:new ef,p:X},M[T].s.curves=E.curves,H&&T++,R[T]=[]):R[T].push({h:E,p:X[0]})}if(!M[0])return b(n);
if(M.length>1){E=!1;a=0;for(let aa=0,da=M.length;aa<da;aa++)F[aa]=[];for(let aa=0,da=M.length;aa<da;aa++)for(h=R[aa],n=0;n<h.length;n++){ea=h[n];H=!0;for(T=0;T<M.length;T++)d(ea.p,M[T].p)&&(aa!==T&&a++,H?(H=!1,F[T].push(ea)):E=!0);H&&F[aa].push(ea)}a>0&&E===!1&&(R=F)}for(let aa=0,da=M.length;aa<da;aa++){F=M[aa].s;u.push(F);E=R[aa];for(let U=0,ka=E.length;U<ka;U++)F.holes.push(E[U].h)}return u}}class ko extends Bd{constructor(a,b=null){super();this.object=a;this.domElement=b;this.enabled=!0;this.state=
-1;this.keys={};this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null};this.touches={ONE:null,TWO:null}}connect(a){a===void 0?console.warn("THREE.Controls: connect() now requires an element."):(this.domElement!==null&&this.disconnect(),this.domElement=a)}disconnect(){}dispose(){}update(){}}class lo{static contain(a,b){const d=a.image&&a.image.width?a.image.width/a.image.height:1;d>b?(a.repeat.x=1,a.repeat.y=d/b,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2):(a.repeat.x=b/d,a.repeat.y=1,a.offset.x=(1-a.repeat.x)/
2,a.offset.y=0);return a}static cover(a,b){const d=a.image&&a.image.width?a.image.width/a.image.height:1;d>b?(a.repeat.x=b/d,a.repeat.y=1,a.offset.x=(1-a.repeat.x)/2,a.offset.y=0):(a.repeat.x=1,a.repeat.y=d/b,a.offset.x=0,a.offset.y=(1-a.repeat.y)/2);return a}static fill(a){a.repeat.x=1;a.repeat.y=1;a.offset.x=0;a.offset.y=0;return a}static getByteLength(a,b,d,h){return Ib(a,b,d,h)}}typeof __THREE_DEVTOOLS__!=="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"180"}}));
typeof window!=="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="180");const Ub={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a \x3c getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE \x3d 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv \x3d max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale \x3d 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales \x3d vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha \x3d vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor \x3d fract( log2( pixScale ) );\n\t\tfloat x \x3d ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a \x3d min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases \x3d vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold \x3d ( x \x3c ( 1.0 - a ) )\n\t\t\t? ( ( x \x3c a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",
alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *\x3d texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a \x3d smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a \x3d\x3d 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a \x3c alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",
aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion \x3d ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *\x3d ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *\x3d ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *\x3d ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD )\n\t\tfloat dotNV \x3d saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *\x3d computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size \x3d textureSize( batchingTexture, 0 ).x;\n\t\tint j \x3d int( i ) * 4;\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\tvec4 v1 \x3d texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 \x3d texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 \x3d texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 \x3d texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size \x3d textureSize( batchingIdTexture, 0 ).x;\n\t\tint x \x3d i % size;\n\t\tint y \x3d i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size \x3d textureSize( batchingColorTexture, 0 ).x;\n\t\tint j \x3d int( i );\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",
batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix \x3d getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed \x3d vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition \x3d vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal \x3d vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent \x3d vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\tvec3 F \x3d F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G \x3d G_BlinnPhong_Implicit( );\n\tfloat D \x3d D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",
iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 \x3d mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 \x3d sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase \x3d 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val \x3d vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos \x3d vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var \x3d vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz \x3d val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x +\x3d 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /\x3d 1.0685e-7;\n\t\tvec3 rgb \x3d XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR \x3d mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq \x3d pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq \x3d 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq \x3c 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 \x3d sqrt( cosTheta2Sq );\n\t\tfloat R0 \x3d IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 \x3d F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 \x3d 1.0 - R12;\n\t\tfloat phi12 \x3d 0.0;\n\t\tif ( iridescenceIOR \x3c outsideIOR ) phi12 \x3d PI;\n\t\tfloat phi21 \x3d PI - phi12;\n\t\tvec3 baseIOR \x3d Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 \x3d IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 \x3d F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 \x3d vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] \x3c iridescenceIOR ) phi23[ 0 ] \x3d PI;\n\t\tif ( baseIOR[ 1 ] \x3c iridescenceIOR ) phi23[ 1 ] \x3d PI;\n\t\tif ( baseIOR[ 2 ] \x3c iridescenceIOR ) phi23[ 2 ] \x3d PI;\n\t\tfloat OPD \x3d 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi \x3d vec3( phi21 ) + phi23;\n\t\tvec3 R123 \x3d clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 \x3d sqrt( R123 );\n\t\tvec3 Rs \x3d pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 \x3d R12 + Rs;\n\t\tI \x3d C0;\n\t\tvec3 Cm \x3d Rs - T121;\n\t\tfor ( int m \x3d 1; m \x3c\x3d 2; ++ m ) {\n\t\t\tCm *\x3d r123;\n\t\t\tvec3 Sm \x3d 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI +\x3d Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx \x3d dFdx( vBumpMapUv );\n\t\tvec2 dSTdy \x3d dFdy( vBumpMapUv );\n\t\tfloat Hll \x3d bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx \x3d bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy \x3d bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX \x3d normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY \x3d normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN \x3d surf_norm;\n\t\tvec3 R1 \x3d cross( vSigmaY, vN );\n\t\tvec3 R2 \x3d cross( vN, vSigmaX );\n\t\tfloat fDet \x3d dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad \x3d sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity \x3d 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\tdistanceToPlane \x3d - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient \x3d fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *\x3d smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity \x3d\x3d 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES \x3c NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity \x3d 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i \x3d UNION_CLIPPING_PLANES; i \x3c NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane \x3d - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient \x3d fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *\x3d 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *\x3d 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *\x3d clipOpacity;\n\t\tif ( diffuseColor.a \x3d\x3d 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES \x3c NUM_CLIPPING_PLANES\n\t\t\tbool clipped \x3d true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i \x3d UNION_CLIPPING_PLANES; i \x3c NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane \x3d clippingPlanes[ i ];\n\t\t\t\tclipped \x3d ( dot( vClipPosition, plane.xyz ) \x3e plane.w ) \x26\x26 clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES \x3e 0\n\tvClipPosition \x3d - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *\x3d vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *\x3d vColor;\n#endif",
color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor \x3d vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor \x3d vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *\x3d color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *\x3d instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor \x3d getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *\x3d batchingColor.xyz;\n#endif",
common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 \x3d x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a \x3d 12.9898, b \x3d 78.233, c \x3d 43758.5453;\n\thighp float dt \x3d dot( uv.xy, vec2( a,b ) ), sn \x3d mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent \x3d max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] \x3d vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] \x3d vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] \x3d vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] \x3d\x3d - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u \x3d atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v \x3d asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel \x3d exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel \x3d exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection \x3d abs( direction );\n\t\tfloat face \x3d - 1.0;\n\t\tif ( absDirection.x \x3e absDirection.z ) {\n\t\t\tif ( absDirection.x \x3e absDirection.y )\n\t\t\t\tface \x3d direction.x \x3e 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z \x3e absDirection.y )\n\t\t\t\tface \x3d direction.z \x3e 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface \x3d direction.y \x3e 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face \x3d\x3d 0.0 ) {\n\t\t\tuv \x3d vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face \x3d\x3d 1.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face \x3d\x3d 2.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face \x3d\x3d 3.0 ) {\n\t\t\tuv \x3d vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face \x3d\x3d 4.0 ) {\n\t\t\tuv \x3d vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv \x3d vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face \x3d getFace( direction );\n\t\tfloat filterInt \x3d max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt \x3d max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize \x3d exp2( mipInt );\n\t\thighp vec2 uv \x3d getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face \x3e 2.0 ) {\n\t\t\tuv.y +\x3d faceSize;\n\t\t\tface -\x3d 3.0;\n\t\t}\n\t\tuv.x +\x3d face * faceSize;\n\t\tuv.x +\x3d filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y +\x3d 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *\x3d CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *\x3d CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip \x3d 0.0;\n\t\tif ( roughness \x3e\x3d cubeUV_r1 ) {\n\t\t\tmip \x3d ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r4 ) {\n\t\t\tmip \x3d ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r5 ) {\n\t\t\tmip \x3d ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness \x3e\x3d cubeUV_r6 ) {\n\t\t\tmip \x3d ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip \x3d - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip \x3d clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF \x3d fract( mip );\n\t\tfloat mipInt \x3d floor( mip );\n\t\tvec3 color0 \x3d bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF \x3d\x3d 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 \x3d bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",
defaultnormal_vertex:"vec3 transformedNormal \x3d objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent \x3d objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm \x3d mat3( batchingMatrix );\n\ttransformedNormal /\x3d vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal \x3d bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent \x3d bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im \x3d mat3( instanceMatrix );\n\ttransformedNormal /\x3d vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal \x3d im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent \x3d im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal \x3d normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal \x3d - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent \x3d ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent \x3d - transformedTangent;\n\t#endif\n#endif",
displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed +\x3d normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor \x3d texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor \x3d sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *\x3d emissiveColor.rgb;\n#endif",
emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor \x3d linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag \x3d normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec \x3d reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec \x3d refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec \x3d vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor \x3d textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor \x3d vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight \x3d mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight \x3d mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight +\x3d envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec \x3d reflect( - viewDir, normal );\n\t\t\treflectVec \x3d normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec \x3d inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor \x3d textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal \x3d cross( bitangent, viewDir );\n\t\t\t\tbentNormal \x3d normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal \x3d normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition \x3d worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex \x3d normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex \x3d normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect \x3d reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect \x3d refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
fog_vertex:"#ifdef USE_FOG\n\tvFogDepth \x3d - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor \x3d 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor \x3d smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb \x3d mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL \x3d dot( normal, lightDirection );\n\tvec2 coord \x3d vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw \x3d fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",
lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\nmaterial.specularStrength \x3d specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",
lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x \x3d normal.x, y \x3d normal.y, z \x3d normal.z;\n\tvec3 result \x3d shCoefficients[ 0 ] * 0.886227;\n\tresult +\x3d shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult +\x3d shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult +\x3d shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult +\x3d shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult +\x3d shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult +\x3d shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult +\x3d shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult +\x3d shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal \x3d inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance \x3d shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance \x3d ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff \x3d 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance \x3e 0.0 ) {\n\t\tdistanceFalloff *\x3d pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS \x3e 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color \x3d directionalLight.color;\n\t\tlight.direction \x3d directionalLight.direction;\n\t\tlight.visible \x3d true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS \x3e 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector \x3d pointLight.position - geometryPosition;\n\t\tlight.direction \x3d normalize( lVector );\n\t\tfloat lightDistance \x3d length( lVector );\n\t\tlight.color \x3d pointLight.color;\n\t\tlight.color *\x3d getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible \x3d ( light.color !\x3d vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS \x3e 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector \x3d spotLight.position - geometryPosition;\n\t\tlight.direction \x3d normalize( lVector );\n\t\tfloat angleCos \x3d dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation \x3d getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation \x3e 0.0 ) {\n\t\t\tfloat lightDistance \x3d length( lVector );\n\t\t\tlight.color \x3d spotLight.color * spotAttenuation;\n\t\t\tlight.color *\x3d getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible \x3d ( light.color !\x3d vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color \x3d vec3( 0.0 );\n\t\t\tlight.visible \x3d false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS \x3e 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL \x3d dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight \x3d 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance \x3d mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",
lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance \x3d getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb;\nmaterial.specularColor \x3d specular;\nmaterial.specularShininess \x3d shininess;\nmaterial.specularStrength \x3d specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular +\x3d irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor \x3d diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy \x3d max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness \x3d max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness \x3d max( roughnessFactor, 0.0525 );material.roughness +\x3d geometryRoughness;\nmaterial.roughness \x3d min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior \x3d ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor \x3d specularIntensity;\n\t\tvec3 specularColorFactor \x3d specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *\x3d texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *\x3d texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 \x3d mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor \x3d 1.0;\n\t\tvec3 specularColorFactor \x3d vec3( 1.0 );\n\t\tmaterial.specularF90 \x3d 1.0;\n\t#endif\n\tmaterial.specularColor \x3d mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor \x3d mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 \x3d 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat \x3d clearcoat;\n\tmaterial.clearcoatRoughness \x3d clearcoatRoughness;\n\tmaterial.clearcoatF0 \x3d vec3( 0.04 );\n\tmaterial.clearcoatF90 \x3d 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *\x3d texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *\x3d texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat \x3d saturate( material.clearcoat );\tmaterial.clearcoatRoughness \x3d max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness +\x3d geometryRoughness;\n\tmaterial.clearcoatRoughness \x3d min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion \x3d dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence \x3d iridescence;\n\tmaterial.iridescenceIOR \x3d iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *\x3d texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness \x3d (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness \x3d iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor \x3d sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *\x3d texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness \x3d clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *\x3d texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat \x3d mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar \x3d texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV \x3d anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV \x3d anisotropyVector;\n\t#endif\n\tmaterial.anisotropy \x3d length( anisotropyV );\n\tif( material.anisotropy \x3d\x3d 0.0 ) {\n\t\tanisotropyV \x3d vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /\x3d material.anisotropy;\n\t\tmaterial.anisotropy \x3d saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT \x3d mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT \x3d tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB \x3d tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect \x3d vec3( 0.0 );\nvec3 clearcoatSpecularIndirect \x3d vec3( 0.0 );\nvec3 sheenSpecularDirect \x3d vec3( 0.0 );\nvec3 sheenSpecularIndirect \x3d vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x \x3d clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 \x3d x * x;\n    float x5 \x3d clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 \x3d pow2( alpha );\n\tfloat gv \x3d dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl \x3d dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 \x3d pow2( alpha );\n\tfloat denom \x3d pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv \x3d dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl \x3d dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v \x3d 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 \x3d alphaT * alphaB;\n\t\thighp vec3 v \x3d vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 \x3d dot( v, v );\n\t\tfloat w2 \x3d a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 \x3d material.clearcoatF0;\n\t\tfloat f90 \x3d material.clearcoatF90;\n\t\tfloat roughness \x3d material.clearcoatRoughness;\n\t\tfloat alpha \x3d pow2( roughness );\n\t\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\t\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F \x3d F_Schlick( f0, f90, dotVH );\n\t\tfloat V \x3d V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D \x3d D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 \x3d material.specularColor;\n\tfloat f90 \x3d material.specularF90;\n\tfloat roughness \x3d material.roughness;\n\tfloat alpha \x3d pow2( roughness );\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat dotVH \x3d saturate( dot( viewDir, halfDir ) );\n\tvec3 F \x3d F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF \x3d mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL \x3d dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV \x3d dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH \x3d dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL \x3d dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV \x3d dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH \x3d dot( material.anisotropyB, halfDir );\n\t\tfloat V \x3d V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D \x3d D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V \x3d V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D \x3d D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE \x3d 64.0;\n\tconst float LUT_SCALE \x3d ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS \x3d 0.5 / LUT_SIZE;\n\tfloat dotNV \x3d saturate( dot( N, V ) );\n\tvec2 uv \x3d vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv \x3d uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l \x3d length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x \x3d dot( v1, v2 );\n\tfloat y \x3d abs( x );\n\tfloat a \x3d 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b \x3d 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v \x3d a / b;\n\tfloat theta_sintheta \x3d ( x \x3e 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 \x3d rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 \x3d rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal \x3d cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) \x3c 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 \x3d normalize( V - N * dot( V, N ) );\n\tT2 \x3d - cross( N, T1 );\n\tmat3 mat \x3d mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] \x3d mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] \x3d mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] \x3d mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] \x3d mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] \x3d normalize( coords[ 0 ] );\n\tcoords[ 1 ] \x3d normalize( coords[ 1 ] );\n\tcoords[ 2 ] \x3d normalize( coords[ 2 ] );\n\tcoords[ 3 ] \x3d normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor \x3d vec3( 0.0 );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor +\x3d LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result \x3d LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha \x3d pow2( roughness );\n\tfloat invAlpha \x3d 1.0 / alpha;\n\tfloat cos2h \x3d dotNH * dotNH;\n\tfloat sin2h \x3d max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir \x3d normalize( lightDir + viewDir );\n\tfloat dotNL \x3d saturate( dot( normal, lightDir ) );\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat dotNH \x3d saturate( dot( normal, halfDir ) );\n\tfloat D \x3d D_Charlie( sheenRoughness, dotNH );\n\tfloat V \x3d V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tfloat r2 \x3d roughness * roughness;\n\tfloat a \x3d roughness \x3c 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b \x3d roughness \x3c 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG \x3d exp( a * dotNV + b ) + ( roughness \x3c 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV \x3d saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 \x3d vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 \x3d vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r \x3d roughness * c0 + c1;\n\tfloat a004 \x3d min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab \x3d vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab \x3d DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab \x3d DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr \x3d mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr \x3d specularColor;\n\t#endif\n\tvec3 FssEss \x3d Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess \x3d fab.x + fab.y;\n\tfloat Ems \x3d 1.0 - Ess;\n\tvec3 Favg \x3d Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms \x3d FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter +\x3d FssEss;\n\tmultiScatter +\x3d Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS \x3e 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal \x3d geometryNormal;\n\t\tvec3 viewDir \x3d geometryViewDir;\n\t\tvec3 position \x3d geometryPosition;\n\t\tvec3 lightPos \x3d rectAreaLight.position;\n\t\tvec3 halfWidth \x3d rectAreaLight.halfWidth;\n\t\tvec3 halfHeight \x3d rectAreaLight.halfHeight;\n\t\tvec3 lightColor \x3d rectAreaLight.color;\n\t\tfloat roughness \x3d material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] \x3d lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] \x3d lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] \x3d lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] \x3d lightPos + halfWidth + halfHeight;\n\t\tvec2 uv \x3d LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 \x3d texture2D( ltc_1, uv );\n\t\tvec4 t2 \x3d texture2D( ltc_2, uv );\n\t\tmat3 mInv \x3d mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel \x3d ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular +\x3d lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse +\x3d lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL \x3d saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance \x3d dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc \x3d saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance \x3d dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect +\x3d ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect +\x3d irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular +\x3d irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse +\x3d irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect +\x3d clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect +\x3d irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering \x3d vec3( 0.0 );\n\tvec3 multiScattering \x3d vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance \x3d irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering \x3d singleScattering + multiScattering;\n\tvec3 diffuse \x3d material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular +\x3d radiance * singleScattering;\n\treflectedLight.indirectSpecular +\x3d multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse +\x3d diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
lights_fragment_begin:"\nvec3 geometryPosition \x3d - vViewPosition;\nvec3 geometryNormal \x3d normal;\nvec3 geometryViewDir \x3d ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal \x3d vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal \x3d clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi \x3d saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness \x3d\x3d 0.0 ) {\n\t\tmaterial.iridescence \x3d 0.0;\n\t} else {\n\t\tmaterial.iridescence \x3d saturate( material.iridescence );\n\t}\n\tif ( material.iridescence \x3e 0.0 ) {\n\t\tmaterial.iridescenceFresnel \x3d evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 \x3d Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_POINT_LIGHT_SHADOWS \x3e 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight \x3d pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow \x3d pointLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight \x3d spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX \x3c NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord \x3d vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap \x3d all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor \x3d texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color \x3d inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow \x3d spotLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) \x26\x26 NUM_DIR_LIGHT_SHADOWS \x3e 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight \x3d directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) \x26\x26 ( UNROLLED_LOOP_INDEX \x3c NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow \x3d directionalLightShadows[ i ];\n\t\tdirectLight.color *\x3d ( directLight.visible \x26\x26 receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS \x3e 0 ) \x26\x26 defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight \x3d rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance \x3d vec3( 0.0 );\n\tvec3 irradiance \x3d getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance +\x3d getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS \x3e 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance +\x3d getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance \x3d vec3( 0.0 );\n\tvec3 clearcoatRadiance \x3d vec3( 0.0 );\n#endif",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel \x3d texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance \x3d lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance +\x3d lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) \x26\x26 defined( STANDARD ) \x26\x26 defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance +\x3d getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) \x26\x26 defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance +\x3d getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance +\x3d getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance +\x3d getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth \x3d vIsPerspective \x3d\x3d 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",
logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth \x3d 1.0 + gl_Position.w;\n\tvIsPerspective \x3d float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor \x3d texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor \x3d sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *\x3d sampledDiffuseColor;\n#endif",
map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv \x3d vUv;\n\t#else\n\t\tvec2 uv \x3d ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *\x3d texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *\x3d texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",
metalnessmap_fragment:"float metalnessFactor \x3d metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness \x3d texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *\x3d texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence \x3d texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] \x3d  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",
morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *\x3d morphTargetBaseInfluence;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) vColor +\x3d getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) vColor +\x3d getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *\x3d morphTargetBaseInfluence;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) objectNormal +\x3d getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",
morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex \x3d vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y \x3d texelIndex / morphTargetsTextureSize.x;\n\t\tint x \x3d texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV \x3d ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *\x3d morphTargetBaseInfluence;\n\tfor ( int i \x3d 0; i \x3c MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] !\x3d 0.0 ) transformed +\x3d getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection \x3d gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx \x3d dFdx( vViewPosition );\n\tvec3 fdy \x3d dFdy( vViewPosition );\n\tvec3 normal \x3d normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal \x3d normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *\x3d faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn \x3d mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn \x3d getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) \x26\x26 ! defined( FLAT_SHADED )\n\t\ttbn[0] *\x3d faceDirection;\n\t\ttbn[1] *\x3d faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 \x3d mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 \x3d getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) \x26\x26 ! defined( FLAT_SHADED )\n\t\ttbn2[0] *\x3d faceDirection;\n\t\ttbn2[1] *\x3d faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal \x3d normal;",
normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal \x3d texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal \x3d - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal \x3d normal * faceDirection;\n\t#endif\n\tnormal \x3d normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN \x3d texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *\x3d normalScale;\n\tnormal \x3d normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal \x3d perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",
normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal \x3d normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent \x3d normalize( transformedTangent );\n\t\tvBitangent \x3d normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) \x26\x26 ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 \x3d dFdx( eye_pos.xyz );\n\t\tvec3 q1 \x3d dFdy( eye_pos.xyz );\n\t\tvec2 st0 \x3d dFdx( uv.st );\n\t\tvec2 st1 \x3d dFdy( uv.st );\n\t\tvec3 N \x3d surf_norm;\n\t\tvec3 q1perp \x3d cross( q1, N );\n\t\tvec3 q0perp \x3d cross( N, q0 );\n\t\tvec3 T \x3d q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B \x3d q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det \x3d max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale \x3d ( det \x3d\x3d 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",
clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal \x3d nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN \x3d texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *\x3d clearcoatNormalScale;\n\tclearcoatNormal \x3d normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",
iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a \x3d 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *\x3d material.transmissionAlpha;\n#endif\ngl_FragColor \x3d vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale \x3d 256. / 255.;const float UnpackDownscale \x3d 255. / 256.;const float ShiftRight8 \x3d 1. / 256.;\nconst float Inv255 \x3d 1. / 255.;\nconst vec4 PackFactors \x3d vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 \x3d vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 \x3d vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 \x3d vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v \x3c\x3d 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v \x3e\x3d 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af \x3d modf( v * PackFactors.a, vuf );\n\tfloat bf \x3d modf( vuf * ShiftRight8, vuf );\n\tfloat gf \x3d modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v \x3c\x3d 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v \x3e\x3d 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf \x3d modf( v * PackFactors.b, vuf );\n\tfloat gf \x3d modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v \x3c\x3d 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v \x3e\x3d 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf \x3d modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r \x3d vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *\x3d gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition \x3d vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition \x3d batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition \x3d instanceMatrix * mvPosition;\n#endif\nmvPosition \x3d modelViewMatrix * mvPosition;\ngl_Position \x3d projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb \x3d dithering( gl_FragColor.rgb );\n#endif",
dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position \x3d rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB \x3d vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB \x3d mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor \x3d roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness \x3d texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *\x3d texelRoughness.g;\n#endif",
roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS \x3e 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\tfloat depth \x3d unpackRGBAToDepth( texture2D( depths, uv ) );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\treturn step( depth, compare );\n\t\t#else\n\t\t\treturn step( compare, depth );\n\t\t#endif\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow( sampler2D shadow, vec2 uv, float compare ) {\n\t\tfloat occlusion \x3d 1.0;\n\t\tvec2 distribution \x3d texture2DDistribution( shadow, uv );\n\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\tfloat hard_shadow \x3d step( distribution.x, compare );\n\t\t#else\n\t\t\tfloat hard_shadow \x3d step( compare, distribution.x );\n\t\t#endif\n\t\tif ( hard_shadow !\x3d 1.0 ) {\n\t\t\tfloat distance \x3d compare - distribution.x;\n\t\t\tfloat variance \x3d max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability \x3d variance / (variance + distance * distance );\t\t\tsoftness_probability \x3d clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion \x3d clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow \x3d 1.0;\n\t\tshadowCoord.xyz /\x3d shadowCoord.w;\n\t\tshadowCoord.z +\x3d shadowBias;\n\t\tbool inFrustum \x3d shadowCoord.x \x3e\x3d 0.0 \x26\x26 shadowCoord.x \x3c\x3d 1.0 \x26\x26 shadowCoord.y \x3e\x3d 0.0 \x26\x26 shadowCoord.y \x3c\x3d 1.0;\n\t\tbool frustumTest \x3d inFrustum \x26\x26 shadowCoord.z \x3c\x3d 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 \x3d - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 \x3d - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 \x3d + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 \x3d + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 \x3d dx0 / 2.0;\n\t\t\tfloat dy2 \x3d dy0 / 2.0;\n\t\t\tfloat dx3 \x3d dx1 / 2.0;\n\t\t\tfloat dy3 \x3d dy1 / 2.0;\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx \x3d texelSize.x;\n\t\t\tfloat dy \x3d texelSize.y;\n\t\t\tvec2 uv \x3d shadowCoord.xy;\n\t\t\tvec2 f \x3d fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -\x3d f * texelSize;\n\t\t\tshadow \x3d (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow \x3d VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow \x3d texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV \x3d abs( v );\n\t\tfloat scaleToCube \x3d 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *\x3d scaleToCube;\n\t\tv *\x3d scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar \x3d v.xy;\n\t\tfloat almostATexel \x3d 1.5 * texelSizeY;\n\t\tfloat almostOne \x3d 1.0 - almostATexel;\n\t\tif ( absV.z \x3e\x3d almostOne ) {\n\t\t\tif ( v.z \x3e 0.0 )\n\t\t\t\tplanar.x \x3d 4.0 - v.x;\n\t\t} else if ( absV.x \x3e\x3d almostOne ) {\n\t\t\tfloat signX \x3d sign( v.x );\n\t\t\tplanar.x \x3d v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y \x3e\x3d almostOne ) {\n\t\t\tfloat signY \x3d sign( v.y );\n\t\t\tplanar.x \x3d v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y \x3d v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow \x3d 1.0;\n\t\tvec3 lightToPosition \x3d shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength \x3d length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar \x3c\x3d 0.0 \x26\x26 lightToPositionLength - shadowCameraNear \x3e\x3d 0.0 ) {\n\t\t\tfloat dp \x3d ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp +\x3d shadowBias;\n\t\t\tvec3 bd3D \x3d normalize( lightToPosition );\n\t\t\tvec2 texelSize \x3d vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset \x3d vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow \x3d (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow \x3d texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",
shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",
shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) \x26\x26 ( NUM_DIR_LIGHT_SHADOWS \x3e 0 || NUM_POINT_LIGHT_SHADOWS \x3e 0 ) ) || ( NUM_SPOT_LIGHT_COORDS \x3e 0 )\n\tvec3 shadowWorldNormal \x3d inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] \x3d directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition \x3d worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] \x3d pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS \x3e 0\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition \x3d worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) \x26\x26 UNROLLED_LOOP_INDEX \x3c NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz +\x3d shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] \x3d spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow \x3d 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS \x3e 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight \x3d directionalLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS \x3e 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight \x3d spotLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS \x3e 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i \x3d 0; i \x3c NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight \x3d pointLightShadows[ i ];\n\t\tshadow *\x3d receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX \x3d getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY \x3d getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ \x3d getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW \x3d getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size \x3d textureSize( boneTexture, 0 ).x;\n\t\tint j \x3d int( i ) * 4;\n\t\tint x \x3d j % size;\n\t\tint y \x3d j / size;\n\t\tvec4 v1 \x3d texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 \x3d texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 \x3d texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 \x3d texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex \x3d bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned \x3d vec4( 0.0 );\n\tskinned +\x3d boneMatX * skinVertex * skinWeight.x;\n\tskinned +\x3d boneMatY * skinVertex * skinWeight.y;\n\tskinned +\x3d boneMatZ * skinVertex * skinWeight.z;\n\tskinned +\x3d boneMatW * skinVertex * skinWeight.w;\n\ttransformed \x3d ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix \x3d mat4( 0.0 );\n\tskinMatrix +\x3d skinWeight.x * boneMatX;\n\tskinMatrix +\x3d skinWeight.y * boneMatY;\n\tskinMatrix +\x3d skinWeight.z * boneMatZ;\n\tskinMatrix +\x3d skinWeight.w * boneMatW;\n\tskinMatrix \x3d bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal \x3d vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent \x3d vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular \x3d texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength \x3d texelSpecular.r;\n#else\n\tspecularStrength \x3d 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb \x3d toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *\x3d toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *\x3d toneMappingExposure;\n\tcolor \x3d max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a \x3d v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b \x3d v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat \x3d mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat \x3d mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *\x3d toneMappingExposure / 0.6;\n\tcolor \x3d ACESInputMat * color;\n\tcolor \x3d RRTAndODTFit( color );\n\tcolor \x3d ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB \x3d mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 \x3d mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 \x3d x * x;\n\tvec3 x4 \x3d x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix \x3d mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix \x3d mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv \x3d - 12.47393;\tconst float AgxMaxEv \x3d 4.026069;\n\tcolor *\x3d toneMappingExposure;\n\tcolor \x3d LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor \x3d AgXInsetMatrix * color;\n\tcolor \x3d max( color, 1e-10 );\tcolor \x3d log2( color );\n\tcolor \x3d ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor \x3d clamp( color, 0.0, 1.0 );\n\tcolor \x3d agxDefaultContrastApprox( color );\n\tcolor \x3d AgXOutsetMatrix * color;\n\tcolor \x3d pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor \x3d LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor \x3d clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression \x3d 0.8 - 0.04;\n\tconst float Desaturation \x3d 0.15;\n\tcolor *\x3d toneMappingExposure;\n\tfloat x \x3d min( color.r, min( color.g, color.b ) );\n\tfloat offset \x3d x \x3c 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -\x3d offset;\n\tfloat peak \x3d max( color.r, max( color.g, color.b ) );\n\tif ( peak \x3c StartCompression ) return color;\n\tfloat d \x3d 1. - StartCompression;\n\tfloat newPeak \x3d 1. - d * d / ( peak + d - StartCompression );\n\tcolor *\x3d newPeak / peak;\n\tfloat g \x3d 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",
transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission \x3d transmission;\n\tmaterial.transmissionAlpha \x3d 1.0;\n\tmaterial.thickness \x3d thickness;\n\tmaterial.attenuationDistance \x3d attenuationDistance;\n\tmaterial.attenuationColor \x3d attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *\x3d texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *\x3d texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos \x3d vWorldPosition;\n\tvec3 v \x3d normalize( cameraPosition - pos );\n\tvec3 n \x3d inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted \x3d getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha \x3d mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse \x3d mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",
transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv \x3d uv * texelSize.zw + 0.5;\n\t\tvec2 iuv \x3d floor( uv );\n\t\tvec2 fuv \x3d fract( uv );\n\t\tfloat g0x \x3d g0( fuv.x );\n\t\tfloat g1x \x3d g1( fuv.x );\n\t\tfloat h0x \x3d h0( fuv.x );\n\t\tfloat h1x \x3d h1( fuv.x );\n\t\tfloat h0y \x3d h0( fuv.y );\n\t\tfloat h1y \x3d h1( fuv.y );\n\t\tvec2 p0 \x3d ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 \x3d ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 \x3d ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 \x3d ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize \x3d vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize \x3d vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv \x3d 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv \x3d 1.0 / cLodSize;\n\t\tvec4 fSample \x3d bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample \x3d bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector \x3d refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x \x3d length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y \x3d length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z \x3d length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod \x3d log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient \x3d -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance \x3d exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread \x3d ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors \x3d vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i \x3d 0; i \x3c 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay \x3d getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit \x3d position + transmissionRay;\n\t\t\t\tvec4 ndcPos \x3d projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords \x3d ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords +\x3d 1.0;\n\t\t\t\trefractionCoords /\x3d 2.0;\n\t\t\t\tvec4 transmissionSample \x3d getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] \x3d transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a +\x3d transmissionSample.a;\n\t\t\t\ttransmittance[ i ] \x3d diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /\x3d 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay \x3d getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit \x3d position + transmissionRay;\n\t\t\tvec4 ndcPos \x3d projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords \x3d ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords +\x3d 1.0;\n\t\t\trefractionCoords /\x3d 2.0;\n\t\t\ttransmittedLight \x3d getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance \x3d diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor \x3d transmittance * transmittedLight.rgb;\n\t\tvec3 F \x3d EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor \x3d ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",
uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",
uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",
uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv \x3d vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv \x3d ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv \x3d ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv \x3d ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv \x3d ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv \x3d ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv \x3d ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv \x3d ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv \x3d ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv \x3d ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv \x3d ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv \x3d ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv \x3d ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv \x3d ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv \x3d ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv \x3d ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv \x3d ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv \x3d ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv \x3d ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv \x3d ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv \x3d ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv \x3d ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv \x3d ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv \x3d ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",
worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS \x3e 0\n\tvec4 worldPosition \x3d vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition \x3d batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition \x3d instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition \x3d modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position \x3d vec4( position.xy, 1.0, 1.0 );\n}",
background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor \x3d texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor \x3d vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *\x3d backgroundIntensity;\n\tgl_FragColor \x3d texColor;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
backgroundCube_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_Position.z \x3d gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include \x3ccube_uv_reflection_fragment\x3e\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor \x3d textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor \x3d textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *\x3d backgroundIntensity;\n\tgl_FragColor \x3d texColor;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
cube_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_Position.z \x3d gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor \x3d textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor \x3d texColor;\n\tgl_FragColor.a *\x3d opacity;\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
depth_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvHighPrecisionZW \x3d gl_Position.zw;\n}",
depth_frag:"#if DEPTH_PACKING \x3d\x3d 3200\n\tuniform float opacity;\n#endif\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\t\tdiffuseColor.a \x3d opacity;\n\t#endif\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ \x3d vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ \x3d 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING \x3d\x3d 3200\n\t\tgl_FragColor \x3d vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING \x3d\x3d 3201\n\t\tgl_FragColor \x3d packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING \x3d\x3d 3202\n\t\tgl_FragColor \x3d vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING \x3d\x3d 3203\n\t\tgl_FragColor \x3d vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvWorldPosition \x3d worldPosition.xyz;\n}",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main () {\n\tvec4 diffuseColor \x3d vec4( 1.0 );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\tfloat dist \x3d length( vWorldPosition - referencePosition );\n\tdist \x3d ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist \x3d saturate( dist );\n\tgl_FragColor \x3d packDepthToRGBA( dist );\n}",
equirect_vert:"varying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvWorldDirection \x3d transformDirection( position, modelMatrix );\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include \x3ccommon\x3e\nvoid main() {\n\tvec3 direction \x3d normalize( vWorldDirection );\n\tvec2 sampleUV \x3d equirectUv( direction );\n\tgl_FragColor \x3d texture2D( tEquirect, sampleUV );\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n}",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\tvLineDistance \x3d scale * lineDistance;\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tif ( mod( vLineDistance, totalSize ) \x3e dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n}",
meshbasic_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include \x3cbeginnormal_vertex\x3e\n\t\t#include \x3cmorphnormal_vertex\x3e\n\t\t#include \x3cskinbase_vertex\x3e\n\t\t#include \x3cskinnormal_vertex\x3e\n\t\t#include \x3cdefaultnormal_vertex\x3e\n\t#endif\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel \x3d texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse +\x3d lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse +\x3d vec3( 1.0 );\n\t#endif\n\t#include \x3caomap_fragment\x3e\n\treflectedLight.indirectDiffuse *\x3d diffuseColor.rgb;\n\tvec3 outgoingLight \x3d reflectedLight.indirectDiffuse;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_lambert_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_lambert_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n}",
meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\tvec3 viewDir \x3d normalize( vViewPosition );\n\tvec3 x \x3d normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y \x3d cross( viewDir, x );\n\tvec2 uv \x3d vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor \x3d texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor \x3d vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight \x3d diffuseColor.rgb * matcapColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition \x3d - mvPosition.xyz;\n#endif\n}",
meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include \x3cpacking\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( 0.0, 0.0, 0.0, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\tgl_FragColor \x3d vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a \x3d 1.0;\n\t#endif\n}",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3cenvmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cenvmap_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_phong_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cspecularmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cspecularmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_phong_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include \x3cenvmap_fragment\x3e\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n#ifdef USE_TRANSMISSION\n\tvWorldPosition \x3d worldPosition.xyz;\n#endif\n}",
meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3ciridescence_fragment\x3e\n#include \x3ccube_uv_reflection_fragment\x3e\n#include \x3cenvmap_common_pars_fragment\x3e\n#include \x3cenvmap_physical_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_physical_pars_fragment\x3e\n#include \x3ctransmission_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3cclearcoat_pars_fragment\x3e\n#include \x3ciridescence_pars_fragment\x3e\n#include \x3croughnessmap_pars_fragment\x3e\n#include \x3cmetalnessmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3croughnessmap_fragment\x3e\n\t#include \x3cmetalnessmap_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cclearcoat_normal_fragment_begin\x3e\n\t#include \x3cclearcoat_normal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_physical_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 totalDiffuse \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular \x3d reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include \x3ctransmission_fragment\x3e\n\tvec3 outgoingLight \x3d totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp \x3d 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight \x3d outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc \x3d saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc \x3d F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight \x3d outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cdisplacementmap_pars_vertex\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cnormal_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cdisplacementmap_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\tvViewPosition \x3d - mvPosition.xyz;\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cdithering_pars_fragment\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3caomap_pars_fragment\x3e\n#include \x3clightmap_pars_fragment\x3e\n#include \x3cemissivemap_pars_fragment\x3e\n#include \x3cgradientmap_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3cnormal_pars_fragment\x3e\n#include \x3clights_toon_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cbumpmap_pars_fragment\x3e\n#include \x3cnormalmap_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tReflectedLight reflectedLight \x3d ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance \x3d emissive;\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\t#include \x3cnormal_fragment_begin\x3e\n\t#include \x3cnormal_fragment_maps\x3e\n\t#include \x3cemissivemap_fragment\x3e\n\t#include \x3clights_toon_fragment\x3e\n\t#include \x3clights_fragment_begin\x3e\n\t#include \x3clights_fragment_maps\x3e\n\t#include \x3clights_fragment_end\x3e\n\t#include \x3caomap_fragment\x3e\n\tvec3 outgoingLight \x3d reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n\t#include \x3cdithering_fragment\x3e\n}",
points_vert:"uniform float size;\nuniform float scale;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv \x3d ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include \x3ccolor_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphcolor_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\tgl_PointSize \x3d size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *\x3d ( scale / - mvPosition.z );\n\t#endif\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3ccolor_pars_fragment\x3e\n#include \x3cmap_particle_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_particle_fragment\x3e\n\t#include \x3ccolor_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n\t#include \x3cpremultiplied_alpha_fragment\x3e\n}",
shadow_vert:"#include \x3ccommon\x3e\n#include \x3cbatching_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3cmorphtarget_pars_vertex\x3e\n#include \x3cskinning_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cshadowmap_pars_vertex\x3e\nvoid main() {\n\t#include \x3cbatching_vertex\x3e\n\t#include \x3cbeginnormal_vertex\x3e\n\t#include \x3cmorphinstance_vertex\x3e\n\t#include \x3cmorphnormal_vertex\x3e\n\t#include \x3cskinbase_vertex\x3e\n\t#include \x3cskinnormal_vertex\x3e\n\t#include \x3cdefaultnormal_vertex\x3e\n\t#include \x3cbegin_vertex\x3e\n\t#include \x3cmorphtarget_vertex\x3e\n\t#include \x3cskinning_vertex\x3e\n\t#include \x3cproject_vertex\x3e\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cworldpos_vertex\x3e\n\t#include \x3cshadowmap_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cpacking\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3cbsdfs\x3e\n#include \x3clights_pars_begin\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cshadowmap_pars_fragment\x3e\n#include \x3cshadowmask_pars_fragment\x3e\nvoid main() {\n\t#include \x3clogdepthbuf_fragment\x3e\n\tgl_FragColor \x3d vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n}",
sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_vertex\x3e\n#include \x3cfog_pars_vertex\x3e\n#include \x3clogdepthbuf_pars_vertex\x3e\n#include \x3cclipping_planes_pars_vertex\x3e\nvoid main() {\n\t#include \x3cuv_vertex\x3e\n\tvec4 mvPosition \x3d modelViewMatrix[ 3 ];\n\tvec2 scale \x3d vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective \x3d isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *\x3d - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition \x3d ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x \x3d cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y \x3d sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy +\x3d rotatedPosition;\n\tgl_Position \x3d projectionMatrix * mvPosition;\n\t#include \x3clogdepthbuf_vertex\x3e\n\t#include \x3cclipping_planes_vertex\x3e\n\t#include \x3cfog_vertex\x3e\n}",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include \x3ccommon\x3e\n#include \x3cuv_pars_fragment\x3e\n#include \x3cmap_pars_fragment\x3e\n#include \x3calphamap_pars_fragment\x3e\n#include \x3calphatest_pars_fragment\x3e\n#include \x3calphahash_pars_fragment\x3e\n#include \x3cfog_pars_fragment\x3e\n#include \x3clogdepthbuf_pars_fragment\x3e\n#include \x3cclipping_planes_pars_fragment\x3e\nvoid main() {\n\tvec4 diffuseColor \x3d vec4( diffuse, opacity );\n\t#include \x3cclipping_planes_fragment\x3e\n\tvec3 outgoingLight \x3d vec3( 0.0 );\n\t#include \x3clogdepthbuf_fragment\x3e\n\t#include \x3cmap_fragment\x3e\n\t#include \x3calphamap_fragment\x3e\n\t#include \x3calphatest_fragment\x3e\n\t#include \x3calphahash_fragment\x3e\n\toutgoingLight \x3d diffuseColor.rgb;\n\t#include \x3copaque_fragment\x3e\n\t#include \x3ctonemapping_fragment\x3e\n\t#include \x3ccolorspace_fragment\x3e\n\t#include \x3cfog_fragment\x3e\n}"},
mb={common:{diffuse:{value:new pb(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Lb},alphaMap:{value:null},alphaMapTransform:{value:new Lb},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Lb}},envmap:{envMap:{value:null},envMapRotation:{value:new Lb},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Lb}},lightmap:{lightMap:{value:null},
lightMapIntensity:{value:1},lightMapTransform:{value:new Lb}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Lb},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Lb},normalScale:{value:new Xa(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Lb},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Lb}},metalnessmap:{metalnessMap:{value:null},
metalnessMapTransform:{value:new Lb}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Lb}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new pb(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},
directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,
shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pb(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Lb},
alphaTest:{value:0},uvTransform:{value:new Lb}},sprite:{diffuse:{value:new pb(16777215)},opacity:{value:1},center:{value:new Xa(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Lb},alphaMap:{value:null},alphaMapTransform:{value:new Lb},alphaTest:{value:0}}},Kd={basic:{uniforms:W([mb.common,mb.specularmap,mb.envmap,mb.aomap,mb.lightmap,mb.fog]),vertexShader:Ub.meshbasic_vert,fragmentShader:Ub.meshbasic_frag},lambert:{uniforms:W([mb.common,mb.specularmap,mb.envmap,mb.aomap,mb.lightmap,
mb.emissivemap,mb.bumpmap,mb.normalmap,mb.displacementmap,mb.fog,mb.lights,{emissive:{value:new pb(0)}}]),vertexShader:Ub.meshlambert_vert,fragmentShader:Ub.meshlambert_frag},phong:{uniforms:W([mb.common,mb.specularmap,mb.envmap,mb.aomap,mb.lightmap,mb.emissivemap,mb.bumpmap,mb.normalmap,mb.displacementmap,mb.fog,mb.lights,{emissive:{value:new pb(0)},specular:{value:new pb(1118481)},shininess:{value:30}}]),vertexShader:Ub.meshphong_vert,fragmentShader:Ub.meshphong_frag},standard:{uniforms:W([mb.common,
mb.envmap,mb.aomap,mb.lightmap,mb.emissivemap,mb.bumpmap,mb.normalmap,mb.displacementmap,mb.roughnessmap,mb.metalnessmap,mb.fog,mb.lights,{emissive:{value:new pb(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ub.meshphysical_vert,fragmentShader:Ub.meshphysical_frag},toon:{uniforms:W([mb.common,mb.aomap,mb.lightmap,mb.emissivemap,mb.bumpmap,mb.normalmap,mb.displacementmap,mb.gradientmap,mb.fog,mb.lights,{emissive:{value:new pb(0)}}]),vertexShader:Ub.meshtoon_vert,
fragmentShader:Ub.meshtoon_frag},matcap:{uniforms:W([mb.common,mb.bumpmap,mb.normalmap,mb.displacementmap,mb.fog,{matcap:{value:null}}]),vertexShader:Ub.meshmatcap_vert,fragmentShader:Ub.meshmatcap_frag},points:{uniforms:W([mb.points,mb.fog]),vertexShader:Ub.points_vert,fragmentShader:Ub.points_frag},dashed:{uniforms:W([mb.common,mb.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ub.linedashed_vert,fragmentShader:Ub.linedashed_frag},depth:{uniforms:W([mb.common,mb.displacementmap]),
vertexShader:Ub.depth_vert,fragmentShader:Ub.depth_frag},normal:{uniforms:W([mb.common,mb.bumpmap,mb.normalmap,mb.displacementmap,{opacity:{value:1}}]),vertexShader:Ub.meshnormal_vert,fragmentShader:Ub.meshnormal_frag},sprite:{uniforms:W([mb.sprite,mb.fog]),vertexShader:Ub.sprite_vert,fragmentShader:Ub.sprite_frag},background:{uniforms:{uvTransform:{value:new Lb},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ub.background_vert,fragmentShader:Ub.background_frag},backgroundCube:{uniforms:{envMap:{value:null},
flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Lb}},vertexShader:Ub.backgroundCube_vert,fragmentShader:Ub.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ub.cube_vert,fragmentShader:Ub.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ub.equirect_vert,fragmentShader:Ub.equirect_frag},distanceRGBA:{uniforms:W([mb.common,mb.displacementmap,{referencePosition:{value:new ma},
nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:Ub.distanceRGBA_vert,fragmentShader:Ub.distanceRGBA_frag},shadow:{uniforms:W([mb.lights,mb.fog,{color:{value:new pb(0)},opacity:{value:1}}]),vertexShader:Ub.shadow_vert,fragmentShader:Ub.shadow_frag}};Kd.physical={uniforms:W([Kd.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Lb},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Lb},clearcoatNormalScale:{value:new Xa(1,
1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Lb},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Lb},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Lb},sheen:{value:0},sheenColor:{value:new pb(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Lb},
sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Lb},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Lb},transmissionSamplerSize:{value:new Xa},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Lb},attenuationDistance:{value:0},attenuationColor:{value:new pb(0)},specularColor:{value:new pb(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Lb},
specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Lb},anisotropyVector:{value:new Xa},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Lb}}]),vertexShader:Ub.meshphysical_vert,fragmentShader:Ub.meshphysical_frag};const Wg={r:0,b:0,g:0},yd=new Cd,om=new Gb,hm=[.125,.215,.35,.446,.526,.582],Qj=new Qh,im=new pb;let Rj=null,Sj=0,Tj=0,Uj=!1;const mf=(1+Math.sqrt(5))/2,Yf=1/mf,jm=[new ma(-mf,Yf,0),new ma(mf,Yf,0),new ma(-Yf,0,mf),new ma(Yf,
0,mf),new ma(0,mf,-Yf),new ma(0,mf,Yf),new ma(-1,1,-1),new ma(1,1,-1),new ma(-1,1,1),new ma(1,1,1)],mo=new ma;class ci{constructor(a){this._renderer=a;this._pingPongRenderTarget=null;this._cubeSize=this._lodMax=0;this._lodPlanes=[];this._sizeLods=[];this._sigmas=[];this._equirectMaterial=this._cubemapMaterial=this._blurMaterial=null;this._compileMaterial(this._blurMaterial)}fromScene(a,b=0,d=.1,h=100,n={}){const {size:u=256,position:E=mo}=n;Rj=this._renderer.getRenderTarget();Sj=this._renderer.getActiveCubeFace();
Tj=this._renderer.getActiveMipmapLevel();Uj=this._renderer.xr.enabled;this._renderer.xr.enabled=!1;this._setSize(u);n=this._allocateTargets();n.depthBuffer=!0;this._sceneToCubeUV(a,d,h,n,E);b>0&&this._blur(n,0,0,b);this._applyPMREM(n);this._cleanup(n);return n}fromEquirectangular(a,b=null){return this._fromTexture(a,b)}fromCubemap(a,b=null){return this._fromTexture(a,b)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=uc(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===
null&&(this._equirectMaterial=Va(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose();this._cubemapMaterial!==null&&this._cubemapMaterial.dispose();this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(a){this._lodMax=Math.floor(Math.log2(a));this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose();this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let a=0;a<this._lodPlanes.length;a++)this._lodPlanes[a].dispose()}_cleanup(a){this._renderer.setRenderTarget(Rj,
Sj,Tj);this._renderer.xr.enabled=Uj;a.scissorTest=!1;zc(a,0,0,a.width,a.height)}_fromTexture(a,b){a.mapping===301||a.mapping===302?this._setSize(a.image.length===0?16:a.image[0].width||a.image[0].image.width):this._setSize(a.image.width/4);Rj=this._renderer.getRenderTarget();Sj=this._renderer.getActiveCubeFace();Tj=this._renderer.getActiveMipmapLevel();Uj=this._renderer.xr.enabled;this._renderer.xr.enabled=!1;b=b||this._allocateTargets();this._textureToCubeUV(a,b);this._applyPMREM(b);this._cleanup(b);
return b}_allocateTargets(){const a=3*Math.max(this._cubeSize,112),b=4*this._cubeSize;var d={magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,colorSpace:"srgb-linear",depthBuffer:!1};const h=$c(a,b,d);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==a||this._pingPongRenderTarget.height!==b){this._pingPongRenderTarget!==null&&this._dispose();this._pingPongRenderTarget=$c(a,b,d);({_lodMax:d}=this);var n=[],u=[];const M=[];let R=d;const T=d-4+1+hm.length;
for(let X=0;X<T;X++){var E=Math.pow(2,R);u.push(E);var F=1/E;X>d-4?F=hm[X-d+4-1]:X===0&&(F=0);M.push(F);F=1/(E-2);E=-F;F=1+F;var H=[E,E,F,E,F,F,E,E,F,F,E,F];E=new Float32Array(108);F=new Float32Array(72);const ea=new Float32Array(36);for(let aa=0;aa<6;aa++){const da=aa%3*2/3-1,U=aa>2?0:-1;E.set([da,U,0,da+2/3,U,0,da+2/3,U+1,0,da,U,0,da+2/3,U+1,0,da,U+1,0],18*aa);F.set(H,12*aa);ea.set([aa,aa,aa,aa,aa,aa],6*aa)}H=new Vb;H.setAttribute("position",new sc(E,3));H.setAttribute("uv",new sc(F,2));H.setAttribute("faceIndex",
new sc(ea,1));n.push(H);R>4&&R--}({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}={lodPlanes:n,sizeLods:u,sigmas:M});n=new Float32Array(20);u=new ma(0,1,0);this._blurMaterial=new Jd({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/a,CUBEUV_TEXEL_HEIGHT:1/b,CUBEUV_MAX_MIP:`${d}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:u}},vertexShader:Ra(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include \x3ccube_uv_reflection_fragment\x3e\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta \x3d cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection \x3d vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis \x3d latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis \x3d vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis \x3d normalize( axis );\n\n\t\t\t\tgl_FragColor \x3d vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb +\x3d weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i \x3d 1; i \x3c n; i++ ) {\n\n\t\t\t\t\tif ( i \x3e\x3d samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta \x3d dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb +\x3d weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}return h}_compileMaterial(a){a=new Kc(this._lodPlanes[0],a);this._renderer.compile(a,Qj)}_sceneToCubeUV(a,b,d,h,n){b=new Yc(90,1,b,d);d=[1,-1,1,1,1,1];const u=[1,1,1,-1,-1,-1],E=this._renderer,F=E.autoClear,H=E.toneMapping;E.getClearColor(im);E.toneMapping=0;E.autoClear=!1;E.state.buffers.depth.getReversed()&&(E.setRenderTarget(h),E.clearDepth(),E.setRenderTarget(null));var M=new He({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1});const R=new Kc(new xf,
M);let T=!1;const X=a.background;X?X.isColor&&(M.color.copy(X),a.background=null,T=!0):(M.color.copy(im),T=!0);for(M=0;M<6;M++){const ea=M%3;ea===0?(b.up.set(0,d[M],0),b.position.set(n.x,n.y,n.z),b.lookAt(n.x+u[M],n.y,n.z)):ea===1?(b.up.set(0,0,d[M]),b.position.set(n.x,n.y,n.z),b.lookAt(n.x,n.y+u[M],n.z)):(b.up.set(0,d[M],0),b.position.set(n.x,n.y,n.z),b.lookAt(n.x,n.y,n.z+u[M]));const aa=this._cubeSize;zc(h,ea*aa,M>2?aa:0,aa,aa);E.setRenderTarget(h);T&&E.render(R,b);E.render(a,b)}R.geometry.dispose();
R.material.dispose();E.toneMapping=H;E.autoClear=F;a.background=X}_textureToCubeUV(a,b){const d=this._renderer;var h=a.mapping===301||a.mapping===302;h?(this._cubemapMaterial===null&&(this._cubemapMaterial=uc()),this._cubemapMaterial.uniforms.flipEnvMap.value=a.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Va());const n=h?this._cubemapMaterial:this._equirectMaterial;h=new Kc(this._lodPlanes[0],n);n.uniforms.envMap.value=a;a=this._cubeSize;zc(b,0,0,3*a,2*a);
d.setRenderTarget(b);d.render(h,Qj)}_applyPMREM(a){const b=this._renderer,d=b.autoClear;b.autoClear=!1;const h=this._lodPlanes.length;for(let n=1;n<h;n++)this._blur(a,n-1,n,Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),jm[(h-n-1)%jm.length]);b.autoClear=d}_blur(a,b,d,h,n){const u=this._pingPongRenderTarget;this._halfBlur(a,u,b,d,h,"latitudinal",n);this._halfBlur(u,a,d,d,h,"longitudinal",n)}_halfBlur(a,b,d,h,n,u,E){const F=this._renderer;var H=this._blurMaterial;u!==
"latitudinal"&&u!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const M=new Kc(this._lodPlanes[h],H);H=H.uniforms;var R=this._sizeLods[d]-1;R=isFinite(n)?Math.PI/(2*R):2*Math.PI/39;var T=n/R;const X=isFinite(n)?1+Math.floor(3*T):20;X>20&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${X} samples when the maximum is set to ${20}`);n=[];let ea=0;for(let da=0;da<20;++da){var aa=da/T;aa=Math.exp(-aa*aa/2);n.push(aa);da===0?
ea+=aa:da<X&&(ea+=2*aa)}for(T=0;T<n.length;T++)n[T]/=ea;H.envMap.value=a.texture;H.samples.value=X;H.weights.value=n;H.latitudinal.value=u==="latitudinal";E&&(H.poleAxis.value=E);({_lodMax:a}=this);H.dTheta.value=R;H.mipInt.value=a-d;d=this._sizeLods[h];zc(b,3*d*(h>a-4?h-a+4:0),4*(this._cubeSize-d),3*d,2*d);F.setRenderTarget(b);F.render(M,Qj)}}const lk=new Cc,kk=new fj(1,1),ok=new yf,mk=new Cf,nk=new Bg,fk=[],gk=[],jk=new Float32Array(16),ik=new Float32Array(9),hk=new Float32Array(4);class no{constructor(a,
b,d){this.id=a;this.addr=d;this.cache=[];this.type=b.type;this.setValue=gg(b.type)}}class oo{constructor(a,b,d){this.id=a;this.addr=d;this.cache=[];this.type=b.type;this.size=b.size;this.setValue=fa(b.type)}}class po{constructor(a){this.id=a;this.seq=[];this.map={}}setValue(a,b,d){const h=this.seq;for(let n=0,u=h.length;n!==u;++n){const E=h[n];E.setValue(a,b[E.id],d)}}}const Vj=/(\w+)(\])?(\[|\.)?/g;class ah{constructor(a,b){this.seq=[];this.map={};const d=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);
for(let M=0;M<d;++M){var h=a.getActiveUniform(b,M),n=a.getUniformLocation(b,h.name),u=this,E=h.name;const R=E.length;for(Vj.lastIndex=0;;){const T=Vj.exec(E),X=Vj.lastIndex;var F=T[1],H=T[3];T[2]==="]"&&(F|=0);if(H===void 0||H==="["&&X+2===R){E=u;h=H===void 0?new no(F,h,n):new oo(F,h,n);E.seq.push(h);E.map[h.id]=h;break}else H=u.map[F],H===void 0&&(H=new po(F),F=u,u=H,F.seq.push(u),F.map[u.id]=u),u=H}}}setValue(a,b,d,h){b=this.map[b];b!==void 0&&b.setValue(a,d,h)}setOptional(a,b,d){b=b[d];b!==void 0&&
this.setValue(a,d,b)}static upload(a,b,d,h){for(let n=0,u=b.length;n!==u;++n){const E=b[n],F=d[E.id];F.needsUpdate!==!1&&E.setValue(a,F.value,h)}}static seqWithValue(a,b){const d=[];for(let h=0,n=a.length;h!==n;++h){const u=a[h];u.id in b&&d.push(u)}return d}}let qm=0;const pk=new Lb,Xg=new ma,fi=/^[ \t]*#include +<([\w\d./]+)>/gm,pm=new Map,qk=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;let qo=0;class rm{constructor(){this.shaderCache=
new Map;this.materialCache=new Map}update(a){var b=a.fragmentShader;const d=this._getShaderStage(a.vertexShader);b=this._getShaderStage(b);a=this._getShaderCacheForMaterial(a);a.has(d)===!1&&(a.add(d),d.usedTimes++);a.has(b)===!1&&(a.add(b),b.usedTimes++);return this}remove(a){const b=this.materialCache.get(a);for(const d of b)d.usedTimes--,d.usedTimes===0&&this.shaderCache.delete(d.code);this.materialCache.delete(a);return this}getVertexShaderID(a){return this._getShaderStage(a.vertexShader).id}getFragmentShaderID(a){return this._getShaderStage(a.fragmentShader).id}dispose(){this.shaderCache.clear();
this.materialCache.clear()}_getShaderCacheForMaterial(a){const b=this.materialCache;let d=b.get(a);d===void 0&&(d=new Set,b.set(a,d));return d}_getShaderStage(a){const b=this.shaderCache;let d=b.get(a);d===void 0&&(d=new ro(a),b.set(a,d));return d}}class ro{constructor(a){this.id=qo++;this.code=a;this.usedTimes=0}}let sm=0;const tm={[0]:1,[2]:6,[4]:7,[3]:5,[1]:0,[6]:2,[7]:4,[5]:3};class so{constructor(){this.mesh=this.texture=null;this.depthFar=this.depthNear=0}init(a,b){if(this.texture===null){const d=
new gj(a.texture);if(a.depthNear!==b.depthNear||a.depthFar!==b.depthFar)this.depthNear=a.depthNear,this.depthFar=a.depthFar;this.texture=d}}getMesh(a){this.texture!==null&&this.mesh===null&&(a=a.cameras[0].viewport,a=new Jd({vertexShader:"\nvoid main() {\n\n\tgl_Position \x3d vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord \x3d vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x \x3e\x3d 1.0 ) {\n\n\t\tgl_FragDepth \x3d texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth \x3d texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",
uniforms:{depthColor:{value:this.texture},depthWidth:{value:a.z},depthHeight:{value:a.w}}}),this.mesh=new Kc(new rg(20,20),a));return this.mesh}reset(){this.mesh=this.texture=null}getDepthTexture(){return this.texture}}class to extends Bd{constructor(a,b){function d(Wa){var hb=Ja.indexOf(Wa.inputSource);hb!==-1&&(hb=Ca[hb],hb!==void 0&&(hb.update(Wa.inputSource,Wa.frame,X||M),hb.dispatchEvent({type:Wa.type,data:Wa.inputSource})))}function h(){F.removeEventListener("select",d);F.removeEventListener("selectstart",
d);F.removeEventListener("selectend",d);F.removeEventListener("squeeze",d);F.removeEventListener("squeezestart",d);F.removeEventListener("squeezeend",d);F.removeEventListener("end",h);F.removeEventListener("inputsourceschange",n);for(let Wa=0;Wa<Ca.length;Wa++){const hb=Ja[Wa];hb!==null&&(Ja[Wa]=null,Ca[Wa].disconnect(hb))}ob=nb=null;wa.reset();for(const Wa in sa)delete sa[Wa];a.setRenderTarget(Ba);Na=F=aa=da=U=null;Mb.stop();E.isPresenting=!1;a.setPixelRatio(Za);a.setSize(Qa.width,Qa.height,!1);
E.dispatchEvent({type:"sessionend"})}function n(Wa){for(var hb=0;hb<Wa.removed.length;hb++){var ja=Wa.removed[hb],ha=Ja.indexOf(ja);ha>=0&&(Ja[ha]=null,Ca[ha].disconnect(ja))}for(hb=0;hb<Wa.added.length;hb++){ja=Wa.added[hb];ha=Ja.indexOf(ja);if(ha===-1){for(let la=0;la<Ca.length;la++)if(la>=Ja.length){Ja.push(ja);ha=la;break}else if(Ja[la]===null){Ja[la]=ja;ha=la;break}if(ha===-1)break}(ha=Ca[ha])&&ha.connect(ja)}}function u(Wa,hb){hb===null?Wa.matrixWorld.copy(Wa.matrix):Wa.matrixWorld.multiplyMatrices(hb.matrixWorld,
Wa.matrix);Wa.matrixWorldInverse.copy(Wa.matrixWorld).invert()}super();const E=this;let F=null,H=1,M=null,R="local-floor",T=1,X=null,ea=null,aa=null,da=null,U=null,ka=null;const qa=typeof XRWebGLBinding!=="undefined",wa=new so,sa={},Aa=b.getContextAttributes();let Ba=null,Na=null;const Ca=[],Ja=[],Qa=new Xa;let Za=null;const gb=new Yc;gb.viewport=new ec;const cb=new Yc;cb.viewport=new ec;const rb=[gb,cb],Ya=new Rl;let nb=null,ob=null;this.cameraAutoUpdate=!0;this.isPresenting=this.enabled=!1;this.getController=
function(Wa){let hb=Ca[Wa];hb===void 0&&(hb=new th,Ca[Wa]=hb);return hb.getTargetRaySpace()};this.getControllerGrip=function(Wa){let hb=Ca[Wa];hb===void 0&&(hb=new th,Ca[Wa]=hb);return hb.getGripSpace()};this.getHand=function(Wa){let hb=Ca[Wa];hb===void 0&&(hb=new th,Ca[Wa]=hb);return hb.getHandSpace()};this.setFramebufferScaleFactor=function(Wa){H=Wa;E.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")};this.setReferenceSpaceType=function(Wa){R=
Wa;E.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")};this.getReferenceSpace=function(){return X||M};this.setReferenceSpace=function(Wa){X=Wa};this.getBaseLayer=function(){return da!==null?da:U};this.getBinding=function(){aa===null&&qa&&(aa=new XRWebGLBinding(F,b));return aa};this.getFrame=function(){return ka};this.getSession=function(){return F};this.setSession=async function(Wa){F=Wa;if(F!==null){Ba=a.getRenderTarget();F.addEventListener("select",
d);F.addEventListener("selectstart",d);F.addEventListener("selectend",d);F.addEventListener("squeeze",d);F.addEventListener("squeezestart",d);F.addEventListener("squeezeend",d);F.addEventListener("end",h);F.addEventListener("inputsourceschange",n);Aa.xrCompatible!==!0&&await b.makeXRCompatible();Za=a.getPixelRatio();a.getSize(Qa);if(qa&&"createProjectionLayer"in XRWebGLBinding.prototype){let ja=Wa=null;var hb=null;Aa.depth&&(hb=Aa.stencil?b.DEPTH24_STENCIL8:b.DEPTH_COMPONENT24,Wa=Aa.stencil?1027:
1026,ja=Aa.stencil?1020:1014);hb={colorFormat:b.RGBA8,depthFormat:hb,scaleFactor:H};aa=this.getBinding();da=aa.createProjectionLayer(hb);F.updateRenderState({layers:[da]});a.setPixelRatio(1);a.setSize(da.textureWidth,da.textureHeight,!1);Na=new zd(da.textureWidth,da.textureHeight,{format:1023,type:1009,depthTexture:new fj(da.textureWidth,da.textureHeight,ja,void 0,void 0,void 0,void 0,void 0,void 0,Wa),stencilBuffer:Aa.stencil,colorSpace:a.outputColorSpace,samples:Aa.antialias?4:0,resolveDepthBuffer:da.ignoreDepthValues===
!1,resolveStencilBuffer:da.ignoreDepthValues===!1})}else U=new XRWebGLLayer(F,b,{antialias:Aa.antialias,alpha:!0,depth:Aa.depth,stencil:Aa.stencil,framebufferScaleFactor:H}),F.updateRenderState({baseLayer:U}),a.setPixelRatio(1),a.setSize(U.framebufferWidth,U.framebufferHeight,!1),Na=new zd(U.framebufferWidth,U.framebufferHeight,{format:1023,type:1009,colorSpace:a.outputColorSpace,stencilBuffer:Aa.stencil,resolveDepthBuffer:U.ignoreDepthValues===!1,resolveStencilBuffer:U.ignoreDepthValues===!1});Na.isXRRenderTarget=
!0;this.setFoveation(T);X=null;M=await F.requestReferenceSpace(R);Mb.setContext(F);Mb.start();E.isPresenting=!0;E.dispatchEvent({type:"sessionstart"})}};this.getEnvironmentBlendMode=function(){if(F!==null)return F.environmentBlendMode};this.getDepthTexture=function(){return wa.getDepthTexture()};const ub=new ma,Cb=new ma;this.updateCamera=function(Wa){if(F!==null){var hb=Wa.near,ja=Wa.far;wa.texture!==null&&(wa.depthNear>0&&(hb=wa.depthNear),wa.depthFar>0&&(ja=wa.depthFar));Ya.near=cb.near=gb.near=
hb;Ya.far=cb.far=gb.far=ja;if(nb!==Ya.near||ob!==Ya.far)F.updateRenderState({depthNear:Ya.near,depthFar:Ya.far}),nb=Ya.near,ob=Ya.far;Ya.layers.mask=Wa.layers.mask|6;gb.layers.mask=Ya.layers.mask&3;cb.layers.mask=Ya.layers.mask&5;hb=Wa.parent;ja=Ya.cameras;u(Ya,hb);for(var ha=0;ha<ja.length;ha++)u(ja[ha],hb);if(ja.length===2){ub.setFromMatrixPosition(gb.matrixWorld);Cb.setFromMatrixPosition(cb.matrixWorld);ja=ub.distanceTo(Cb);var la=gb.projectionMatrix.elements,ta=cb.projectionMatrix.elements,ua=
la[14]/(la[10]-1);ha=la[14]/(la[10]+1);const Ga=(la[9]+1)/la[5],ya=(la[9]-1)/la[5];var Pa=(la[8]-1)/la[0],oa=(ta[8]+1)/ta[0];ta=ua*Pa;const Ma=ua*oa;oa=ja/(-Pa+oa);Pa=oa*-Pa;gb.matrixWorld.decompose(Ya.position,Ya.quaternion,Ya.scale);Ya.translateX(Pa);Ya.translateZ(oa);Ya.matrixWorld.compose(Ya.position,Ya.quaternion,Ya.scale);Ya.matrixWorldInverse.copy(Ya.matrixWorld).invert();la[10]===-1?(Ya.projectionMatrix.copy(gb.projectionMatrix),Ya.projectionMatrixInverse.copy(gb.projectionMatrixInverse)):
(la=ua+oa,ua=ha+oa,Ya.projectionMatrix.makePerspective(ta-Pa,Ma+(ja-Pa),Ga*ha/ua*la,ya*ha/ua*la,la,ua),Ya.projectionMatrixInverse.copy(Ya.projectionMatrix).invert())}else Ya.projectionMatrix.copy(gb.projectionMatrix);hb===null?Wa.matrix.copy(Ya.matrixWorld):(Wa.matrix.copy(hb.matrixWorld),Wa.matrix.invert(),Wa.matrix.multiply(Ya.matrixWorld));Wa.matrix.decompose(Wa.position,Wa.quaternion,Wa.scale);Wa.updateMatrixWorld(!0);Wa.projectionMatrix.copy(Ya.projectionMatrix);Wa.projectionMatrixInverse.copy(Ya.projectionMatrixInverse);
Wa.isPerspectiveCamera&&(Wa.fov=ye*2*Math.atan(1/Wa.projectionMatrix.elements[5]),Wa.zoom=1)}};this.getCamera=function(){return Ya};this.getFoveation=function(){if(da!==null||U!==null)return T};this.setFoveation=function(Wa){T=Wa;da!==null&&(da.fixedFoveation=Wa);U!==null&&U.fixedFoveation!==void 0&&(U.fixedFoveation=Wa)};this.hasDepthSensing=function(){return wa.texture!==null};this.getDepthSensingMesh=function(){return wa.getMesh(Ya)};this.getCameraTexture=function(Wa){return sa[Wa]};let sb=null;
const Mb=new Sd;Mb.setAnimationLoop(function(Wa,hb){ea=hb.getViewerPose(X||M);ka=hb;if(ea!==null){var ja=ea.views;U!==null&&(a.setRenderTargetFramebuffer(Na,U.framebuffer),a.setRenderTarget(Na));var ha=!1;ja.length!==Ya.cameras.length&&(Ya.cameras.length=0,ha=!0);for(var la=0;la<ja.length;la++){var ta=ja[la];let Pa;if(U!==null)Pa=U.getViewport(ta);else{var ua=aa.getViewSubImage(da,ta);Pa=ua.viewport;la===0&&(a.setRenderTargetTextures(Na,ua.colorTexture,ua.depthStencilTexture),a.setRenderTarget(Na))}ua=
rb[la];ua===void 0&&(ua=new Yc,ua.layers.enable(la),ua.viewport=new ec,rb[la]=ua);ua.matrix.fromArray(ta.transform.matrix);ua.matrix.decompose(ua.position,ua.quaternion,ua.scale);ua.projectionMatrix.fromArray(ta.projectionMatrix);ua.projectionMatrixInverse.copy(ua.projectionMatrix).invert();ua.viewport.set(Pa.x,Pa.y,Pa.width,Pa.height);la===0&&(Ya.matrix.copy(ua.matrix),Ya.matrix.decompose(Ya.position,Ya.quaternion,Ya.scale));ha===!0&&Ya.cameras.push(ua)}(ha=F.enabledFeatures)&&ha.includes("depth-sensing")&&
F.depthUsage=="gpu-optimized"&&qa&&(aa=E.getBinding(),(la=aa.getDepthInformation(ja[0]))&&la.isValid&&la.texture&&wa.init(la,F.renderState));if(ha&&ha.includes("camera-access")&&qa)for(a.state.unbindTexture(),aa=E.getBinding(),ha=0;ha<ja.length;ha++)if(ta=ja[ha].camera)la=sa[ta],la||(la=new gj,sa[ta]=la),ta=aa.getCameraImage(ta),la.sourceTexture=ta}for(ja=0;ja<Ca.length;ja++)ha=Ja[ja],la=Ca[ja],ha!==null&&la!==void 0&&la.update(ha,hb,X||M);sb&&sb(Wa,hb);hb.detectedPlanes&&E.dispatchEvent({type:"planesdetected",
data:hb});ka=null});this.setAnimationLoop=function(Wa){sb=Wa};this.dispose=function(){}}}const Ad=new Cd,um=new Gb;class uo{constructor(a={}){function b(){Lc=new xc(za);Lc.init();qe=new gh(za,Lc);Xc=new sd(za,Lc,a,qe);Ob=new yi(za,Lc);Xc.reversedDepthBuffer&&gb&&Ob.buffers.depth.setReversed(!0);vd=new gc(za);Pb=new ni;lc=new zi(za,Lc,Ob,Pb,Xc,qe,vd);Zf=new Pc(sb);$f=new Ab(sb);ag=new Td(za);nf=new rd(za,ag);Wj=new Jc(za,ag,vd,nf);bg=new qf(za,Wj,ag,vd);km=new eg(za,Xc,lc);Fd=new Wb(Pb);re=new mi(sb,
Zf,$f,Lc,Xc,nf,Fd);Xj=new Ai(sb,Pb);Xh=new pi;Yh=new ui(Lc);Gd=new Id(sb,Zf,$f,Ob,bg,cb,Ca);Pd=new vi(sb,bg,Xc);Zh=new Bi(za,vd,Xc,Ob);lm=new La(za,Lc,vd);mm=new Me(za,Lc,vd);vd.programs=re.programs;sb.capabilities=Xc;sb.extensions=Lc;sb.properties=Pb;sb.renderLists=Xh;sb.shadowMap=Pd;sb.state=Ob;sb.info=vd}function d(ia){ia.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");Mb=!0}function h(){console.log("THREE.WebGLRenderer: Context Restored.");Mb=!1;const ia=vd.autoReset,Fa=Pd.enabled,
Oa=Pd.autoUpdate,Ka=Pd.needsUpdate,va=Pd.type;b();vd.autoReset=ia;Pd.enabled=Fa;Pd.autoUpdate=Oa;Pd.needsUpdate=Ka;Pd.type=va}function n(ia){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ia.statusMessage)}function u(ia){ia=ia.target;ia.removeEventListener("dispose",u);E(ia);Pb.remove(ia)}function E(ia){const Fa=Pb.get(ia).programs;Fa!==void 0&&(Fa.forEach(function(Oa){re.releaseProgram(Oa)}),ia.isShaderMaterial&&re.releaseShaderCache(ia))}function F(ia,Fa,Oa){ia.transparent===
!0&&ia.side===2&&ia.forceSinglePass===!1?(ia.side=1,ia.needsUpdate=!0,da(ia,Fa,Oa),ia.side=0,ia.needsUpdate=!0,da(ia,Fa,Oa),ia.side=2):da(ia,Fa,Oa)}function H(){of.stop()}function M(){of.start()}function R(ia,Fa,Oa,Ka){if(ia.visible!==!1){if(ia.layers.test(Fa.layers))if(ia.isGroup)Oa=ia.renderOrder;else if(ia.isLOD)ia.autoUpdate===!0&&ia.update(Fa);else if(ia.isLight)ob.pushLight(ia),ia.castShadow&&ob.pushShadow(ia);else if(ia.isSprite){if(!ia.frustumCulled||Nb.intersectsSprite(ia)){Ka&&Wd.setFromMatrixPosition(ia.matrixWorld).applyMatrix4(Xe);
var va=bg.update(ia),bb=ia.material;bb.visible&&nb.push(ia,va,bb,Oa,Wd.z,null)}}else if(ia.isMesh||ia.isLine||ia.isPoints)if(!ia.frustumCulled||Nb.intersectsObject(ia))if(va=bg.update(ia),bb=ia.material,Ka&&(ia.boundingSphere!==void 0?(ia.boundingSphere===null&&ia.computeBoundingSphere(),Wd.copy(ia.boundingSphere.center)):(va.boundingSphere===null&&va.computeBoundingSphere(),Wd.copy(va.boundingSphere.center)),Wd.applyMatrix4(ia.matrixWorld).applyMatrix4(Xe)),Array.isArray(bb)){const db=va.groups;
for(let ib=0,Zb=db.length;ib<Zb;ib++){const mc=db[ib],Hb=bb[mc.materialIndex];Hb&&Hb.visible&&nb.push(ia,va,Hb,Oa,Wd.z,mc)}}else bb.visible&&nb.push(ia,va,bb,Oa,Wd.z,null);ia=ia.children;for(let db=0,ib=ia.length;db<ib;db++)R(ia[db],Fa,Oa,Ka)}}function T(ia,Fa,Oa,Ka){const va=ia.opaque,bb=ia.transmissive;ia=ia.transparent;ob.setupLightsView(Oa);wc===!0&&Fd.setGlobalState(sb.clippingPlanes,Oa);Ka&&Ob.viewport(ta.copy(Ka));va.length>0&&ea(va,Fa,Oa);bb.length>0&&ea(bb,Fa,Oa);ia.length>0&&ea(ia,Fa,Oa);
Ob.buffers.depth.setTest(!0);Ob.buffers.depth.setMask(!0);Ob.buffers.color.setMask(!0);Ob.setPolygonOffset(!1)}function X(ia,Fa,Oa,Ka){if((Oa.isScene===!0?Oa.overrideMaterial:null)===null){ob.state.transmissionRenderTarget[Ka.id]===void 0&&(ob.state.transmissionRenderTarget[Ka.id]=new zd(1,1,{generateMipmaps:!0,type:Lc.has("EXT_color_buffer_half_float")||Lc.has("EXT_color_buffer_float")?1016:1009,minFilter:1008,samples:4,stencilBuffer:Aa,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:$b.workingColorSpace}));
var va=ob.state.transmissionRenderTarget[Ka.id],bb=Ka.viewport||ta;va.setSize(bb.z*sb.transmissionResolutionScale,bb.w*sb.transmissionResolutionScale);bb=sb.getRenderTarget();var db=sb.getActiveCubeFace(),ib=sb.getActiveMipmapLevel();sb.setRenderTarget(va);sb.getClearColor(oa);Ga=sb.getClearAlpha();Ga<1&&sb.setClearColor(16777215,.5);sb.clear();Ye&&Gd.render(Oa);var Zb=sb.toneMapping;sb.toneMapping=0;var mc=Ka.viewport;Ka.viewport!==void 0&&(Ka.viewport=void 0);ob.setupLightsView(Ka);wc===!0&&Fd.setGlobalState(sb.clippingPlanes,
Ka);ea(ia,Oa,Ka);lc.updateMultisampleRenderTarget(va);lc.updateRenderTargetMipmap(va);if(Lc.has("WEBGL_multisampled_render_to_texture")===!1){var Hb=!1;for(let Xb=0,Uc=Fa.length;Xb<Uc;Xb++){var Sb=Fa[Xb];ia=Sb.object;const qc=Sb.geometry,kd=Sb.material;Sb=Sb.group;kd.side===2&&ia.layers.test(Ka.layers)&&(Hb=kd.side,kd.side=1,kd.needsUpdate=!0,aa(ia,Oa,Ka,qc,kd,Sb),kd.side=Hb,Hb=kd.needsUpdate=!0)}Hb===!0&&(lc.updateMultisampleRenderTarget(va),lc.updateRenderTargetMipmap(va))}sb.setRenderTarget(bb,
db,ib);sb.setClearColor(oa,Ga);mc!==void 0&&(Ka.viewport=mc);sb.toneMapping=Zb}}function ea(ia,Fa,Oa){const Ka=Fa.isScene===!0?Fa.overrideMaterial:null;for(let bb=0,db=ia.length;bb<db;bb++){var va=ia[bb];const ib=va.object,Zb=va.geometry,mc=va.group;va=va.material;va.allowOverride===!0&&Ka!==null&&(va=Ka);ib.layers.test(Oa.layers)&&aa(ib,Fa,Oa,Zb,va,mc)}}function aa(ia,Fa,Oa,Ka,va,bb){ia.onBeforeRender(sb,Fa,Oa,Ka,va,bb);ia.modelViewMatrix.multiplyMatrices(Oa.matrixWorldInverse,ia.matrixWorld);ia.normalMatrix.getNormalMatrix(ia.modelViewMatrix);
va.onBeforeRender(sb,Fa,Oa,Ka,ia,bb);va.transparent===!0&&va.side===2&&va.forceSinglePass===!1?(va.side=1,va.needsUpdate=!0,sb.renderBufferDirect(Oa,Fa,Ka,va,ia,bb),va.side=0,va.needsUpdate=!0,sb.renderBufferDirect(Oa,Fa,Ka,va,ia,bb),va.side=2):sb.renderBufferDirect(Oa,Fa,Ka,va,ia,bb);ia.onAfterRender(sb,Fa,Oa,Ka,va,bb)}function da(ia,Fa,Oa){Fa.isScene!==!0&&(Fa=Af);const Ka=Pb.get(ia),va=ob.state.lights,bb=va.state.version;Oa=re.getParameters(ia,va.state,ob.state.shadowsArray,Fa,Oa);var db=re.getProgramCacheKey(Oa);
let ib=Ka.programs;Ka.environment=ia.isMeshStandardMaterial?Fa.environment:null;Ka.fog=Fa.fog;Ka.envMap=(ia.isMeshStandardMaterial?$f:Zf).get(ia.envMap||Ka.environment);Ka.envMapRotation=Ka.environment!==null&&ia.envMap===null?Fa.environmentRotation:ia.envMapRotation;ib===void 0&&(ia.addEventListener("dispose",u),ib=new Map,Ka.programs=ib);Fa=ib.get(db);if(Fa!==void 0){if(Ka.currentProgram===Fa&&Ka.lightsStateVersion===bb)return ka(ia,Oa),Fa}else Oa.uniforms=re.getUniforms(ia),ia.onBeforeCompile(Oa,
sb),Fa=re.acquireProgram(Oa,db),ib.set(db,Fa),Ka.uniforms=Oa.uniforms;db=Ka.uniforms;if(!ia.isShaderMaterial&&!ia.isRawShaderMaterial||ia.clipping===!0)db.clippingPlanes=Fd.uniform;ka(ia,Oa);Ka.needsLights=ia.isMeshLambertMaterial||ia.isMeshToonMaterial||ia.isMeshPhongMaterial||ia.isMeshStandardMaterial||ia.isShadowMaterial||ia.isShaderMaterial&&ia.lights===!0;Ka.lightsStateVersion=bb;Ka.needsLights&&(db.ambientLightColor.value=va.state.ambient,db.lightProbe.value=va.state.probe,db.directionalLights.value=
va.state.directional,db.directionalLightShadows.value=va.state.directionalShadow,db.spotLights.value=va.state.spot,db.spotLightShadows.value=va.state.spotShadow,db.rectAreaLights.value=va.state.rectArea,db.ltc_1.value=va.state.rectAreaLTC1,db.ltc_2.value=va.state.rectAreaLTC2,db.pointLights.value=va.state.point,db.pointLightShadows.value=va.state.pointShadow,db.hemisphereLights.value=va.state.hemi,db.directionalShadowMap.value=va.state.directionalShadowMap,db.directionalShadowMatrix.value=va.state.directionalShadowMatrix,
db.spotShadowMap.value=va.state.spotShadowMap,db.spotLightMatrix.value=va.state.spotLightMatrix,db.spotLightMap.value=va.state.spotLightMap,db.pointShadowMap.value=va.state.pointShadowMap,db.pointShadowMatrix.value=va.state.pointShadowMatrix);Ka.currentProgram=Fa;Ka.uniformsList=null;return Fa}function U(ia){if(ia.uniformsList===null){const Fa=ia.currentProgram.getUniforms();ia.uniformsList=ah.seqWithValue(Fa.seq,ia.uniforms)}return ia.uniformsList}function ka(ia,Fa){ia=Pb.get(ia);ia.outputColorSpace=
Fa.outputColorSpace;ia.batching=Fa.batching;ia.batchingColor=Fa.batchingColor;ia.instancing=Fa.instancing;ia.instancingColor=Fa.instancingColor;ia.instancingMorph=Fa.instancingMorph;ia.skinning=Fa.skinning;ia.morphTargets=Fa.morphTargets;ia.morphNormals=Fa.morphNormals;ia.morphColors=Fa.morphColors;ia.morphTargetsCount=Fa.morphTargetsCount;ia.numClippingPlanes=Fa.numClippingPlanes;ia.numIntersection=Fa.numClipIntersection;ia.vertexAlphas=Fa.vertexAlphas;ia.vertexTangents=Fa.vertexTangents;ia.toneMapping=
Fa.toneMapping}const {canvas:qa=z(),context:wa=null,depth:sa=!0,stencil:Aa=!1,alpha:Ba=!1,antialias:Na=!1,premultipliedAlpha:Ca=!0,preserveDrawingBuffer:Ja=!1,powerPreference:Qa="default",failIfMajorPerformanceCaveat:Za=!1,reversedDepthBuffer:gb=!1}=a;this.isWebGLRenderer=!0;let cb;if(wa!==null){if(typeof WebGLRenderingContext!=="undefined"&&wa instanceof WebGLRenderingContext)throw Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");cb=wa.getContextAttributes().alpha}else cb=Ba;const rb=
new Uint32Array(4),Ya=new Int32Array(4);let nb=null,ob=null;const ub=[],Cb=[];this.domElement=qa;this.debug={checkShaderErrors:!0,onShaderError:null};this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this.toneMapping=0;this.transmissionResolutionScale=this.toneMappingExposure=1;const sb=this;let Mb=!1;this._outputColorSpace="srgb";let Wa=0,hb=0,ja=null,ha=-1,la=null;const ta=new ec,ua=new ec;let Pa=
null;const oa=new pb(0);let Ga=0,ya=qa.width,Ma=qa.height,Ta=1,Sa=null,$a=null;const Jb=new ec(0,0,ya,Ma),Kb=new ec(0,0,ya,Ma);let Fb=!1;const Nb=new Bf;let wc=!1,zf=!1;const Xe=new Gb,ch=new ma,Wd=new ec,Af={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ye=!1,za=wa;try{const ia={alpha:!0,depth:sa,stencil:Aa,antialias:Na,premultipliedAlpha:Ca,preserveDrawingBuffer:Ja,powerPreference:Qa,failIfMajorPerformanceCaveat:Za};"setAttribute"in qa&&qa.setAttribute("data-engine",
"three.js r180");qa.addEventListener("webglcontextlost",d,!1);qa.addEventListener("webglcontextrestored",h,!1);qa.addEventListener("webglcontextcreationerror",n,!1);if(za===null&&(za=qa.getContext("webgl2",ia),za===null)){if(qa.getContext("webgl2",void 0))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");}}catch(ia){throw console.error("THREE.WebGLRenderer: "+ia.message),ia;}let Lc,Xc,Ob,vd,Pb,lc,Zf,$f,ag,Wj,bg,re,Xj,Xh,Yh,Fd,Pd,
Gd,km,lm,mm,qe,nf,Zh;b();const Vc=new to(sb,za);this.xr=Vc;this.getContext=function(){return za};this.getContextAttributes=function(){return za.getContextAttributes()};this.forceContextLoss=function(){const ia=Lc.get("WEBGL_lose_context");ia&&ia.loseContext()};this.forceContextRestore=function(){const ia=Lc.get("WEBGL_lose_context");ia&&ia.restoreContext()};this.getPixelRatio=function(){return Ta};this.setPixelRatio=function(ia){ia!==void 0&&(Ta=ia,this.setSize(ya,Ma,!1))};this.getSize=function(ia){return ia.set(ya,
Ma)};this.setSize=function(ia,Fa,Oa=!0){Vc.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ya=ia,Ma=Fa,qa.width=Math.floor(ia*Ta),qa.height=Math.floor(Fa*Ta),Oa===!0&&(qa.style.width=ia+"px",qa.style.height=Fa+"px"),this.setViewport(0,0,ia,Fa))};this.getDrawingBufferSize=function(ia){return ia.set(ya*Ta,Ma*Ta).floor()};this.setDrawingBufferSize=function(ia,Fa,Oa){ya=ia;Ma=Fa;Ta=Oa;qa.width=Math.floor(ia*Oa);qa.height=Math.floor(Fa*Oa);this.setViewport(0,
0,ia,Fa)};this.getCurrentViewport=function(ia){return ia.copy(ta)};this.getViewport=function(ia){return ia.copy(Jb)};this.setViewport=function(ia,Fa,Oa,Ka){ia.isVector4?Jb.set(ia.x,ia.y,ia.z,ia.w):Jb.set(ia,Fa,Oa,Ka);Ob.viewport(ta.copy(Jb).multiplyScalar(Ta).round())};this.getScissor=function(ia){return ia.copy(Kb)};this.setScissor=function(ia,Fa,Oa,Ka){ia.isVector4?Kb.set(ia.x,ia.y,ia.z,ia.w):Kb.set(ia,Fa,Oa,Ka);Ob.scissor(ua.copy(Kb).multiplyScalar(Ta).round())};this.getScissorTest=function(){return Fb};
this.setScissorTest=function(ia){Ob.setScissorTest(Fb=ia)};this.setOpaqueSort=function(ia){Sa=ia};this.setTransparentSort=function(ia){$a=ia};this.getClearColor=function(ia){return ia.copy(Gd.getClearColor())};this.setClearColor=function(){Gd.setClearColor(...arguments)};this.getClearAlpha=function(){return Gd.getClearAlpha()};this.setClearAlpha=function(){Gd.setClearAlpha(...arguments)};this.clear=function(ia=!0,Fa=!0,Oa=!0){let Ka=0;if(ia)if(ia=!1,ja!==null&&(ia=ja.texture.format,ia=ia===1033||
ia===1031||ia===1029),ia){ia=ja.texture.type;ia=ia===1009||ia===1014||ia===1012||ia===1020||ia===1017||ia===1018;var va=Gd.getClearColor();const bb=Gd.getClearAlpha(),db=va.r,ib=va.g;va=va.b;ia?(rb[0]=db,rb[1]=ib,rb[2]=va,rb[3]=bb,za.clearBufferuiv(za.COLOR,0,rb)):(Ya[0]=db,Ya[1]=ib,Ya[2]=va,Ya[3]=bb,za.clearBufferiv(za.COLOR,0,Ya))}else Ka|=za.COLOR_BUFFER_BIT;Fa&&(Ka|=za.DEPTH_BUFFER_BIT);Oa&&(Ka|=za.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295));za.clear(Ka)};this.clearColor=
function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.dispose=function(){qa.removeEventListener("webglcontextlost",d,!1);qa.removeEventListener("webglcontextrestored",h,!1);qa.removeEventListener("webglcontextcreationerror",n,!1);Gd.dispose();Xh.dispose();Yh.dispose();Pb.dispose();Zf.dispose();$f.dispose();bg.dispose();nf.dispose();Zh.dispose();re.dispose();Vc.dispose();Vc.removeEventListener("sessionstart",H);Vc.removeEventListener("sessionend",
M);of.stop()};this.renderBufferDirect=function(ia,Fa,Oa,Ka,va,bb){Fa===null&&(Fa=Af);var db=va.isMesh&&va.matrixWorld.determinant()<0,ib=Fa;ib.isScene!==!0&&(ib=Af);lc.resetTextureUnits();Fa=ib.fog;var Zb=Ka.isMeshStandardMaterial?ib.environment:null,mc=ja===null?sb.outputColorSpace:ja.isXRRenderTarget===!0?ja.texture.colorSpace:"srgb-linear";Zb=(Ka.isMeshStandardMaterial?$f:Zf).get(Ka.envMap||Zb);var Hb=Ka.vertexColors===!0&&!!Oa.attributes.color&&Oa.attributes.color.itemSize===4,Sb=!!Oa.attributes.tangent&&
(!!Ka.normalMap||Ka.anisotropy>0),Xb=!!Oa.morphAttributes.position,Uc=!!Oa.morphAttributes.normal,qc=!!Oa.morphAttributes.color;let kd=0;!Ka.toneMapped||ja!==null&&ja.isXRRenderTarget!==!0||(kd=sb.toneMapping);var wb=Oa.morphAttributes.position||Oa.morphAttributes.normal||Oa.morphAttributes.color;const Yj=wb!==void 0?wb.length:0;wb=Pb.get(Ka);const Zj=ob.state.lights;wc!==!0||zf!==!0&&ia===la||Fd.setState(Ka,ia,ia===la&&Ka.id===ha);let tc=!1;Ka.version===wb.__version?wb.needsLights&&wb.lightsStateVersion!==
Zj.state.version?tc=!0:wb.outputColorSpace!==mc?tc=!0:va.isBatchedMesh&&wb.batching===!1?tc=!0:va.isBatchedMesh||wb.batching!==!0?va.isBatchedMesh&&wb.batchingColor===!0&&va.colorTexture===null?tc=!0:va.isBatchedMesh&&wb.batchingColor===!1&&va.colorTexture!==null?tc=!0:va.isInstancedMesh&&wb.instancing===!1?tc=!0:va.isInstancedMesh||wb.instancing!==!0?va.isSkinnedMesh&&wb.skinning===!1?tc=!0:va.isSkinnedMesh||wb.skinning!==!0?va.isInstancedMesh&&wb.instancingColor===!0&&va.instanceColor===null?tc=
!0:va.isInstancedMesh&&wb.instancingColor===!1&&va.instanceColor!==null?tc=!0:va.isInstancedMesh&&wb.instancingMorph===!0&&va.morphTexture===null?tc=!0:va.isInstancedMesh&&wb.instancingMorph===!1&&va.morphTexture!==null?tc=!0:wb.envMap!==Zb?tc=!0:Ka.fog===!0&&wb.fog!==Fa?tc=!0:wb.numClippingPlanes===void 0||wb.numClippingPlanes===Fd.numPlanes&&wb.numIntersection===Fd.numIntersection?wb.vertexAlphas!==Hb?tc=!0:wb.vertexTangents!==Sb?tc=!0:wb.morphTargets!==Xb?tc=!0:wb.morphNormals!==Uc?tc=!0:wb.morphColors!==
qc?tc=!0:wb.toneMapping!==kd?tc=!0:wb.morphTargetsCount!==Yj&&(tc=!0):tc=!0:tc=!0:tc=!0:tc=!0:(tc=!0,wb.__version=Ka.version);mc=wb.currentProgram;tc===!0&&(mc=da(Ka,ib,va));Uc=Xb=qc=!1;Hb=mc.getUniforms();Sb=wb.uniforms;Ob.useProgram(mc.program)&&(Uc=Xb=qc=!0);Ka.id!==ha&&(ha=Ka.id,Xb=!0);if(qc||la!==ia)Ob.buffers.depth.getReversed()&&ia.reversedDepth!==!0&&(ia._reversedDepth=!0,ia.updateProjectionMatrix()),Hb.setValue(za,"projectionMatrix",ia.projectionMatrix),Hb.setValue(za,"viewMatrix",ia.matrixWorldInverse),
qc=Hb.map.cameraPosition,qc!==void 0&&qc.setValue(za,ch.setFromMatrixPosition(ia.matrixWorld)),Xc.logarithmicDepthBuffer&&Hb.setValue(za,"logDepthBufFC",2/(Math.log(ia.far+1)/Math.LN2)),(Ka.isMeshPhongMaterial||Ka.isMeshToonMaterial||Ka.isMeshLambertMaterial||Ka.isMeshBasicMaterial||Ka.isMeshStandardMaterial||Ka.isShaderMaterial)&&Hb.setValue(za,"isOrthographic",ia.isOrthographicCamera===!0),la!==ia&&(la=ia,Uc=Xb=!0);va.isSkinnedMesh&&(Hb.setOptional(za,va,"bindMatrix"),Hb.setOptional(za,va,"bindMatrixInverse"),
qc=va.skeleton)&&(qc.boneTexture===null&&qc.computeBoneTexture(),Hb.setValue(za,"boneTexture",qc.boneTexture,lc));va.isBatchedMesh&&(Hb.setOptional(za,va,"batchingTexture"),Hb.setValue(za,"batchingTexture",va._matricesTexture,lc),Hb.setOptional(za,va,"batchingIdTexture"),Hb.setValue(za,"batchingIdTexture",va._indirectTexture,lc),Hb.setOptional(za,va,"batchingColorTexture"),va._colorsTexture!==null&&Hb.setValue(za,"batchingColorTexture",va._colorsTexture,lc));qc=Oa.morphAttributes;qc.position===void 0&&
qc.normal===void 0&&qc.color===void 0||km.update(va,Oa,mc);if(Xb||wb.receiveShadow!==va.receiveShadow)wb.receiveShadow=va.receiveShadow,Hb.setValue(za,"receiveShadow",va.receiveShadow);Ka.isMeshGouraudMaterial&&Ka.envMap!==null&&(Sb.envMap.value=Zb,Sb.flipEnvMap.value=Zb.isCubeTexture&&Zb.isRenderTargetTexture===!1?-1:1);Ka.isMeshStandardMaterial&&Ka.envMap===null&&ib.environment!==null&&(Sb.envMapIntensity.value=ib.environmentIntensity);Xb&&(Hb.setValue(za,"toneMappingExposure",sb.toneMappingExposure),
wb.needsLights&&(ib=Uc,Sb.ambientLightColor.needsUpdate=ib,Sb.lightProbe.needsUpdate=ib,Sb.directionalLights.needsUpdate=ib,Sb.directionalLightShadows.needsUpdate=ib,Sb.pointLights.needsUpdate=ib,Sb.pointLightShadows.needsUpdate=ib,Sb.spotLights.needsUpdate=ib,Sb.spotLightShadows.needsUpdate=ib,Sb.rectAreaLights.needsUpdate=ib,Sb.hemisphereLights.needsUpdate=ib),Fa&&Ka.fog===!0&&Xj.refreshFogUniforms(Sb,Fa),Xj.refreshMaterialUniforms(Sb,Ka,Ta,Ma,ob.state.transmissionRenderTarget[ia.id]),ah.upload(za,
U(wb),Sb,lc));Ka.isShaderMaterial&&Ka.uniformsNeedUpdate===!0&&(ah.upload(za,U(wb),Sb,lc),Ka.uniformsNeedUpdate=!1);Ka.isSpriteMaterial&&Hb.setValue(za,"center",va.center);Hb.setValue(za,"modelViewMatrix",va.modelViewMatrix);Hb.setValue(za,"normalMatrix",va.normalMatrix);Hb.setValue(za,"modelMatrix",va.matrixWorld);if(Ka.isShaderMaterial||Ka.isRawShaderMaterial){ia=Ka.uniformsGroups;for(let Og=0,ak=ia.length;Og<ak;Og++)Fa=ia[Og],Zh.update(Fa,mc),Zh.bind(Fa,mc)}Fa=mc;Ob.setMaterial(Ka,db);db=Oa.index;
ib=1;if(Ka.wireframe===!0){db=Wj.getWireframeAttribute(Oa);if(db===void 0)return;ib=2}wb=Oa.drawRange;Zb=Oa.attributes.position;ia=wb.start*ib;wb=(wb.start+wb.count)*ib;bb!==null&&(ia=Math.max(ia,bb.start*ib),wb=Math.min(wb,(bb.start+bb.count)*ib));db!==null?(ia=Math.max(ia,0),wb=Math.min(wb,db.count)):Zb!==void 0&&Zb!==null&&(ia=Math.max(ia,0),wb=Math.min(wb,Zb.count));ib=wb-ia;if(!(ib<0||ib===Infinity))if(nf.setup(va,Ka,Fa,Oa,db),bb=lm,db!==null&&(Fa=ag.get(db),bb=mm,bb.setIndex(Fa)),va.isMesh?
Ka.wireframe===!0?(Ob.setLineWidth(Ka.wireframeLinewidth*(ja===null?Ta:1)),bb.setMode(za.LINES)):bb.setMode(za.TRIANGLES):va.isLine?(Fa=Ka.linewidth,Fa===void 0&&(Fa=1),Ob.setLineWidth(Fa*(ja===null?Ta:1)),va.isLineSegments?bb.setMode(za.LINES):va.isLineLoop?bb.setMode(za.LINE_LOOP):bb.setMode(za.LINE_STRIP)):va.isPoints?bb.setMode(za.POINTS):va.isSprite&&bb.setMode(za.TRIANGLES),va.isBatchedMesh)if(va._multiDrawInstances!==null)t("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),
bb.renderMultiDrawInstances(va._multiDrawStarts,va._multiDrawCounts,va._multiDrawCount,va._multiDrawInstances);else if(Lc.get("WEBGL_multi_draw"))bb.renderMultiDraw(va._multiDrawStarts,va._multiDrawCounts,va._multiDrawCount);else for(Oa=va._multiDrawStarts,ia=va._multiDrawCounts,va=va._multiDrawCount,db=db?ag.get(db).bytesPerElement:1,Ka=Pb.get(Ka).currentProgram.getUniforms(),Fa=0;Fa<va;Fa++)Ka.setValue(za,"_gl_DrawID",Fa),bb.render(Oa[Fa]/db,ia[Fa]);else va.isInstancedMesh?bb.renderInstances(ia,
ib,va.count):Oa.isInstancedBufferGeometry?bb.renderInstances(ia,ib,Math.min(Oa.instanceCount,Oa._maxInstanceCount!==void 0?Oa._maxInstanceCount:Infinity)):bb.render(ia,ib)};this.compile=function(ia,Fa,Oa=null){Oa===null&&(Oa=ia);ob=Yh.get(Oa);ob.init(Fa);Cb.push(ob);Oa.traverseVisible(function(va){va.isLight&&va.layers.test(Fa.layers)&&(ob.pushLight(va),va.castShadow&&ob.pushShadow(va))});ia!==Oa&&ia.traverseVisible(function(va){va.isLight&&va.layers.test(Fa.layers)&&(ob.pushLight(va),va.castShadow&&
ob.pushShadow(va))});ob.setupLights();const Ka=new Set;ia.traverse(function(va){if(va.isMesh||va.isPoints||va.isLine||va.isSprite){var bb=va.material;if(bb)if(Array.isArray(bb))for(let db=0;db<bb.length;db++){const ib=bb[db];F(ib,Oa,va);Ka.add(ib)}else F(bb,Oa,va),Ka.add(bb)}});ob=Cb.pop();return Ka};this.compileAsync=function(ia,Fa,Oa=null){const Ka=this.compile(ia,Fa,Oa);return new Promise(va=>{function bb(){Ka.forEach(function(db){Pb.get(db).currentProgram.isReady()&&Ka.delete(db)});Ka.size===
0?va(ia):setTimeout(bb,10)}Lc.get("KHR_parallel_shader_compile")!==null?bb():setTimeout(bb,10)})};let bk=null;const of=new Sd;of.setAnimationLoop(function(ia){bk&&bk(ia)});typeof self!=="undefined"&&of.setContext(self);this.setAnimationLoop=function(ia){bk=ia;Vc.setAnimationLoop(ia);ia===null?of.stop():of.start()};Vc.addEventListener("sessionstart",H);Vc.addEventListener("sessionend",M);this.render=function(ia,Fa){if(Fa!==void 0&&Fa.isCamera!==!0)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
else if(Mb!==!0){ia.matrixWorldAutoUpdate===!0&&ia.updateMatrixWorld();Fa.parent===null&&Fa.matrixWorldAutoUpdate===!0&&Fa.updateMatrixWorld();Vc.enabled===!0&&Vc.isPresenting===!0&&(Vc.cameraAutoUpdate===!0&&Vc.updateCamera(Fa),Fa=Vc.getCamera());if(ia.isScene===!0)ia.onBeforeRender(sb,ia,Fa,ja);ob=Yh.get(ia,Cb.length);ob.init(Fa);Cb.push(ob);Xe.multiplyMatrices(Fa.projectionMatrix,Fa.matrixWorldInverse);Nb.setFromProjectionMatrix(Xe,2E3,Fa.reversedDepth);zf=this.localClippingEnabled;wc=Fd.init(this.clippingPlanes,
zf);nb=Xh.get(ia,ub.length);nb.init();ub.push(nb);if(Vc.enabled===!0&&Vc.isPresenting===!0){var Oa=sb.xr.getDepthSensingMesh();Oa!==null&&R(Oa,Fa,-Infinity,sb.sortObjects)}R(ia,Fa,0,sb.sortObjects);nb.finish();sb.sortObjects===!0&&nb.sort(Sa,$a);(Ye=Vc.enabled===!1||Vc.isPresenting===!1||Vc.hasDepthSensing()===!1)&&Gd.addToRenderList(nb,ia);this.info.render.frame++;wc===!0&&Fd.beginShadows();Pd.render(ob.state.shadowsArray,ia,Fa);wc===!0&&Fd.endShadows();this.info.autoReset===!0&&this.info.reset();
var Ka=nb.opaque,va=nb.transmissive;ob.setupLights();if(Fa.isArrayCamera){Oa=Fa.cameras;if(va.length>0)for(let bb=0,db=Oa.length;bb<db;bb++)X(Ka,va,ia,Oa[bb]);Ye&&Gd.render(ia);for(let bb=0,db=Oa.length;bb<db;bb++)Ka=Oa[bb],T(nb,ia,Ka,Ka.viewport)}else va.length>0&&X(Ka,va,ia,Fa),Ye&&Gd.render(ia),T(nb,ia,Fa);ja!==null&&hb===0&&(lc.updateMultisampleRenderTarget(ja),lc.updateRenderTargetMipmap(ja));if(ia.isScene===!0)ia.onAfterRender(sb,ia,Fa);nf.resetDefaultState();ha=-1;la=null;Cb.pop();Cb.length>
0?(ob=Cb[Cb.length-1],wc===!0&&Fd.setGlobalState(sb.clippingPlanes,ob.state.camera)):ob=null;ub.pop();nb=ub.length>0?ub[ub.length-1]:null}};this.getActiveCubeFace=function(){return Wa};this.getActiveMipmapLevel=function(){return hb};this.getRenderTarget=function(){return ja};this.setRenderTargetTextures=function(ia,Fa,Oa){const Ka=Pb.get(ia);Ka.__autoAllocateDepthBuffer=ia.resolveDepthBuffer===!1;Ka.__autoAllocateDepthBuffer===!1&&(Ka.__useRenderToTexture=!1);Pb.get(ia.texture).__webglTexture=Fa;
Pb.get(ia.depthTexture).__webglTexture=Ka.__autoAllocateDepthBuffer?void 0:Oa;Ka.__hasExternalTextures=!0};this.setRenderTargetFramebuffer=function(ia,Fa){ia=Pb.get(ia);ia.__webglFramebuffer=Fa;ia.__useDefaultFramebuffer=Fa===void 0};const vo=za.createFramebuffer();this.setRenderTarget=function(ia,Fa=0,Oa=0){ja=ia;Wa=Fa;hb=Oa;var Ka=!0,va=null,bb=!1;let db=!1;if(ia){va=Pb.get(ia);if(va.__useDefaultFramebuffer!==void 0)Ob.bindFramebuffer(za.FRAMEBUFFER,null),Ka=!1;else if(va.__webglFramebuffer===void 0)lc.setupRenderTarget(ia);
else if(va.__hasExternalTextures)lc.rebindTextures(ia,Pb.get(ia.texture).__webglTexture,Pb.get(ia.depthTexture).__webglTexture);else if(ia.depthBuffer){const ib=ia.depthTexture;if(va.__boundDepthTexture!==ib){if(ib!==null&&Pb.has(ib)&&(ia.width!==ib.image.width||ia.height!==ib.image.height))throw Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");lc.setupDepthRenderbuffer(ia)}}va=ia.texture;if(va.isData3DTexture||va.isDataArrayTexture||va.isCompressedArrayTexture)db=
!0;va=Pb.get(ia).__webglFramebuffer;ia.isWebGLCubeRenderTarget?(va=Array.isArray(va[Fa])?va[Fa][Oa]:va[Fa],bb=!0):va=ia.samples>0&&lc.useMultisampledRTT(ia)===!1?Pb.get(ia).__webglMultisampledFramebuffer:Array.isArray(va)?va[Oa]:va;ta.copy(ia.viewport);ua.copy(ia.scissor);Pa=ia.scissorTest}else ta.copy(Jb).multiplyScalar(Ta).floor(),ua.copy(Kb).multiplyScalar(Ta).floor(),Pa=Fb;Oa!==0&&(va=vo);Ob.bindFramebuffer(za.FRAMEBUFFER,va)&&Ka&&Ob.drawBuffers(ia,va);Ob.viewport(ta);Ob.scissor(ua);Ob.setScissorTest(Pa);
if(bb)ia=Pb.get(ia.texture),za.framebufferTexture2D(za.FRAMEBUFFER,za.COLOR_ATTACHMENT0,za.TEXTURE_CUBE_MAP_POSITIVE_X+Fa,ia.__webglTexture,Oa);else if(db)for(Ka=0;Ka<ia.textures.length;Ka++)bb=Pb.get(ia.textures[Ka]),za.framebufferTextureLayer(za.FRAMEBUFFER,za.COLOR_ATTACHMENT0+Ka,bb.__webglTexture,Oa,Fa);else ia!==null&&Oa!==0&&(Fa=Pb.get(ia.texture),za.framebufferTexture2D(za.FRAMEBUFFER,za.COLOR_ATTACHMENT0,za.TEXTURE_2D,Fa.__webglTexture,Oa));ha=-1};this.readRenderTargetPixels=function(ia,Fa,
Oa,Ka,va,bb,db,ib=0){if(ia&&ia.isWebGLRenderTarget){var Zb=Pb.get(ia).__webglFramebuffer;ia.isWebGLCubeRenderTarget&&db!==void 0&&(Zb=Zb[db]);if(Zb){Ob.bindFramebuffer(za.FRAMEBUFFER,Zb);try{const mc=ia.textures[ib],Hb=mc.format,Sb=mc.type;Xc.textureFormatReadable(Hb)?Xc.textureTypeReadable(Sb)?Fa>=0&&Fa<=ia.width-Ka&&Oa>=0&&Oa<=ia.height-va&&(ia.textures.length>1&&za.readBuffer(za.COLOR_ATTACHMENT0+ib),za.readPixels(Fa,Oa,Ka,va,qe.convert(Hb),qe.convert(Sb),bb)):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type."):
console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.")}finally{ia=ja!==null?Pb.get(ja).__webglFramebuffer:null,Ob.bindFramebuffer(za.FRAMEBUFFER,ia)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};this.readRenderTargetPixelsAsync=async function(ia,Fa,Oa,Ka,va,bb,db,ib=0){if(!ia||!ia.isWebGLRenderTarget)throw Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");
var Zb=Pb.get(ia).__webglFramebuffer;ia.isWebGLCubeRenderTarget&&db!==void 0&&(Zb=Zb[db]);if(Zb){if(Fa>=0&&Fa<=ia.width-Ka&&Oa>=0&&Oa<=ia.height-va){Ob.bindFramebuffer(za.FRAMEBUFFER,Zb);db=ia.textures[ib];Zb=db.format;const mc=db.type;if(!Xc.textureFormatReadable(Zb))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Xc.textureTypeReadable(mc))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");
db=za.createBuffer();za.bindBuffer(za.PIXEL_PACK_BUFFER,db);za.bufferData(za.PIXEL_PACK_BUFFER,bb.byteLength,za.STREAM_READ);ia.textures.length>1&&za.readBuffer(za.COLOR_ATTACHMENT0+ib);za.readPixels(Fa,Oa,Ka,va,qe.convert(Zb),qe.convert(mc),0);ia=ja!==null?Pb.get(ja).__webglFramebuffer:null;Ob.bindFramebuffer(za.FRAMEBUFFER,ia);ia=za.fenceSync(za.SYNC_GPU_COMMANDS_COMPLETE,0);za.flush();await v(za,ia,4);za.bindBuffer(za.PIXEL_PACK_BUFFER,db);za.getBufferSubData(za.PIXEL_PACK_BUFFER,0,bb);za.deleteBuffer(db);
za.deleteSync(ia);return bb}throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.");}};this.copyFramebufferToTexture=function(ia,Fa=null,Oa=0){var Ka=Math.pow(2,-Oa);const va=Math.floor(ia.image.width*Ka);Ka=Math.floor(ia.image.height*Ka);const bb=Fa!==null?Fa.x:0;Fa=Fa!==null?Fa.y:0;lc.setTexture2D(ia,0);za.copyTexSubImage2D(za.TEXTURE_2D,Oa,0,0,bb,Fa,va,Ka);Ob.unbindTexture()};const wo=za.createFramebuffer(),xo=za.createFramebuffer();this.copyTextureToTexture=
function(ia,Fa,Oa=null,Ka=null,va=0,bb=null){bb===null&&(va!==0?(t("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),bb=va,va=0):bb=0);let db,ib;let Zb,mc,Hb,Sb;var Xb=ia.isCompressedTexture?ia.mipmaps[bb]:ia.image;if(Oa!==null){db=Oa.max.x-Oa.min.x;ib=Oa.max.y-Oa.min.y;var Uc=Oa.isBox3?Oa.max.z-Oa.min.z:1;Zb=Oa.min.x;mc=Oa.min.y;Oa=Oa.isBox3?Oa.min.z:0}else Uc=Math.pow(2,-va),db=Math.floor(Xb.width*Uc),ib=Math.floor(Xb.height*Uc),Uc=ia.isDataArrayTexture?
Xb.depth:ia.isData3DTexture?Math.floor(Xb.depth*Uc):1,Oa=mc=Zb=0;Ka!==null?(Hb=Ka.x,Sb=Ka.y,Ka=Ka.z):Ka=Sb=Hb=0;var qc=qe.convert(Fa.format);const kd=qe.convert(Fa.type);let wb;Fa.isData3DTexture?(lc.setTexture3D(Fa,0),wb=za.TEXTURE_3D):Fa.isDataArrayTexture||Fa.isCompressedArrayTexture?(lc.setTexture2DArray(Fa,0),wb=za.TEXTURE_2D_ARRAY):(lc.setTexture2D(Fa,0),wb=za.TEXTURE_2D);za.pixelStorei(za.UNPACK_FLIP_Y_WEBGL,Fa.flipY);za.pixelStorei(za.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Fa.premultiplyAlpha);za.pixelStorei(za.UNPACK_ALIGNMENT,
Fa.unpackAlignment);const Yj=za.getParameter(za.UNPACK_ROW_LENGTH),Zj=za.getParameter(za.UNPACK_IMAGE_HEIGHT),tc=za.getParameter(za.UNPACK_SKIP_PIXELS),Og=za.getParameter(za.UNPACK_SKIP_ROWS),ak=za.getParameter(za.UNPACK_SKIP_IMAGES);za.pixelStorei(za.UNPACK_ROW_LENGTH,Xb.width);za.pixelStorei(za.UNPACK_IMAGE_HEIGHT,Xb.height);za.pixelStorei(za.UNPACK_SKIP_PIXELS,Zb);za.pixelStorei(za.UNPACK_SKIP_ROWS,mc);za.pixelStorei(za.UNPACK_SKIP_IMAGES,Oa);const nm=ia.isDataArrayTexture||ia.isData3DTexture;
var pf=Fa.isDataArrayTexture||Fa.isData3DTexture;if(ia.isDepthTexture){pf=Pb.get(ia);Xb=Pb.get(Fa);pf=Pb.get(pf.__renderTarget);Xb=Pb.get(Xb.__renderTarget);Ob.bindFramebuffer(za.READ_FRAMEBUFFER,pf.__webglFramebuffer);Ob.bindFramebuffer(za.DRAW_FRAMEBUFFER,Xb.__webglFramebuffer);for(Xb=0;Xb<Uc;Xb++)nm&&(za.framebufferTextureLayer(za.READ_FRAMEBUFFER,za.COLOR_ATTACHMENT0,Pb.get(ia).__webglTexture,va,Oa+Xb),za.framebufferTextureLayer(za.DRAW_FRAMEBUFFER,za.COLOR_ATTACHMENT0,Pb.get(Fa).__webglTexture,
bb,Ka+Xb)),za.blitFramebuffer(Zb,mc,db,ib,Hb,Sb,db,ib,za.DEPTH_BUFFER_BIT,za.NEAREST);Ob.bindFramebuffer(za.READ_FRAMEBUFFER,null);Ob.bindFramebuffer(za.DRAW_FRAMEBUFFER,null)}else if(va!==0||ia.isRenderTargetTexture||Pb.has(ia)){ia=Pb.get(ia);Xb=Pb.get(Fa);Ob.bindFramebuffer(za.READ_FRAMEBUFFER,wo);Ob.bindFramebuffer(za.DRAW_FRAMEBUFFER,xo);for(qc=0;qc<Uc;qc++)nm?za.framebufferTextureLayer(za.READ_FRAMEBUFFER,za.COLOR_ATTACHMENT0,ia.__webglTexture,va,Oa+qc):za.framebufferTexture2D(za.READ_FRAMEBUFFER,
za.COLOR_ATTACHMENT0,za.TEXTURE_2D,ia.__webglTexture,va),pf?za.framebufferTextureLayer(za.DRAW_FRAMEBUFFER,za.COLOR_ATTACHMENT0,Xb.__webglTexture,bb,Ka+qc):za.framebufferTexture2D(za.DRAW_FRAMEBUFFER,za.COLOR_ATTACHMENT0,za.TEXTURE_2D,Xb.__webglTexture,bb),va!==0?za.blitFramebuffer(Zb,mc,db,ib,Hb,Sb,db,ib,za.COLOR_BUFFER_BIT,za.NEAREST):pf?za.copyTexSubImage3D(wb,bb,Hb,Sb,Ka+qc,Zb,mc,db,ib):za.copyTexSubImage2D(wb,bb,Hb,Sb,Zb,mc,db,ib);Ob.bindFramebuffer(za.READ_FRAMEBUFFER,null);Ob.bindFramebuffer(za.DRAW_FRAMEBUFFER,
null)}else pf?ia.isDataTexture||ia.isData3DTexture?za.texSubImage3D(wb,bb,Hb,Sb,Ka,db,ib,Uc,qc,kd,Xb.data):Fa.isCompressedArrayTexture?za.compressedTexSubImage3D(wb,bb,Hb,Sb,Ka,db,ib,Uc,qc,Xb.data):za.texSubImage3D(wb,bb,Hb,Sb,Ka,db,ib,Uc,qc,kd,Xb):ia.isDataTexture?za.texSubImage2D(za.TEXTURE_2D,bb,Hb,Sb,db,ib,qc,kd,Xb.data):ia.isCompressedTexture?za.compressedTexSubImage2D(za.TEXTURE_2D,bb,Hb,Sb,Xb.width,Xb.height,qc,Xb.data):za.texSubImage2D(za.TEXTURE_2D,bb,Hb,Sb,db,ib,qc,kd,Xb);za.pixelStorei(za.UNPACK_ROW_LENGTH,
Yj);za.pixelStorei(za.UNPACK_IMAGE_HEIGHT,Zj);za.pixelStorei(za.UNPACK_SKIP_PIXELS,tc);za.pixelStorei(za.UNPACK_SKIP_ROWS,Og);za.pixelStorei(za.UNPACK_SKIP_IMAGES,ak);bb===0&&Fa.generateMipmaps&&za.generateMipmap(wb);Ob.unbindTexture()};this.initRenderTarget=function(ia){Pb.get(ia).__webglFramebuffer===void 0&&lc.setupRenderTarget(ia)};this.initTexture=function(ia){ia.isCubeTexture?lc.setTextureCube(ia,0):ia.isData3DTexture?lc.setTexture3D(ia,0):ia.isDataArrayTexture||ia.isCompressedArrayTexture?
lc.setTexture2DArray(ia,0):lc.setTexture2D(ia,0);Ob.unbindTexture()};this.resetState=function(){hb=Wa=0;ja=null;Ob.reset();nf.reset()};typeof __THREE_DEVTOOLS__!=="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return 2E3}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(a){this._outputColorSpace=a;const b=this.getContext();b.drawingBufferColorSpace=$b._getDrawingBufferColorSpace(a);b.unpackColorSpace=$b._getUnpackColorSpace()}}
q.ACESFilmicToneMapping=4;q.AddEquation=100;q.AddOperation=2;q.AdditiveAnimationBlendMode=2501;q.AdditiveBlending=2;q.AgXToneMapping=6;q.AlphaFormat=1021;q.AlwaysCompare=519;q.AlwaysDepth=1;q.AlwaysStencilFunc=519;q.AmbientLight=Hl;q.AnimationAction=Wl;q.AnimationClip=Lg;q.AnimationLoader=en;q.AnimationMixer=Hn;q.AnimationObjectGroup=Fn;q.AnimationUtils=cn;q.ArcCurve=gl;q.ArrayCamera=Rl;q.ArrowHelper=ho;q.AttachedBindMode="attached";q.Audio=Tl;q.AudioAnalyser=wn;q.AudioContext=Lj;q.AudioListener=
tn;q.AudioLoader=qn;q.AxesHelper=io;q.BackSide=1;q.BasicDepthPacking=3200;q.BasicShadowMap=0;q.BatchedMesh=Yk;q.Bone=$i;q.BooleanKeyframeTrack=Ve;q.Box2=Rn;q.Box3=Sc;q.Box3Helper=fo;q.BoxGeometry=xf;q.BoxHelper=eo;q.BufferAttribute=sc;q.BufferGeometry=Vb;q.BufferGeometryLoader=Ml;q.ByteType=1010;q.Cache=ee;q.Camera=sh;q.CameraHelper=co;q.CanvasTexture=$m;q.CapsuleGeometry=hj;q.CatmullRomCurve3=hl;q.CineonToneMapping=3;q.CircleGeometry=ij;q.ClampToEdgeWrapping=1001;q.Clock=Sl;q.Color=pb;q.ColorKeyframeTrack=
bi;q.ColorManagement=$b;q.CompressedArrayTexture=Ym;q.CompressedCubeTexture=Zm;q.CompressedTexture=Eh;q.CompressedTextureLoader=fn;q.ConeGeometry=Gh;q.ConstantAlphaFactor=213;q.ConstantColorFactor=211;q.Controls=ko;q.CubeCamera=Fk;q.CubeReflectionMapping=301;q.CubeRefractionMapping=302;q.CubeTexture=Bg;q.CubeTextureLoader=gn;q.CubeUVReflectionMapping=306;q.CubicBezierCurve=oj;q.CubicBezierCurve3=il;q.CubicInterpolant=wl;q.CullFaceBack=1;q.CullFaceFront=2;q.CullFaceFrontBack=3;q.CullFaceNone=0;q.Curve=
Od;q.CurvePath=kl;q.CustomBlending=5;q.CustomToneMapping=5;q.CylinderGeometry=Fh;q.Cylindrical=Qn;q.Data3DTexture=Cf;q.DataArrayTexture=yf;q.DataTexture=$d;q.DataTextureLoader=hn;q.DataUtils=Cm;q.DecrementStencilOp=7683;q.DecrementWrapStencilOp=34056;q.DefaultLoadingManager=zl;q.DepthFormat=1026;q.DepthStencilFormat=1027;q.DepthTexture=fj;q.DetachedBindMode="detached";q.DirectionalLight=Gl;q.DirectionalLightHelper=bo;q.DiscreteInterpolant=xl;q.DodecahedronGeometry=jj;q.DoubleSide=2;q.DstAlphaFactor=
206;q.DstColorFactor=208;q.DynamicCopyUsage=35050;q.DynamicDrawUsage=35048;q.DynamicReadUsage=35049;q.EdgesGeometry=fl;q.EllipseCurve=Kh;q.EqualCompare=514;q.EqualDepth=4;q.EqualStencilFunc=514;q.EquirectangularReflectionMapping=303;q.EquirectangularRefractionMapping=304;q.Euler=Cd;q.EventDispatcher=Bd;q.ExternalTexture=gj;q.ExtrudeGeometry=tj;q.FileLoader=pe;q.Float16BufferAttribute=Jm;q.Float32BufferAttribute=vb;q.FloatType=1015;q.Fog=Vi;q.FogExp2=Ui;q.FramebufferTexture=Xm;q.FrontSide=0;q.Frustum=
Bf;q.FrustumArray=cj;q.GLBufferAttribute=Mn;q.GLSL1="100";q.GLSL3="300 es";q.GreaterCompare=516;q.GreaterDepth=6;q.GreaterEqualCompare=518;q.GreaterEqualDepth=5;q.GreaterEqualStencilFunc=518;q.GreaterStencilFunc=516;q.GridHelper=$n;q.Group=Of;q.HalfFloatType=1016;q.HemisphereLight=Al;q.HemisphereLightHelper=Zn;q.IcosahedronGeometry=uj;q.ImageBitmapLoader=pn;q.ImageLoader=Mg;q.ImageUtils=Qg;q.IncrementStencilOp=7682;q.IncrementWrapStencilOp=34055;q.InstancedBufferAttribute=Tf;q.InstancedBufferGeometry=
Ll;q.InstancedInterleavedBuffer=Ln;q.InstancedMesh=Vk;q.Int16BufferAttribute=Hm;q.Int32BufferAttribute=Im;q.Int8BufferAttribute=Em;q.IntType=1013;q.InterleavedBuffer=uh;q.InterleavedBufferAttribute=Pf;q.Interpolant=Kg;q.InterpolateDiscrete=2300;q.InterpolateLinear=2301;q.InterpolateSmooth=2302;q.InterpolationSamplingMode={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};q.InterpolationSamplingType={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"};q.InvertStencilOp=
5386;q.KeepStencilOp=7680;q.KeyframeTrack=Ed;q.LOD=Lk;q.LatheGeometry=vj;q.Layers=bh;q.LessCompare=513;q.LessDepth=2;q.LessEqualCompare=515;q.LessEqualDepth=3;q.LessEqualStencilFunc=515;q.LessStencilFunc=513;q.Light=Ke;q.LightProbe=Kl;q.Line=Je;q.Line3=Un;q.LineBasicMaterial=jd;q.LineCurve=pj;q.LineCurve3=jl;q.LineDashedMaterial=vl;q.LineLoop=bl;q.LineSegments=ce;q.LinearFilter=1006;q.LinearInterpolant=Dj;q.LinearMipMapLinearFilter=1008;q.LinearMipMapNearestFilter=1007;q.LinearMipmapLinearFilter=
1008;q.LinearMipmapNearestFilter=1007;q.LinearSRGBColorSpace="srgb-linear";q.LinearToneMapping=1;q.LinearTransfer="linear";q.Loader=pd;q.LoaderUtils=Jj;q.LoadingManager=Ej;q.LoopOnce=2200;q.LoopPingPong=2202;q.LoopRepeat=2201;q.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2};q.Material=fd;q.MaterialLoader=Ij;q.MathUtils=Ci;q.Matrix2=Zl;q.Matrix3=Lb;q.Matrix4=Gb;q.MaxEquation=104;q.Mesh=Kc;q.MeshBasicMaterial=He;q.MeshDepthMaterial=wi;q.MeshDistanceMaterial=xi;q.MeshLambertMaterial=tl;q.MeshMatcapMaterial=
ul;q.MeshNormalMaterial=sl;q.MeshPhongMaterial=ql;q.MeshPhysicalMaterial=pl;q.MeshStandardMaterial=Cj;q.MeshToonMaterial=rl;q.MinEquation=103;q.MirroredRepeatWrapping=1002;q.MixOperation=1;q.MultiplyBlending=4;q.MultiplyOperation=0;q.NearestFilter=1003;q.NearestMipMapLinearFilter=1005;q.NearestMipMapNearestFilter=1004;q.NearestMipmapLinearFilter=1005;q.NearestMipmapNearestFilter=1004;q.NeutralToneMapping=7;q.NeverCompare=512;q.NeverDepth=0;q.NeverStencilFunc=512;q.NoBlending=0;q.NoColorSpace="";q.NoToneMapping=
0;q.NormalAnimationBlendMode=2500;q.NormalBlending=1;q.NotEqualCompare=517;q.NotEqualDepth=7;q.NotEqualStencilFunc=517;q.NumberKeyframeTrack=og;q.Object3D=jc;q.ObjectLoader=nn;q.ObjectSpaceNormalMap=1;q.OctahedronGeometry=Oh;q.OneFactor=201;q.OneMinusConstantAlphaFactor=214;q.OneMinusConstantColorFactor=212;q.OneMinusDstAlphaFactor=207;q.OneMinusDstColorFactor=209;q.OneMinusSrcAlphaFactor=205;q.OneMinusSrcColorFactor=203;q.OrthographicCamera=Qh;q.PCFShadowMap=1;q.PCFSoftShadowMap=2;q.PMREMGenerator=
ci;q.Path=Nh;q.PerspectiveCamera=Yc;q.Plane=xe;q.PlaneGeometry=rg;q.PlaneHelper=go;q.PointLight=Fl;q.PointLightHelper=Xn;q.Points=dl;q.PointsMaterial=ej;q.PolarGridHelper=ao;q.PolyhedronGeometry=df;q.PositionalAudio=vn;q.PropertyBinding=kc;q.PropertyMixer=Vl;q.QuadraticBezierCurve=qj;q.QuadraticBezierCurve3=rj;q.Quaternion=dd;q.QuaternionKeyframeTrack=qg;q.QuaternionLinearInterpolant=yl;q.RED_GREEN_RGTC2_Format=36285;q.RED_RGTC1_Format=36283;q.REVISION="180";q.RGBADepthPacking=3201;q.RGBAFormat=1023;
q.RGBAIntegerFormat=1033;q.RGBA_ASTC_10x10_Format=37819;q.RGBA_ASTC_10x5_Format=37816;q.RGBA_ASTC_10x6_Format=37817;q.RGBA_ASTC_10x8_Format=37818;q.RGBA_ASTC_12x10_Format=37820;q.RGBA_ASTC_12x12_Format=37821;q.RGBA_ASTC_4x4_Format=37808;q.RGBA_ASTC_5x4_Format=37809;q.RGBA_ASTC_5x5_Format=37810;q.RGBA_ASTC_6x5_Format=37811;q.RGBA_ASTC_6x6_Format=37812;q.RGBA_ASTC_8x5_Format=37813;q.RGBA_ASTC_8x6_Format=37814;q.RGBA_ASTC_8x8_Format=37815;q.RGBA_BPTC_Format=36492;q.RGBA_ETC2_EAC_Format=37496;q.RGBA_PVRTC_2BPPV1_Format=
35843;q.RGBA_PVRTC_4BPPV1_Format=35842;q.RGBA_S3TC_DXT1_Format=33777;q.RGBA_S3TC_DXT3_Format=33778;q.RGBA_S3TC_DXT5_Format=33779;q.RGBDepthPacking=3202;q.RGBFormat=1022;q.RGBIntegerFormat=1032;q.RGB_BPTC_SIGNED_Format=36494;q.RGB_BPTC_UNSIGNED_Format=36495;q.RGB_ETC1_Format=36196;q.RGB_ETC2_Format=37492;q.RGB_PVRTC_2BPPV1_Format=35841;q.RGB_PVRTC_4BPPV1_Format=35840;q.RGB_S3TC_DXT1_Format=33776;q.RGDepthPacking=3203;q.RGFormat=1030;q.RGIntegerFormat=1031;q.RawShaderMaterial=ol;q.Ray=Hf;q.Raycaster=
Nn;q.RectAreaLight=Il;q.RedFormat=1028;q.RedIntegerFormat=1029;q.ReinhardToneMapping=2;q.RenderTarget=wg;q.RenderTarget3D=In;q.RepeatWrapping=1E3;q.ReplaceStencilOp=7681;q.ReverseSubtractEquation=102;q.RingGeometry=wj;q.SIGNED_RED_GREEN_RGTC2_Format=36286;q.SIGNED_RED_RGTC1_Format=36284;q.SRGBColorSpace="srgb";q.SRGBTransfer="srgb";q.Scene=Gk;q.ShaderChunk=Ub;q.ShaderLib=Kd;q.ShaderMaterial=Jd;q.ShadowMaterial=nl;q.Shape=ef;q.ShapeGeometry=xj;q.ShapePath=jo;q.ShapeUtils=de;q.ShortType=1011;q.Skeleton=
aj;q.SkeletonHelper=Wn;q.SkinnedMesh=Rk;q.Source=Xd;q.Sphere=Qc;q.SphereGeometry=Ph;q.Spherical=Pn;q.SphericalHarmonics3=Jl;q.SplineCurve=sj;q.SpotLight=Dl;q.SpotLightHelper=Vn;q.Sprite=Jk;q.SpriteMaterial=Wi;q.SrcAlphaFactor=204;q.SrcAlphaSaturateFactor=210;q.SrcColorFactor=202;q.StaticCopyUsage=35046;q.StaticDrawUsage=35044;q.StaticReadUsage=35045;q.StereoCamera=rn;q.StreamCopyUsage=35042;q.StreamDrawUsage=35040;q.StreamReadUsage=35041;q.StringKeyframeTrack=We;q.SubtractEquation=101;q.SubtractiveBlending=
3;q.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};q.TangentSpaceNormalMap=0;q.TetrahedronGeometry=yj;q.Texture=Cc;q.TextureLoader=jn;q.TextureUtils=lo;q.Timer=On;q.TimestampQuery={COMPUTE:"compute",RENDER:"render"};q.TorusGeometry=zj;q.TorusKnotGeometry=Aj;q.Triangle=ud;q.TriangleFanDrawMode=2;q.TriangleStripDrawMode=1;q.TrianglesDrawMode=0;q.TubeGeometry=Bj;q.UVMapping=300;q.Uint16BufferAttribute=ei;q.Uint32BufferAttribute=di;q.Uint8BufferAttribute=Fm;q.Uint8ClampedBufferAttribute=Gm;q.Uniform=
Xl;q.UniformsGroup=Kn;q.UniformsLib=mb;q.UniformsUtils=rk;q.UnsignedByteType=1009;q.UnsignedInt101111Type=35899;q.UnsignedInt248Type=1020;q.UnsignedInt5999Type=35902;q.UnsignedIntType=1014;q.UnsignedShort4444Type=1017;q.UnsignedShort5551Type=1018;q.UnsignedShortType=1012;q.VSMShadowMap=3;q.Vector2=Xa;q.Vector3=ma;q.Vector4=ec;q.VectorKeyframeTrack=pg;q.VideoFrameTexture=Wm;q.VideoTexture=el;q.WebGL3DRenderTarget=Gi;q.WebGLArrayRenderTarget=Fi;q.WebGLCoordinateSystem=2E3;q.WebGLCubeRenderTarget=ek;
q.WebGLRenderTarget=zd;q.WebGLRenderer=uo;q.WebGLUtils=gh;q.WebGPUCoordinateSystem=2001;q.WebXRController=th;q.WireframeGeometry=ll;q.WrapAroundEnding=2402;q.ZeroCurvatureEnding=2400;q.ZeroFactor=200;q.ZeroSlopeEnding=2401;q.ZeroStencilOp=0;q.createCanvasElement=z};
shadow$provide[102]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Api:{enumerable:!0,get:function(){return x}}});class x{static apply(r){r.set=function(e){const g=this.options||{},f=Object.entries(e).reduce(function(k,[m,p]){g[m]!==p&&(k[m]=p);return k},{});this.options=Object.assign(g,f);this.trigger({type:"change",options:e,changes:f})};r.get=function(){return this.options};r.api=function(e,g){e||(e={});g&&Object.entries(e).forEach(function([f,k]){typeof k==="function"&&
(e[f]=(...m)=>k(...m,g))});e.set=this.set.bind(this);e.get=this.get.bind(this);return e}}}};
shadow$provide[103]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Binder:{enumerable:!0,get:function(){return r}}});var x=l(101);class r{static bind(e,g){return function(f,k){k.__binds||(k.__binds=[]);let m=e;Array.isArray(f)&&(m=f[0],f=f[1]);var p=/^([^.:]*(?:\.[^.:]+)*)?(?::(.*))?$/.exec(f);const z=p[1].split(/\./g),t=z.pop(),v=p[2]||t;p=z.shift();let y={this:k}[p]||g[p]||e[p]||m;for(;y&&(f=z.shift());)y=y[f];if(y&&(y.on||y.addEventListener)){const B=function(D){k[v]&&
k[v](D,e)};r._polyfill(y,["addEventListener","on"],function(D){y[D](t,B)});k.__binds.push({target:y,name:t,callback:B});return B}throw"Cannot bind '"+f+"' in "+this.__name;}}static unbind(){return function(e){e.__binds&&(e.__binds.forEach(function(g){r._polyfill(g.target,["removeEventListener","off"],function(f){g.target[f](g.name,g.callback)})}.bind(this)),e.__binds=[])}}static apply(e){e.trigger=r._trigger;e.triggerOnce=r._triggerOnce;e.hasEventListener=x.EventDispatcher.prototype.hasEventListener;
e.addEventListener=x.EventDispatcher.prototype.addEventListener;e.removeEventListener=x.EventDispatcher.prototype.removeEventListener;e.on=e.addEventListener;e.off=e.removeEventListener;e.dispatchEvent=e.trigger}static _triggerOnce(e){this.trigger(e);this._listeners&&delete this._listeners[e.type]}static _trigger(e){if(this._listeners!==void 0){var g=this._listeners[e.type];if(g!==void 0){g=g.slice();const f=g.length;e.target=this;for(let k=0;k<f;k++)g[k].call(this,e,this)}}}static _polyfill(e,g,
f){g.map(function(k){return e.method});g.length&&f(g[0])}}};
shadow$provide[104]=function(l,L,q){function x(g){return g&&typeof g.valueOf()==="string"}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Bootstrap:{enumerable:!0,get:function(){return e}}});L=l(102);l=l(103);const r=(g,f)=>{let k=0;for(const m of g){if(f(m,k,g)===!1)break;k++}};class e{static initClass(){this.Plugins={};this.Aliases={}}static registerPlugin(g,f){const k=function(m){e.Plugin.call(this,m);this.__name=g};k.prototype=Object.assign(new e.Plugin,f);this.Plugins[g]=k}static unregisterPlugin(g){delete this.Plugins[g]}static registerAlias(g,
f){this.Aliases[g]=f}static unregisterAlias(g){delete this.Aliases[g]}constructor(g){if(g){var f=[].slice.apply(arguments);g={};if(f[0]instanceof Node){const k=f[0];f=f.slice(1);g.element=k}x(f[0])?g.plugins=f:Array.isArray(f[0])?g.plugins=f[0]:f[0]&&(g=Object.assign({},f[0],g))}this.__options=Object.assign({},{init:!0,element:document.body,plugins:["core"],aliases:{},plugindb:e.Plugins||{},aliasdb:e.Aliases||{}},g||{});this.__destroyed=this.__inited=!1;this.__installed=[];f=this.__options.element;
f===""+f&&(f=document.querySelector(f));this.plugins={};this.element=f;this.trigger=this.trigger.bind(this);this.frame=this.frame.bind(this);this.events=["pre","update","render","post"].map(function(k){return{type:k}});this.__options.init&&this.init()}init(){this.__inited||(this.__inited=!0,this.install(this.__options.plugins))}destroy(){this.__inited&&!this.__destroyed&&(this.__destroyed=!0,this.trigger({type:"destroy"}),this.uninstall())}frame(){this.events.map(this.trigger)}resolve(g){function f(z,
t,v){if(v>=256)throw"Plug-in alias recursion detected.";z=z.filter(p);z.forEach(function(y){const B=m[y];B?t=t.concat(f(B,[],v+1)):t.push(y)});return t}g=Array.isArray(g)?g:[g];const k=this.__options,m=Object.assign({},k.aliasdb,k.aliases),p=function(z){z=z.split(":");if(!z[1])return!0;m[z[0]]=[z[1]];return!1};g=g.filter(p);Object.entries(m).forEach(function([z,t]){m[z]=Array.isArray(t)?t:[t]});return f(g,[],0)}install(g){g=Array.isArray(g)?g:[g];g=this.resolve(g);r(g,f=>this.__install(f));this.__ready()}uninstall(g){g&&
(g=Array.isArray(g)?g:[g],g=this.resolve(g));(g||this.__installed).reverse().forEach(f=>this.__uninstall(f))}__install(g){var f=this.__options.plugindb[g];if(!f)throw"[three.install] Cannot install. '"+g+"' is not registered.";if(this.plugins[g])return console.warn("[three.install] "+g+" is already installed.");f=new f(this.__options[g]||{},g);this.plugins[g]=f;g=f.install(this);this.__installed.push(f);this.trigger({type:"install",plugin:f});return g}__uninstall(g){const f=x(g)?this.plugins[g]:g;
f?(g=f.__name,f.uninstall(this),this.__installed=this.__installed.filter(k=>k!==f),delete this.plugins[g],this.trigger({type:"uninstall",plugin:f})):console.warn("[three.uninstall] "+g+"' is not installed.")}__ready(){this.triggerOnce({type:"ready"})}}e.initClass();e.Plugin=function(g){this.options=Object.assign({},this.defaults,g||{})};e.Plugin.prototype={listen:[],defaults:{},install:function(g){},uninstall:function(g){}};l.Binder.apply(e.prototype);l.Binder.apply(e.Plugin.prototype);L.Api.apply(e.Plugin.prototype)};
shadow$provide[105]=function(l,L,q){l(104).Bootstrap.registerPlugin("splash",{defaults:{color:"mono",fancy:!0},listen:["ready","mathbox/init:init","mathbox/progress:progress","mathbox/destroy:destroy"],uninstall(){return this.destroy()},ready(x,r){if(r.MathBox&&!this.div)return this.init(x,r)},init(x,r){this.destroy();({color:x}=this.options);var e=`\
<div class="mathbox-loader mathbox-splash-${x}">
  <div class="mathbox-logo">
    <div> <div></div><div></div><div></div> </div>
    <div> <div></div><div></div><div></div> </div>
  </div>
  <div class="mathbox-progress"><div></div></div>
</div>\
`;this.div=x=document.createElement("div");x.innerHTML=e;r.element.appendChild(x);e=Math.random()*2-1;const g=Math.random()*2-1,f=Math.random()*2-1,k=1/Math.sqrt(e*e+g*g+f*f);this.loader=x.querySelector(".mathbox-loader");this.bar=x.querySelector(".mathbox-progress \x3e div");this.gyro=x.querySelectorAll(".mathbox-logo \x3e div");this.transforms=["rotateZ(22deg) rotateX(24deg) rotateY(30deg)","rotateZ(11deg) rotateX(12deg) rotateY(15deg) scale3d(.6, .6, .6)"];this.random=[e*k,g*k,f*k];this.start=
r.Time.now;return this.timer=null},progress(x,r){if(this.div){var {current:e,total:g}=x;x=e<g;clearTimeout(this.timer);x?(this.loader.classList.remove("mathbox-exit"),this.loader.style.display="block"):(this.loader.classList.add("mathbox-exit"),this.timer=setTimeout(()=>this.loader.style.display="none",150));this.bar.style.width=e<g?Math.round(1E3*e/g)*.1+"%":"100%";if(this.options.fancy){const f=this.random,k=Math.max(0,Math.min(1,r.Time.now-this.start)),m=function(p,z){z==null&&(z=0);return p.replace(/(-?[0-9.e]+)deg/g,
(t,v)=>+v+f[z++]*k*r.Time.step*60+"deg")};return(()=>{const p=[];for(let z=0;z<this.gyro.length;z++){let t;const v=this.gyro[z];this.transforms[z]=t=m(this.transforms[z]);p.push(v.style.transform=v.style.WebkitTransform=t)}return p})()}}},destroy(){this.div!=null&&this.div.remove();return this.div=null}})};
shadow$provide[106]=function(l,L,q){l=l(104);l.Bootstrap.registerAlias("empty","fallback bind renderer size fill loop time".split(" "));l.Bootstrap.registerAlias("core",["empty","scene","camera","render","warmup"]);l.Bootstrap.registerAlias("VR",["core","cursor","fullscreen","render:vr"])};
shadow$provide[107]=function(l,L,q){L=l(104);var x=l(103);L.Bootstrap.registerPlugin("bind",{install:function(r){r.bind=x.Binder.bind(r,{three:r,window});r.unbind=x.Binder.unbind(r);r.bind("install:bind",this);r.bind("uninstall:unbind",this)},uninstall:function(r){r.unbind(this);delete r.bind;delete r.unbind},bind:function(r,e){const g=r.plugin;(r=g.listen)&&r.forEach(function(f){e.bind(f,g)})},unbind:function(r,e){e.unbind(r.plugin)}})};
shadow$provide[108]=function(l,L,q){var x=l(101);l(104).Bootstrap.registerPlugin("camera",{defaults:{near:.01,far:1E4,type:"perspective",fov:60,aspect:null,left:-1,right:1,bottom:-1,top:1,klass:null,parameters:null},listen:["resize","this.change"],install:function(r){r.Camera=this.api();r.camera=null;this.aspect=1;this.change({},r)},uninstall:function(r){delete r.Camera;delete r.camera},change:function(r,e){const g=this.options,f=e.camera;if(!e.camera||r.changes.type||r.changes.klass)r=g.klass||{perspective:x.PerspectiveCamera,
orthographic:x.OrthographicCamera}[g.type]||x.Camera,e.camera=g.parameters?new r(g.parameters):new r;Object.entries(g).forEach(function([k]){Object.prototype.hasOwnProperty.call(e.camera,k)&&(e.camera[k]=g[k])}.bind(this));this.update(e);f===e.camera||e.trigger({type:"camera",camera:e.camera})},resize:function(r,e){this.aspect=r.viewWidth/Math.max(1,r.viewHeight);this.update(e)},update:function(r){r.camera.aspect=this.options.aspect||this.aspect;r.camera.updateProjectionMatrix()}})};
shadow$provide[109]=function(l,L,q){l(104).Bootstrap.registerPlugin("fallback",{defaults:{force:!1,fill:!0,begin:'\x3cdiv class\x3d"threestrap-fallback" style\x3d"display: table; width: 100%; height: 100%;box-sizing: border-box; border: 1px dashed rgba(0, 0, 0, .25);"\x3e\x3cdiv style\x3d"display: table-cell; padding: 10px; vertical-align: middle; text-align: center;"\x3e',end:"\x3c/div\x3e\x3c/div\x3e",message:'\x3cbig\x3e\x3cstrong\x3eThis example requires WebGL\x3c/strong\x3e\x3c/big\x3e\x3cbr\x3eVisit \x3ca target\x3d"_blank" href\x3d"http://get.webgl.org/"\x3eget.webgl.org\x3c/a\x3e for more info\x3c/a\x3e'},
install:function(x){try{var r=document.createElement("canvas");var e=r.getContext("webgl")||r.getContext("experimental-webgl");if(!e||this.options.force)throw"WebGL unavailable.";x.fallback=!1}catch(g){r=this.options.message;e=this.options.begin;const f=this.options.end,k=this.options.fill,m=document.createElement("div");m.innerHTML=e+r+f;for(this.children=[];m.childNodes.length>0;)this.children.push(m.firstChild),x.element.appendChild(m.firstChild);k&&x.install("fill");this.div=m;x.fallback=!0;return!1}},
uninstall:function(x){this.children&&(this.children.forEach(function(r){r.parentNode.removeChild(r)}),this.children=null);delete x.fallback}})};
shadow$provide[110]=function(l,L,q){l(104).Bootstrap.registerPlugin("fill",{defaults:{block:!0,body:!0,layout:!0},install:function(x){function r(g){g=g.style.height;return g=="auto"||g==""}function e(g){g.style.height="100%";g.style.margin=0;g.style.padding=0;return g}this.options.body&&x.element==document.body&&(this.applied=[x.element,document.documentElement].filter(r).map(e));this.options.block&&x.canvas&&(x.canvas.style.display="block",this.block=!0);this.options.layout&&x.element&&window.getComputedStyle(x.element).position==
"static"&&(x.element.style.position="relative",this.layout=!0)},uninstall:function(x){this.applied&&(this.applied.map(function(r){r.style.height="";r.style.margin="";r.style.padding="";return r}),delete this.applied);this.block&&x.canvas&&(x.canvas.style.display="",delete this.block);this.layout&&x.element&&(x.element.style.position="",delete this.layout)},change:function(x){this.uninstall(x);this.install(x)}})};
shadow$provide[111]=function(l,L,q){l(104).Bootstrap.registerPlugin("loop",{defaults:{start:!0,each:1},listen:["ready"],install:function(x){this.running=!1;this.lastRequestId=null;x.Loop=this.api({start:this.start.bind(this),stop:this.stop.bind(this),running:!1,window},x);this.events=["pre","update","render","post"].map(function(r){return{type:r}})},uninstall:function(x){this.stop(x)},ready:function(x,r){this.options.start&&this.start(r)},start:function(x){if(!this.running){x.Loop.running=this.running=
!0;var r=x.trigger.bind(x),e=function(){this.running&&(this.lastRequestId=x.Loop.window.requestAnimationFrame(e),this.events.map(r))}.bind(this);this.lastRequestId=x.Loop.window.requestAnimationFrame(e);x.trigger({type:"start"})}},stop:function(x){this.running&&(x.Loop.running=this.running=!1,x.Loop.window.cancelAnimationFrame(this.lastRequestId),this.lastRequestId=null,x.trigger({type:"stop"}))}})};
shadow$provide[112]=function(l,L,q){l(104).Bootstrap.registerPlugin("render",{listen:["render"],render:function(x,r){r.scene&&r.camera&&r.renderer.render(r.scene,r.camera)}})};
shadow$provide[113]=function(l,L,q){L=l(101);l(104).Bootstrap.registerPlugin("renderer",{defaults:{klass:L.WebGL1Renderer,parameters:{depth:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!0}},listen:["resize"],install:function(x){const r=x.renderer=new this.options.klass(this.options.parameters);x.canvas=r.domElement;x.element.appendChild(r.domElement)},uninstall:function(x){x.element.removeChild(x.renderer.domElement);delete x.renderer;delete x.canvas},resize:function(x,r){r=r.renderer;const e=
r.domElement;e&&e.tagName=="CANVAS"?r.setSize(x.renderWidth,x.renderHeight,!1):(r.setRenderSize&&r.setRenderSize(x.renderWidth,x.renderHeight),r.setSize(x.viewWidth,x.viewHeight,!1))}})};
shadow$provide[114]=function(l,L,q){var x=l(101);l(104).Bootstrap.registerPlugin("scene",{install:function(r){r.scene=new x.Scene},uninstall:function(r){delete r.scene}})};
shadow$provide[115]=function(l,L,q){l(104).Bootstrap.registerPlugin("size",{defaults:{width:null,height:null,aspect:null,scale:1,maxRenderWidth:Infinity,maxRenderHeight:Infinity,devicePixelRatio:!0},listen:["window.resize:queue","element.resize:queue","this.change:queue","ready:resize","pre:pre"],install:function(x){x.Size=this.api({renderWidth:0,renderHeight:0,viewWidth:0,viewHeight:0});this.resized=!1},uninstall:function(x){delete x.Size},queue:function(x,r){this.resized=!0},pre:function(x,r){this.resized&&
(this.resized=!1,this.resize(x,r))},resize:function(x,r){var e=this.options,g=r.element,f=r.renderer,k,m;let p,z=0,t=0;x=k=e.width===void 0||e.width==null?g.offsetWidth||g.innerWidth||0:e.width;g=m=e.height===void 0||e.height==null?g.offsetHeight||g.innerHeight||0:e.height;p=x/g;e.aspect&&(e.aspect>p?(g=Math.round(x/e.aspect),t=Math.floor((m-g)/2)):(x=Math.round(g*e.aspect),z=Math.floor((k-x)/2)),p=x/g);m=1;e.devicePixelRatio&&typeof window!="undefined"&&(m=window.devicePixelRatio||1);k=Math.round(Math.min(x*
m*e.scale,e.maxRenderWidth));e=Math.round(Math.min(g*m*e.scale,e.maxRenderHeight));k/e>p?k=Math.round(e*p):e=Math.round(k/p);m=e/g;f=f.domElement.style;f.width=x+"px";f.height=g+"px";f.marginLeft=z+"px";f.marginTop=t+"px";Object.assign(r.Size,{renderWidth:k,renderHeight:e,viewWidth:x,viewHeight:g,aspect:p,pixelRatio:m});r.trigger({type:"resize",renderWidth:k,renderHeight:e,viewWidth:x,viewHeight:g,aspect:p,pixelRatio:m})}})};
shadow$provide[116]=function(l,L,q){l(104).Bootstrap.registerPlugin("time",{defaults:{speed:1,warmup:0,timeout:1},listen:["pre:tick","this.change"],now:function(){return+new Date/1E3},install:function(x){x.Time=this.api({now:this.now(),clock:0,step:1/60,frames:0,time:0,delta:1/60,average:0,fps:0});this.clock=this.time=this.last=0;this.wait=this.options.warmup;this.timeStart=this.clockStart=0},tick:function(x,r){x=this.options.speed;const e=this.options.timeout;r=r.Time;const g=r.now=this.now();var f=
this.last;let k=this.time,m=this.clock;if(f){f=r.delta=g-f;const p=r.average||f;f>e&&(f=0);x*=f;k+=f;m+=x;r.frames>0&&(r.average=p+(f-p)*.1,r.fps=1/p);r.step=x;r.clock=m-this.clockStart;r.time=k-this.timeStart;r.frames++;this.wait-- >0&&(this.clockStart=m,this.timeStart=k,r.clock=0,r.step=1E-100)}this.last=g;this.clock=m;this.time=k},uninstall:function(x){delete x.Time}})};
shadow$provide[117]=function(l,L,q){l(104).Bootstrap.registerPlugin("warmup",{defaults:{delay:2},listen:["ready","post"],ready:function(x,r){r.renderer.domElement.style.visibility="hidden";this.frame=0;this.hidden=!0},post:function(x,r){this.hidden&&this.frame>=this.options.delay&&(r.renderer.domElement.style.visibility="visible",this.hidden=!1);this.frame++}})};
shadow$provide[118]=function(l,L,q){l(107);l(108);l(109);l(110);l(111);l(112);l(113);l(114);l(115);l(116);l(117)};
shadow$provide[119]=function(l,L,q){var x=l(101);l(104).Bootstrap.registerPlugin("controls",{listen:["update","resize","camera","this.change"],defaults:{klass:null,parameters:{}},install:function(r){if(!this.options.klass)throw"Must provide class for `controls.klass`";r.controls=null;this._camera=r.camera||new x.PerspectiveCamera;this.change(null,r)},uninstall:function(r){delete r.controls},change:function(r,e){if(this.options.klass){if(!r||r.changes.klass)e.controls=new this.options.klass(this._camera,
e.renderer.domElement);Object.assign(e.controls,this.options.parameters)}else e.controls=null},update:function(r,e){r=e.Time&&e.Time.delta||1/60;const g=e.VR&&e.VR.state;e.controls.vr&&e.controls.vr(g);e.controls.update(r)},camera:function(r,e){e.controls.object=this._camera=r.camera},resize:function(r,e){e.controls.handleResize&&e.controls.handleResize()}})};
shadow$provide[120]=function(l,L,q){l(104).Bootstrap.registerPlugin("cursor",{listen:"update this.change install:change uninstall:change element.mousemove vr".split(" "),defaults:{cursor:null,hide:!1,timeout:3},install:function(x){this.timeout=this.options.timeout;this.element=x.element;this.change(null,x)},uninstall:function(x){delete x.controls},change:function(x,r){this.applyCursor(r)},mousemove:function(x,r){this.options.hide&&(this.applyCursor(r),this.timeout=+this.options.timeout||0)},update:function(x,
r){x=r.Time&&r.Time.delta||1/60;this.options.hide&&(this.timeout-=x,this.timeout<0&&this.applyCursor(r,"none"))},vr:function(x,r){this.hide=x.active&&!x.hmd.fake;this.applyCursor(r)},applyCursor:function(x,r){x=x.controls?"move":"";r=r||this.options.cursor||x;this.hide&&(r="none");this.cursor!=r&&(this.element.style.cursor=r)}})};
shadow$provide[121]=function(l,L,q){l(104).Bootstrap.registerPlugin("fullscreen",{defaults:{key:"f"},listen:["ready","update"],install:function(x){x.Fullscreen=this.api({active:!1,toggle:this.toggle.bind(this)},x)},uninstall:function(x){delete x.Fullscreen},ready:function(x,r){document.body.addEventListener("keypress",function(e){this.options.key&&e.charCode==this.options.key.charCodeAt(0)&&this.toggle(r)}.bind(this));x=function(){const e=!!document.fullscreenElement||!!document.mozFullScreenElement||
!!document.webkitFullscreenElement||!!document.msFullscreenElement;r.Fullscreen.active=this.active=e;r.trigger({type:"fullscreen",active:e})}.bind(this);document.addEventListener("fullscreenchange",x,!1);document.addEventListener("webkitfullscreenchange",x,!1);document.addEventListener("mozfullscreenchange",x,!1)},toggle:function(x){const r=x.canvas;x=x.VR&&x.VR.active?{vrDisplay:x.VR.hmd}:{};this.active?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen():r.requestFullScreen?r.requestFullScreen(x):r.msRequestFullScreen?r.msRequestFullscreen(x):r.webkitRequestFullscreen?r.webkitRequestFullscreen(x):r.mozRequestFullScreen&&r.mozRequestFullScreen(x)}})};
shadow$provide[122]=function(l,L,q){(function(x,r){"object"===typeof q&&"undefined"!==typeof L?L.exports=r():"function"===typeof define&&define.amd?define(r):x.Stats=r()})(this,function(){var x=function(){function r(y){f.appendChild(y.dom);return y}function e(y){for(var B=0;B<f.children.length;B++)f.children[B].style.display=B===y?"block":"none";g=y}var g=0,f=document.createElement("div");f.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000";f.addEventListener("click",
function(y){y.preventDefault();e(++g%f.children.length)},!1);var k=(performance||Date).now(),m=k,p=0,z=r(new x.Panel("FPS","#0ff","#002")),t=r(new x.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var v=r(new x.Panel("MB","#f08","#201"));e(0);return{REVISION:16,dom:f,addPanel:r,showPanel:e,begin:function(){k=(performance||Date).now()},end:function(){p++;var y=(performance||Date).now();t.update(y-k,200);if(y>m+1E3&&(z.update(1E3*p/(y-m),100),m=y,p=0,v)){var B=performance.memory;
v.update(B.usedJSHeapSize/1048576,B.jsHeapSizeLimit/1048576)}return y},update:function(){k=this.end()},domElement:f,setMode:e}};x.Panel=function(r,e,g){var f=Infinity,k=0,m=Math.round,p=m(window.devicePixelRatio||1),z=80*p,t=48*p,v=3*p,y=2*p,B=3*p,D=15*p,G=74*p,I=30*p,K=document.createElement("canvas");K.width=z;K.height=t;K.style.cssText="width:80px;height:48px";var Q=K.getContext("2d");Q.font="bold "+9*p+"px Helvetica,Arial,sans-serif";Q.textBaseline="top";Q.fillStyle=g;Q.fillRect(0,0,z,t);Q.fillStyle=
e;Q.fillText(r,v,y);Q.fillRect(B,D,G,I);Q.fillStyle=g;Q.globalAlpha=.9;Q.fillRect(B,D,G,I);return{dom:K,update:function(O,J){f=Math.min(f,O);k=Math.max(k,O);Q.fillStyle=g;Q.globalAlpha=1;Q.fillRect(0,0,z,D);Q.fillStyle=e;Q.fillText(m(O)+" "+r+" ("+m(f)+"-"+m(k)+")",v,y);Q.drawImage(K,B+p,D,G-p,I,B,D,G-p,I);Q.fillRect(B+G-p,D,p,I);Q.fillStyle=g;Q.globalAlpha=.9;Q.fillRect(B+G-p,D,p,m((1-O/J)*I))}}};return x})};
shadow$provide[123]=function(l,L,q){var x=l(122);l(104).Bootstrap.registerPlugin("stats",{listen:["pre","post"],install:function(r){const e=this.stats=new x.default,g=e.domElement.style;g.position="absolute";g.top=g.left=0;r.element.appendChild(e.domElement);r.stats=e},uninstall:function(r){this.stats.domElement.remove();delete r.stats},pre:function(r,e){this.stats.begin()},post:function(r,e){this.stats.end()}})};
shadow$provide[124]=function(l,L,q){l(104).Bootstrap.registerPlugin("ui",{defaults:{theme:"white",style:".threestrap-ui { position: absolute; bottom: 5px; right: 5px; float: left; }.threestrap-ui button { border: 0; background: none;  vertical-align: middle; font-weight: bold; } .threestrap-ui .glyphicon { top: 2px; font-weight: bold; } @media (max-width: 640px) { .threestrap-ui button { font-size: 120% } }.threestrap-white button { color: #fff; text-shadow: 0 1px 1px rgba(0, 0, 0, 1), 0 1px 3px rgba(0, 0, 0, 1); }.threestrap-black button { color: #000; text-shadow: 0 0px 1px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1), 0 0px 2px rgba(255, 255, 255, 1) }"},
listen:["fullscreen"],markup:function(x,r,e){let g="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css";location.href.match(/^file:\/\//)&&(g="http://"+g);const f=[];x.Fullscreen&&f.push('\x3cbutton class\x3d"fullscreen" title\x3d"Full Screen"\x3e\x3cspan class\x3d"glyphicon glyphicon-fullscreen"\x3e\x3c/span\x3e\x3c/button\x3e');x.VR&&f.push('\x3cbutton class\x3d"vr" title\x3d"VR Headset"\x3eVR\x3c/button\x3e');return'\x3cstyle type\x3d"text/css"\x3e@import url("'+g+'"); '+e+
'\x3c/style\x3e\x3cdiv class\x3d"threestrap-ui threestrap-'+r+'"\x3e'+f.join("\n")+"\x3c/div\x3e"},install:function(x){var r=this.ui=document.createElement("div");r.innerHTML=this.markup(x,this.options.theme,this.options.style);document.body.appendChild(r);const e=this.ui.fullscreen=r.querySelector("button.fullscreen");e&&x.bind([e,"click:goFullscreen"],this);(r=this.ui.vr=r.querySelector("button.vr"))&&x.VR&&(x.VR.set({mode:"2d"}),x.bind([r,"click:goVR"],this))},fullscreen:function(x,r){this.ui.style.display=
x.active?"none":"block";x.active||r.VR&&r.VR.set({mode:"2d"})},goFullscreen:function(x,r){r.Fullscreen&&r.Fullscreen.toggle()},goVR:function(x,r){r.VR&&(r.VR.set({mode:"auto"}),r.Fullscreen.toggle())},uninstall:function(x){document.body.removeChild(this.ui)}})};
shadow$provide[125]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},VRRenderer:{enumerable:!0,get:function(){return r}}});var x=l(101);class r{constructor(e,g){this.renderer=e;this.right=new x.Vector3;this.cameraLeft=new x.PerspectiveCamera;this.cameraRight=new x.PerspectiveCamera;e=g.getEyeTranslation("left");this.halfIPD=(new x.Vector3(e.x,e.y,e.z)).length();this.fovLeft=g.getRecommendedEyeFieldOfView("left");this.fovRight=g.getRecommendedEyeFieldOfView("right")}FovToNDCScaleOffset(e){const g=
2/(e.leftTan+e.rightTan),f=2/(e.upTan+e.downTan);return{scale:[g,f],offset:[(e.leftTan-e.rightTan)*g*.5,(e.upTan-e.downTan)*f*.5]}}FovPortToProjection(e,g,f,k,m){k=k===void 0?.01:k;m=m===void 0?1E4:m;f=f===void 0||f?-1:1;const p=e.elements;g=this.FovToNDCScaleOffset(g);p[0]=g.scale[0];p[1]=0;p[2]=g.offset[0]*f;p[3]=0;p[4]=0;p[5]=g.scale[1];p[6]=-g.offset[1]*f;p[7]=0;p[8]=0;p[9]=0;p[10]=m/(k-m)*-f;p[11]=m*k/(k-m);p[12]=0;p[13]=0;p[14]=f;p[15]=0;e.transpose()}FovToProjection(e,g,f,k,m){return this.FovPortToProjection(e,
{upTan:Math.tan(g.upDegrees*Math.PI/180),downTan:Math.tan(g.downDegrees*Math.PI/180),leftTan:Math.tan(g.leftDegrees*Math.PI/180),rightTan:Math.tan(g.rightDegrees*Math.PI/180)},f,k,m)}render(e,g){this.FovToProjection(this.cameraLeft.projectionMatrix,this.fovLeft,!0,g.near,g.far);this.FovToProjection(this.cameraRight.projectionMatrix,this.fovRight,!0,g.near,g.far);this.right.set(this.halfIPD,0,0);this.right.applyQuaternion(g.quaternion);this.cameraLeft.position.copy(g.position).sub(this.right);this.cameraRight.position.copy(g.position).add(this.right);
this.cameraLeft.quaternion.copy(g.quaternion);this.cameraRight.quaternion.copy(g.quaternion);var f=this.renderer.devicePixelRatio||1;g=this.renderer.domElement.width/2/f;f=this.renderer.domElement.height/f;this.renderer.enableScissorTest(!0);this.renderer.setViewport(0,0,g,f);this.renderer.setScissor(0,0,g,f);this.renderer.render(e,this.cameraLeft);this.renderer.setViewport(g,0,g,f);this.renderer.setScissor(g,0,g,f);this.renderer.render(e,this.cameraRight)}}};
shadow$provide[126]=function(l,L,q){L=l(104);var x=l(125);L.Bootstrap.registerPlugin("vr",{defaults:{mode:"auto",device:null,fov:80},listen:["window.load","pre","render","resize","this.change"],install:function(r){r.VR=this.api({active:!1,devices:[],hmd:null,sensor:null,renderer:null,state:null},r)},uninstall:function(r){delete r.VR},mocks:function(r,e,g){return[{fake:!0,force:1,deviceId:"emu",deviceName:"Emulated",getEyeTranslation:function(f){return{left:{x:-.03,y:0,z:0},right:{x:.03,y:0,z:0}}[f]},
getRecommendedEyeFieldOfView:function(f){var k=r.camera;const m=(e||k&&k.fov||g)/2;k=Math.atan(Math.tan(m*Math.PI/180)*(k&&k.aspect||16/9)/2)*180/Math.PI;return{left:{rightDegrees:k,leftDegrees:k,downDegrees:m,upDegrees:m},right:{rightDegrees:k,leftDegrees:k,downDegrees:m,upDegrees:m}}[f]}},{force:2,getState:function(){return{}}}]},load:function(r,e){r=function(g){this.callback(g,e)}.bind(this);navigator.getVRDevices?navigator.getVRDevices().then(r):navigator.mozGetVRDevices?navigator.mozGetVRDevices(r):
(console.warn("No native VR support detected."),r(this.mocks(e,this.options.fov,this.defaults.fov),e))},callback:function(r,e){let g,f;var k=window.HMDVRDevice||function(){};const m=window.PositionSensorVRDevice||function(){};r=e.VR.devices=r||e.VR.devices;var p=this.options.device;let z;for(let t=0;t<r.length;++t)if(z=r[t],(z.force==1||z instanceof k)&&(!p||p==z.deviceId)){g=z;break}if(g){for(p=0;p<r.length;++p)if(k=r[p],k.force==2||k instanceof m&&k.hardwareUnitId==g.hardwareUnitId){f=k;break}this.hookup(g,
f,e)}},hookup:function(r,e,g){x.VRRenderer||console.log("VRRenderer not found");this.renderer=new (x.VRRenderer||function(){})(g.renderer,r);this.hmd=r;this.sensor=e;g.VR.renderer=this.renderer;g.VR.hmd=r;g.VR.sensor=e;console.log("VRRenderer",r.deviceName)},change:function(r,e){r.changes.device&&this.callback(null,e);this.pre(r,e)},pre:function(r,e){r=this.active;const g=this.active=this.renderer&&this.options.mode!="2d";if((e.VR.active=g)&&this.sensor){const f=this.sensor.getState();e.VR.state=
f}else e.VR.state=null;r!=this.active&&e.trigger({type:"vr",active:g,hmd:this.hmd,sensor:this.sensor})},resize:function(r,e){this.active&&this.renderer.initialize()},render:function(r,e){if(e.scene&&e.camera){r=this.active?this.renderer:e.renderer;if(this.last!=r&&r==e.renderer){var g=r.getPixelRatio();const f=r.domElement.width/g;g=r.domElement.height/g;r.setScissorTest(!1);r.setViewport(0,0,f,g)}this.last=r;r.render(e.scene,e.camera)}}})};
shadow$provide[127]=function(l,L,q){l(119);l(120);l(121);l(123);l(124);l(126)};
shadow$provide[128]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},VRControls:{enumerable:!0,get:function(){return r}}});var x=l(101);class r{constructor(e,g){function f(k){this.vrDisplays=k;k.length>0?this.vrDisplay=k[0]:g&&g("VR input not available.")}this.object=e;this.standingMatrix=new x.Matrix4;this.frameData=null;"VRFrameData"in window&&(this.frameData=new VRFrameData);navigator.getVRDisplays&&navigator.getVRDisplays().then(f).catch(function(){console.warn("VRControls: Unable to get VR Displays")});
this.scale=1;this.standing=!1;this.userHeight=1.6}getVRDisplay(){return this.vrDisplay}setVRDisplay(e){this.vrDisplay=e}getVRDisplays(){console.warn("VRControls: getVRDisplays() is being deprecated.");return this.vrDisplays}getStandingMatrix(){return this.standingMatrix}update(){if(this.vrDisplay){let e;this.vrDisplay.getFrameData?(this.vrDisplay.getFrameData(this.frameData),e=this.frameData.pose):this.vrDisplay.getPose&&(e=this.vrDisplay.getPose());e.orientation!==null&&this.object.quaternion.fromArray(e.orientation);
e.position!==null?this.object.position.fromArray(e.position):this.object.position.set(0,0,0);this.standing&&(this.vrDisplay.stageParameters?(this.object.updateMatrix(),this.standingMatrix.fromArray(this.vrDisplay.stageParameters.sittingToStandingTransform),this.object.applyMatrix(this.standingMatrix)):this.object.position.setY(this.object.position.y+this.userHeight));this.object.position.multiplyScalar(this.scale)}}dispose(){this.vrDisplay=null}}};
shadow$provide[129]=function(l,L,q){l(128)};
shadow$provide[130]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},MultiRenderer:{enumerable:!0,get:function(){return r}}});var x=l(101);class r{constructor(e){console.log("MultiRenderer",x.REVISION);this.domElement=document.createElement("div");this.domElement.style.position="relative";this.renderers=[];this._renderSizeSet=!1;const g=e.renderers||[];e=e.parameters||[];for(let f=0;f<g.length;f++){const k=new g[f](e[f]);k.domElement.style.position="absolute";k.domElement.style.top=
"0px";k.domElement.style.left="0px";this.domElement.appendChild(k.domElement);this.renderers.push(k)}}setSize(e,g){this.domElement.style.width=e+"px";this.domElement.style.height=g+"px";for(let f=0;f<this.renderers.length;f++){const k=this.renderers[f],m=k.domElement;(!this._renderSizeSet||m&&m.tagName!=="CANVAS")&&k.setSize(e,g);m.style.width=e+"px";m.style.height=g+"px"}}setRenderSize(e,g){this._renderSizeSet=!0;for(let f=0;f<this.renderers.length;f++){const k=this.renderers[f],m=k.domElement;m&&
m.tagName==="CANVAS"&&k.setSize(e,g,!1)}}render(e,g){for(let f=0;f<this.renderers.length;f++)this.renderers[f].render(e,g)}}};
shadow$provide[131]=function(l,L,q){l(130);l(125)};
shadow$provide[132]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Api:{enumerable:!0,get:function(){return x.Api}},Binder:{enumerable:!0,get:function(){return r.Binder}},Bootstrap:{enumerable:!0,get:function(){return e.Bootstrap}},MultiRenderer:{enumerable:!0,get:function(){return f.MultiRenderer}},VRControls:{enumerable:!0,get:function(){return g.VRControls}},VRRenderer:{enumerable:!0,get:function(){return k.VRRenderer}}});l(106);l(103);l(104);l(118);l(127);l(129);
l(131);var x=l(102),r=l(103),e=l(104),g=l(128),f=l(130),k=l(125)};
shadow$provide[133]=function(l,L,q){function x(f,k){return typeof f!=="undefined"&&f!==null?k(f):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Attributes:{enumerable:!0,get:function(){return r}}});class r{constructor(f,k){this.context=k;this.traits=f.Traits;this.types=f.Types;this.pending=[];this.bound=[];this.last=null}make(f){return{enum:typeof f.enum==="function"?f.enum():void 0,type:typeof f.uniform==="function"?f.uniform():void 0,value:f.make()}}apply(f,k){return new g(f,
k,this)}bind(f){return this.bound.push(f)}unbind(f){return this.bound=Array.from(this.bound).filter(k=>k!==f)}queue(f,k,m,p){this.lastObject=k;this.lastKey=m;this.lastValue=p;return this.pending.push(f)}invoke(f){return f(this.context.time.clock,this.context.time.step)}compute(){if(this.bound.length)for(const f of Array.from(this.bound))this.invoke(f)}digest(){let f;if(!this.pending.length)return!1;[f,this.pending]=Array.from([this.pending,[]]);for(const k of Array.from(f))k();return!0}getTrait(f){return this.traits[f]}getLastTrigger(){return`${this.lastObject.toString()} - ${this.lastKey}=\`${this.lastValue}\``}}
const e=function(f){const k={};for(const m in f)k[m]=f[m];return k};class g{constructor(f,k,m){let p;let z,t,v,y,B,{props:D}=k;const {traits:G,finals:I,freeform:K}=k,Q=this;f.props!=null&&f.expr!=null&&f.orig!=null&&f.computed!=null&&f.attributes!=null&&(y=e(f.props),t=e(f.expr),v=f.orig(),z=f.computed(),f.attributes!=null&&f.attributes.dispose());const O={},J={},W={},ba=Ha=>(Q[Ha]!=null?Q[Ha].value:void 0)!=null?Q[Ha]!=null?Q[Ha].value:void 0:x(Q[W[Ha]!=null?W[Ha]:Ha],fb=>fb.value),Y=function(Ha,
fb,ab,Qb){let fc;Ha=W[Ha]!=null?W[Ha]:Ha;if((fc=Q[Ha])==null){if(!K)throw Error(`${f.toString()} - Setting unknown property \`${Ha}={${fb}}\``);fc=Q[Ha]={short:Ha,type:null,last:null,value:null};jb[Ha]=pc=>pc}if(!ab){if(xa[Ha])throw Error(`${f.toString()} - Can't set bound property \`${Ha}={${fb}}\``);if(na[Ha])throw Error(`${f.toString()} - Can't set computed property \`${Ha}={${fb}}\``);if(N[Ha])throw Error(`${f.toString()} - Can't set final property \`${Ha}={${fb}}\``);}let oc=!0;const Dc=rc(Ha,
fb,fc.last,function(){oc=!1;return null});if(oc){[fc.value,fc.last]=Array.from([Dc,fc.value]);const {short:pc}=fc;O[pc]=Dc;ab||(J[pc]=fb);Qb||eb[Ha](fc.value,fc.last)||Db(Ha,fb)}return oc};k=function(Ha,fb,ab){Ha=W[Ha]!=null?W[Ha]:Ha;Y(Ha,fb,!0,ab);return N[Ha]=!0};const S={},ca={},V={},xa={},na={},N={},pa=function(Ha,fb,ab){ab==null&&(ab=!1);Ha=W[Ha]!=null?W[Ha]:Ha;if(typeof fb!=="function")throw Error(`${f.toString()} - Expression \`${Ha}=>{${S}}\` is not a function`);if(xa[Ha])throw Error(`${f.toString()} - Property \`${Ha}=>{${S}}\` is already bound`);
if(na[Ha])throw Error(`${f.toString()} - Property \`${Ha}\` is computed`);if(N[Ha])throw Error(`${f.toString()} - Property \`${Ha}\` is final`);(ab?na:xa)[Ha]=fb;const Qb=Q[Ha]!=null?Q[Ha].short:Ha;ab||(S[Qb]=fb);V[Ha]=fb;fb=fb.bind(f);ca[Ha]=function(fc,oc){let Dc;if(Dc=f.clock!=null?f.clock.getTime():void 0)fc=Dc.clock,oc=Dc.step;return f.set(Ha,fb(fc,oc),!0)};return m.bind(ca[Ha])},ra=function(Ha,fb){fb==null&&(fb=!1);Ha=W[Ha]!=null?W[Ha]:Ha;fb=fb?na:xa;if(fb[Ha])return m.unbind(ca[Ha]),delete ca[Ha],
delete fb[Ha],Q[Ha]!=null&&(Ha=Q[Ha].short),delete S[Ha]},Ea=function(Ha,fb){let ab;Ha=W[Ha]!=null?W[Ha]:Ha;return(ab=typeof V[Ha]==="function"?V[Ha](fb,0):void 0)!=null?ab:Q[Ha].value};f.expr=S;f.props=O;f.evaluate=function(Ha,fb){if(Ha!=null)return Ea(Ha,fb);const ab={};for(Ha in D)ab[Ha]=Ea(Ha,fb);return ab};f.get=function(Ha){return Ha!=null?ba(Ha):O};f.set=function(Ha,fb,ab,Qb){if(typeof Ha==="string")Y(Ha,fb,ab,Qb);else{Qb=ab;ab=fb;const fc=Ha;for(Ha in fc)fb=fc[Ha],Y(Ha,fb,ab,Qb)}};f.bind=
function(Ha,fb,ab){if(typeof Ha==="string")pa(Ha,fb,ab);else{ab=fb;const Qb=Ha;for(Ha in Qb)fb=Qb[Ha],pa(Ha,fb,ab)}};f.unbind=function(Ha,fb){if(typeof Ha==="string")ra(Ha,fb);else{fb=S;const ab=Ha;for(Ha in ab)ra(Ha,fb)}};f.attribute=function(Ha){return Ha!=null?Q[W[Ha]!=null?W[Ha]:Ha]:Q};f.orig=function(Ha){return Ha!=null?J[W[Ha]!=null?W[Ha]:Ha]:e(J)};f.computed=function(Ha){return Ha!=null?na[W[Ha]!=null?W[Ha]:Ha]:e(na)};const Ua={},jb={},eb={},rc=(Ha,fb,ab,Qb)=>jb[Ha](fb,ab,Qb);f.validate=function(Ha,
fb){let ab;Ha=W[Ha]!=null?W[Ha]:Ha;const Qb=Ua[Ha];Qb!=null&&(ab=Qb());return ab=rc(Ha,fb,ab,function(){throw Error(`${f.toString()} - Invalid value \`${Ha}={${fb}}\``);})};let xb=!1,Bb={},bc={},qb={},cc={};const Db=function(Ha,fb){xb||(xb=!0,m.queue(Bc,f,Ha,fb));fb=Ha.split(".")[0];Bb[Ha]=!0;return bc[fb]=!0},nc={type:"change",changed:null,touched:null},Bc=function(){nc.changed=Bb;nc.touched=bc;Bb=qb;bc=cc;({changed:qb}=nc);({touched:cc}=nc);xb=!1;for(Ha in Bb)Bb[Ha]=!1;for(Ha in bc)bc[Ha]=!1;nc.type=
"change";f.trigger(nc);var Ha=[];for(const fb in nc.touched)nc.type=`change:${fb}`,Ha.push(f.trigger(nc));return Ha},yb=function(Ha){Ha=Ha.split(/\./g);const fb=Ha.pop();Ha.pop();Ha.unshift(fb);return Ha.reduce((ab,Qb)=>ab+Qb.charAt(0).toUpperCase()+Qb.substring(1))},lb=(Ha,fb)=>(()=>{const ab=[];for(let Qb in fb){let fc;const oc=fb[Qb];Qb=[Ha,Qb].join(".");const Dc=yb(Qb);Q[Qb]={T:oc,ns:Ha,short:Dc,enum:typeof oc.enum==="function"?oc.enum():void 0,type:typeof oc.uniform==="function"?oc.uniform():
void 0,last:oc.make(),value:fc=oc.make()};if(W[Dc])throw Error(`${f.toString()} - Duplicate property \`${Dc}\``);W[Dc]=Qb;O[Dc]=fc;Ua[Qb]=oc.make;jb[Qb]=oc.validate!=null?oc.validate:pc=>pc;ab.push(eb[Qb]=oc.equals!=null?oc.equals:(pc,Qd)=>pc===Qd)}return ab})(),Tb=[];for(let Ha of Array.from(G)){[Ha,yc]=Array.from(Ha.split(":"));const fb=yc?[yc,Ha].join("."):Ha;B=m.getTrait(Ha);Tb.push(Ha);B!=null&&lb(fb,B)}if(D!=null)for(yc in D)B=D[yc],lb(yc,B);var yc=Tb.filter((Ha,fb)=>Tb.indexOf(Ha)===fb);f.traits=
yc;y!=null&&f.set(y,!0,!0);if(I!=null)for(p in I)k(p,I[p],!0);v!=null&&f.set(v,!1,!0);z!=null&&f.bind(z,!0);t!=null&&f.bind(t,!1);this.dispose=function(){for(p in na)ra(p,!0);for(p in xa)ra(p,!1);D={};delete f.attributes;delete f.get;return delete f.set};null}}};
shadow$provide[134]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},JSX:{enumerable:!0,get:function(){return B}},format:{enumerable:!0,get:function(){return y}},markup:{enumerable:!0,get:function(){return z}},number:{enumerable:!0,get:function(){return m}},print:{enumerable:!0,get:function(){return p}}});const x=(D,G)=>Math.abs(D/G-Math.round(D/G))<1E-4,r=D=>x(D,1),e=function(D,G,I,K){D=Math.round(D/G);return D===1?`${I}`:D===-1?`-${I}`:I==="1"?`${D}`:K?`${D}${I}`:`${D}*${I}`},
g=function(D,G,I,K){D=Math.round(D*G);Math.abs(D)===1?D=(D<0?"-":"")+I:I!=="1"&&(D+=K?`${I}`:`*${I}`);return`${D}/${G}`},f=[{1:1},{1:1,"τ":Math.PI*2},{1:1,"π":Math.PI},{1:1,"τ":Math.PI*2,"π":Math.PI},{1:1,e:Math.E},{1:1,"τ":Math.PI*2,e:Math.E},{1:1,"π":Math.PI,e:Math.E},{1:1,"τ":Math.PI*2,"π":Math.PI,e:Math.E}],k=[[420,[2,3,5,7]],[88200,[2,3,5,7]],[60060,[2,3,5,7,11,13]],[861764,[2,17,19,23,29]],[65536,[2]],[1E6,[2,5]]],m=function(D){let G,I,K,Q,O;D&&({cache:G,compact:I,tau:O,pi:Q,e:K}=D);I=+!(I!=
null&&!I);const J=+!(O!=null&&!O)+ +!(Q!=null&&!Q)*2+ +!(K!=null&&!K)*4,W=+!(G!=null&&!G)?{}:null;return function(ba){if(W!=null){var Y;if((Y=W[ba])!=null)return Y;if(ba===Math.round(ba))return W[ba]=`${ba}`}let S=`${ba}`,ca=S.length+S.indexOf(".")+2;Y=function(V){const xa=V.length;if(xa<=ca)return S=`${V}`,ca=xa};for(const V in f[J]){const xa=f[J][V];if(x(ba/xa,1))Y(`${e(ba/xa,1,V,I)}`);else for(let [na,N]of Array.from(k)){let pa=ba/xa*na;if(x(pa,1)){for(const ra of Array.from(N)){let Ea,Ua;for(;r(Ua=
pa/ra)&&r(Ea=na/ra);)pa=Ua,na=Ea}Y(`${g(ba/xa,na,V,I)}`);break}}}`${ba}`.length>5&&Y(`${ba.toPrecision(5)}`);W!=null&&(W[ba]=S);return S}},p=function(D,G){G==null&&(G="info");D=z(D);return console[G].apply(console,D)},z=function(D){let G=!1,I=0;const K=[];D=D.replace(/(\\[<={}> "'])|(=>|[<={}> "'])/g,function(Q,O,J){return O!=null&&O.length?O:G&&!['"',"'"].includes(J)||I&&!['"',"'","{","}"].includes(J)?J:(()=>{switch(J){case "\x3c":return K.push("color:rgb(128,0,128)"),"%c\x3c";case "\x3e":return K.push("color:rgb(128,0,128)"),
K.push("color:inherit"),"%c\x3e%c";case " ":return K.push("color:rgb(144,64,0)")," %c";case "\x3d":case "\x3d\x3e":return K.push("color:rgb(128,0,128)"),`%c${J}`;case '"':case "'":if(G=!G)return K.push(I?"color:rgb(144,64,0)":"color:rgb(0,0,192)"),`${J}%c`;K.push(I?"color:rgb(0,70,156)":"color:rgb(128,0,128)");return`%c${J}`;case "{":return I++===0?(K.push("color:rgb(0,70,156)"),`%c${J}`):J;case "}":return--I===0?(K.push("color:rgb(128,0,128)"),`${J}%c`):J;default:return J}})()});return[D].concat(K)},
t=function(){const D=m({compact:!1});return function(G,I,K){const Q=function(O){if(O instanceof Array)return`[${O.map(Q).join(", ")}]`;switch(typeof O){case "string":return O.match("\n")?`"\n${O}"\n`:`"${O}"`;case "function":return O=`${O}`,O.match("\n")?`\n${O}\n`:`${O}`,O=O.replace(/^function (\([^)]*\))/,"$1 \x3d\x3e"),O=O.replace(/^(\([^)]*\)) =>\s*{\s*return\s*([^}]+)\s*;\s*}/,"$1 \x3d\x3e $2");case "number":return D(O);default:return O!=null&&O!==!!O?O._up!=null?Q(O.map(J=>J)):O.toMarkup?O.toString():
"{"+(()=>{const J=[];for(const S in O){const ca=O[S];if(Object.prototype.hasOwnProperty.call(O,S)){var W=J,ba=W.push;var Y=S===""+ +S||S.match(/^[A-Za-z_][A-Za-z0-9]*$/)?S:JSON.stringify(S);ba.call(W,`${Y}: ${Q(ca)}`)}}return J})().join(", ")+"}":`${JSON.stringify(O)}`}};return[G,K,function(O){return O.match('\n*"')?O:`{${O}}`}(Q(I))].join("")}}(),v=function(D){D=D.replace(/&/g,"\x26amp;");D=D.replace(/</g,"\x26lt;");return D.replace(/"/g,"\x26quot;")},y=function(D){const G=[].slice.call(arguments);
G.shift();let I="\x3cspan\x3e";D=v(D);for(const K of Array.from(G))D=D.replace(/%([a-z])/,function(Q,O){Q=G.shift();switch(O){case "c":return`</span><span style="${v(Q)}">`;default:return v(Q)}});I+=D;return I+="\x3c/span\x3e"},B={prop:(D,G)=>t(D,G,"\x3d"),bind:(D,G)=>t(D,G,"\x3d\x3e")}};
shadow$provide[135]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Node:{enumerable:!0,get:function(){return e}}});var x=l(134);l=l(103);let r=0;class e{constructor(g,f,k,m,p,z){this.type=g;this._id=(++r).toString();this.configure(p,z);this.parent=this.root=this.path=this.index=null;this.set(f,!0,!0);this.set(k,!1,!0);this.bind(m,!1)}configure(g,f){let {traits:k,props:m,finals:p,freeform:z}=g;k==null&&(k=(this._config!=null?this._config.traits:void 0)!=null?this._config!=
null?this._config.traits:void 0:[]);m==null&&(m=(this._config!=null?this._config.props:void 0)!=null?this._config!=null?this._config.props:void 0:{});p==null&&(p=(this._config!=null?this._config.finals:void 0)!=null?this._config!=null?this._config.finals:void 0:{});z==null&&(z=(this._config!=null?this._config.freeform:void 0)!=null?this._config!=null?this._config.freeform:void 0:!1);this._config={traits:k,props:m,finals:p,freeform:z};return this.attributes=f.apply(this,this._config)}dispose(){this.attributes.dispose();
return this.attributes=null}_added(g){this.parent=g;this.root=g.root;g={type:"add",node:this,parent:this.parent};this.root&&this.root.trigger(g);g.type="added";return this.trigger(g)}_removed(){const g={type:"remove",node:this};this.root&&this.root.trigger(g);g.type="removed";this.trigger(g);return this.root=this.parent=null}_index(g,f){f==null&&({parent:f}=this);this.index=g;this.path=g=g!=null?((f!=null?f.path:void 0)!=null?f!=null?f.path:void 0:[]).concat([g]):null;this.order=g!=null?this._encode(g):
Infinity;if(this.root!=null)return this.trigger({type:"reindex"})}_encode(g){let f=1+1/3,k=0;for(const m of Array.from(g))[f,k]=Array.from([k+3/(m+1+3)*(f-k),k+3/(m+2+3)*(f-k)]);return f}toString(){const g=this.type!=null?this.type:"node";let f;f=g+`#${this.id!=null?this.id:this._id}`;this.classes!=null&&this.classes.length&&(f+=`.${this.classes.join(".")}`);if(this.children!=null){let k;return(k=this.children.length)?`<${f}>\u2026(${k})\u2026</${g}>`:`<${f}></${g}>`}return`<${f} />`}toMarkup(g=null,
f){let k,m;f==null&&(f="");if(g&&typeof g!=="function"){var p;g=(p=this.root!=null?this.root.model._matcher(g):void 0)!=null?p:()=>!0}p=this.type!=null?this.type:"node";let {expr:z}=this;const t={id:this._id};var v=typeof this.orig==="function"?this.orig():void 0;for(k in v)m=v[k],t[k]=m;v=(()=>{const D=[];for(k in t)m=t[k],this.expr[k]||D.push(x.JSX.prop(k,m));return D})();z=(()=>{const D=[];for(k in z)m=z[k],D.push(x.JSX.bind(k,m));return D})();var y=[""];v.length&&(y=y.concat(v));z.length&&(y=
y.concat(z));y=y.join(" ");let B=f;v=()=>this.children!=null&&this.children.length?this.children.map(D=>D.toMarkup(g,B)).filter(D=>D!=null&&D.length).join("\n"):"";return g&&!g(this)?v():this.children!=null?(y=`<${p}${y}>`,p=`</${p}>`,B=f+"  ",v=v(),v.length&&(v="\n"+v+"\n"+f),v==null&&(v=""),f+y+v+p):`${f}<${p}${y} />`}print(g,f){return x.print(this.toMarkup(g),f)}}l.Binder.apply(e.prototype)};
shadow$provide[136]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Group:{enumerable:!0,get:function(){return x}}});l=l(135);class x extends l.Node{constructor(r,e,g,f,k,m){super(r,e,g,f,k,m);this.children=[];this.on("reindex",p=>Array.from(this.children).map(z=>z.trigger(p)))}add(r){r.parent!=null&&r.parent.remove(r);r._index(this.children.length,this);this.children.push(r);return r._added(this)}remove(r){r.children!=null&&r.children.length&&r.empty();const e=this.children.indexOf(r);
if(e!==-1){this.children.splice(e,1);r._index(null);r._removed(this);for(let g=0;g<this.children.length;g++)r=this.children[g],g>=e&&r._index(g)}}empty(){const r=this.children.slice().reverse();for(const e of Array.from(r))this.remove(e)}}};
shadow$provide[137]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Guard:{enumerable:!0,get:function(){return x}}});class x{constructor(r){r==null&&(r=10);this.limit=r}iterate(r){const {step:e,last:g}=r;for({limit:r}=this;e();)if(!--r)throw console.warn("Last iteration",typeof g==="function"?g():void 0),Error("Exceeded iteration limit.");return null}}};
shadow$provide[138]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.Doctype=q.CDATA=q.Tag=q.Style=q.Script=q.Comment=q.Directive=q.Text=q.Root=q.isTag=q.ElementType=void 0;var x;(function(r){r.Root="root";r.Text="text";r.Directive="directive";r.Comment="comment";r.Script="script";r.Style="style";r.Tag="tag";r.CDATA="cdata";r.Doctype="doctype"})(x=q.ElementType||(q.ElementType={}));q.isTag=function(r){return r.type===x.Tag||r.type===x.Script||r.type===x.Style};q.Root=x.Root;q.Text=
x.Text;q.Directive=x.Directive;q.Comment=x.Comment;q.Script=x.Script;q.Style=x.Style;q.Tag=x.Tag;q.CDATA=x.CDATA;q.Doctype=x.Doctype};
shadow$provide[139]=function(l,L,q){function x(O){return(0,v.isTag)(O)}function r(O){return O.type===v.ElementType.CDATA}function e(O){return O.type===v.ElementType.Text}function g(O){return O.type===v.ElementType.Comment}function f(O){return O.type===v.ElementType.Directive}function k(O){return O.type===v.ElementType.Root}function m(O,J){J===void 0&&(J=!1);if(e(O))J=new B(O.data);else if(g(O))J=new D(O.data);else if(x(O)){J=J?p(O.children):[];var W=new Q(O.name,t({},O.attribs),J);J.forEach(function(S){return S.parent=
W});O.namespace!=null&&(W.namespace=O.namespace);O["x-attribsNamespace"]&&(W["x-attribsNamespace"]=t({},O["x-attribsNamespace"]));O["x-attribsPrefix"]&&(W["x-attribsPrefix"]=t({},O["x-attribsPrefix"]));J=W}else if(r(O)){J=J?p(O.children):[];var ba=new I(v.ElementType.CDATA,J);J.forEach(function(S){return S.parent=ba});J=ba}else if(k(O)){J=J?p(O.children):[];var Y=new K(J);J.forEach(function(S){return S.parent=Y});O["x-mode"]&&(Y["x-mode"]=O["x-mode"]);J=Y}else if(f(O))J=new G(O.name,O.data),O["x-name"]!=
null&&(J["x-name"]=O["x-name"],J["x-publicId"]=O["x-publicId"],J["x-systemId"]=O["x-systemId"]);else throw Error("Not implemented yet: ".concat(O.type));J.startIndex=O.startIndex;J.endIndex=O.endIndex;O.sourceCodeLocation!=null&&(J.sourceCodeLocation=O.sourceCodeLocation);return J}function p(O){O=O.map(function(W){return m(W,!0)});for(var J=1;J<O.length;J++)O[J].prev=O[J-1],O[J-1].next=O[J];return O}var z=this&&this.__extends||function(){var O=function(J,W){O=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(ba,Y){ba.__proto__=Y}||function(ba,Y){for(var S in Y)Object.prototype.hasOwnProperty.call(Y,S)&&(ba[S]=Y[S])};return O(J,W)};return function(J,W){function ba(){this.constructor=J}if(typeof W!=="function"&&W!==null)throw new TypeError("Class extends value "+String(W)+" is not a constructor or null");O(J,W);J.prototype=W===null?Object.create(W):(ba.prototype=W.prototype,new ba)}}(),t=this&&this.__assign||function(){t=Object.assign||function(O){for(var J,W=1,ba=arguments.length;W<ba;W++){J=
arguments[W];for(var Y in J)Object.prototype.hasOwnProperty.call(J,Y)&&(O[Y]=J[Y])}return O};return t.apply(this,arguments)};Object.defineProperty(q,"__esModule",{value:!0});q.cloneNode=q.hasChildren=q.isDocument=q.isDirective=q.isComment=q.isText=q.isCDATA=q.isTag=q.Element=q.Document=q.NodeWithChildren=q.ProcessingInstruction=q.Comment=q.Text=q.DataNode=q.Node=void 0;var v=l(138),y=new Map([[v.ElementType.Tag,1],[v.ElementType.Script,1],[v.ElementType.Style,1],[v.ElementType.Directive,1],[v.ElementType.Text,
3],[v.ElementType.CDATA,4],[v.ElementType.Comment,8],[v.ElementType.Root,9]]);l=function(){function O(J){this.type=J;this.endIndex=this.startIndex=this.next=this.prev=this.parent=null}Object.defineProperty(O.prototype,"nodeType",{get:function(){var J;return(J=y.get(this.type))!==null&&J!==void 0?J:1},enumerable:!1,configurable:!0});Object.defineProperty(O.prototype,"parentNode",{get:function(){return this.parent},set:function(J){this.parent=J},enumerable:!1,configurable:!0});Object.defineProperty(O.prototype,
"previousSibling",{get:function(){return this.prev},set:function(J){this.prev=J},enumerable:!1,configurable:!0});Object.defineProperty(O.prototype,"nextSibling",{get:function(){return this.next},set:function(J){this.next=J},enumerable:!1,configurable:!0});O.prototype.cloneNode=function(J){J===void 0&&(J=!1);return m(this,J)};return O}();q.Node=l;L=function(O){function J(W,ba){W=O.call(this,W)||this;W.data=ba;return W}z(J,O);Object.defineProperty(J.prototype,"nodeValue",{get:function(){return this.data},
set:function(W){this.data=W},enumerable:!1,configurable:!0});return J}(l);q.DataNode=L;var B=function(O){function J(W){return O.call(this,v.ElementType.Text,W)||this}z(J,O);return J}(L);q.Text=B;var D=function(O){function J(W){return O.call(this,v.ElementType.Comment,W)||this}z(J,O);return J}(L);q.Comment=D;var G=function(O){function J(W,ba){ba=O.call(this,v.ElementType.Directive,ba)||this;ba.name=W;return ba}z(J,O);return J}(L);q.ProcessingInstruction=G;var I=function(O){function J(W,ba){W=O.call(this,
W)||this;W.children=ba;return W}z(J,O);Object.defineProperty(J.prototype,"firstChild",{get:function(){var W;return(W=this.children[0])!==null&&W!==void 0?W:null},enumerable:!1,configurable:!0});Object.defineProperty(J.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0});Object.defineProperty(J.prototype,"childNodes",{get:function(){return this.children},set:function(W){this.children=W},enumerable:!1,configurable:!0});
return J}(l);q.NodeWithChildren=I;var K=function(O){function J(W){return O.call(this,v.ElementType.Root,W)||this}z(J,O);return J}(I);q.Document=K;var Q=function(O){function J(W,ba,Y,S){Y===void 0&&(Y=[]);S===void 0&&(S=W==="script"?v.ElementType.Script:W==="style"?v.ElementType.Style:v.ElementType.Tag);Y=O.call(this,S,Y)||this;Y.name=W;Y.attribs=ba;return Y}z(J,O);Object.defineProperty(J.prototype,"tagName",{get:function(){return this.name},set:function(W){this.name=W},enumerable:!1,configurable:!0});
Object.defineProperty(J.prototype,"attributes",{get:function(){var W=this;return Object.keys(this.attribs).map(function(ba){var Y,S;return{name:ba,value:W.attribs[ba],namespace:(Y=W["x-attribsNamespace"])===null||Y===void 0?void 0:Y[ba],prefix:(S=W["x-attribsPrefix"])===null||S===void 0?void 0:S[ba]}})},enumerable:!1,configurable:!0});return J}(I);q.Element=Q;q.isTag=x;q.isCDATA=r;q.isText=e;q.isComment=g;q.isDirective=f;q.isDocument=k;q.hasChildren=function(O){return Object.prototype.hasOwnProperty.call(O,
"children")};q.cloneNode=m};
shadow$provide[140]=function(l,L,q){var x=this&&this.__createBinding||(Object.create?function(k,m,p,z){z===void 0&&(z=p);var t=Object.getOwnPropertyDescriptor(m,p);if(!t||("get"in t?!m.__esModule:t.writable||t.configurable))t={enumerable:!0,get:function(){return m[p]}};Object.defineProperty(k,z,t)}:function(k,m,p,z){z===void 0&&(z=p);k[z]=m[p]});L=this&&this.__exportStar||function(k,m){for(var p in k)p==="default"||Object.prototype.hasOwnProperty.call(m,p)||x(m,k,p)};Object.defineProperty(q,"__esModule",
{value:!0});q.DomHandler=void 0;var r=l(138),e=l(139);L(l(139),q);var g=/\s+/g,f={normalizeWhitespace:!1,withStartIndices:!1,withEndIndices:!1,xmlMode:!1};l=function(){function k(m,p,z){this.dom=[];this.root=new e.Document(this.dom);this.done=!1;this.tagStack=[this.root];this.parser=this.lastNode=null;typeof p==="function"&&(z=p,p=f);typeof m==="object"&&(p=m,m=void 0);this.callback=m!==null&&m!==void 0?m:null;this.options=p!==null&&p!==void 0?p:f;this.elementCB=z!==null&&z!==void 0?z:null}k.prototype.onparserinit=
function(m){this.parser=m};k.prototype.onreset=function(){this.dom=[];this.root=new e.Document(this.dom);this.done=!1;this.tagStack=[this.root];this.parser=this.lastNode=null};k.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))};k.prototype.onerror=function(m){this.handleCallback(m)};k.prototype.onclosetag=function(){this.lastNode=null;var m=this.tagStack.pop();this.options.withEndIndices&&(m.endIndex=this.parser.endIndex);this.elementCB&&this.elementCB(m)};
k.prototype.onopentag=function(m,p){m=new e.Element(m,p,void 0,this.options.xmlMode?r.ElementType.Tag:void 0);this.addNode(m);this.tagStack.push(m)};k.prototype.ontext=function(m){var p=this.options.normalizeWhitespace,z=this.lastNode;z&&z.type===r.ElementType.Text?(z.data=p?(z.data+m).replace(g," "):z.data+m,this.options.withEndIndices&&(z.endIndex=this.parser.endIndex)):(p&&(m=m.replace(g," ")),m=new e.Text(m),this.addNode(m),this.lastNode=m)};k.prototype.oncomment=function(m){this.lastNode&&this.lastNode.type===
r.ElementType.Comment?this.lastNode.data+=m:(m=new e.Comment(m),this.addNode(m),this.lastNode=m)};k.prototype.oncommentend=function(){this.lastNode=null};k.prototype.oncdatastart=function(){var m=new e.Text(""),p=new e.NodeWithChildren(r.ElementType.CDATA,[m]);this.addNode(p);m.parent=p;this.lastNode=m};k.prototype.oncdataend=function(){this.lastNode=null};k.prototype.onprocessinginstruction=function(m,p){m=new e.ProcessingInstruction(m,p);this.addNode(m)};k.prototype.handleCallback=function(m){if(typeof this.callback===
"function")this.callback(m,this.dom);else if(m)throw m;};k.prototype.addNode=function(m){var p=this.tagStack[this.tagStack.length-1],z=p.children[p.children.length-1];this.options.withStartIndices&&(m.startIndex=this.parser.startIndex);this.options.withEndIndices&&(m.endIndex=this.parser.endIndex);p.children.push(m);z&&(m.prev=z,z.next=m);m.parent=p;this.lastNode=null};return k}();q.DomHandler=l;q.default=l};
shadow$provide[141]=function(l,L,q){L.exports={Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"\ud835\udd04",afr:"\ud835\udd1e",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",amp:"\x26",AMP:"\x26",andand:"⩕",And:"⩓",and:"∧",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",
angmsdag:"⦮",angmsdah:"⦯",angmsd:"∡",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"\ud835\udd38",aopf:"\ud835\udd52",apacir:"⩯",ap:"≈",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"\ud835\udc9c",ascr:"\ud835\udcb6",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",
Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"\ud835\udd05",bfr:"\ud835\udd1f",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",
blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"\x3d⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"\ud835\udd39",bopf:"\ud835\udd53",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxHd:"╤",boxhD:"╥",boxHD:"╦",boxhu:"┴",boxHu:"╧",boxhU:"╨",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",
boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"\ud835\udcb7",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsolb:"⧅",bsol:"\\",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",capand:"⩄",capbrcup:"⩉",capcap:"⩋",cap:"∩",Cap:"⋒",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",
caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"\ud835\udd20",Cfr:"ℭ",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",
cir:"○",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"\ud835\udd54",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",
Cscr:"\ud835\udc9e",cscr:"\ud835\udcb8",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cup:"∪",Cup:"⋓",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",Darr:"↡",dArr:"⇓",dash:"‐",
Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",ddagger:"‡",ddarr:"⇊",DD:"ⅅ",dd:"ⅆ",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"\ud835\udd07",dfr:"\ud835\udd21",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",
divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"\ud835\udd3b",dopf:"\ud835\udd55",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",
DoubleVerticalBar:"∥",DownArrowBar:"⤓",downarrow:"↓",DownArrow:"↓",Downarrow:"⇓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVectorBar:"⥖",DownLeftVector:"↽",DownRightTeeVector:"⥟",DownRightVectorBar:"⥗",DownRightVector:"⇁",DownTeeArrow:"↧",DownTee:"⊤",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"\ud835\udc9f",dscr:"\ud835\udcb9",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",
dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",Ecirc:"Ê",ecirc:"ê",ecir:"≖",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",edot:"ė",eDot:"≑",ee:"ⅇ",efDot:"≒",Efr:"\ud835\udd08",efr:"\ud835\udd22",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp13:" ",emsp14:" ",
emsp:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"\ud835\udd3c",eopf:"\ud835\udd56",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"\x3d",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",
exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"\ud835\udd09",ffr:"\ud835\udd23",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"\ud835\udd3d",fopf:"\ud835\udd57",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",
frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"\ud835\udcbb",Fscr:"ℱ",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",ge:"≥",gE:"≧",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",gescc:"⪩",ges:"⩾",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"\ud835\udd0a",gfr:"\ud835\udd24",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gla:"⪥",gl:"≷",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",
gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"\ud835\udd3e",gopf:"\ud835\udd58",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"\ud835\udca2",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",gtcc:"⪧",gtcir:"⩺",gt:"\x3e",GT:"\x3e",Gt:"≫",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",
HARDcy:"Ъ",hardcy:"ъ",harrcir:"⥈",harr:"↔",hArr:"⇔",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"\ud835\udd25",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"\ud835\udd59",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"\ud835\udcbd",Hscr:"ℋ",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",
icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",ifr:"\ud835\udd26",Ifr:"ℑ",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",Im:"ℑ",imof:"⊷",imped:"Ƶ",Implies:"⇒",incare:"℅","in":"∈",infin:"∞",infintie:"⧝",inodot:"ı",intcal:"⊺","int":"∫",Int:"∬",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",
iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"\ud835\udd40",iopf:"\ud835\udd5a",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",iscr:"\ud835\udcbe",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"\ud835\udd0d",jfr:"\ud835\udd27",jmath:"ȷ",Jopf:"\ud835\udd41",jopf:"\ud835\udd5b",Jscr:"\ud835\udca5",jscr:"\ud835\udcbf",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",
Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"\ud835\udd0e",kfr:"\ud835\udd28",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"\ud835\udd42",kopf:"\ud835\udd5c",Kscr:"\ud835\udca6",kscr:"\ud835\udcc0",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larrb:"⇤",larrbfs:"⤟",larr:"←",Larr:"↞",lArr:"⇐",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",latail:"⤙",lAtail:"⤛",lat:"⪫",late:"⪭",
lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",LeftArrowBar:"⇤",leftarrow:"←",LeftArrow:"←",Leftarrow:"⇐",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVectorBar:"⥙",LeftDownVector:"⇃",LeftFloor:"⌊",leftharpoondown:"↽",
leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTeeArrow:"↤",LeftTee:"⊣",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangleBar:"⧏",LeftTriangle:"⊲",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVectorBar:"⥘",LeftUpVector:"↿",LeftVectorBar:"⥒",LeftVector:"↼",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",lescc:"⪨",les:"⩽",lesdot:"⩿",lesdoto:"⪁",
lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"\ud835\udd0f",lfr:"\ud835\udd29",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",llarr:"⇇",ll:"≪",Ll:"⋘",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoustache:"⎰",lmoust:"⎰",lnap:"⪉",lnapprox:"⪉",
lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftrightarrow:"⟷",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longmapsto:"⟼",longrightarrow:"⟶",LongRightArrow:"⟶",Longrightarrow:"⟹",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"\ud835\udd43",lopf:"\ud835\udd5d",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",
lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"\ud835\udcc1",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",ltcc:"⪦",ltcir:"⩹",lt:"\x3c",LT:"\x3c",Lt:"≪",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",
mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"\ud835\udd10",mfr:"\ud835\udd2a",mho:"℧",micro:"µ",midast:"*",midcir:"⫰",mid:"∣",middot:"·",minusb:"⊟",minus:"−",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"\ud835\udd44",mopf:"\ud835\udd5e",mp:"∓",mscr:"\ud835\udcc2",Mscr:"ℳ",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natural:"♮",naturals:"ℕ",
natur:"♮",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",ne:"≠",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"\ud835\udd11",nfr:"\ud835\udd2b",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",
nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nlE:"≦̸",nle:"≰",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"\ud835\udd5f",Nopf:"ℕ",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",
NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangleBar:"⧏̸",NotLeftTriangle:"⋪",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",
NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangleBar:"⧐̸",NotRightTriangle:"⋫",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",
NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",nparallel:"∦",npar:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",nprec:"⊀",npreceq:"⪯̸",npre:"⪯̸",nrarrc:"⤳̸",nrarr:"↛",nrArr:"⇏",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"\ud835\udca9",nscr:"\ud835\udcc3",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",
nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:"\x3e⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"\x3c⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",
nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",Ocirc:"Ô",ocirc:"ô",ocir:"⊚",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"\ud835\udd12",ofr:"\ud835\udd2c",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"\ud835\udd46",oopf:"\ud835\udd60",opar:"⦷",
OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",orarr:"↻",Or:"⩔",or:"∨",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"\ud835\udcaa",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",otimesas:"⨶",Otimes:"⨷",otimes:"⊗",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",para:"¶",parallel:"∥",par:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",
permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"\ud835\udd13",pfr:"\ud835\udd2d",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plus:"+",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"\ud835\udd61",Popf:"ℙ",pound:"£",prap:"⪷",Pr:"⪻",pr:"≺",prcue:"≼",precapprox:"⪷",prec:"≺",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",
PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",pre:"⪯",prE:"⪳",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportional:"∝",Proportion:"∷",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"\ud835\udcab",pscr:"\ud835\udcc5",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"\ud835\udd14",qfr:"\ud835\udd2e",qint:"⨌",qopf:"\ud835\udd62",Qopf:"ℚ",qprime:"⁗",Qscr:"\ud835\udcac",qscr:"\ud835\udcc6",quaternions:"ℍ",
quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarr:"→",Rarr:"↠",rArr:"⇒",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",
rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",Re:"ℜ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"\ud835\udd2f",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrowBar:"⇥",rightarrow:"→",RightArrow:"→",Rightarrow:"⇒",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",
RightDownTeeVector:"⥝",RightDownVectorBar:"⥕",RightDownVector:"⇂",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTeeArrow:"↦",RightTee:"⊢",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangleBar:"⧐",RightTriangle:"⊳",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVectorBar:"⥔",RightUpVector:"↾",RightVectorBar:"⥓",RightVector:"⇀",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",
rmoustache:"⎱",rmoust:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"\ud835\udd63",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"\ud835\udcc7",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",scap:"⪸",Scaron:"Š",scaron:"š",Sc:"⪼",sc:"≻",sccue:"≽",sce:"⪰",scE:"⪴",Scedil:"Ş",
scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdotb:"⊡",sdot:"⋅",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"\ud835\udd16",sfr:"\ud835\udd30",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",
sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",solbar:"⌿",solb:"⧄",sol:"/",Sopf:"\ud835\udd4a",sopf:"\ud835\udd64",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",square:"□",Square:"□",
SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squ:"□",squf:"▪",srarr:"→",Sscr:"\ud835\udcae",sscr:"\ud835\udcc8",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",
subsim:"⫇",subsub:"⫕",subsup:"⫓",succapprox:"⪸",succ:"≻",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup1:"¹",sup2:"²",sup3:"³",sup:"⊃",Sup:"⋑",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",
supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"\ud835\udd17",tfr:"\ud835\udd31",there4:"∴",therefore:"∴",Therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",ThinSpace:" ",thinsp:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",tilde:"˜",Tilde:"∼",
TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",timesbar:"⨱",timesb:"⊠",times:"×",timesd:"⨰",tint:"∭",toea:"⤨",topbot:"⌶",topcir:"⫱",top:"⊤",Topf:"\ud835\udd4b",topf:"\ud835\udd65",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"\ud835\udcaf",tscr:"\ud835\udcc9",TScy:"Ц",tscy:"ц",
TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",uarr:"↑",Uarr:"↟",uArr:"⇑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"\ud835\udd18",ufr:"\ud835\udd32",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",
UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"\ud835\udd4c",uopf:"\ud835\udd66",UpArrowBar:"⤒",uparrow:"↑",UpArrow:"↑",Uparrow:"⇑",UpArrowDownArrow:"⇅",updownarrow:"↕",UpDownArrow:"↕",Updownarrow:"⇕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTeeArrow:"↥",UpTee:"⊥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"\ud835\udcb0",
uscr:"\ud835\udcca",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",Vcy:"В",vcy:"в",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",veebar:"⊻",vee:"∨",Vee:"⋁",veeeq:"≚",
vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"\ud835\udd19",vfr:"\ud835\udd33",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"\ud835\udd4d",vopf:"\ud835\udd67",vprop:"∝",vrtri:"⊳",Vscr:"\ud835\udcb1",vscr:"\ud835\udccb",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",Wfr:"\ud835\udd1a",wfr:"\ud835\udd34",Wopf:"\ud835\udd4e",
wopf:"\ud835\udd68",wp:"℘",wr:"≀",wreath:"≀",Wscr:"\ud835\udcb2",wscr:"\ud835\udccc",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"\ud835\udd1b",xfr:"\ud835\udd35",xharr:"⟷",xhArr:"⟺",Xi:"Ξ",xi:"ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"\ud835\udd4f",xopf:"\ud835\udd69",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",Xscr:"\ud835\udcb3",xscr:"\ud835\udccd",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",
Yfr:"\ud835\udd1c",yfr:"\ud835\udd36",YIcy:"Ї",yicy:"ї",Yopf:"\ud835\udd50",yopf:"\ud835\udd6a",Yscr:"\ud835\udcb4",yscr:"\ud835\udcce",YUcy:"Ю",yucy:"ю",yuml:"ÿ",Yuml:"Ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",zfr:"\ud835\udd37",Zfr:"ℨ",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",zopf:"\ud835\udd6b",Zopf:"ℤ",Zscr:"\ud835\udcb5",zscr:"\ud835\udccf",zwj:"‍",zwnj:"‌"}};
shadow$provide[142]=function(l,L,q){L.exports={Aacute:"Á",aacute:"á",Acirc:"Â",acirc:"â",acute:"´",AElig:"Æ",aelig:"æ",Agrave:"À",agrave:"à",amp:"\x26",AMP:"\x26",Aring:"Å",aring:"å",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",brvbar:"¦",Ccedil:"Ç",ccedil:"ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",Eacute:"É",eacute:"é",Ecirc:"Ê",ecirc:"ê",Egrave:"È",egrave:"è",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",frac12:"½",frac14:"¼",frac34:"¾",gt:"\x3e",GT:"\x3e",Iacute:"Í",iacute:"í",Icirc:"Î",
icirc:"î",iexcl:"¡",Igrave:"Ì",igrave:"ì",iquest:"¿",Iuml:"Ï",iuml:"ï",laquo:"«",lt:"\x3c",LT:"\x3c",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",Ntilde:"Ñ",ntilde:"ñ",Oacute:"Ó",oacute:"ó",Ocirc:"Ô",ocirc:"ô",Ograve:"Ò",ograve:"ò",ordf:"ª",ordm:"º",Oslash:"Ø",oslash:"ø",Otilde:"Õ",otilde:"õ",Ouml:"Ö",ouml:"ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",THORN:"Þ",thorn:"þ",times:"×",Uacute:"Ú",uacute:"ú",Ucirc:"Û",
ucirc:"û",Ugrave:"Ù",ugrave:"ù",uml:"¨",Uuml:"Ü",uuml:"ü",Yacute:"Ý",yacute:"ý",yen:"¥",yuml:"ÿ"}};
shadow$provide[143]=function(l,L,q){L.exports={amp:"\x26",apos:"'",gt:"\x3e",lt:"\x3c",quot:'"'}};
shadow$provide[144]=function(l,L,q){L.exports={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376}};
shadow$provide[145]=function(l,L,q){L=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{"default":e}};Object.defineProperty(q,"__esModule",{value:!0});var x=L(l(144)),r=String.fromCodePoint||function(e){var g="";e>65535&&(e-=65536,g+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023);return g+=String.fromCharCode(e)};q.default=function(e){if(e>=55296&&e<=57343||e>1114111)return"�";e in x.default&&(e=x.default[e]);return r(e)}};
shadow$provide[146]=function(l,L,q){function x(z){var t=r(z);return function(v){return String(v).replace(m,t)}}function r(z){return function(t){if(t.charAt(1)==="#"){var v=t.charAt(2);return v==="X"||v==="x"?k.default(parseInt(t.substr(3),16)):k.default(parseInt(t.substr(2),10))}return z[t.slice(1,-1)]||t}}L=this&&this.__importDefault||function(z){return z&&z.__esModule?z:{"default":z}};Object.defineProperty(q,"__esModule",{value:!0});q.decodeHTML=q.decodeHTMLStrict=q.decodeXML=void 0;var e=L(l(141)),
g=L(l(142)),f=L(l(143)),k=L(l(145)),m=/&(?:[a-zA-Z0-9]+|#[xX][\da-fA-F]+|#\d+);/g;q.decodeXML=x(f.default);q.decodeHTMLStrict=x(e.default);var p=function(z,t){return z<t?1:-1};q.decodeHTML=function(){function z(I){I.substr(-1)!==";"&&(I+=";");return G(I)}for(var t=Object.keys(g.default).sort(p),v=Object.keys(e.default).sort(p),y=0,B=0;y<v.length;y++)t[B]===v[y]?(v[y]+=";?",B++):v[y]+=";";var D=new RegExp("\x26(?:"+v.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),G=r(e.default);return function(I){return String(I).replace(D,
z)}}()};
shadow$provide[147]=function(l,L,q){function x(t){return Object.keys(t).sort().reduce(function(v,y){v[t[y]]="\x26"+y+";";return v},{})}function r(t){var v=[],y=[],B=0;for(t=Object.keys(t);B<t.length;B++){var D=t[B];D.length===1?v.push("\\"+D):y.push(D)}v.sort();for(B=0;B<v.length-1;B++){for(t=B;t<v.length-1&&v[t].charCodeAt(1)+1===v[t+1].charCodeAt(1);)t+=1;D=1+t-B;D<3||v.splice(B,D,v[B]+"-"+v[t])}y.unshift("["+v.join("")+"]");return new RegExp(y.join("|"),"g")}function e(t){return"\x26#x"+(t.length>
1?p(t):t.charCodeAt(0)).toString(16).toUpperCase()+";"}function g(t){return function(v){return v.replace(z,function(y){return t[y]||e(y)})}}L=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(q,"__esModule",{value:!0});q.escapeUTF8=q.escape=q.encodeNonAsciiHTML=q.encodeHTML=q.encodeXML=void 0;var f=L(l(143));f=x(f.default);var k=r(f);q.encodeXML=g(f);l=L(l(141));l=x(l.default);L=r(l);q.encodeHTML=function(t,v){return function(y){return y.replace(v,
function(B){return t[B]}).replace(m,e)}}(l,L);q.encodeNonAsciiHTML=g(l);var m=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,p=String.prototype.codePointAt!=null?function(t){return t.codePointAt(0)}:function(t){return(t.charCodeAt(0)-55296)*1024+t.charCodeAt(1)-56320+65536},z=new RegExp(k.source+"|"+m.source,"g");q.escape=function(t){return t.replace(z,e)};q.escapeUTF8=function(t){return t.replace(k,e)}};
shadow$provide[148]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.decodeXMLStrict=q.decodeHTML5Strict=q.decodeHTML4Strict=q.decodeHTML5=q.decodeHTML4=q.decodeHTMLStrict=q.decodeHTML=q.decodeXML=q.encodeHTML5=q.encodeHTML4=q.escapeUTF8=q.escape=q.encodeNonAsciiHTML=q.encodeHTML=q.encodeXML=q.encode=q.decodeStrict=q.decode=void 0;var x=l(146),r=l(147);q.decode=function(f,k){return(!k||k<=0?x.decodeXML:x.decodeHTML)(f)};q.decodeStrict=function(f,k){return(!k||k<=0?x.decodeXML:x.decodeHTMLStrict)(f)};
q.encode=function(f,k){return(!k||k<=0?r.encodeXML:r.encodeHTML)(f)};var e=l(147);Object.defineProperty(q,"encodeXML",{enumerable:!0,get:function(){return e.encodeXML}});Object.defineProperty(q,"encodeHTML",{enumerable:!0,get:function(){return e.encodeHTML}});Object.defineProperty(q,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return e.encodeNonAsciiHTML}});Object.defineProperty(q,"escape",{enumerable:!0,get:function(){return e.escape}});Object.defineProperty(q,"escapeUTF8",{enumerable:!0,get:function(){return e.escapeUTF8}});
Object.defineProperty(q,"encodeHTML4",{enumerable:!0,get:function(){return e.encodeHTML}});Object.defineProperty(q,"encodeHTML5",{enumerable:!0,get:function(){return e.encodeHTML}});var g=l(146);Object.defineProperty(q,"decodeXML",{enumerable:!0,get:function(){return g.decodeXML}});Object.defineProperty(q,"decodeHTML",{enumerable:!0,get:function(){return g.decodeHTML}});Object.defineProperty(q,"decodeHTMLStrict",{enumerable:!0,get:function(){return g.decodeHTMLStrict}});Object.defineProperty(q,"decodeHTML4",
{enumerable:!0,get:function(){return g.decodeHTML}});Object.defineProperty(q,"decodeHTML5",{enumerable:!0,get:function(){return g.decodeHTML}});Object.defineProperty(q,"decodeHTML4Strict",{enumerable:!0,get:function(){return g.decodeHTMLStrict}});Object.defineProperty(q,"decodeHTML5Strict",{enumerable:!0,get:function(){return g.decodeHTMLStrict}});Object.defineProperty(q,"decodeXMLStrict",{enumerable:!0,get:function(){return g.decodeXML}})};
shadow$provide[149]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.attributeNames=q.elementNames=void 0;q.elementNames=new Map([["altglyph","altGlyph"],["altglyphdef","altGlyphDef"],["altglyphitem","altGlyphItem"],["animatecolor","animateColor"],["animatemotion","animateMotion"],["animatetransform","animateTransform"],["clippath","clipPath"],["feblend","feBlend"],["fecolormatrix","feColorMatrix"],["fecomponenttransfer","feComponentTransfer"],["fecomposite","feComposite"],["feconvolvematrix",
"feConvolveMatrix"],["fediffuselighting","feDiffuseLighting"],["fedisplacementmap","feDisplacementMap"],["fedistantlight","feDistantLight"],["fedropshadow","feDropShadow"],["feflood","feFlood"],["fefunca","feFuncA"],["fefuncb","feFuncB"],["fefuncg","feFuncG"],["fefuncr","feFuncR"],["fegaussianblur","feGaussianBlur"],["feimage","feImage"],["femerge","feMerge"],["femergenode","feMergeNode"],["femorphology","feMorphology"],["feoffset","feOffset"],["fepointlight","fePointLight"],["fespecularlighting",
"feSpecularLighting"],["fespotlight","feSpotLight"],["fetile","feTile"],["feturbulence","feTurbulence"],["foreignobject","foreignObject"],["glyphref","glyphRef"],["lineargradient","linearGradient"],["radialgradient","radialGradient"],["textpath","textPath"]]);q.attributeNames=new Map([["definitionurl","definitionURL"],["attributename","attributeName"],["attributetype","attributeType"],["basefrequency","baseFrequency"],["baseprofile","baseProfile"],["calcmode","calcMode"],["clippathunits","clipPathUnits"],
["diffuseconstant","diffuseConstant"],["edgemode","edgeMode"],["filterunits","filterUnits"],["glyphref","glyphRef"],["gradienttransform","gradientTransform"],["gradientunits","gradientUnits"],["kernelmatrix","kernelMatrix"],["kernelunitlength","kernelUnitLength"],["keypoints","keyPoints"],["keysplines","keySplines"],["keytimes","keyTimes"],["lengthadjust","lengthAdjust"],["limitingconeangle","limitingConeAngle"],["markerheight","markerHeight"],["markerunits","markerUnits"],["markerwidth","markerWidth"],
["maskcontentunits","maskContentUnits"],["maskunits","maskUnits"],["numoctaves","numOctaves"],["pathlength","pathLength"],["patterncontentunits","patternContentUnits"],["patterntransform","patternTransform"],["patternunits","patternUnits"],["pointsatx","pointsAtX"],["pointsaty","pointsAtY"],["pointsatz","pointsAtZ"],["preservealpha","preserveAlpha"],["preserveaspectratio","preserveAspectRatio"],["primitiveunits","primitiveUnits"],["refx","refX"],["refy","refY"],["repeatcount","repeatCount"],["repeatdur",
"repeatDur"],["requiredextensions","requiredExtensions"],["requiredfeatures","requiredFeatures"],["specularconstant","specularConstant"],["specularexponent","specularExponent"],["spreadmethod","spreadMethod"],["startoffset","startOffset"],["stddeviation","stdDeviation"],["stitchtiles","stitchTiles"],["surfacescale","surfaceScale"],["systemlanguage","systemLanguage"],["tablevalues","tableValues"],["targetx","targetX"],["targety","targetY"],["textlength","textLength"],["viewbox","viewBox"],["viewtarget",
"viewTarget"],["xchannelselector","xChannelSelector"],["ychannelselector","yChannelSelector"],["zoomandpan","zoomAndPan"]])};
shadow$provide[150]=function(l,L,q){function x(D,G){if(D)return Object.keys(D).map(function(I){var K,Q,O=(K=D[I])!==null&&K!==void 0?K:"";G.xmlMode==="foreign"&&(I=(Q=z.attributeNames.get(I))!==null&&Q!==void 0?Q:I);return G.emptyAttrs||G.xmlMode||O!==""?I+'\x3d"'+(G.decodeEntities!==!1?p.encodeXML(O):O.replace(/"/g,"\x26quot;"))+'"':I}).join(" ")}function r(D,G){G===void 0&&(G={});D="length"in D?D:[D];for(var I="",K=0;K<D.length;K++)I+=e(D[K],G);return I}function e(D,G){switch(D.type){case m.Root:return r(D.children,
G);case m.Directive:case m.Doctype:return"\x3c"+D.data+"\x3e";case m.Comment:return"\x3c!--"+D.data+"--\x3e";case m.CDATA:return"\x3c![CDATA["+D.children[0].data+"]]\x3e";case m.Script:case m.Style:case m.Tag:var I;G.xmlMode==="foreign"&&(D.name=(I=z.elementNames.get(D.name))!==null&&I!==void 0?I:D.name,D.parent&&y.has(D.parent.name)&&(G=g(g({},G),{xmlMode:!1})));!G.xmlMode&&B.has(D.name)&&(G=g(g({},G),{xmlMode:"foreign"}));I="\x3c"+D.name;var K=x(D.attribs,G);K&&(I+=" "+K);if(D.children.length===
0&&(G.xmlMode?G.selfClosingTags!==!1:G.selfClosingTags&&v.has(D.name)))G.xmlMode||(I+=" "),I+="/\x3e";else if(I+="\x3e",D.children.length>0&&(I+=r(D.children,G)),G.xmlMode||!v.has(D.name))I+="\x3c/"+D.name+"\x3e";return I;case m.Text:return I=D.data||"",G.decodeEntities===!1||!G.xmlMode&&D.parent&&t.has(D.parent.name)||(I=p.encodeXML(I)),I}}var g=this&&this.__assign||function(){g=Object.assign||function(D){for(var G,I=1,K=arguments.length;I<K;I++){G=arguments[I];for(var Q in G)Object.prototype.hasOwnProperty.call(G,
Q)&&(D[Q]=G[Q])}return D};return g.apply(this,arguments)},f=this&&this.__createBinding||(Object.create?function(D,G,I,K){K===void 0&&(K=I);Object.defineProperty(D,K,{enumerable:!0,get:function(){return G[I]}})}:function(D,G,I,K){K===void 0&&(K=I);D[K]=G[I]}),k=this&&this.__setModuleDefault||(Object.create?function(D,G){Object.defineProperty(D,"default",{enumerable:!0,value:G})}:function(D,G){D["default"]=G});L=this&&this.__importStar||function(D){if(D&&D.__esModule)return D;var G={};if(D!=null)for(var I in D)I!==
"default"&&Object.prototype.hasOwnProperty.call(D,I)&&f(G,D,I);k(G,D);return G};Object.defineProperty(q,"__esModule",{value:!0});var m=L(l(138)),p=l(148),z=l(149),t=new Set("style script xmp iframe noembed noframes plaintext noscript".split(" ")),v=new Set("area base basefont br col command embed frame hr img input isindex keygen link meta param source track wbr".split(" "));q.default=r;var y=new Set("mi mo mn ms mtext annotation-xml foreignObject desc title".split(" ")),B=new Set(["svg","math"])};
shadow$provide[151]=function(l,L,q){function x(p,z){return(0,k.default)(p,z)}function r(p){return Array.isArray(p)?p.map(r).join(""):(0,f.isTag)(p)?p.name==="br"?"\n":r(p.children):(0,f.isCDATA)(p)?r(p.children):(0,f.isText)(p)?p.data:""}function e(p){return Array.isArray(p)?p.map(e).join(""):(0,f.hasChildren)(p)&&!(0,f.isComment)(p)?e(p.children):(0,f.isText)(p)?p.data:""}function g(p){return Array.isArray(p)?p.map(g).join(""):(0,f.hasChildren)(p)&&(p.type===m.ElementType.Tag||(0,f.isCDATA)(p))?
g(p.children):(0,f.isText)(p)?p.data:""}L=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{"default":p}};Object.defineProperty(q,"__esModule",{value:!0});q.innerText=q.textContent=q.getText=q.getInnerHTML=q.getOuterHTML=void 0;var f=l(140),k=L(l(150)),m=l(138);q.getOuterHTML=x;q.getInnerHTML=function(p,z){return(0,f.hasChildren)(p)?p.children.map(function(t){return x(t,z)}).join(""):""};q.getText=r;q.textContent=e;q.innerText=g};
shadow$provide[152]=function(l,L,q){function x(f){var k;return(k=f.children)!==null&&k!==void 0?k:g}function r(f){return f.parent||null}Object.defineProperty(q,"__esModule",{value:!0});q.prevElementSibling=q.nextElementSibling=q.getName=q.hasAttrib=q.getAttributeValue=q.getSiblings=q.getParent=q.getChildren=void 0;var e=l(140),g=[];q.getChildren=x;q.getParent=r;q.getSiblings=function(f){var k=r(f);if(k!=null)return x(k);k=[f];var m=f.prev;for(f=f.next;m!=null;)k.unshift(m),m=m.prev;for(;f!=null;)k.push(f),
f=f.next;return k};q.getAttributeValue=function(f,k){var m;return(m=f.attribs)===null||m===void 0?void 0:m[k]};q.hasAttrib=function(f,k){return f.attribs!=null&&Object.prototype.hasOwnProperty.call(f.attribs,k)&&f.attribs[k]!=null};q.getName=function(f){return f.name};q.nextElementSibling=function(f){for(f=f.next;f!==null&&!(0,e.isTag)(f);)f=f.next;return f};q.prevElementSibling=function(f){for(f=f.prev;f!==null&&!(0,e.isTag)(f);)f=f.prev;return f}};
shadow$provide[153]=function(l,L,q){function x(r){r.prev&&(r.prev.next=r.next);r.next&&(r.next.prev=r.prev);if(r.parent){var e=r.parent.children;e.splice(e.lastIndexOf(r),1)}}Object.defineProperty(q,"__esModule",{value:!0});q.prepend=q.prependChild=q.append=q.appendChild=q.replaceElement=q.removeElement=void 0;q.removeElement=x;q.replaceElement=function(r,e){var g=e.prev=r.prev;g&&(g.next=e);if(g=e.next=r.next)g.prev=e;if(g=e.parent=r.parent)g=g.children,g[g.lastIndexOf(r)]=e};q.appendChild=function(r,
e){x(e);e.next=null;e.parent=r;r.children.push(e)>1?(r=r.children[r.children.length-2],r.next=e,e.prev=r):e.prev=null};q.append=function(r,e){x(e);var g=r.parent,f=r.next;e.next=f;e.prev=r;r.next=e;e.parent=g;f?(f.prev=e,g&&(r=g.children,r.splice(r.lastIndexOf(f),0,e))):g&&g.children.push(e)};q.prependChild=function(r,e){x(e);e.parent=r;e.prev=null;r.children.unshift(e)!==1?(r=r.children[1],r.prev=e,e.next=r):e.next=null};q.prepend=function(r,e){x(e);var g=r.parent;if(g){var f=g.children;f.splice(f.indexOf(r),
0,e)}r.prev&&(r.prev.next=e);e.parent=g;e.prev=r.prev;e.next=r;r.prev=e}};
shadow$provide[154]=function(l,L,q){function x(f,k,m,p){for(var z=[],t=0;t<k.length;t++){var v=k[t];if(f(v)&&(z.push(v),--p<=0))break;if(m&&(0,g.hasChildren)(v)&&v.children.length>0&&(v=x(f,v.children,m,p),z.push.apply(z,v),p-=v.length,p<=0))break}return z}function r(f,k,m){m===void 0&&(m=!0);for(var p=null,z=0;z<k.length&&!p;z++){var t=k[z];(0,g.isTag)(t)&&(f(t)?p=t:m&&t.children.length>0&&(p=r(f,t.children)))}return p}function e(f,k){return k.some(function(m){return(0,g.isTag)(m)&&(f(m)||m.children.length>
0&&e(f,m.children))})}Object.defineProperty(q,"__esModule",{value:!0});q.findAll=q.existsOne=q.findOne=q.findOneChild=q.find=q.filter=void 0;var g=l(140);q.filter=function(f,k,m,p){m===void 0&&(m=!0);p===void 0&&(p=Infinity);Array.isArray(k)||(k=[k]);return x(f,k,m,p)};q.find=x;q.findOneChild=function(f,k){return k.find(f)};q.findOne=r;q.existsOne=e;q.findAll=function(f,k){var m,p=[];k=k.filter(g.isTag);for(var z;z=k.shift();){var t=(m=z.children)===null||m===void 0?void 0:m.filter(g.isTag);t&&t.length>
0&&k.unshift.apply(k,t);f(z)&&p.push(z)}return p}};
shadow$provide[155]=function(l,L,q){function x(m,p){return typeof p==="function"?function(z){return(0,g.isTag)(z)&&p(z.attribs[m])}:function(z){return(0,g.isTag)(z)&&z.attribs[m]===p}}function r(m,p){return function(z){return m(z)||p(z)}}function e(m){var p=Object.keys(m).map(function(z){var t=m[z];return Object.prototype.hasOwnProperty.call(k,z)?k[z](t):x(z,t)});return p.length===0?null:p.reduce(r)}Object.defineProperty(q,"__esModule",{value:!0});q.getElementsByTagType=q.getElementsByTagName=q.getElementById=
q.getElements=q.testElement=void 0;var g=l(140),f=l(154),k={tag_name:function(m){return typeof m==="function"?function(p){return(0,g.isTag)(p)&&m(p.name)}:m==="*"?g.isTag:function(p){return(0,g.isTag)(p)&&p.name===m}},tag_type:function(m){return typeof m==="function"?function(p){return m(p.type)}:function(p){return p.type===m}},tag_contains:function(m){return typeof m==="function"?function(p){return(0,g.isText)(p)&&m(p.data)}:function(p){return(0,g.isText)(p)&&p.data===m}}};q.testElement=function(m,
p){return(m=e(m))?m(p):!0};q.getElements=function(m,p,z,t){t===void 0&&(t=Infinity);return(m=e(m))?(0,f.filter)(m,p,z,t):[]};q.getElementById=function(m,p,z){z===void 0&&(z=!0);Array.isArray(p)||(p=[p]);return(0,f.findOne)(x("id",m),p,z)};q.getElementsByTagName=function(m,p,z,t){z===void 0&&(z=!0);t===void 0&&(t=Infinity);return(0,f.filter)(k.tag_name(m),p,z,t)};q.getElementsByTagType=function(m,p,z,t){z===void 0&&(z=!0);t===void 0&&(t=Infinity);return(0,f.filter)(k.tag_type(m),p,z,t)}};
shadow$provide[156]=function(l,L,q){function x(e,g){var f=[],k=[];if(e===g)return 0;for(var m=(0,r.hasChildren)(e)?e:e.parent;m;)f.unshift(m),m=m.parent;for(m=(0,r.hasChildren)(g)?g:g.parent;m;)k.unshift(m),m=m.parent;var p=Math.min(f.length,k.length);for(m=0;m<p&&f[m]===k[m];)m++;if(m===0)return 1;p=f[m-1];var z=p.children;k=k[m];return z.indexOf(f[m])>z.indexOf(k)?p===g?20:4:p===e?10:2}Object.defineProperty(q,"__esModule",{value:!0});q.uniqueSort=q.compareDocumentPosition=q.removeSubsets=void 0;
var r=l(140);q.removeSubsets=function(e){for(var g=e.length;--g>=0;){var f=e[g];if(g>0&&e.lastIndexOf(f,g-1)>=0)e.splice(g,1);else for(f=f.parent;f;f=f.parent)if(e.includes(f)){e.splice(g,1);break}}return e};q.compareDocumentPosition=x;q.uniqueSort=function(e){e=e.filter(function(g,f,k){return!k.includes(g,f+1)});e.sort(function(g,f){g=x(g,f);return g&2?-1:g&4?1:0});return e}};
shadow$provide[157]=function(l,L,q){function x(y){var B;y=y.children;var D={type:"atom",items:(0,z.getElementsByTagName)("entry",y).map(function(I){var K,Q=I.children;I={media:e(Q)};k(I,"id","id",Q);k(I,"title","title",Q);var O=(K=g("link",Q))===null||K===void 0?void 0:K.attribs.href;O&&(I.link=O);if(K=f("summary",Q)||f("content",Q))I.description=K;if(K=f("updated",Q))I.pubDate=new Date(K);return I})};k(D,"id","id",y);k(D,"title","title",y);var G=(B=g("link",y))===null||B===void 0?void 0:B.attribs.href;
G&&(D.link=G);k(D,"description","subtitle",y);if(B=f("updated",y))D.updated=new Date(B);k(D,"author","email",y,!0);return D}function r(y){var B,D,G=(D=(B=g("channel",y.children))===null||B===void 0?void 0:B.children)!==null&&D!==void 0?D:[];y={type:y.name.substr(0,3),id:"",items:(0,z.getElementsByTagName)("item",y.children).map(function(I){var K=I.children;I={media:e(K)};k(I,"id","guid",K);k(I,"title","title",K);k(I,"link","link",K);k(I,"description","description",K);if(K=f("pubDate",K))I.pubDate=
new Date(K);return I})};k(y,"title","title",G);k(y,"link","link",G);k(y,"description","description",G);if(B=f("lastBuildDate",G))y.updated=new Date(B);k(y,"author","managingEditor",G,!0);return y}function e(y){return(0,z.getElementsByTagName)("media:content",y).map(function(B){B=B.attribs;for(var D={medium:B.medium,isDefault:!!B.isDefault},G=0,I=t;G<I.length;G++){var K=I[G];B[K]&&(D[K]=B[K])}G=0;for(I=v;G<I.length;G++)K=I[G],B[K]&&(D[K]=parseInt(B[K],10));B.expression&&(D.expression=B.expression);
return D})}function g(y,B){return(0,z.getElementsByTagName)(y,B,!0,1)[0]}function f(y,B,D){D===void 0&&(D=!1);return(0,p.textContent)((0,z.getElementsByTagName)(y,B,D,1)).trim()}function k(y,B,D,G,I){I===void 0&&(I=!1);(D=f(D,G,I))&&(y[B]=D)}function m(y){return y==="rss"||y==="feed"||y==="rdf:RDF"}Object.defineProperty(q,"__esModule",{value:!0});q.getFeed=void 0;var p=l(151),z=l(155);q.getFeed=function(y){return(y=g(m,y))?y.name==="feed"?x(y):r(y):null};var t=["url","type","lang"],v="fileSize bitrate framerate samplingrate channels duration height width".split(" ")};
shadow$provide[158]=function(l,L,q){var x=this&&this.__createBinding||(Object.create?function(e,g,f,k){k===void 0&&(k=f);Object.defineProperty(e,k,{enumerable:!0,get:function(){return g[f]}})}:function(e,g,f,k){k===void 0&&(k=f);e[k]=g[f]});L=this&&this.__exportStar||function(e,g){for(var f in e)f==="default"||Object.prototype.hasOwnProperty.call(g,f)||x(g,e,f)};Object.defineProperty(q,"__esModule",{value:!0});q.hasChildren=q.isDocument=q.isComment=q.isText=q.isCDATA=q.isTag=void 0;L(l(151),q);L(l(152),
q);L(l(153),q);L(l(154),q);L(l(155),q);L(l(156),q);L(l(157),q);var r=l(140);Object.defineProperty(q,"isTag",{enumerable:!0,get:function(){return r.isTag}});Object.defineProperty(q,"isCDATA",{enumerable:!0,get:function(){return r.isCDATA}});Object.defineProperty(q,"isText",{enumerable:!0,get:function(){return r.isText}});Object.defineProperty(q,"isComment",{enumerable:!0,get:function(){return r.isComment}});Object.defineProperty(q,"isDocument",{enumerable:!0,get:function(){return r.isDocument}});Object.defineProperty(q,
"hasChildren",{enumerable:!0,get:function(){return r.hasChildren}})};
shadow$provide[159]=function(l,L,q){L.exports={trueFunc:function(){return!0},falseFunc:function(){return!1}}};
shadow$provide[160]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.AttributeAction=q.IgnoreCaseMode=q.SelectorType=void 0;(function(x){x.Attribute="attribute";x.Pseudo="pseudo";x.PseudoElement="pseudo-element";x.Tag="tag";x.Universal="universal";x.Adjacent="adjacent";x.Child="child";x.Descendant="descendant";x.Parent="parent";x.Sibling="sibling";x.ColumnCombinator="column-combinator"})(q.SelectorType||(q.SelectorType={}));q.IgnoreCaseMode={Unknown:null,QuirksMode:"quirks",IgnoreCase:!0,
CaseSensitive:!1};(function(x){x.Any="any";x.Element="element";x.End="end";x.Equals="equals";x.Exists="exists";x.Hyphen="hyphen";x.Not="not";x.Start="start"})(q.AttributeAction||(q.AttributeAction={}))};
shadow$provide[161]=function(l,L,q){function x(B){switch(B.type){case m.SelectorType.Adjacent:case m.SelectorType.Child:case m.SelectorType.Descendant:case m.SelectorType.Parent:case m.SelectorType.Sibling:case m.SelectorType.ColumnCombinator:return!0;default:return!1}}function r(B,D,G){B=parseInt(D,16)-65536;return B!==B||G?D:B<0?String.fromCharCode(B+65536):String.fromCharCode(B>>10|55296,B&1023|56320)}function e(B){return B.replace(z,r)}function g(B){return B===39||B===34}function f(B){return B===
32||B===9||B===10||B===12||B===13}function k(B,D,G){function I(ra){var Ea=D.slice(G+ra).match(p);if(!Ea)throw Error("Expected name, found ".concat(D.slice(G)));Ea=Ea[0];G+=ra+Ea.length;return e(Ea)}function K(ra){for(G+=ra;G<D.length&&f(D.charCodeAt(G));)G++}function Q(){for(var ra=G+=1,Ea=1;Ea>0&&G<D.length;G++)D.charCodeAt(G)!==40||O(G)?D.charCodeAt(G)!==41||O(G)||Ea--:Ea++;if(Ea)throw Error("Parenthesis not matched");return e(D.slice(ra,G-1))}function O(ra){for(var Ea=0;D.charCodeAt(--ra)===92;)Ea++;
return(Ea&1)===1}function J(){if(S.length>0&&x(S[S.length-1]))throw Error("Did not expect successive traversals.");}function W(ra){S.length>0&&S[S.length-1].type===m.SelectorType.Descendant?S[S.length-1].type=ra:(J(),S.push({type:ra}))}function ba(ra,Ea){S.push({type:m.SelectorType.Attribute,name:ra,action:Ea,value:I(1),namespace:null,ignoreCase:"quirks"})}function Y(){S.length&&S[S.length-1].type===m.SelectorType.Descendant&&S.pop();if(S.length===0)throw Error("Empty sub-selector");B.push(S)}var S=
[];K(0);if(D.length===G)return G;a:for(;G<D.length;){var ca=D.charCodeAt(G);switch(ca){case 32:case 9:case 10:case 12:case 13:if(S.length===0||S[0].type!==m.SelectorType.Descendant)J(),S.push({type:m.SelectorType.Descendant});K(1);break;case 62:W(m.SelectorType.Child);K(1);break;case 60:W(m.SelectorType.Parent);K(1);break;case 126:W(m.SelectorType.Sibling);K(1);break;case 43:W(m.SelectorType.Adjacent);K(1);break;case 46:ba("class",m.AttributeAction.Element);break;case 35:ba("id",m.AttributeAction.Equals);
break;case 91:K(1);ca=void 0;var V=null;D.charCodeAt(G)===124?ca=I(1):D.startsWith("*|",G)?(V="*",ca=I(2)):(ca=I(0),D.charCodeAt(G)===124&&D.charCodeAt(G+1)!==61&&(V=ca,ca=I(1)));K(0);var xa=m.AttributeAction.Exists,na=t.get(D.charCodeAt(G));if(na){xa=na;if(D.charCodeAt(G+1)!==61)throw Error("Expected `\x3d`");K(2)}else D.charCodeAt(G)===61&&(xa=m.AttributeAction.Equals,K(1));var N="";na=null;if(xa!=="exists"){if(g(D.charCodeAt(G))){N=D.charCodeAt(G);for(var pa=G+1;pa<D.length&&(D.charCodeAt(pa)!==
N||O(pa));)pa+=1;if(D.charCodeAt(pa)!==N)throw Error("Attribute value didn't end");N=e(D.slice(G+1,pa));G=pa+1}else{for(N=G;G<D.length&&(!f(D.charCodeAt(G))&&D.charCodeAt(G)!==93||O(G));)G+=1;N=e(D.slice(N,G))}K(0);pa=D.charCodeAt(G)|32;pa===115?(na=!1,K(1)):pa===105&&(na=!0,K(1))}if(D.charCodeAt(G)!==93)throw Error("Attribute selector didn't terminate");G+=1;S.push({type:m.SelectorType.Attribute,name:ca,action:xa,value:N,namespace:V,ignoreCase:na});break;case 58:if(D.charCodeAt(G+1)===58){S.push({type:m.SelectorType.PseudoElement,
name:I(2).toLowerCase(),data:D.charCodeAt(G)===40?Q():null});continue}V=I(1).toLowerCase();ca=null;if(D.charCodeAt(G)===40)if(v.has(V)){if(g(D.charCodeAt(G+1)))throw Error("Pseudo-selector ".concat(V," cannot be quoted"));ca=[];G=k(ca,D,G+1);if(D.charCodeAt(G)!==41)throw Error("Missing closing parenthesis in :".concat(V," (").concat(D,")"));G+=1}else ca=Q(),y.has(V)&&(xa=ca.charCodeAt(0),xa===ca.charCodeAt(ca.length-1)&&g(xa)&&(ca=ca.slice(1,-1))),ca=e(ca);S.push({type:m.SelectorType.Pseudo,name:V,
data:ca});break;case 44:Y();S=[];K(1);break;default:if(D.startsWith("/*",G)){V=D.indexOf("*/",G+2);if(V<0)throw Error("Comment was not terminated");G=V+2;S.length===0&&K(0)}else{V=null;xa=void 0;if(ca===42)G+=1,xa="*";else if(ca===124){if(xa="",D.charCodeAt(G+1)===124){W(m.SelectorType.ColumnCombinator);K(2);break}}else if(p.test(D.slice(G)))xa=I(0);else break a;D.charCodeAt(G)===124&&D.charCodeAt(G+1)!==124&&(V=xa,D.charCodeAt(G+1)===42?(xa="*",G+=2):xa=I(1));S.push(xa==="*"?{type:m.SelectorType.Universal,
namespace:V}:{type:m.SelectorType.Tag,name:xa,namespace:V})}}}Y();return G}Object.defineProperty(q,"__esModule",{value:!0});q.parse=q.isTraversal=void 0;var m=l(160),p=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,z=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,t=new Map([[126,m.AttributeAction.Element],[94,m.AttributeAction.Start],[36,m.AttributeAction.End],[42,m.AttributeAction.Any],[33,m.AttributeAction.Not],[124,m.AttributeAction.Hyphen]]),v=new Set("has not matches is where host host-context".split(" "));
q.isTraversal=x;var y=new Set(["contains","icontains"]);q.parse=function(B){var D=[],G=k(D,"".concat(B),0);if(G<B.length)throw Error("Unmatched selector: ".concat(B.slice(G)));return D}};
shadow$provide[162]=function(l,L,q){function x(y){return y.map(function(B){return B.map(r).join("")}).join(", ")}function r(y,B,D){switch(y.type){case m.SelectorType.Child:return B===0?"\x3e ":" \x3e ";case m.SelectorType.Parent:return B===0?"\x3c ":" \x3c ";case m.SelectorType.Sibling:return B===0?"~ ":" ~ ";case m.SelectorType.Adjacent:return B===0?"+ ":" + ";case m.SelectorType.Descendant:return" ";case m.SelectorType.ColumnCombinator:return B===0?"|| ":" || ";case m.SelectorType.Universal:return y.namespace===
"*"&&B+1<D.length&&"name"in D[B+1]?"":"".concat(f(y.namespace),"*");case m.SelectorType.Tag:return g(y);case m.SelectorType.PseudoElement:return"::".concat(k(y.name,v)).concat(y.data===null?"":"(".concat(k(y.data,t),")"));case m.SelectorType.Pseudo:return":".concat(k(y.name,v)).concat(y.data===null?"":"(".concat(typeof y.data==="string"?k(y.data,t):x(y.data),")"));case m.SelectorType.Attribute:if(y.name==="id"&&y.action===m.AttributeAction.Equals&&y.ignoreCase==="quirks"&&!y.namespace)return"#".concat(k(y.value,
v));if(y.name==="class"&&y.action===m.AttributeAction.Element&&y.ignoreCase==="quirks"&&!y.namespace)return".".concat(k(y.value,v));B=g(y);return y.action===m.AttributeAction.Exists?"[".concat(B,"]"):"[".concat(B).concat(e(y.action),'\x3d"').concat(k(y.value,z),'"').concat(y.ignoreCase===null?"":y.ignoreCase?" i":" s","]")}}function e(y){switch(y){case m.AttributeAction.Equals:return"";case m.AttributeAction.Element:return"~";case m.AttributeAction.Start:return"^";case m.AttributeAction.End:return"$";
case m.AttributeAction.Any:return"*";case m.AttributeAction.Not:return"!";case m.AttributeAction.Hyphen:return"|";case m.AttributeAction.Exists:throw Error("Shouldn't be here");}}function g(y){return"".concat(f(y.namespace)).concat(k(y.name,v))}function f(y){return y!==null?"".concat(y==="*"?"*":k(y,v),"|"):""}function k(y,B){for(var D=0,G="",I=0;I<y.length;I++)B.has(y.charCodeAt(I))&&(G+="".concat(y.slice(D,I),"\\").concat(y.charAt(I)),D=I+1);return G.length>0?G+y.slice(D):y}L=this&&this.__spreadArray||
function(y,B,D){if(D||arguments.length===2)for(var G=0,I=B.length,K;G<I;G++)!K&&G in B||(K||(K=Array.prototype.slice.call(B,0,G)),K[G]=B[G]);return y.concat(K||Array.prototype.slice.call(B))};Object.defineProperty(q,"__esModule",{value:!0});q.stringify=void 0;var m=l(160);l=["\\",'"'];var p=L(L([],l,!0),["(",")"],!1),z=new Set(l.map(function(y){return y.charCodeAt(0)})),t=new Set(p.map(function(y){return y.charCodeAt(0)})),v=new Set(L(L([],p,!0),"~^$*+!|:[] .".split(""),!1).map(function(y){return y.charCodeAt(0)}));
q.stringify=x};
shadow$provide[163]=function(l,L,q){var x=this&&this.__createBinding||(Object.create?function(g,f,k,m){m===void 0&&(m=k);var p=Object.getOwnPropertyDescriptor(f,k);if(!p||("get"in p?!f.__esModule:p.writable||p.configurable))p={enumerable:!0,get:function(){return f[k]}};Object.defineProperty(g,m,p)}:function(g,f,k,m){m===void 0&&(m=k);g[m]=f[k]});L=this&&this.__exportStar||function(g,f){for(var k in g)k==="default"||Object.prototype.hasOwnProperty.call(f,k)||x(f,g,k)};Object.defineProperty(q,"__esModule",
{value:!0});q.stringify=q.parse=q.isTraversal=void 0;L(l(160),q);var r=l(161);Object.defineProperty(q,"isTraversal",{enumerable:!0,get:function(){return r.isTraversal}});Object.defineProperty(q,"parse",{enumerable:!0,get:function(){return r.parse}});var e=l(162);Object.defineProperty(q,"stringify",{enumerable:!0,get:function(){return e.stringify}})};
shadow$provide[164]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.isTraversal=q.procedure=void 0;q.procedure={universal:50,tag:30,attribute:1,pseudo:0,"pseudo-element":0,"column-combinator":-1,descendant:-1,child:-1,parent:-1,sibling:-1,adjacent:-1,_flexibleDescendant:-1};q.isTraversal=function(x){return q.procedure[x.type]<0}};
shadow$provide[165]=function(l,L,q){function x(f){var k=e.procedure[f.type];if(f.type===r.SelectorType.Attribute)k=g[f.action],k===g.equals&&f.name==="id"&&(k=9),f.ignoreCase&&(k>>=1);else if(f.type===r.SelectorType.Pseudo)if(f.data)if(f.name==="has"||f.name==="contains")k=0;else if(Array.isArray(f.data)){for(var m=k=0;m<f.data.length;m++)if(f.data[m].length===1){var p=x(f.data[m][0]);if(p===0){k=0;break}p>k&&(k=p)}f.data.length>1&&k>0&&--k}else k=1;else k=3;return k}Object.defineProperty(q,"__esModule",
{value:!0});var r=l(163),e=l(164),g={exists:10,equals:8,not:7,start:6,end:6,any:5,hyphen:4,element:4};q.default=function(f){for(var k=f.map(x),m=1;m<f.length;m++){var p=k[m];if(!(p<0))for(var z=m-1;z>=0&&p<k[z];z--){var t=f[z+1];f[z+1]=f[z];f[z]=t;k[z+1]=k[z];k[z]=p}}}};
shadow$provide[166]=function(l,L,q){function x(f,k){return typeof f.ignoreCase==="boolean"?f.ignoreCase:f.ignoreCase==="quirks"?!!k.quirksMode:!k.xmlMode&&g.has(f.name)}Object.defineProperty(q,"__esModule",{value:!0});q.attributeRules=void 0;var r=l(159),e=/[-[\]{}()*+?.,\\^$|#\s]/g,g=new Set("accept accept-charset align alink axis bgcolor charset checked clear codetype color compact declare defer dir direction disabled enctype face frame hreflang http-equiv lang language link media method multiple nohref noresize noshade nowrap readonly rel rev rules scope scrolling selected shape target text type valign valuetype vlink".split(" "));
q.attributeRules={equals:function(f,k,m){var p=m.adapter,z=k.name,t=k.value;return x(k,m)?(t=t.toLowerCase(),function(v){var y=p.getAttributeValue(v,z);return y!=null&&y.length===t.length&&y.toLowerCase()===t&&f(v)}):function(v){return p.getAttributeValue(v,z)===t&&f(v)}},hyphen:function(f,k,m){var p=m.adapter,z=k.name,t=k.value,v=t.length;return x(k,m)?(t=t.toLowerCase(),function(y){var B=p.getAttributeValue(y,z);return B!=null&&(B.length===v||B.charAt(v)==="-")&&B.substr(0,v).toLowerCase()===t&&
f(y)}):function(y){var B=p.getAttributeValue(y,z);return B!=null&&(B.length===v||B.charAt(v)==="-")&&B.substr(0,v)===t&&f(y)}},element:function(f,k,m){var p=m.adapter,z=k.name,t=k.value;if(/\s/.test(t))return r.falseFunc;var v=new RegExp("(?:^|\\s)".concat(t.replace(e,"\\$\x26"),"(?:$|\\s)"),x(k,m)?"i":"");return function(y){var B=p.getAttributeValue(y,z);return B!=null&&B.length>=t.length&&v.test(B)&&f(y)}},exists:function(f,k,m){var p=k.name,z=m.adapter;return function(t){return z.hasAttrib(t,p)&&
f(t)}},start:function(f,k,m){var p=m.adapter,z=k.name,t=k.value,v=t.length;return v===0?r.falseFunc:x(k,m)?(t=t.toLowerCase(),function(y){var B=p.getAttributeValue(y,z);return B!=null&&B.length>=v&&B.substr(0,v).toLowerCase()===t&&f(y)}):function(y){var B;return!((B=p.getAttributeValue(y,z))===null||B===void 0||!B.startsWith(t))&&f(y)}},end:function(f,k,m){var p=m.adapter,z=k.name,t=k.value,v=-t.length;return v===0?r.falseFunc:x(k,m)?(t=t.toLowerCase(),function(y){var B;return((B=p.getAttributeValue(y,
z))===null||B===void 0?void 0:B.substr(v).toLowerCase())===t&&f(y)}):function(y){var B;return!((B=p.getAttributeValue(y,z))===null||B===void 0||!B.endsWith(t))&&f(y)}},any:function(f,k,m){var p=m.adapter,z=k.name,t=k.value;if(t==="")return r.falseFunc;if(x(k,m)){var v=new RegExp(t.replace(e,"\\$\x26"),"i");return function(y){var B=p.getAttributeValue(y,z);return B!=null&&B.length>=t.length&&v.test(B)&&f(y)}}return function(y){var B;return!((B=p.getAttributeValue(y,z))===null||B===void 0||!B.includes(t))&&
f(y)}},not:function(f,k,m){var p=m.adapter,z=k.name,t=k.value;return t===""?function(v){return!!p.getAttributeValue(v,z)&&f(v)}:x(k,m)?(t=t.toLowerCase(),function(v){var y=p.getAttributeValue(v,z);return(y==null||y.length!==t.length||y.toLowerCase()!==t)&&f(v)}):function(v){return p.getAttributeValue(v,z)!==t&&f(v)}}}};
shadow$provide[167]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.parse=void 0;var x=new Set([9,10,12,13,32]);q.parse=function(r){function e(){if(r.charAt(k)==="-")return k++,-1;r.charAt(k)==="+"&&k++;return 1}function g(){for(var t=k,v=0;k<r.length&&r.charCodeAt(k)>=48&&r.charCodeAt(k)<=57;)v=v*10+(r.charCodeAt(k)-48),k++;return k===t?null:v}function f(){for(;k<r.length&&x.has(r.charCodeAt(k));)k++}r=r.trim().toLowerCase();if(r==="even")return[2,0];if(r==="odd")return[2,1];var k=
0,m=0,p=e(),z=g();k<r.length&&r.charAt(k)==="n"&&(k++,m=p*(z!==null&&z!==void 0?z:1),f(),k<r.length?(p=e(),f(),z=g()):p=z=0);if(z===null||k<r.length)throw Error("n-th rule couldn't be parsed ('".concat(r,"')"));return[m,p*z]}};
shadow$provide[168]=function(l,L,q){L=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{"default":r}};Object.defineProperty(q,"__esModule",{value:!0});q.generate=q.compile=void 0;var x=L(l(159));q.compile=function(r){var e=r[0],g=r[1]-1;if(g<0&&e<=0)return x.default.falseFunc;if(e===-1)return function(m){return m<=g};if(e===0)return function(m){return m===g};if(e===1)return g<0?x.default.trueFunc:function(m){return m>=g};var f=Math.abs(e),k=(g%f+f)%f;return e>1?function(m){return m>=
g&&m%f===k}:function(m){return m<=g&&m%f===k}};q.generate=function(r){var e=r[0],g=r[1]-1,f=0;if(e<0){var k=-e,m=(g%k+k)%k;return function(){var p=m+k*f++;return p>g?null:p}}if(e===0)return g<0?function(){return null}:function(){return f++===0?g:null};g<0&&(g+=e*Math.ceil(-g/e));return function(){return e*f++ +g}}};
shadow$provide[169]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.sequence=q.generate=q.compile=q.parse=void 0;var x=l(167);Object.defineProperty(q,"parse",{enumerable:!0,get:function(){return x.parse}});var r=l(168);Object.defineProperty(q,"compile",{enumerable:!0,get:function(){return r.compile}});Object.defineProperty(q,"generate",{enumerable:!0,get:function(){return r.generate}});q.default=function(e){return(0,r.compile)((0,x.parse)(e))};q.sequence=function(e){return(0,r.generate)((0,x.parse)(e))}};
shadow$provide[170]=function(l,L,q){function x(f,k){return function(m){var p=k.getParent(m);return p!=null&&k.isTag(p)&&f(m)}}function r(f){return function(k,m,p){var z=p.adapter[f];return typeof z!=="function"?g.falseFunc:function(t){return z(t)&&k(t)}}}L=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{"default":f}};Object.defineProperty(q,"__esModule",{value:!0});q.filters=void 0;var e=L(l(169)),g=l(159);q.filters={contains:function(f,k,m){var p=m.adapter;return function(z){return f(z)&&
p.getText(z).includes(k)}},icontains:function(f,k,m){var p=m.adapter,z=k.toLowerCase();return function(t){return f(t)&&p.getText(t).toLowerCase().includes(z)}},"nth-child":function(f,k,m){var p=m.adapter,z=m.equals,t=(0,e.default)(k);return t===g.falseFunc?g.falseFunc:t===g.trueFunc?x(f,p):function(v){for(var y=p.getSiblings(v),B=0,D=0;D<y.length&&!z(v,y[D]);D++)p.isTag(y[D])&&B++;return t(B)&&f(v)}},"nth-last-child":function(f,k,m){var p=m.adapter,z=m.equals,t=(0,e.default)(k);return t===g.falseFunc?
g.falseFunc:t===g.trueFunc?x(f,p):function(v){for(var y=p.getSiblings(v),B=0,D=y.length-1;D>=0&&!z(v,y[D]);D--)p.isTag(y[D])&&B++;return t(B)&&f(v)}},"nth-of-type":function(f,k,m){var p=m.adapter,z=m.equals,t=(0,e.default)(k);return t===g.falseFunc?g.falseFunc:t===g.trueFunc?x(f,p):function(v){for(var y=p.getSiblings(v),B=0,D=0;D<y.length;D++){var G=y[D];if(z(v,G))break;p.isTag(G)&&p.getName(G)===p.getName(v)&&B++}return t(B)&&f(v)}},"nth-last-of-type":function(f,k,m){var p=m.adapter,z=m.equals,t=
(0,e.default)(k);return t===g.falseFunc?g.falseFunc:t===g.trueFunc?x(f,p):function(v){for(var y=p.getSiblings(v),B=0,D=y.length-1;D>=0;D--){var G=y[D];if(z(v,G))break;p.isTag(G)&&p.getName(G)===p.getName(v)&&B++}return t(B)&&f(v)}},root:function(f,k,m){var p=m.adapter;return function(z){var t=p.getParent(z);return(t==null||!p.isTag(t))&&f(z)}},scope:function(f,k,m,p){var z=m.equals;return p&&p.length!==0?p.length===1?function(t){return z(p[0],t)&&f(t)}:function(t){return p.includes(t)&&f(t)}:q.filters.root(f,
k,m)},hover:r("isHovered"),visited:r("isVisited"),active:r("isActive")}};
shadow$provide[171]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.verifyPseudoArgs=q.pseudos=void 0;q.pseudos={empty:function(x,r){var e=r.adapter;return!e.getChildren(x).some(function(g){return e.isTag(g)||e.getText(g)!==""})},"first-child":function(x,r){var e=r.adapter;r=r.equals;var g=e.getSiblings(x).find(function(f){return e.isTag(f)});return g!=null&&r(x,g)},"last-child":function(x,r){var e=r.adapter;r=r.equals;for(var g=e.getSiblings(x),f=g.length-1;f>=0;f--){if(r(x,g[f]))return!0;
if(e.isTag(g[f]))break}return!1},"first-of-type":function(x,r){var e=r.adapter;r=r.equals;for(var g=e.getSiblings(x),f=e.getName(x),k=0;k<g.length;k++){var m=g[k];if(r(x,m))return!0;if(e.isTag(m)&&e.getName(m)===f)break}return!1},"last-of-type":function(x,r){var e=r.adapter;r=r.equals;for(var g=e.getSiblings(x),f=e.getName(x),k=g.length-1;k>=0;k--){var m=g[k];if(r(x,m))return!0;if(e.isTag(m)&&e.getName(m)===f)break}return!1},"only-of-type":function(x,r){var e=r.adapter,g=r.equals,f=e.getName(x);return e.getSiblings(x).every(function(k){return g(x,
k)||!e.isTag(k)||e.getName(k)!==f})},"only-child":function(x,r){var e=r.adapter,g=r.equals;return e.getSiblings(x).every(function(f){return g(x,f)||!e.isTag(f)})}};q.verifyPseudoArgs=function(x,r,e){if(e===null){if(x.length>2)throw Error("pseudo-selector :".concat(r," requires an argument"));}else if(x.length===2)throw Error("pseudo-selector :".concat(r," doesn't have any arguments"));}};
shadow$provide[172]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.aliases=void 0;q.aliases={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:":is(\n        :is(button, input, select, textarea, optgroup, option)[disabled],\n        optgroup[disabled] \x3e option,\n        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)\n    )",enabled:":not(:disabled)",checked:":is(:is(input[type\x3dradio], input[type\x3dcheckbox])[checked], option:selected)",
required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(\x3e option[selected])) \x3e :first-of-type)",checkbox:"[type\x3dcheckbox]",file:"[type\x3dfile]",password:"[type\x3dpassword]",radio:"[type\x3dradio]",reset:"[type\x3dreset]",image:"[type\x3dimage]",submit:"[type\x3dsubmit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type\x3dbutton])",input:":is(input, textarea, select, button)",
text:"input:is(:not([type!\x3d'']), [type\x3dtext])"}};
shadow$provide[173]=function(l,L,q){function x(k,m){return k===g.falseFunc?g.falseFunc:function(p){return m.isTag(p)&&k(p)}}function r(k,m){var p=m.getSiblings(k);if(p.length<=1)return[];k=p.indexOf(k);return k<0||k===p.length-1?[]:p.slice(k+1).filter(m.isTag)}var e=this&&this.__spreadArray||function(k,m,p){if(p||arguments.length===2)for(var z=0,t=m.length,v;z<t;z++)!v&&z in m||(v||(v=Array.prototype.slice.call(m,0,z)),v[z]=m[z]);return k.concat(v||Array.prototype.slice.call(m))};Object.defineProperty(q,
"__esModule",{value:!0});q.subselects=q.getNextSiblings=q.ensureIsTag=q.PLACEHOLDER_ELEMENT=void 0;var g=l(159),f=l(164);q.PLACEHOLDER_ELEMENT={};q.ensureIsTag=x;q.getNextSiblings=r;l=function(k,m,p,z,t){var v=t(m,{xmlMode:!!p.xmlMode,adapter:p.adapter,equals:p.equals},z);return function(y){return v(y)&&k(y)}};q.subselects={is:l,matches:l,where:l,not:function(k,m,p,z,t){var v=t(m,{xmlMode:!!p.xmlMode,adapter:p.adapter,equals:p.equals},z);return v===g.falseFunc?k:v===g.trueFunc?g.falseFunc:function(y){return!v(y)&&
k(y)}},has:function(k,m,p,z,t){var v=p.adapter;p={xmlMode:!!p.xmlMode,adapter:v,equals:p.equals};var y=m.some(function(G){return G.some(f.isTraversal)})?[q.PLACEHOLDER_ELEMENT]:void 0;m=t(m,p,y);if(m===g.falseFunc)return g.falseFunc;if(m===g.trueFunc)return function(G){return v.getChildren(G).some(v.isTag)&&k(G)};var B=x(m,v);m=m.shouldTestNextSiblings;var D=m===void 0?!1:m;return y?function(G){y[0]=G;var I=v.getChildren(G);I=D?e(e([],I,!0),r(G,v),!0):I;return k(G)&&v.existsOne(B,I)}:function(G){return k(G)&&
v.existsOne(B,v.getChildren(G))}}}};
shadow$provide[174]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.compilePseudoSelector=q.aliases=q.pseudos=q.filters=void 0;var x=l(159),r=l(163),e=l(170);Object.defineProperty(q,"filters",{enumerable:!0,get:function(){return e.filters}});var g=l(171);Object.defineProperty(q,"pseudos",{enumerable:!0,get:function(){return g.pseudos}});var f=l(172);Object.defineProperty(q,"aliases",{enumerable:!0,get:function(){return f.aliases}});var k=l(173);q.compilePseudoSelector=function(m,
p,z,t,v){var y=p.name,B=p.data;if(Array.isArray(B))return k.subselects[y](m,B,z,t,v);if(y in f.aliases){if(B!=null)throw Error("Pseudo ".concat(y," doesn't have any arguments"));p=(0,r.parse)(f.aliases[y]);return k.subselects.is(m,p,z,t,v)}if(y in e.filters)return e.filters[y](m,B,z,t);if(y in g.pseudos){var D=g.pseudos[y];(0,g.verifyPseudoArgs)(D,y,B);return D===x.falseFunc?x.falseFunc:m===x.trueFunc?function(G){return D(G,z,B)}:function(G){return D(G,z,B)&&m(G)}}throw Error("unmatched pseudo-class :".concat(y));
}};
shadow$provide[175]=function(l,L,q){Object.defineProperty(q,"__esModule",{value:!0});q.compileGeneralSelector=void 0;var x=l(166),r=l(174),e=l(163);q.compileGeneralSelector=function(g,f,k,m,p){var z=k.adapter,t=k.equals;switch(f.type){case e.SelectorType.PseudoElement:throw Error("Pseudo-elements are not supported by css-select");case e.SelectorType.ColumnCombinator:throw Error("Column combinators are not yet supported by css-select");case e.SelectorType.Attribute:if(f.namespace!=null)throw Error("Namespaced attributes are not yet supported by css-select");
if(!k.xmlMode||k.lowerCaseAttributeNames)f.name=f.name.toLowerCase();return x.attributeRules[f.action](g,f,k);case e.SelectorType.Pseudo:return(0,r.compilePseudoSelector)(g,f,k,m,p);case e.SelectorType.Tag:if(f.namespace!=null)throw Error("Namespaced tag names are not yet supported by css-select");var v=f.name;if(!k.xmlMode||k.lowerCaseTags)v=v.toLowerCase();return function(B){return z.getName(B)===v&&g(B)};case e.SelectorType.Descendant:if(k.cacheResults===!1||typeof WeakSet==="undefined")return function(B){for(;B=
z.getParent(B);)if(z.isTag(B)&&g(B))return!0;return!1};var y=new WeakSet;return function(B){for(;B=z.getParent(B);)if(!y.has(B)){if(z.isTag(B)&&g(B))return!0;y.add(B)}return!1};case "_flexibleDescendant":return function(B){do if(z.isTag(B)&&g(B))return!0;while(B=z.getParent(B));return!1};case e.SelectorType.Parent:return function(B){return z.getChildren(B).some(function(D){return z.isTag(D)&&g(D)})};case e.SelectorType.Child:return function(B){B=z.getParent(B);return B!=null&&z.isTag(B)&&g(B)};case e.SelectorType.Sibling:return function(B){for(var D=
z.getSiblings(B),G=0;G<D.length;G++){var I=D[G];if(t(B,I))break;if(z.isTag(I)&&g(I))return!0}return!1};case e.SelectorType.Adjacent:return z.prevElementSibling?function(B){B=z.prevElementSibling(B);return B!=null&&g(B)}:function(B){for(var D=z.getSiblings(B),G,I=0;I<D.length;I++){var K=D[I];if(t(B,K))break;z.isTag(K)&&(G=K)}return!!G&&g(G)};case e.SelectorType.Universal:if(f.namespace!=null&&f.namespace!=="*")throw Error("Namespaced universal selectors are not yet supported by css-select");return g}}};
shadow$provide[176]=function(l,L,q){function x(I,K,Q){I=typeof I==="string"?(0,m.parse)(I):I;return g(I,K,Q)}function r(I){return I.type==="pseudo"&&(I.name==="scope"||Array.isArray(I.data)&&I.data.some(function(K){return K.some(r)}))}function e(I,K,Q){var O=K.adapter;K=!(Q===null||Q===void 0||!Q.every(function(W){var ba=O.isTag(W)&&O.getParent(W);return W===y.PLACEHOLDER_ELEMENT||ba&&O.isTag(ba)}));for(Q=0;Q<I.length;Q++){var J=I[Q];if(!(J.length>0&&(0,t.isTraversal)(J[0])&&J[0].type!=="descendant"))if(K&&
!J.some(r))J.unshift(B);else continue;J.unshift(G)}}function g(I,K,Q){var O;I=I.filter(function(Y){return Y.length>0});I.forEach(z.default);Q=(O=K.context)!==null&&O!==void 0?O:Q;var J=Array.isArray(Q),W=Q&&(Array.isArray(Q)?Q:[Q]);e(I,K,W);var ba=!1;I=I.map(function(Y){if(Y.length>=2){var S=Y[0],ca=Y[1];if(S.type==="pseudo"&&S.name==="scope")if(J&&ca.type==="descendant")Y[1]=D;else if(ca.type==="adjacent"||ca.type==="sibling")ba=!0}return f(Y,K,W)}).reduce(k,p.falseFunc);I.shouldTestNextSiblings=
ba;return I}function f(I,K,Q){var O;return I.reduce(function(J,W){return J===p.falseFunc?p.falseFunc:(0,v.compileGeneralSelector)(J,W,K,Q,g)},(O=K.rootFunc)!==null&&O!==void 0?O:p.trueFunc)}function k(I,K){return K===p.falseFunc||I===p.trueFunc?I:I===p.falseFunc||K===p.trueFunc?K:function(Q){return I(Q)||K(Q)}}L=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{"default":I}};Object.defineProperty(q,"__esModule",{value:!0});q.compileToken=q.compileUnsafe=q.compile=void 0;var m=l(163),
p=l(159),z=L(l(165)),t=l(164),v=l(175),y=l(173);q.compile=function(I,K,Q){I=x(I,K,Q);return(0,y.ensureIsTag)(I,K.adapter)};q.compileUnsafe=x;var B={type:m.SelectorType.Descendant},D={type:"_flexibleDescendant"},G={type:m.SelectorType.Pseudo,name:"scope",data:null};q.compileToken=g};
shadow$provide[177]=function(l,L,q){function x(D){var G,I,K,Q;D=D!==null&&D!==void 0?D:y;(G=D.adapter)!==null&&G!==void 0?G:D.adapter=m;(I=D.equals)!==null&&I!==void 0?I:D.equals=(Q=(K=D.adapter)===null||K===void 0?void 0:K.equals)!==null&&Q!==void 0?Q:v;return D}function r(D){return function(G,I,K){I=x(I);return D(G,I,K)}}function e(D){return function(G,I,K){K=x(K);typeof G!=="function"&&(G=(0,z.compileUnsafe)(G,K,I));I=g(I,K.adapter,G.shouldTestNextSiblings);return D(G,I,K)}}function g(D,G,I){I===
void 0&&(I=!1);if(I){D=Array.isArray(D)?D.slice(0):[D];I=D.length;for(var K=0;K<I;K++){var Q=(0,t.getNextSiblings)(D[K],G);D.push.apply(D,Q)}}return Array.isArray(D)?G.removeSubsets(D):G.getChildren(D)}var f=this&&this.__createBinding||(Object.create?function(D,G,I,K){K===void 0&&(K=I);var Q=Object.getOwnPropertyDescriptor(G,I);if(!Q||("get"in Q?!G.__esModule:Q.writable||Q.configurable))Q={enumerable:!0,get:function(){return G[I]}};Object.defineProperty(D,K,Q)}:function(D,G,I,K){K===void 0&&(K=I);
D[K]=G[I]}),k=this&&this.__setModuleDefault||(Object.create?function(D,G){Object.defineProperty(D,"default",{enumerable:!0,value:G})}:function(D,G){D["default"]=G});L=this&&this.__importStar||function(D){if(D&&D.__esModule)return D;var G={};if(D!=null)for(var I in D)I!=="default"&&Object.prototype.hasOwnProperty.call(D,I)&&f(G,D,I);k(G,D);return G};Object.defineProperty(q,"__esModule",{value:!0});q.aliases=q.pseudos=q.filters=q.is=q.selectOne=q.selectAll=q.prepareContext=q._compileToken=q._compileUnsafe=
q.compile=void 0;var m=L(l(158)),p=l(159),z=l(176),t=l(173),v=function(D,G){return D===G},y={adapter:m,equals:v};q.compile=r(z.compile);q._compileUnsafe=r(z.compileUnsafe);q._compileToken=r(z.compileToken);q.prepareContext=g;q.selectAll=e(function(D,G,I){return D!==p.falseFunc&&G&&G.length!==0?I.adapter.findAll(D,G):[]});q.selectOne=e(function(D,G,I){return D!==p.falseFunc&&G&&G.length!==0?I.adapter.findOne(D,G):null});q.is=function(D,G,I){I=x(I);return(typeof G==="function"?G:(0,z.compile)(G,I))(D)};
q.default=q.selectAll;var B=l(174);Object.defineProperty(q,"filters",{enumerable:!0,get:function(){return B.filters}});Object.defineProperty(q,"pseudos",{enumerable:!0,get:function(){return B.pseudos}});Object.defineProperty(q,"aliases",{enumerable:!0,get:function(){return B.aliases}})};
shadow$provide[178]=function(l,L,q){function x(g){return g.children||[]}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return e}}});const r={isTag:function(g){return!0},existsOne(g,f){return f.some(k=>g(k)||r.existsOne(g,x(k)))},getSiblings(g){const f=g.parent;return f?x(f):[g]},getChildren:x,getParent:function(g){return g.parent},getAttributeValue(g,f){return f==="class"?g.props.classes.join(" "):f==="id"?g.id:""},hasAttrib(g,f){return f==="id"?
!!g.id:f==="class"?g.props.classes.length>0:g.traits.hash?Object.prototype.hasOwnProperty.call(g.traits.hash,f):!1},removeSubsets:function(g){const f=new Set(g);f.forEach(k=>{let m=k.parent;for(;m;){if(f.has(m)){f.delete(k);break}m=m.parent}});return Array.from(f)},getName(g){var f;return(f=g.type)!==null&&f!==void 0?f:""},findOne:function m(f,k){for(const p of k){if(f(p))return p;if(k=m(f,x(p)))return k}return null},findAll:function p(k,m){const z=[];for(const t of m)k(t)&&z.push(t),z.push(...p(k,
x(t)));return z},getText:function(k){return""}},e=r};
shadow$provide[179]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},compile:{enumerable:!0,get:function(){return g}},selectAll:{enumerable:!0,get:function(){return e}}});var x=l(177);L=l(178);var r=l.esmDefault(L);const e=(f,k)=>{try{x.compile(f)}catch(p){return[]}var m=Array.isArray(k);if(m&&k.length===0)return[];for(m=m?k[0]:k;r.default.getParent(m)!==null;)m=r.default.getParent(m);m=x.selectAll(f,m,{adapter:r.default});if(k){f=[];k=Array.isArray(k)?k:[k];k=new Set(k);
for(const p of Array.from(m))for(m=p;m!=null;){if(k.has(m)){f.push(p);break}m=r.default.getParent(m)}return f}return m},g=f=>{try{return x.compile(f,{adapter:r.default})}catch(k){return()=>!1}}};
shadow$provide[180]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Model:{enumerable:!0,get:function(){return e}}});var x=l(179);const r=/^<([0-9]+|<*)$/;class e{constructor(g){this.root=g;this.root.model=this;this.root.root=this.root;this.ids={};this.classes={};this.traits={};this.types={};this.nodes=[];this.watchers=[];this.fire=!1;this.lastNode=null;this.event={type:"update"};this.root.on("add",Y=>f(Y.node));this.root.on("remove",Y=>{Y=Y.node;Q(Y);J(Y);ba(Y);D(Y.id,
Y);I(Y.classes,Y);Y.off("change:node",z);return p(Y)});const f=Y=>{K(Y);O(Y);W(Y);Y.on("change:node",z);z(null,Y,!0);return p(Y)},k=Y=>{for(const S of Array.from(this.watchers))S.match=S.matcher(Y);return null},m=Y=>{for(const S of Array.from(this.watchers)){const ca=S.fire||(S.fire=S.match!==S.matcher(Y));ca&&(this.lastNode=Y);this.fire||(this.fire=ca)}return null},p=Y=>{for(const S of Array.from(this.watchers)){const ca=S.fire||(S.fire=S.matcher(Y));ca&&(this.lastNode=Y);this.fire||(this.fire=ca)}return null};
this.digest=()=>{if(!this.fire)return!1;for(const Y of Array.from(this.watchers.slice()))Y.fire&&(Y.fire=!1,Y.handler());this.fire=!1;return!0};const z=(Y,S,ca)=>{var V=ca||Y.changed["node.classes"];let xa=!1;if(ca||Y.changed["node.id"])Y=S.get("node.id"),Y!==S.id&&(ca||k(S),xa=!0,S.id!=null&&D(S.id,S),B(Y,S));if(V){var na;V=(na=S.get("node.classes"))!=null?na:[];na=V.join(",");na!==(S.classes!=null?S.classes.klass:void 0)&&(V=V.slice(),ca||xa||k(S),xa=!0,S.classes!=null&&I(S.classes,S),G(V,S),S.classes=
V,S.classes.klass=na)}!ca&&xa&&m(S);return null},t=function(Y,S,ca){if(S!=null){for(const V of Array.from(S))S=Y[V]!=null?Y[V]:[],S.push(ca),Y[V]=S;return null}},v=function(Y,S,ca){if(S!=null){for(const V of Array.from(S)){S=Y[V];const xa=S.indexOf(ca);xa>=0&&S.splice(xa,1);S.length===0&&delete Y[V]}return null}},y=function(Y){if(Y.length>0){var S=Y.hash={};return Array.from(Y).map(ca=>S[ca]=!0)}},B=(Y,S)=>{if(this.ids[Y])throw Error(`Duplicate node id \`${Y}\``);Y!=null&&(this.ids[Y]=[S]);return S.id=
Y!=null?Y:S._id},D=(Y,S)=>{Y!=null&&delete this.ids[Y];return S.id=S._id},G=(Y,S)=>{t(this.classes,Y,S);if(Y!=null)return y(Y)},I=(Y,S)=>{v(this.classes,Y,S);if(Y!=null)return delete Y.hash},K=Y=>this.nodes.push(Y),Q=Y=>this.nodes.splice(this.nodes.indexOf(Y),1),O=Y=>t(this.types,[Y.type],Y),J=Y=>v(this.types,[Y.type],Y),W=Y=>{t(this.traits,Y.traits,Y);return y(Y.traits)},ba=Y=>{v(this.traits,Y.traits,Y);return delete Y.traits.hash};f(this.root);this.root.trigger({type:"added"})}select(g,f){return(0,x.selectAll)(g,
f||this.getRoot())}watch(g,f){let k;f.unwatch=()=>this.unwatch(f);f.watcher=k={selector:g,handler:f,matcher:this._matcher(g),match:!1,fire:!1};this.watchers.push(k);return this.select(g)}unwatch(g){const {watcher:f}=g;if(f!=null)return this.watchers.splice(this.watchers.indexOf(f),1),delete g.unwatch,delete g.watcher}_matcher(g){if(r.test(g))throw Error("Auto-link matcher unsupported");return(0,x.compile)(g)}getRoot(){return this.root}getLastTrigger(){return this.lastNode.toString()}}};
shadow$provide[181]=function(l,L,q){q=l(133);var x=l(136),r=l(137),e=l(180),g=l(135);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g)};
shadow$provide[182]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},OverlayFactory:{enumerable:!0,get:function(){return x}}});class x{constructor(r,e){this.classes=r;this.canvas=e;r=document.createElement("div");r.classList.add("mathbox-overlays");this.div=r}inject(){const r=this.canvas.parentNode;if(!r)throw Error("Canvas not inserted into document.");return r.insertBefore(this.div,this.canvas)}unject(){return this.div.parentNode.removeChild(this.div)}getTypes(){return Object.keys(this.classes)}make(r,
e){return new this.classes[r](this.div,e)}}};
shadow$provide[183]=function(l,L,q){function x(G,I,K){const Q=[],O=G<I;for(I=K?O?I+1:I-1:I;O?G<I:G>I;O?G++:G--)Q.push(G);return Q}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Types:{enumerable:!0,get:function(){return g}},apply:{enumerable:!0,get:function(){return z}},createClass:{enumerable:!0,get:function(){return D}},element:{enumerable:!0,get:function(){return m}},hint:{enumerable:!0,get:function(){return k}},recycle:{enumerable:!0,get:function(){return p}}});const r=[];let e=
0;const g={},f=()=>({id:e++,type:null,props:null,children:null,rendered:null,instance:null}),k=function(G){G=Math.max(0,r.length-G*2);return x(0,G,!1).map(I=>r.push(f()))},m=function(G,I,K){const Q=r.length?r.pop():f();Q.type=G!=null?G:"div";Q.props=I!=null?I:null;Q.children=K!=null?K:null;return Q},p=function(G){if(G.type){var {children:I}=G;G.type=G.props=G.children=G.instance=null;r.push(G);if(I!=null)for(const K of Array.from(I))p(K)}},z=function(G,I,K,Q,O){if(G!=null){if(I==null)return t(G,Q,
O);var J;if(G instanceof Node){if(J=G===I)return}else J=typeof G===typeof I&&I!==null&&G!==null&&G.type===I.type;if(J){G.instance=I.instance;const V=G.type!=null&&G.type.isComponentClass?G.type:g[G.type],xa=I!=null?I.props:void 0,na=G.props;J=(I!=null?I.children:void 0)!=null?I!=null?I.children:void 0:null;var W=G.children;na!=null&&(na.children=W);if(V!=null){var ba=K._COMPONENT_DIRTY;xa!=null!==(na!=null)&&(ba=!0);J!==W&&(ba=!0);if(xa!=null&&na!=null){if(!ba)for(ca in xa)Object.prototype.hasOwnProperty.call(na,
ca)||(ba=!0);if(!ba)for(ca in na){var Y=na[ca];xa[ca]!==Y&&(ba=!0)}}if(ba){var S;J=I.instance;G.props==null&&(G.props={});for(const N in J.defaultProps)W=J.defaultProps[N],G.props[N]==null&&(G.props[N]=W);G.props.children=G.children;typeof J.willReceiveProps==="function"&&J.willReceiveProps(G.props);if(W=K._COMPONENT_FORCE||((S=typeof J.shouldUpdate==="function"?J.shouldUpdate(G.props):void 0)!=null?S:!0)){var ca=J.getNextState();typeof J.willUpdate==="function"&&J.willUpdate(G.props,ca)}ca=J.props;
S=J.applyNextState();J.props=G.props;J.children=G.children;W&&(G=G.rendered=typeof J.render==="function"?J.render(m,G.props,G.children):void 0,z(G,I.rendered,K,Q,O),typeof J.didUpdate==="function"&&J.didUpdate(ca,S))}}else{if(xa!=null)for(ca in xa)if(!Object.prototype.hasOwnProperty.call(na,ca))if(G=K,I=ca,Q=xa[ca],I==="style")for(Y in Q)G.style[y[Y]!=null?y[Y]:Y]="";else G[I]!=null&&(G[I]=void 0),G instanceof Node&&G.removeAttribute(I);if(na!=null)for(ca in na)Y=na[ca],(ba=xa[ca])!==Y&&ca!=="children"&&
B(K,ca,Y,ba);if(W!=null)if(["string","number"].includes(typeof W))W!==J&&(K.textContent=W);else if(W.type!=null)z(W,J,K.childNodes[0],K,0);else if({childNodes:Q}=K,J!=null)for(I=0;I<W.length;I++)G=W[I],z(G,J[I],Q[I],K,I);else for(I=0;I<W.length;I++)G=W[I],z(G,null,Q[I],K,I);else J!=null&&(v(null,K),K.innerHTML="")}return}v(I.instance,K);K.remove();return t(G,Q,O)}if(I!=null)return v(I.instance,K),I.node.remove()},t=function(G,I,K){K==null&&(K=0);var Q=G.type!=null&&G.type.isComponentClass?G.type:
g[G.type];if(G instanceof Node)var O=G;else{if(Q!=null){var J=G.type!=null&&G.type.isComponentClass?G.type:g[G.type];if(!J)return G=G.rendered=m("noscript"),O=t(G,I,K);G.instance=J=new J(I);G.props==null&&(G.props={});for(O in J.defaultProps)Q=J.defaultProps[O],G.props[O]==null&&(G.props[O]=Q);G.props.children=G.children;J.props=G.props;J.children=G.children;J.setState(typeof J.getInitialState==="function"?J.getInitialState():void 0);typeof J.willMount==="function"&&J.willMount();G=G.rendered=typeof J.render===
"function"?J.render(m,G.props,G.children):void 0;O=t(G,I,K);typeof J.didMount==="function"&&J.didMount(G);O._COMPONENT=J;return O}if(["string","number"].includes(typeof G))O=document.createTextNode(G);else for(J in O=document.createElement(G.type),G.props)B(O,J,G.props[J]);({children:G}=G);if(G!=null)if(["string","number"].includes(typeof G))O.textContent=G;else if(G.type!=null)t(G,O,0);else for(J=0;J<G.length;J++)t(G[J],O,J)}I.insertBefore(O,I.childNodes[K]);return O},v=function(G,I){if(G){typeof G.willUnmount===
"function"&&G.willUnmount();for(const K in G)delete G[K]}G=[];for(const K of Array.from(I.childNodes))v(K._COMPONENT,K),G.push(delete K._COMPONENT);return G};l=function(G){if(typeof document==="undefined")return!0;if(document.documentElement.style[G]!=null)return G;G=G[0].toUpperCase()+G.slice(1);const I=["webkit","moz","ms","o"];for(const K of Array.from(I))if(document.documentElement.style[K+G]!=null)return K+G};const y={};for(const G of["transform"])y[G]=l(G);const B=function(G,I,K,Q){if(I==="style")for(const O in K)I=
K[O],(Q!=null?Q[O]:void 0)!==I&&(G.style[y[O]!=null?y[O]:O]=I);else if(G[I]!=null)try{G[I]=K}catch(O){console.log("failed setting "+I)}else G instanceof Node&&G.setAttribute(I,K)},D=function(G){let I;const K={willMount:"componentWillMount",didMount:"componentDidMount",willReceiveProps:"componentWillReceiveProps",shouldUpdate:"shouldComponentUpdate",willUpdate:"componentWillUpdate",didUpdate:"componentDidUpdate",willUnmount:"componentWillUnmount"};for(const O in K){const J=K[O];G[O]==null&&(G[O]=G[J])}class Q{constructor(O,
J,W=null,ba=null){let Y,S;J==null&&(J={});this.props=J;this.state=W;this.children=ba;J=function(V,xa){return typeof V==="function"?V.bind(xa):V};for(Y in G)S=G[Y],this[Y]=J(S,this);let ca=null;this.setState=function(V){ca==null&&(ca=V?ca!=null?ca:{}:null);for(Y in V)S=V[Y],ca[Y]=S;O._COMPONENT_DIRTY=!0};this.forceUpdate=function(){O._COMPONENT_FORCE=O._COMPONENT_DIRTY=!0;let V=O;const xa=[];for(;V=V.parentNode;)V._COMPONENT?xa.push(V._COMPONENT_FORCE=!0):xa.push(void 0);return xa};this.getNextState=
()=>ca;this.applyNextState=function(){O._COMPONENT_FORCE=O._COMPONENT_DIRTY=!1;const V=this.state;[ca,this.state]=Array.from([null,ca]);return V}}}Q.isComponentClass=!0;Q.prototype.defaultProps=(I=typeof G.getDefaultProps==="function"?G.getDefaultProps():void 0)!=null?I:{};return Q}};
shadow$provide[184]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Overlay:{enumerable:!0,get:function(){return x}}});class x{constructor(r,e){this.element=r;typeof this.init==="function"&&this.init(e)}dispose(){}}};
shadow$provide[185]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},DOM:{enumerable:!0,get:function(){return r}}});var x=l(183);l=l(184);class r extends l.Overlay{static initClass(){this.prototype.el=x.element;this.prototype.hint=x.hint;this.prototype.apply=x.apply;this.prototype.recycle=x.recycle}init(e){return this.last=null}dispose(){this.unmount();return super.dispose()}mount(){const e=document.createElement("div");e.classList.add("mathbox-overlay");this.element.appendChild(e);
return this.overlay=e}unmount(e){this.overlay&&this.overlay.parentNode&&this.element.removeChild(this.overlay);return this.overlay=null}render(e){this.overlay||this.mount();["string","number"].includes(typeof e)&&(e=this.el("div",null,e));e instanceof Array&&(e=this.el("div",null,e));e==null&&(e=this.el("div"));var g=e.type==="div";let {last:f}=this;const {overlay:k}=this,m=g?k:k.childNodes[0];g=g?k.parentNode:k;!f&&m&&(f=this.el("div"));this.apply(e,f,m,g,0);this.last=e;f!=null&&this.recycle(f)}}
r.initClass()};
shadow$provide[186]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Classes:{enumerable:!0,get:function(){return x}}});const x={dom:l(185).DOM}};
shadow$provide[187]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Factory:{enumerable:!0,get:function(){return x.OverlayFactory}}});var x=l(182);q=l(186);var r=l(184);l.exportCopy(L,q);l.exportCopy(L,r)};
shadow$provide[188]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Primitive:{enumerable:!0,get:function(){return r}}});var x=l(181);l=l(103);class r{static initClass(){this.Node=x.Node;this.Group=x.Group;this.model=this.Node;this.finals=this.props=this.traits=this.defaults=null;this.freeform=!1}constructor(e,g,f){this.node=e;this._context=g;this._renderables=this._context.renderables;this._attributes=this._context.attributes;this._shaders=this._context.shaders;this._overlays=
this._context.overlays;this._animator=this._context.animator;this._types=this._attributes.types;this.node.controller=this;this.node.on("added",k=>this._added());this.node.on("removed",k=>this._removed());this.node.on("change",k=>{if(this._root)return this.change(k.changed,k.touched)});this.reconfigure();this._get=this.node.get.bind(this.node);this._helpers=f(this,this.node.traits);this._handlers={inherit:{},listen:[],watch:[],compute:[]};this._root=this._parent=null;this.init()}is(e){return this.traits.hash[e]}init(){}make(){}made(){}unmake(e){}unmade(){}change(e,
g,f){}refresh(){return this.change({},{},!0)}rebuild(){if(this._root)return this._removed(!0),this._added()}reconfigure(e){e!=null&&this.node.configure(e,this._attributes);this.traits=this.node.traits;return this.props=this.node.props}_added(){let e,g;this._parent=this.node.parent!=null?this.node.parent.controller:void 0;this._root=this.node.root!=null?this.node.root.controller:void 0;this.node.clock=(g=this._inherit("clock"))!=null?g:this._root;try{try{return this.make(),this.refresh(),this.made()}catch(f){throw e=
f,this.node.print("warn"),console.error(e),e;}}catch(f){try{return this._removed()}catch(k){}}}_removed(e){e==null&&(e=!1);this.unmake(e);this._unlisten();this._unattach();this._uncompute();this._parent=this._root=null;return this.unmade(e)}_listen(e,g,f,k){k==null&&(k=this);if(e instanceof Array)for(const m of Array.from(e))return this.__listen(m,g,f,k);return this.__listen(e,g,f,k)}__listen(e,g,f,k){k==null&&(k=this);typeof e==="string"&&(e=this._inherit(e));e!=null&&(f=f.bind(k),f.node=this.node,
e.on(g,f),this._handlers.listen.push([e,g,f]));return e}_unlisten(){if(this._handlers.listen.length){for(const [e,g,f]of Array.from(this._handlers.listen))e.off(g,f);return this._handlers.listen=[]}}_inherit(e){const g=this._handlers.inherit[e];return g!==void 0?g:this._handlers.inherit[e]=this._parent!=null?this._parent._find(e!=null?e:null):void 0}_find(e){return this.is(e)?this:this._parent!=null?this._parent._find(e):void 0}_uninherit(){return this._handlers.inherit={}}_attach(e,g,f,k,m,p,z){k==
null&&(k=this);m==null&&(m=this);p==null&&(p=!1);z==null&&(z=!1);const t=function(D){if(D!=null&&Array.from(D.traits).includes(g))return D},v=D=>D!=null?D.controller:void 0,y=function(D){if(D==null)return D;let G=[];for(const I of Array.from(D))I instanceof Array?G=G.concat(I):G.push(I);return G},B=D=>{let G;if(typeof D==="object"){var I=D;if(I!=null&&I._up)return D=z?I._targets:[I[0]];if(I instanceof Array)return D=z?y(I.map(B)):B(I[0]);if(I instanceof x.Node)return[I]}else if(typeof D==="string"&&
D[0]==="\x3c"){var K=0;if(I=D.match(/^<([0-9])+$/))K=+I[1]-1;D.match(/^<+$/)&&(K=+D.length-1);G=[];let Q=m.node;for(;Q;){({parent:I}=Q);if(!I)break;(Q=I.children[Q.index-1])||G.length||(Q=I);I=null;t(Q)&&(I=Q);I!=null&&K--<=0&&G.push(I);if(!z&&G.length)return G}if(z&&G.length)return G}else if(typeof D==="string")if(K=f.bind(k),this._handlers.watch.push(K),K=this._root.watch(D,K),z){if(G=K.filter(t),G.length)return G}else if(t(K[0])&&(I=K[0]),I!=null)return[I];if(!p)throw console.warn(this.node.toMarkup()),
Error(`${this.node.toString()} - Could not find ${g} \`${D}\``);return z?[]:null};e=y(B(e));return z?e!=null?e.map(v):null:e!=null?v(e[0]):null}_unattach(){if(this._handlers.watch.length){for(const e of Array.from(this._handlers.watch))e!=null&&e.unwatch();return this._handlers.watch=[]}}_compute(e,g){this._handlers.compute.push(e);return this.node.bind(e,g,!0)}_uncompute(){if(this._handlers.compute.length){for(const e of Array.from(this._handlers.compute))this.node.unbind(e,!0);return this._handlers.compute=
[]}}}r.initClass();l.Binder.apply(r.prototype)};
shadow$provide[189]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Parent:{enumerable:!0,get:function(){return r}}});var x=l(188);class r extends x.Primitive{static initClass(){this.model=x.Primitive.Group;this.traits=["node"]}}r.initClass()};
shadow$provide[190]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Group:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits=["node","object","entity","visible","active"]}make(){this._helpers.visible.make();return this._helpers.active.make()}unmake(){this._helpers.visible.unmake();return this._helpers.active.unmake()}}x.initClass()};
shadow$provide[191]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Inherit:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits=["node","bind"]}make(){return this._helpers.bind.make([{to:"inherit.source",trait:"node"}])}unmake(){return this._helpers.bind.unmake()}_find(r){return this.bind.source&&Array.from(this.props.traits).includes(r)?this.bind.source._inherit(r):super._find()}}x.initClass()};
shadow$provide[192]=function(l,L,q){function x(e,g){return typeof e!=="undefined"&&e!==null?g(e):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Root:{enumerable:!0,get:function(){return r}}});l=l(189);class r extends l.Parent{static initClass(){this.traits="node root clock scene vertex unit".split(" ")}init(){this.size=null;this.cameraEvent={type:"root.camera"};this.preEvent={type:"root.pre"};this.updateEvent={type:"root.update"};this.renderEvent={type:"root.render"};this.postEvent=
{type:"root.post"};this.clockEvent={type:"clock.tick"};return this.camera=null}make(){return this._helpers.unit.make()}unmake(){return this._helpers.unit.unmake()}change(e,g,f){if(e["root.camera"]||f)return this._unattach(),this._attach(this.props.camera,"camera",this.setCamera,this,this,!0),this.setCamera()}adopt(e){return Array.from(e.renders).map(g=>this._context.scene.add(g))}unadopt(e){return Array.from(e.renders).map(g=>this._context.scene.remove(g))}select(e){return this.node.model.select(e)}watch(e,
g){return this.node.model.watch(e,g)}unwatch(e){return this.node.model.unwatch(e)}resize(e){this.size=e;return this.trigger({type:"root.resize",size:e})}getSize(){return this.size}getSpeed(){return this.props.speed}getUnit(){return this._helpers.unit.get()}getUnitUniforms(){return this._helpers.unit.uniforms()}pre(){this.getCamera().updateProjectionMatrix();this.trigger(this.clockEvent);return this.trigger(this.preEvent)}update(){return this.trigger(this.updateEvent)}render(){return this.trigger(this.renderEvent)}post(){return this.trigger(this.postEvent)}setCamera(){const e=
x(this.select(this.props.camera)[0],g=>g.controller);if(this.camera!==e)return this.camera=e,this.trigger({type:"root.camera"})}getCamera(){let e;return(e=this.camera!=null?this.camera.getCamera():void 0)!=null?e:this._context.defaultCamera}getTime(){return this._context.time}vertex(e,g){return g===2?e.pipe("view.position"):g===3?e.pipe("root.position"):e}}r.initClass()};
shadow$provide[193]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Unit:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits=["node","unit"]}make(){return this._helpers.unit.make()}unmake(){return this._helpers.unit.unmake()}getUnit(){return this._helpers.unit.get()}getUnitUniforms(){return this._helpers.unit.uniforms()}}x.initClass()};
shadow$provide[194]=function(l,L,q){q=l(190);var x=l(191),r=l(192),e=l(193);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e)};
shadow$provide[195]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},paramToArrayStorage:{enumerable:!0,get:function(){return g}},paramToGL:{enumerable:!0,get:function(){return e}},swizzleToEulerOrder:{enumerable:!0,get:function(){return f}},transformComposer:{enumerable:!0,get:function(){return k}}});var x=l(101),r=l(101);const e=function(m,p){return p===x.RepeatWrapping?m.REPEAT:p===x.ClampToEdgeWrapping?m.CLAMP_TO_EDGE:p===x.MirroredRepeatWrapping?m.MIRRORED_REPEAT:
p===x.NearestFilter?m.NEAREST:p===x.NearestMipMapNearestFilter?m.NEAREST_MIPMAP_NEAREST:p===x.NearestMipMapLinearFilter?m.NEAREST_MIPMAP_LINEAR:p===x.LinearFilter?m.LINEAR:p===x.LinearMipMapNearestFilter?m.LINEAR_MIPMAP_NEAREST:p===x.LinearMipMapLinearFilter?m.LINEAR_MIPMAP_LINEAR:p===x.UnsignedByteType?m.UNSIGNED_BYTE:p===x.UnsignedShort4444Type?m.UNSIGNED_SHORT_4_4_4_4:p===x.UnsignedShort5551Type?m.UNSIGNED_SHORT_5_5_5_1:p===x.ByteType?m.BYTE:p===x.ShortType?m.SHORT:p===x.UnsignedShortType?m.UNSIGNED_SHORT:
p===x.IntType?m.INT:p===x.UnsignedIntType?m.UNSIGNED_INT:p===x.FloatType?m.FLOAT:p===x.AlphaFormat?m.ALPHA:p===x.RGBAFormat?m.RGBA:p===x.LuminanceFormat?m.LUMINANCE:p===x.LuminanceAlphaFormat?m.LUMINANCE_ALPHA:p===x.AddEquation?m.FUNC_ADD:p===x.SubtractEquation?m.FUNC_SUBTRACT:p===x.ReverseSubtractEquation?m.FUNC_REVERSE_SUBTRACT:p===x.ZeroFactor?m.ZERO:p===x.OneFactor?m.ONE:p===x.SrcColorFactor?m.SRC_COLOR:p===x.OneMinusSrcColorFactor?m.ONE_MINUS_SRC_COLOR:p===x.SrcAlphaFactor?m.SRC_ALPHA:p===x.OneMinusSrcAlphaFactor?
m.ONE_MINUS_SRC_ALPHA:p===x.DstAlphaFactor?m.DST_ALPHA:p===x.OneMinusDstAlphaFactor?m.ONE_MINUS_DST_ALPHA:p===x.DstColorFactor?m.DST_COLOR:p===x.OneMinusDstColorFactor?m.ONE_MINUS_DST_COLOR:p===x.SrcAlphaSaturateFactor?m.SRC_ALPHA_SATURATE:0},g=function(m){switch(m){case x.UnsignedByteType:return Uint8Array;case x.ByteType:return Int8Array;case x.ShortType:return Int16Array;case x.UnsignedShortType:return Uint16Array;case x.IntType:return Int32Array;case x.UnsignedIntType:return Uint32Array;case x.FloatType:return Float32Array}},
f=m=>m.map(p=>["","X","Y","Z"][p]).join(""),k=function(){const m=new r.Euler,p=new r.Quaternion,z=new r.Vector3,t=new r.Vector3,v=new r.Matrix4;return function(y,B,D,G,I,K){K==null&&(K="XYZ");B!=null?(K instanceof Array&&(K=f(K)),m.setFromVector3(B,K),p.setFromEuler(m)):p.set(0,0,0,1);D!=null&&p.multiply(D);y!=null?z.copy(y):z.set(0,0,0);G!=null?t.copy(G):t.set(1,1,1);v.compose(z,p,t);I!=null&&v.multiplyMatrices(v,I);return v}}};
shadow$provide[196]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Camera:{enumerable:!0,get:function(){return e}}});var x=l(195),r=l(101);l=l(188);class e extends l.Primitive{static initClass(){this.traits=["node","camera"]}init(){}make(){const g=this._context.defaultCamera;this.camera=this.props.proxy?g:g.clone();this.euler=new r.Euler;return this.quat=new r.Quaternion}unmake(){}getCamera(){return this.camera}change(g,f,k){if(g["camera.position"]||g["camera.quaternion"]||
g["camera.rotation"]||g["camera.lookAt"]||g["camera.up"]||g["camera.fov"]||k){const {position:m,quaternion:p,rotation:z,lookAt:t,up:v,fov:y}=this.props;m!=null&&this.camera.position.copy(m);if(p!=null||z!=null||t!=null)t!=null?this.camera.lookAt(t):this.camera.quaternion.set(0,0,0,1),z!=null&&(this.euler.setFromVector3(z,x.swizzleToEulerOrder(this.props.eulerOrder)),this.quat.setFromEuler(this.euler),this.camera.quaternion.multiply(this.quat)),p!=null&&this.camera.quaternion.multiply(p);y!=null&&
this.camera.fov!=null&&(this.camera.fov=y);v!=null&&this.camera.up.copy(v);return this.camera.updateMatrix()}}}e.initClass()};
shadow$provide[197]=function(l,L,q){q=l(196);l.exportCopy(L,q)};
shadow$provide[198]=function(l,L,q){function x(t,v,y){const B=[],D=t<v;for(v=y?D?v+1:v-1:v;D?t<v:t>v;D?t++:t--)B.push(t);return B}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},getDimensions:{enumerable:!0,get:function(){return e}},getLerpEmitter:{enumerable:!0,get:function(){return p}},getLerpThunk:{enumerable:!0,get:function(){return z}},getSizes:{enumerable:!0,get:function(){return r}},getStreamer:{enumerable:!0,get:function(){return m}},getThunk:{enumerable:!0,get:function(){return k}},
makeEmitter:{enumerable:!0,get:function(){return f}},repeatCall:{enumerable:!0,get:function(){return g}}});const r=function(t){const v=[];for(;typeof t!=="string"&&(t!=null?t.length:void 0)!=null;)v.push(t.length),t=t[0];return v},e=function(t,v){let y;v==null&&(v={});const {items:B,channels:D,width:G,height:I,depth:K}=v;v={};if(!t||!t.length)return{items:B,channels:D,width:G!=null?G:0,height:I!=null?I:0,depth:K!=null?K:0};t=r(t);var Q=t.length;v.channels=D!==1&&t.length>1?t.pop():D;v.items=B!==1&&
t.length>1?t.pop():B;v.width=G!==1&&t.length>1?t.pop():G;v.height=I!==1&&t.length>1?t.pop():I;v.depth=K!==1&&t.length>1?t.pop():K;D===1&&Q++;B===1&&Q>1&&Q++;G===1&&Q>2&&Q++;I===1&&Q>3&&Q++;t=(y=t.pop())!=null?y:1;Q<=1&&(t/=v.channels!=null?v.channels:1);Q<=2&&(t/=v.items!=null?v.items:1);Q<=3&&(t/=v.width!=null?v.width:1);Q<=4&&(t/=v.height!=null?v.height:1);t=Math.floor(t);v.width==null&&(v.width=t,t=1);v.height==null&&(v.height=t,t=1);v.depth==null&&(v.depth=t);return v},g=function(t,v){switch(v){case 0:return()=>
!0;case 1:return()=>t();case 2:return function(){t();return t()};case 3:return function(){t();t();t();return t()};case 4:return function(){t();t();t();return t()};case 6:return function(){t();t();t();t();t();return t()};case 8:return function(){t();t();t();t();t();return t()}}},f=function(t,v,y){let B;const D=(()=>{switch(y){case 0:return()=>!0;case 1:return I=>I(t());case 2:return I=>I(t(),t());case 3:return I=>I(t(),t(),t());case 4:return I=>I(t(),t(),t(),t());case 6:return I=>I(t(),t(),t(),t(),
t(),t());case 8:return I=>I(t(),t(),t(),t(),t(),t(),t(),t())}})();let G=null;for(;v>0;){const I=Math.min(v,8);B=(()=>{switch(I){case 1:return K=>D(K);case 2:return function(K){D(K);return D(K)};case 3:return function(K){D(K);D(K);return D(K)};case 4:return function(K){D(K);D(K);D(K);return D(K)};case 5:return function(K){D(K);D(K);D(K);D(K);return D(K)};case 6:return function(K){D(K);D(K);D(K);D(K);D(K);return D(K)};case 7:return function(K){D(K);D(K);D(K);D(K);D(K);D(K);return D(K)};case 8:return function(K){D(K);
D(K);D(K);D(K);D(K);D(K);D(K);return D(K)}}})();G=G!=null?((K,Q)=>function(O){K(O);return Q(O)})(B,G):B;v-=I}B=G!=null?G:()=>!0;B.reset=t.reset;B.rebind=t.rebind;return B},k=function(t){let v,y,B,D,G,I=r(t);const K=I.length;let Q=I.pop(),O=I.pop(),J=I.pop();const W=I.pop();let ba,Y,S,ca,V;switch(K){case 0:v=()=>0;v.reset=function(){};break;case 1:ba=0;v=()=>t[ba++];v.reset=()=>ba=0;break;case 2:ba=y=0;Y=t[y]!=null?t[y]:[];v=function(){const xa=Y[ba++];ba===Q&&(ba=0,y++,Y=t[y]!=null?t[y]:[]);return xa};
v.reset=function(){ba=y=0;Y=t[y]!=null?t[y]:[]};break;case 3:ba=y=B=0;S=t[B]!=null?t[B]:[];Y=S[y]!=null?S[y]:[];v=function(){const xa=Y[ba++];ba===Q&&(ba=0,y++,y===O&&(y=0,B++,S=t[B]!=null?t[B]:[]),Y=S[y]!=null?S[y]:[]);return xa};v.reset=function(){ba=y=B=0;S=t[B]!=null?t[B]:[];Y=S[y]!=null?S[y]:[]};break;case 4:ba=y=B=D=0;ca=t[D]!=null?t[D]:[];S=ca[B]!=null?ca[B]:[];Y=S[y]!=null?S[y]:[];v=function(){const xa=Y[ba++];ba===Q&&(ba=0,y++,y===O&&(y=0,B++,B===J&&(B=0,D++,ca=t[D]!=null?t[D]:[]),S=ca[B]!=
null?ca[B]:[]),Y=S[y]!=null?S[y]:[]);return xa};v.reset=function(){ba=y=B=D=0;ca=t[D]!=null?t[D]:[];S=ca[B]!=null?ca[B]:[];Y=S[y]!=null?S[y]:[]};break;case 5:ba=y=B=D=G=0,V=t[G]!=null?t[G]:[],ca=V[D]!=null?V[D]:[],S=ca[B]!=null?ca[B]:[],Y=S[y]!=null?S[y]:[],v=function(){const xa=Y[ba++];ba===Q&&(ba=0,y++,y===O&&(y=0,B++,B===J&&(B=0,D++,D===W&&(D=0,G++,V=t[G]!=null?t[G]:[]),ca=V[D]!=null?V[D]:[]),S=ca[B]!=null?ca[B]:[]),Y=S[y]!=null?S[y]:[]);return xa},v.reset=function(){ba=y=B=D=G=0;V=t[G]!=null?
t[G]:[];ca=V[D]!=null?V[D]:[];S=ca[B]!=null?ca[B]:[];Y=S[y]!=null?S[y]:[]}}v.rebind=function(xa){t=xa;I=r(t);I.length&&(Q=I.pop());I.length&&(O=I.pop());I.length&&(J=I.pop());if(I.length)return I.pop()};return v},m=function(t,v,y,B){let D,G,I=D=G=0;const K=function(){I=v*y*B;return D=G=0},Q=(()=>{switch(y){case 1:return function(W){D+=W;G+=W};case 2:return function(W){D+=W*2;G+=W};case 3:return function(W){D+=W*3;G+=W};case 4:return function(W){D+=W*4;G+=W}}})(),O=(()=>{switch(y){case 1:return function(W){W(t[D++]);
++G};case 2:return function(W){W(t[D++],t[D++]);++G};case 3:return function(W){W(t[D++],t[D++],t[D++]);++G};case 4:return function(W){W(t[D++],t[D++],t[D++],t[D++]);++G}}})(),J=(()=>{switch(y){case 1:return function(W){t[D++]=W;++G};case 2:return function(W,ba){t[D++]=W;t[D++]=ba;++G};case 3:return function(W,ba,Y){t[D++]=W;t[D++]=ba;t[D++]=Y;++G};case 4:return function(W,ba,Y,S){t[D++]=W;t[D++]=ba;t[D++]=Y;t[D++]=S;++G}}})();O.reset=K;J.reset=K;K();return{emit:J,consume:O,skip:Q,count:()=>G,done:()=>
I-D<=0,reset:K}},p=function(t,v){let y,B,D,G;const I=new Float32Array(4096);let K=y=.5,Q=B=D=G=0;const O=function(ba,Y,S,ca){D++;I[Q++]=ba*K;I[Q++]=Y*K;I[Q++]=S*K;return I[Q++]=ca*K},J=function(ba,Y,S,ca){G++;I[B++]+=ba*y;I[B++]+=Y*y;I[B++]+=S*y;return I[B++]+=ca*y};var W=Math.max(t.length,v.length);W=W<=3?function(ba,Y,S){Q=B=D=G=0;t(O,Y,S);v(J,Y,S);let ca=0;return x(0,Math.min(D,G),!1).map(V=>ba(I[ca++],I[ca++],I[ca++],I[ca++]))}:W<=5?function(ba,Y,S,ca,V){Q=B=D=G=0;t(O,Y,S,ca,V);v(J,Y,S,ca,V);
let xa=0;return x(0,Math.min(D,G),!1).map(na=>ba(I[xa++],I[xa++],I[xa++],I[xa++]))}:W<=7?function(ba,Y,S,ca,V,xa,na){Q=B=D=G=0;t(O,Y,S,ca,V,xa,na);v(J,Y,S,ca,V,xa,na);Y=Math.min(D,G);S=0;V=[];na=0;for(ca=0<=Y;ca?na<Y:na>Y;ca?na++:na--)V.push(ba(I[S++],I[S++],I[S++],I[S++]));return V}:W<=9?function(ba,Y,S,ca,V,xa,na,N,pa){Q=B=D=G=0;t(O,Y,S,ca,V,xa,na,N,pa);v(J,Y,S,ca,V,xa,na,N,pa);Y=Math.min(D,G);pa=0;ca=[];N=0;for(S=0<=Y;S?N<Y:N>Y;S?N++:N--)ca.push(ba(I[pa++],I[pa++],I[pa++],I[pa++]));return ca}:
function(ba,Y,S,ca,V,xa,na,N,pa,ra,Ea){Q=B=0;t(O,Y,S,ca,V,xa,na,N,pa,ra,Ea);v(J,Y,S,ca,V,xa,na,N,pa,ra,Ea);Y=Math.min(D,G);pa=0;ca=[];N=0;for(S=0<=Y;S?N<Y:N>Y;S?N++:N--)ca.push(ba(I[pa++],I[pa++],I[pa++],I[pa++]));return ca};W.lerp=function(ba){let Y;return[K,y]=Array.from(Y=[1-ba,ba]),Y};return W},z=function(t,v){const y=r(t).reduce((Q,O)=>Q*O),B=r(v).reduce((Q,O)=>Q*O),D=Math.min(y,B),G=k(t),I=k(v),K=new Float32Array(D);K.lerp=function(Q){G.reset();I.reset();let O=0;const J=[];for(;O<D;){const W=
G(),ba=I();J.push(K[O++]=W+(ba-W)*Q)}return J};return K}};
shadow$provide[199]=function(l,L,q){function x(K,Q,O){const J=[],W=K<Q;for(Q=O?W?Q+1:Q-1:Q;W?K<Q:K>Q;W?K++:K--)J.push(K);return J}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},binaryOperator:{enumerable:!0,get:function(){return z}},constant:{enumerable:!0,get:function(){return I}},extendVec:{enumerable:!0,get:function(){return t}},identity:{enumerable:!0,get:function(){return G}},injectVec4:{enumerable:!0,get:function(){return y}},invertSwizzleVec4:{enumerable:!0,get:function(){return D}},
mapByte2FloatOffset:{enumerable:!0,get:function(){return m}},sample2DArray:{enumerable:!0,get:function(){return p}},swizzleVec4:{enumerable:!0,get:function(){return B}},toType:{enumerable:!0,get:function(){return f}},truncateVec:{enumerable:!0,get:function(){return v}}});const r=["x","y","z","w"],e={0:-1,x:0,y:1,z:2,w:3},g=function(K){K===""+K&&(K=K.split(""));K===+K&&(K=[K]);return K},f=function(K){K===+K&&(K="vec"+K);K==="vec1"&&(K="float");return K},k=function(K){K=""+K;if(K.indexOf(".")<0)return K+
".0"},m=function(K){K==null&&(K=4);K=k(K);return`\
vec4 float2ByteIndex(vec4 xyzw, out float channelIndex) {
  float relative = xyzw.w / ${K};
  float w = floor(relative);
  channelIndex = (relative - w) * ${K};
  return vec4(xyzw.xyz, w);
}\
`},p=function(K){const Q=function(J,W){if(J===W)J=`\
return texture2D(dataTextures[${J}], uv);\
`;else{const ba=Math.ceil(J+(W-J)/2);J=`\
if (z < ${ba-.5}) {
  ${Q(J,ba-1)}
}
else {
  ${Q(ba,W)}
}\
`}return J.replace(/\n/g,"\n  ")},O=Q(0,K-1);return`\
uniform sampler2D dataTextures[${K}];

vec4 sample2DArray(vec2 uv, float z) {
  ${O}
}\
`},z=function(K,Q,O){K=f(K);return O!=null?`\
${K} binaryOperator(${K} a) {
  return a ${Q} ${O};
}\
`:`\
${K} binaryOperator(${K} a, ${K} b) {
  return a ${Q} b;
}\
`},t=function(K,Q,O){O==null&&(O=0);if(K>Q)return v(K,Q);var J=Q-K;K=f(K);Q=f(Q);O=k(O);J=x(0,J,!0).map(function(W){return W?O:"v"}).join(",");return`\
${Q} extendVec(${K} v) { return ${Q}(${J}); }\
`},v=function(K,Q){if(K<Q)return t(K,Q);const O="."+"xyzw".substr(0,Q);K=f(K);Q=f(Q);return`\
${Q} truncateVec(${K} v) { return v${O}; }\
`},y=function(K){var Q=["0.0","0.0","0.0","0.0"];K=g(K);K=K.map(function(O){return O===""+O?e[O]:O});for(let O=0;O<K.length;O++)Q[K[O]]=["a","b","c","d"][O];Q=Q.slice(0,4).join(", ");return`\
vec4 inject(${["float a","float b","float c","float d"].slice(0,K.length)}) {
  return vec4(${Q});
}\
`},B=function(K,Q=null){const O=["0.0","xyzw.x","xyzw.y","xyzw.z","xyzw.w"];Q==null&&(Q=K.length);K=g(K);for(K=K.map(function(J){Array.from([0,1,2,3,4]).includes(+J)&&(J=+J);J===""+J&&(J=e[J]+1);return O[J]});K.length<Q;)K.push("0.0");K=K.join(", ");return`\
vec${Q} swizzle(vec4 xyzw) {
  return vec${Q}(${K});
}\
`.replace(/vec1/g,"float")},D=function(K){const Q=["0.0","0.0","0.0","0.0"];K=g(K);K=K.map(function(O){return O===+O?r[O-1]:O});for(let O=0;O<K.length;O++)Q[e[K[O]]]=`xyzw.${r[O]}`;return`\
vec4 invertSwizzle(vec4 xyzw) {
  return vec4(${Q.join(", ")});
}\
`},G=function(K){let Q=[].slice.call(arguments);return Q.length>1?(Q=Q.map((O,J)=>["inout",O,String.fromCharCode(97+J)].join(" ")),Q=Q.join(", "),`\
void identity(${Q}) { }\
`):`\
${K} identity(${K} x) {
  return x;
}\
`},I=(K,Q)=>`\
${K} constant() {
return ${Q};
}\
`};
shadow$provide[200]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Source:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(188);class r extends l.Primitive{static initClass(){this.traits=["node","source","index"]}made(){return this.trigger({type:"source.rebuild"})}indexShader(e){return e.pipe(x.identity("vec4"))}sourceShader(e){return e.pipe(x.identity("vec4"))}getDimensions(){return{items:1,width:1,height:1,depth:1}}getActiveDimensions(){return this.getDimensions()}getIndexDimensions(){return this.getActiveDimensions()}getFutureDimensions(){return this.getActiveDimensions()}}
r.initClass()};
shadow$provide[201]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Data:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(200);class r extends l.Source{static initClass(){this.traits="node data source index entity active".split(" ")}init(){return this.dataSizes=this.dataEmitter=null}emitter(e,g){const {data:f,bind:k,expr:m}=this.props;if(f!=null){var p=this.dataSizes;var z=x.getSizes(f);p&&p.length===z.length||(p=x.getThunk(f),this.dataEmitter=this.callback(x.makeEmitter(p,
g,e)),this.dataSizes=z);e=this.dataEmitter}else z!=null?(z=this._inherit("resolve"),e=this.callback(z.callback(k))):e=m!=null?this.callback(m):this.callback(this.passthrough);return e}callback(e){return e!=null?e:function(){}}update(){}make(){this._helpers.active.make();this.first=!0;return this._listen("root","root.update",()=>{(this.isActive||this.first)&&this.update();return this.first=!1})}unmake(){this._helpers.active.unmake();return this.dataSizes=this.dataEmitter=null}}r.initClass()};
shadow$provide[202]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Buffer:{enumerable:!0,get:function(){return x}}});l=l(201);class x extends l.Data{static initClass(){this.traits="node buffer active data source index texture".split(" ")}init(){this.bufferStep=this.bufferClock=this.bufferDelta=this.bufferTime=this.bufferFrames=this.bufferSlack=0;super.init()}make(){super.make();this.clockParent=this._inherit("clock");this.latchParent=this._inherit("latch")}unmake(){return super.unmake()}rawBuffer(){return this.buffer}emitter(){const {channels:r,
items:e}=this.props;return super.emitter(r,e)}change(r,e,g){if(r["buffer.fps"]||g)return{fps:r}=this.props,this.bufferSlack=r?.5/r:0}syncBuffer(r){let e,g;if(this.buffer){var {live:f,fps:k,hurry:m,limit:p,realtime:z,observe:t}=this.props,v=this.buffer.getFilled();if(!v||f)if(!this.latchParent||this.latchParent.isDirty){var y=this.clockParent.getTime();if(k!=null){const B=this.bufferSlack,D=y.step/y.delta;e=z?y.delta:y.step;const G=1/k;g=z&&t?D*G:G;Math.abs(y.time-this.bufferTime)>y.step*p&&(this.bufferTime=
y.time,this.bufferClock=y.clock);this.bufferSlack=Math.min(p/k,B+e);this.bufferDelta=e;this.bufferStep=g;let I=Math.min(m,Math.floor(B*k));v||(I=Math.max(1,I));let K=!1;const Q=()=>K=!0;return(()=>{const O=[];for(let J=0,W=I,ba=0<=W;ba?J<W:J>W;ba?J++:J--){this.bufferTime+=e;this.bufferClock+=g;if(K)break;r(Q,this.bufferFrames++,J,I);O.push(this.bufferSlack-=G)}return O})()}this.bufferTime=y.time;this.bufferDelta=y.delta;this.bufferClock=y.clock;this.bufferStep=y.step;return r(function(){},this.bufferFrames++,
0,1)}}}alignShader(r,e){const {minFilter:g,magFilter:f,aligned:k}=this.props;r=r.items>1&&r.width>1||r.height>1&&r.depth>1;if(!k&&r)return g===this.node.attributes["texture.minFilter"].enum.nearest&&f===this.node.attributes["texture.magFilter"].enum.nearest||console.warn(`${this.node.toString()} - Cannot use linear min/magFilter with 3D/4D sampling`),e.pipe("map.xyzw.align")}}x.initClass()};
shadow$provide[203]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Array_:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(202);class r extends l.Buffer{static initClass(){this.traits="node buffer active data source index array texture raw".split(" ")}init(){this.buffer=this.spec=null;this.space={width:0,history:0};this.used={width:0};this.storage="arrayBuffer";this.passthrough=(e,g)=>e(g,0,0,0);return super.init()}sourceShader(e){const g=this.getDimensions();
this.alignShader(g,e);return this.buffer.shader(e)}getDimensions(){return{items:this.items,width:this.space.width,height:this.space.history,depth:1}}getActiveDimensions(){return{items:this.items,width:this.used.width,height:this.buffer.getFilled(),depth:1}}getFutureDimensions(){return{items:this.items,width:this.used.width,height:this.space.history,depth:1}}getRawDimensions(){return{items:this.items,width:this.space.width,height:1,depth:1}}make(){super.make();const e=this.minFilter!=null?this.minFilter:
this.props.minFilter,g=this.magFilter!=null?this.magFilter:this.props.magFilter,f=this.type!=null?this.type:this.props.type;var {width:k}=this.props;const {history:m}=this.props,p=this.props.bufferWidth,{channels:z}=this.props,{items:t}=this.props;k=this.spec={channels:z,items:t,width:k};this.items=k.items;this.channels=k.channels;var {data:v}=this.props;k=x.getDimensions(v,k);({space:v}=this);v.width=Math.max(p,k.width||1);v.history=m;return this.buffer=this._renderables.make(this.storage,{width:v.width,
history:v.history,channels:z,items:t,minFilter:e,magFilter:g,type:f})}unmake(){super.unmake();if(this.buffer)return this.buffer.dispose(),this.buffer=this.spec=null}change(e,g,f){if(g.texture||e["history.history"]||e["buffer.channels"]||e["buffer.items"]||e["array.bufferWidth"])return this.rebuild();if(this.buffer){if(e["array.width"]){const {width:k,bufferWidth:m}=this.props;this.spec.width=k;if(k>m)return this.rebuild()}if(e["data.map"]||e["data.data"]||e["data.resolve"]||e["data.expr"]||f)return this.buffer.setCallback(this.emitter())}}callback(e){return e.length<=
2?e:(g,f)=>e(g,f,this.bufferClock,this.bufferStep)}update(){if(this.buffer){var {data:e}=this.props,{width:g}=this.props,{space:f,used:k}=this,m=k.width,p=this.buffer.getFilled();this.syncBuffer(z=>{if(e!=null){const t=x.getDimensions(e,this.spec);if(t.width>f.width)return z(),this.rebuild();k.width=t.width;this.buffer.setActive(k.width);typeof this.buffer.callback.rebind==="function"&&this.buffer.callback.rebind(e);return this.buffer.update()}g=this.spec.width||1;this.buffer.setActive(g);g=this.buffer.update();
return k.width=g});if(k.width!==m||p!==this.buffer.getFilled())return this.trigger({type:"source.resize"})}}}r.initClass()};
shadow$provide[204]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Interval:{enumerable:!0,get:function(){return x}}});l=l(203);class x extends l.Array_{static initClass(){this.traits="node buffer active data source index texture array span interval sampler raw".split(" ")}updateSpan(){var r=this.props.axis;({width:f}=this.props);const {centered:e}=this.props,g=this.props.padding;r=this._helpers.span.get("",r);f+=g*2;this.a=r.x;r=r.y-r.x;if(e){var f=1/Math.max(1,f);
this.a+=r*f/2}else f=1/Math.max(1,f-1);this.b=r*f;return this.a+=g*this.b}callback(r){this.updateSpan();if(this.last===r)return this._callback;this.last=r;return r.length<=3?this._callback=(e,g)=>r(e,this.a+this.b*g,g):this._callback=(e,g)=>r(e,this.a+this.b*g,g,this.bufferClock,this.bufferStep)}make(){super.make();this._helpers.span.make();return this._listen(this,"span.range",this.updateSpan)}unmake(){super.unmake();return this._helpers.span.unmake()}change(r,e,g){super.change(r,e,g);e.span&&this.updateSpan()}}
x.initClass()};
shadow$provide[205]=function(l,L,q){L.exports=function(x,r){for(var e=-1,g=x==null?0:x.length;++e<g&&r(x[e],e,x)!==!1;);return x}};
shadow$provide[206]=function(l,L,q){l=l(35);a:{try{var x=l(Object,"defineProperty");x({},"",{});var r=x;break a}catch(e){}r=void 0}L.exports=r};
shadow$provide[207]=function(l,L,q){var x=l(206);L.exports=function(r,e,g){e=="__proto__"&&x?x(r,e,{configurable:!0,enumerable:!0,value:g,writable:!0}):r[e]=g}};
shadow$provide[208]=function(l,L,q){var x=l(207),r=l(11),e=Object.prototype.hasOwnProperty;L.exports=function(g,f,k){var m=g[f];e.call(g,f)&&r(m,k)&&(k!==void 0||f in g)||x(g,f,k)}};
shadow$provide[209]=function(l,L,q){var x=l(208),r=l(207);L.exports=function(e,g,f,k){var m=!f;f||(f={});for(var p=-1,z=g.length;++p<z;){var t=g[p],v=k?k(f[t],e[t],t,f,e):void 0;v===void 0&&(v=e[t]);m?r(f,t,v):x(f,t,v)}return f}};
shadow$provide[210]=function(l,L,q){var x=l(209),r=l(88);L.exports=function(e,g){return e&&x(g,r(g),e)}};
shadow$provide[211]=function(l,L,q){L.exports=function(x){var r=[];if(x!=null)for(var e in Object(x))r.push(e);return r}};
shadow$provide[212]=function(l,L,q){var x=l(28),r=l(83),e=l(211),g=Object.prototype.hasOwnProperty;L.exports=function(f){if(!x(f))return e(f);var k=r(f),m=[],p;for(p in f)(p!="constructor"||!k&&g.call(f,p))&&m.push(p);return m}};
shadow$provide[213]=function(l,L,q){var x=l(82),r=l(212),e=l(87);L.exports=function(g){return e(g)?x(g,!0):r(g)}};
shadow$provide[214]=function(l,L,q){var x=l(209),r=l(213);L.exports=function(e,g){return e&&x(g,r(g),e)}};
shadow$provide[215]=function(l,L,q){l=l(23);var x=(q=typeof q=="object"&&q&&!q.nodeType&&q)&&typeof L=="object"&&L&&!L.nodeType&&L,r=(l=x&&x.exports===q?l.Buffer:void 0)?l.allocUnsafe:void 0;L.exports=function(e,g){if(g)return e.slice();g=e.length;g=r?r(g):new e.constructor(g);e.copy(g);return g}};
shadow$provide[216]=function(l,L,q){L.exports=function(x,r){var e=-1,g=x.length;for(r||(r=Array(g));++e<g;)r[e]=x[e];return r}};
shadow$provide[217]=function(l,L,q){var x=l(209),r=l(69);L.exports=function(e,g){return x(e,r(e),g)}};
shadow$provide[218]=function(l,L,q){l=l(84)(Object.getPrototypeOf,Object);L.exports=l};
shadow$provide[219]=function(l,L,q){var x=l(64),r=l(218),e=l(69);l=l(68);L.exports=Object.getOwnPropertySymbols?function(g){for(var f=[];g;)x(f,e(g)),g=r(g);return f}:l};
shadow$provide[220]=function(l,L,q){var x=l(209),r=l(219);L.exports=function(e,g){return x(e,r(e),g)}};
shadow$provide[221]=function(l,L,q){var x=l(66),r=l(219),e=l(213);L.exports=function(g){return x(g,e,r)}};
shadow$provide[222]=function(l,L,q){var x=Object.prototype.hasOwnProperty;L.exports=function(r){var e=r.length,g=new r.constructor(e);e&&typeof r[0]=="string"&&x.call(r,"index")&&(g.index=r.index,g.input=r.input);return g}};
shadow$provide[223]=function(l,L,q){var x=l(60);L.exports=function(r){var e=new r.constructor(r.byteLength);(new x(e)).set(new x(r));return e}};
shadow$provide[224]=function(l,L,q){var x=l(223);L.exports=function(r,e){e=e?x(r.buffer):r.buffer;return new r.constructor(e,r.byteOffset,r.byteLength)}};
shadow$provide[225]=function(l,L,q){var x=/\w*$/;L.exports=function(r){var e=new r.constructor(r.source,x.exec(r));e.lastIndex=r.lastIndex;return e}};
shadow$provide[226]=function(l,L,q){var x=(l=(l=l(24))?l.prototype:void 0)?l.valueOf:void 0;L.exports=function(r){return x?Object(x.call(r)):{}}};
shadow$provide[227]=function(l,L,q){var x=l(223);L.exports=function(r,e){e=e?x(r.buffer):r.buffer;return new r.constructor(e,r.byteOffset,r.length)}};
shadow$provide[228]=function(l,L,q){var x=l(223),r=l(224),e=l(225),g=l(226),f=l(227);L.exports=function(k,m,p){var z=k.constructor;switch(m){case "[object ArrayBuffer]":return x(k);case "[object Boolean]":case "[object Date]":return new z(+k);case "[object DataView]":return r(k,p);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return f(k,
p);case "[object Map]":return new z;case "[object Number]":case "[object String]":return new z(k);case "[object RegExp]":return e(k);case "[object Set]":return new z;case "[object Symbol]":return g(k)}}};
shadow$provide[229]=function(l,L,q){var x=l(28),r=Object.create;l=function(){function e(){}return function(g){if(!x(g))return{};if(r)return r(g);e.prototype=g;g=new e;e.prototype=void 0;return g}}();L.exports=l};
shadow$provide[230]=function(l,L,q){var x=l(229),r=l(218),e=l(83);L.exports=function(g){return typeof g.constructor!="function"||e(g)?{}:x(r(g))}};
shadow$provide[231]=function(l,L,q){var x=l(95),r=l(71);L.exports=function(e){return r(e)&&x(e)=="[object Map]"}};
shadow$provide[232]=function(l,L,q){q=l(231);var x=l(79);q=(l=(l=l(80))&&l.isMap)?x(l):q;L.exports=q};
shadow$provide[233]=function(l,L,q){var x=l(95),r=l(71);L.exports=function(e){return r(e)&&x(e)=="[object Set]"}};
shadow$provide[234]=function(l,L,q){q=l(233);var x=l(79);q=(l=(l=l(80))&&l.isSet)?x(l):q;L.exports=q};
shadow$provide[235]=function(l,L,q){function x(ca,V,xa,na,N,pa){var ra,Ea=V&1,Ua=V&2,jb=V&4;xa&&(ra=N?xa(ca,na,N,pa):xa(ca));if(ra!==void 0)return ra;if(!J(ca))return ca;if(na=K(ca)){if(ra=D(ca),!Ea)return p(ca,ra)}else{var eb=B(ca),rc=eb=="[object Function]"||eb=="[object GeneratorFunction]";if(Q(ca))return m(ca,Ea);if(eb=="[object Object]"||eb=="[object Arguments]"||rc&&!N){if(ra=Ua||rc?{}:I(ca),!Ea)return Ua?t(ca,k(ra,ca)):z(ca,f(ra,ca))}else{if(!S[eb])return N?ca:{};ra=G(ca,eb,Ea)}}pa||(pa=new r);
if(N=pa.get(ca))return N;pa.set(ca,ra);W(ca)?ca.forEach(function(Bb){ra.add(x(Bb,V,xa,Bb,ca,pa))}):O(ca)&&ca.forEach(function(Bb,bc){ra.set(bc,x(Bb,V,xa,bc,ca,pa))});Ua=jb?Ua?y:v:Ua?Y:ba;var xb=na?void 0:Ua(ca);e(xb||ca,function(Bb,bc){xb&&(bc=Bb,Bb=ca[bc]);g(ra,bc,x(Bb,V,xa,bc,ca,pa))});return ra}var r=l(53),e=l(205),g=l(208),f=l(210),k=l(214),m=l(215),p=l(216),z=l(217),t=l(220),v=l(89),y=l(221),B=l(95),D=l(222),G=l(228),I=l(230),K=l(65),Q=l(75),O=l(232),J=l(28),W=l(234),ba=l(88),Y=l(213),S={};S["[object Arguments]"]=
S["[object Array]"]=S["[object ArrayBuffer]"]=S["[object DataView]"]=S["[object Boolean]"]=S["[object Date]"]=S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Map]"]=S["[object Number]"]=S["[object Object]"]=S["[object RegExp]"]=S["[object Set]"]=S["[object String]"]=S["[object Symbol]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0;S["[object Error]"]=
S["[object Function]"]=S["[object WeakMap]"]=!1;L.exports=x};
shadow$provide[236]=function(l,L,q){var x=l(235);L.exports=function(r){return x(r,5)}};
shadow$provide[237]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Latch:{enumerable:!0,get:function(){return g}}});L=l(189);q=l(236);var x=l(98),r=l.esmDefault(q),e=l.esmDefault(x);class g extends L.Parent{static initClass(){this.traits=["node","entity","active","latch"]}init(){this.data=void 0;this.isDirty=!0}make(){this._helpers.active.make();this._listen("root","root.update",function(){this.isActive&&this.update()})}unmake(){this._helpers.active.unmake();this.data=
void 0}swap(){const {deep:f,data:k}=this.props;(f?(0,e.default)(k,this.data):k==this.data)||(this.data=f?(0,r.default)(k):k)}update(){this.isDirty=this.swap()}}g.initClass()};
shadow$provide[238]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Matrix:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(202);class r extends l.Buffer{static initClass(){this.traits="node buffer active data source index texture matrix raw".split(" ")}init(){this.buffer=this.spec=null;this.space={width:0,height:0,history:0};this.used={width:0,height:0};this.storage="matrixBuffer";this.passthrough=(e,g,f)=>e(g,f,0,0);return super.init()}sourceShader(e){const g=
this.getDimensions();this.alignShader(g,e);return this.buffer.shader(e)}getDimensions(){return{items:this.items,width:this.space.width,height:this.space.height,depth:this.space.history}}getActiveDimensions(){return{items:this.items,width:this.used.width,height:this.used.height,depth:this.buffer.getFilled()}}getFutureDimensions(){return{items:this.items,width:this.used.width,height:this.used.height,depth:this.space.history}}getRawDimensions(){return{items:this.items,width:this.space.width,height:this.space.height,
depth:1}}make(){super.make();const e=this.minFilter!=null?this.minFilter:this.props.minFilter,g=this.magFilter!=null?this.magFilter:this.props.magFilter,f=this.type!=null?this.type:this.props.type;var {width:k}=this.props,{height:m}=this.props;const {history:p}=this.props,z=this.props.bufferWidth,t=this.props.bufferHeight,{channels:v}=this.props,{items:y}=this.props;k=this.spec={channels:v,items:y,width:k,height:m};this.items=k.items;this.channels=k.channels;({data:m}=this.props);k=x.getDimensions(m,
k);({space:m}=this);m.width=Math.max(z,k.width||1);m.height=Math.max(t,k.height||1);m.history=p;return this.buffer=this._renderables.make(this.storage,{width:m.width,height:m.height,history:m.history,channels:v,items:y,minFilter:e,magFilter:g,type:f})}unmake(){super.unmake();if(this.buffer)return this.buffer.dispose(),this.buffer=this.spec=null}change(e,g,f){if(g.texture||e["matrix.history"]||e["buffer.channels"]||e["buffer.items"]||e["matrix.bufferWidth"]||e["matrix.bufferHeight"])return this.rebuild();
if(this.buffer){if(e["matrix.width"]){const {width:k,bufferWidth:m}=this.props;this.spec.width=k;if(k>m)return this.rebuild()}if(e["matrix.height"]){const {height:k,bufferHeight:m}=this.props;this.spec.height=k;if(k>m)return this.rebuild()}if(e["data.map"]||e["data.data"]||e["data.resolve"]||e["data.expr"]||f)return this.buffer.setCallback(this.emitter())}}callback(e){return e.length<=3?e:(g,f,k)=>e(g,f,k,this.bufferClock,this.bufferStep)}update(){if(this.buffer){var {data:e}=this.props,{space:g,
used:f}=this,k=f.width,m=f.height,p=this.buffer.getFilled();this.syncBuffer(z=>{if(e!=null){var t=x.getDimensions(e,this.spec);if(t.width>g.width||t.height>g.height)return z(),this.rebuild();f.width=t.width;f.height=t.height;this.buffer.setActive(f.width,f.height);typeof this.buffer.callback.rebind==="function"&&this.buffer.callback.rebind(e);return this.buffer.update()}z=this.spec.width||1;t=this.spec.height||1;this.buffer.setActive(z,t);const v=this.buffer.update();f.width=z;f.height=Math.min(t,
Math.ceil(v/z));f.height===1&&(f.width=Math.min(z,v))});if(f.width!==k||f.height!==m||p!==this.buffer.getFilled())return this.trigger({type:"source.resize"})}}}r.initClass()};
shadow$provide[239]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Area:{enumerable:!0,get:function(){return x}}});l=l(238);class x extends l.Matrix{static initClass(){this.traits="node buffer active data source index matrix texture raw span:x span:y area sampler:x sampler:y".split(" ")}updateSpan(){var r=this.props.axes;({width:p}=this.props);({height:z}=this.props);const {centeredX:e}=this.props,{centeredY:g}=this.props,f=this.props.paddingX,k=this.props.paddingY;
var m=this._helpers.span.get("x.",r[0]);r=this._helpers.span.get("y.",r[1]);this.aX=m.x;this.aY=r.x;m=m.y-m.x;r=r.y-r.x;p+=f*2;z+=k*2;if(e){var p=1/Math.max(1,p);this.aX+=m*p/2}else p=1/Math.max(1,p-1);if(g){var z=1/Math.max(1,z);this.aY+=r*z/2}else z=1/Math.max(1,z-1);this.bX=m*p;this.bY=r*z;this.aX+=f*this.bX;return this.aY+=k*this.bY}callback(r){this.updateSpan();if(this.last===r)return this._callback;this.last=r;return r.length<=5?this._callback=(e,g,f)=>r(e,this.aX+this.bX*g,this.aY+this.bY*
f,g,f):this._callback=(e,g,f)=>r(e,this.aX+this.bX*g,this.aY+this.bY*f,g,f,this.bufferClock,this.bufferStep)}make(){super.make();this._helpers.span.make();return this._listen(this,"span.range",this.updateSpan)}unmake(){super.unmake();return this._helpers.span.unmake()}change(r,e,g){super.change(r,e,g);(e.x||e.y)&&this.updateSpan()}}x.initClass()};
shadow$provide[240]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Voxel:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(202);class r extends l.Buffer{constructor(...e){super(...e);this.update=this.update.bind(this)}static initClass(){this.traits="node buffer active data source index texture voxel raw".split(" ")}init(){this.buffer=this.spec=null;this.space={width:0,height:0,depth:0};this.used={width:0,height:0,depth:0};this.storage="voxelBuffer";this.passthrough=
(e,g,f,k)=>e(g,f,k,0);super.init()}sourceShader(e){const g=this.getDimensions();this.alignShader(g,e);return this.buffer.shader(e)}getDimensions(){return{items:this.items,width:this.space.width,height:this.space.height,depth:this.space.depth}}getActiveDimensions(){return{items:this.items,width:this.used.width,height:this.used.height,depth:this.used.depth*this.buffer.getFilled()}}getRawDimensions(){return this.getDimensions()}make(){super.make();const e=this.minFilter!=null?this.minFilter:this.props.minFilter,
g=this.magFilter!=null?this.magFilter:this.props.magFilter,f=this.type!=null?this.type:this.props.type;var {width:k}=this.props,{height:m}=this.props;const {depth:p}=this.props,z=this.props.bufferWidth,t=this.props.bufferHeight,v=this.props.bufferDepth,{channels:y}=this.props,{items:B}=this.props;k=this.spec={channels:y,items:B,width:k,height:m,depth:p};this.items=k.items;this.channels=k.channels;({data:m}=this.props);k=x.getDimensions(m,k);({space:m}=this);m.width=Math.max(z,k.width||1);m.height=
Math.max(t,k.height||1);m.depth=Math.max(v,k.depth||1);return this.buffer=this._renderables.make(this.storage,{width:m.width,height:m.height,depth:m.depth,channels:y,items:B,minFilter:e,magFilter:g,type:f})}unmake(){super.unmake();if(this.buffer)return this.buffer.dispose(),this.buffer=this.spec=null}change(e,g,f){if(g.texture||e["buffer.channels"]||e["buffer.items"]||e["voxel.bufferWidth"]||e["voxel.bufferHeight"]||e["voxel.bufferDepth"])return this.rebuild();if(this.buffer){if(e["voxel.width"]){const {width:k,
bufferWidth:m}=this.props;this.spec.width=k;if(k>m)return this.rebuild()}if(e["voxel.height"]){const {height:k,bufferHeight:m}=this.props;this.spec.height=k;if(k>m)return this.rebuild()}if(e["voxel.depth"]){const {depth:k,bufferDepth:m}=this.props;this.spec.depth=k;if(k>m)return this.rebuild()}if(e["data.map"]||e["data.data"]||e["data.resolve"]||e["data.expr"]||f)return this.buffer.setCallback(this.emitter())}}callback(e){return e.length<=4?e:(g,f,k,m)=>e(g,f,k,m,this.bufferClock,this.bufferStep)}update(){if(this.buffer){var {data:e}=
this.props,{space:g,used:f}=this,k=f.width,m=f.height,p=f.depth,z=this.buffer.getFilled();this.syncBuffer(t=>{if(e!=null){var v=x.getDimensions(e,this.spec);if(v.width>g.width||v.height>g.height||v.depth>g.depth)return t(),this.rebuild();f.width=v.width;f.height=v.height;f.depth=v.depth;this.buffer.setActive(f.width,f.height,f.depth);typeof this.buffer.callback.rebind==="function"&&this.buffer.callback.rebind(e);return this.buffer.update()}t=this.spec.width||1;v=this.spec.height||1;const y=this.spec.depth||
1;this.buffer.setActive(t,v,y);const B=this.buffer.update();f.width=t;f.height=v;f.depth=Math.min(y,Math.ceil(B/t/v));f.depth===1&&(f.height=Math.min(v,Math.ceil(B/t)),f.height===1&&(f.width=Math.min(t,B)))});if(f.width!==k||f.height!==m||f.depth!==p||z!==this.buffer.getFilled())return this.trigger({type:"source.resize"})}}}r.initClass()};
shadow$provide[241]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Volume:{enumerable:!0,get:function(){return x}}});l=l(240);class x extends l.Voxel{static initClass(){this.traits="node buffer active data source index texture voxel span:x span:y span:z volume sampler:x sampler:y sampler:z raw".split(" ")}updateSpan(){var r=this.props.axes;({width:v}=this.props);({height:y}=this.props);({depth:B}=this.props);const {centeredX:e}=this.props,{centeredY:g}=this.props,{centeredZ:f}=
this.props,k=this.props.paddingX,m=this.props.paddingY,p=this.props.paddingZ;var z=this._helpers.span.get("x.",r[0]),t=this._helpers.span.get("y.",r[1]);r=this._helpers.span.get("z.",r[2]);this.aX=z.x;this.aY=t.x;this.aZ=r.x;z=z.y-z.x;t=t.y-t.x;r=r.y-r.x;v+=k*2;y+=m*2;B+=p*2;if(e){var v=1/Math.max(1,v);this.aX+=z*v/2}else v=1/Math.max(1,v-1);if(g){var y=1/Math.max(1,y);this.aY+=t*y/2}else y=1/Math.max(1,y-1);if(f){var B=1/Math.max(1,B);this.aZ+=r*B/2}else B=1/Math.max(1,B-1);this.bX=z*v;this.bY=t*
y;this.bZ=r*B;this.aX+=this.bX*k;this.aY+=this.bY*m;return this.aZ+=this.bZ*m}callback(r){this.updateSpan();if(this.last===r)return this._callback;this.last=r;return r.length<=7?this._callback=(e,g,f,k)=>r(e,this.aX+this.bX*g,this.aY+this.bY*f,this.aZ+this.bZ*k,g,f,k):this._callback=(e,g,f,k)=>r(e,this.aX+this.bX*g,this.aY+this.bY*f,this.aZ+this.bZ*k,g,f,k,this.bufferClock,this.bufferStep)}make(){super.make();this._helpers.span.make();return this._listen(this,"span.range",this.updateSpan)}unmake(){super.unmake();
return this._helpers.span.unmake()}change(r,e,g){super.change(r,e,g);(e.x||e.y||e.z)&&this.updateSpan()}}x.initClass()};
shadow$provide[242]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},addOrigin:{enumerable:!0,get:function(){return e}},recenterAxis:{enumerable:!0,get:function(){return k}},setDimension:{enumerable:!0,get:function(){return g}},setDimensionNormal:{enumerable:!0,get:function(){return f}},setOrigin:{enumerable:!0,get:function(){return r}}});var x=l(101);const r=function(m,p,z){+p===p&&(p=[p]);const t=Array.from(p).includes(1)?0:z.x,v=Array.from(p).includes(2)?0:z.y,y=Array.from(p).includes(3)?
0:z.z;p=Array.from(p).includes(4)?0:z.w;return m.set(t,v,y,p)},e=function(){const m=new x.Vector4;return function(p,z,t){r(m,z,t);return p.add(m)}}(),g=function(m,p){return m.set(p===1?1:0,p===2?1:0,p===3?1:0,p===4?1:0)},f=function(m,p){return m.set(p===2?1:0,(p===3?1:0)+(p===1?1:0),p===4?1:0,0)},k=function(){const m=[0,0];return function(p,z,t,v){v==null&&(v=0);if(t>0){var y=p;p+=z;z=Math.max(Math.abs(y),Math.abs(p));v*=z;const B=Math.min(y,p);y=Math.max(y,p);p=B+(-z+v-B)*t;z=y+(z+v-y)*t-p}m[0]=
p;m[1]=z;return m}}()};
shadow$provide[243]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Scale:{enumerable:!0,get:function(){return r}}});var x=l(242);l=l(200);class r extends l.Source{static initClass(){this.traits="node source index interval span scale raw origin".split(" ")}init(){return this.used=this.space=this.scaleAxis=this.sampler=null}rawBuffer(){return this.buffer}sourceShader(e){return e.pipe(this.sampler)}getDimensions(){return{items:1,width:this.space,height:1,depth:1}}getActiveDimensions(){return{items:1,
width:this.used,height:this.buffer.getFilled(),depth:1}}getRawDimensions(){return this.getDimensions()}make(){var e;this.space=e=this._helpers.scale.divide("");this.buffer=this._renderables.make("dataBuffer",{width:e,channels:1,items:1});e={scaleAxis:this._attributes.make(this._types.vec4()),scaleOffset:this._attributes.make(this._types.vec4())};this.scaleAxis=e.scaleAxis.value;this.scaleOffset=e.scaleOffset.value;const g=this.sampler=this._shaders.shader();g.require(this.buffer.shader(this._shaders.shader(),
1));g.pipe("scale.position",e);this._helpers.span.make();return this._listen(this,"span.range",this.updateRanges)}unmake(){this.scaleAxis=null;return this._helpers.span.unmake()}change(e,g,f){if(e["scale.divide"])return this.rebuild();if(g.view||g.interval||g.span||g.scale||g.origin||f)return this.updateRanges()}updateRanges(){const {used:e}=this,{axis:g,origin:f}=this.props;var k=this._helpers.span.get("",g);k=this._helpers.scale.generate("",this.buffer,k.x,k.y);x.setDimension(this.scaleAxis,g);
x.setOrigin(this.scaleOffset,g,f);this.used=k.length;if(this.used!==e)return this.trigger({type:"source.resize"})}}r.initClass()};
shadow$provide[244]=function(l,L,q){q=l(203);var x=l(204),r=l(237),e=l(238),g=l(239),f=l(240),k=l(241),m=l(243);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f);l.exportCopy(L,k);l.exportCopy(L,m)};
shadow$provide[245]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},clone:{enumerable:!0,get:function(){return r}},merge:{enumerable:!0,get:function(){return x}},parseQuoted:{enumerable:!0,get:function(){return e}}});const x=function(){const g={};for(const f of Array.from(arguments))for(const k in f)g[k]=f[k];return g},r=g=>JSON.parse(JSON.serialize(g)),e=function(g){let f="";const k=function(z){if(f.length){var t=p,v=t.push;var y=f.replace(/\\/g,"");v.call(t,y)}return f=
z!=null?z:""};g=g.split(/(?=(?:\\.|["' ,]))/g);let m=!1;const p=[];for(const z of Array.from(g)){const t=z[0],v=z.slice(1);switch(t){case '"':case "'":if(m)m===t?(m=!1,k(v)):f+=z;else{if(f!=="")throw Error(`ParseError: String \`${g}\` does not contain comma-separated quoted tokens.`);m=t;f+=v}break;case " ":case ",":m?f+=z:k(v);break;default:f+=z}}k();return p}};
shadow$provide[246]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Axis:{enumerable:!0,get:function(){return e}}});var x=l(242),r=l(245);l=l(188);class e extends l.Primitive{static initClass(){this.traits="node object visible style line axis span interval arrow position origin shade".split(" ");this.defaults={end:!0,zBias:-1}}constructor(g,f,k){super(g,f,k);this.axisPosition=this.axisStep=this.resolution=this.line=this.arrows=null}make(){var g={axisPosition:this._attributes.make(this._types.vec4()),
axisStep:this._attributes.make(this._types.vec4())};this.axisPosition=g.axisPosition.value;this.axisStep=g.axisStep.value;let f=this._shaders.shader();f.pipe("axis.position",g);f=this._helpers.position.pipeline(f);var k=this._helpers.style.uniforms();const m=this._helpers.line.uniforms(),p=this._helpers.arrow.uniforms(),z=this._inherit("unit").getUnitUniforms();var {detail:t}=this.props;g=t+1;this.resolution=1/t;const {start:v,end:y}=this.props,{stroke:B,join:D}=this.props;t=this._helpers.object.mask();
const G=this._helpers.shade.pipeline()||!1,{crossed:I,axis:K}=this.props;!I&&t!=null&&K>1&&(t=this._helpers.position.swizzle(t,["x000","y000","z000","w000"][K]));k=r.merge(p,m,k,z);this.line=this._renderables.make("line",{uniforms:k,samples:g,position:f,clip:v||y,stroke:B,join:D,mask:t,material:G});this.arrows=[];v&&this.arrows.push(this._renderables.make("arrow",{uniforms:k,flip:!0,samples:g,position:f,mask:t,material:G}));y&&this.arrows.push(this._renderables.make("arrow",{uniforms:k,samples:g,
position:f,mask:t,material:G}));this._helpers.visible.make();this._helpers.object.make(this.arrows.concat([this.line]));this._helpers.span.make();return this._listen(this,"span.range",this.updateRanges)}unmake(){this._helpers.visible.unmake();this._helpers.object.unmake();return this._helpers.span.unmake()}change(g,f,k){if(g["axis.detail"]||g["line.stroke"]||g["line.join"]||g["axis.crossed"]||g["interval.axis"]&&this.props.crossed)return this.rebuild();if(f.interval||f.span||f.view||f.origin||k)return this.updateRanges()}updateRanges(){const {axis:g,
origin:f}=this.props;var k=this._helpers.span.get("",g);const m=k.x;k=k.y;x.setDimension(this.axisPosition,g).multiplyScalar(m);x.setDimension(this.axisStep,g).multiplyScalar((k-m)*this.resolution);return x.addOrigin(this.axisPosition,g,f)}}e.initClass()};
shadow$provide[247]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Face:{enumerable:!0,get:function(){return e}}});var x=l(199),r=l(245);l=l(188);class e extends l.Primitive{static initClass(){this.traits="node object visible style line mesh face geometry position bind shade".split(" ")}constructor(g,f,k){super(g,f,k);this.face=null}resize(){if(this.bind.points!=null){var g=this.bind.points.getActiveDimensions(),{items:f,width:k,height:m,depth:p}=g;this.face&&this.face.geometry.clip(k,
m,p,f);this.line&&this.line.geometry.clip(f,k,m,p);if(this.bind.map!=null&&(g=this.bind.map.getActiveDimensions(),this.face))return this.face.geometry.map(g.width,g.height,g.depth,g.items)}}make(){let g;this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"mesh.map",trait:"source"}]);if(this.bind.points!=null){var f=this.bind.points.sourceShader(this._shaders.shader());f=this._helpers.position.pipeline(f);var k=this._helpers.style.uniforms();var m=
this._helpers.line.uniforms();var p=this._inherit("unit").getUnitUniforms(),z={};z.styleZBias=this._attributes.make(this._types.number());this.wireZBias=z.styleZBias;var t=this.bind.points.getDimensions(),{items:v,width:y,height:B,depth:D}=t,{line:G,shaded:I,fill:K,stroke:Q,join:O}=this.props;this.bind.colors&&(g=this._shaders.shader(),this.bind.colors.sourceShader(g));t=this._helpers.object.mask();var J=this._helpers.shade.map(this.bind.map!=null?this.bind.map.sourceShader(this._shaders.shader()):
void 0),W=this._helpers.shade.pipeline(),ba=W||I;W=W||!1;var Y=[];if(G){const S=this._shaders.shader();S.pipe(x.swizzleVec4("yzwx"));S.pipe(f);m=r.merge(p,m,k,z);this.line=this._renderables.make("line",{uniforms:m,samples:v,strips:y,ribbons:B,layers:D,position:S,color:g,stroke:Q,join:O,material:W,mask:t,closed:!0});Y.push(this.line)}K&&(m=r.merge(p,k,{}),this.face=this._renderables.make("face",{uniforms:m,width:y,height:B,depth:D,items:v,position:f,color:g,material:ba,mask:t,map:J}),Y.push(this.face));
this._helpers.visible.make();return this._helpers.object.make(Y)}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();this._helpers.visible.unmake();this._helpers.object.unmake();return this.face=this.line=null}change(g,f,k){if(g["geometry.points"]||f.mesh)return this.rebuild();if(g["style.zBias"]||g["mesh.lineBias"]||k){const {fill:m,zBias:p,lineBias:z}=this.props;return this.wireZBias.value=p+(m?z:0)}}}e.initClass()};
shadow$provide[248]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Grid:{enumerable:!0,get:function(){return e}}});var x=l(242),r=l(245);l=l(188);class e extends l.Primitive{static initClass(){this.traits="node object visible style line grid area position origin shade axis:x axis:y scale:x scale:y span:x span:y".split(" ");this.defaults={width:1,zBias:-2}}constructor(g,f,k){super(g,f,k);this.axes=null}make(){let g,f=this._helpers.object.mask();const k=this._helpers.shade.pipeline()||
!1;g=(D,G,I)=>{var K,Q=this._get(D+"axis.detail");const O=Q+1;Q=1/Q;const J=this._helpers.scale.divide(G),W=this._renderables.make("dataBuffer",{width:J,channels:1});var ba={gridPosition:this._attributes.make(this._types.vec4()),gridStep:this._attributes.make(this._types.vec4()),gridAxis:this._attributes.make(this._types.vec4())};const Y={gridPosition:ba.gridPosition.value,gridStep:ba.gridStep.value,gridAxis:ba.gridAxis.value};var S=K=this._shaders.shader();I!=null&&f!=null&&(f=this._helpers.position.swizzle(f,
I));S.require(W.shader(this._shaders.shader(),2));S.pipe("grid.position",ba);K=this._helpers.position.pipeline(S);I=this._helpers.style.uniforms();ba=this._helpers.line.uniforms();S=this._inherit("unit").getUnitUniforms();I=r.merge(ba,I,S);K=this._renderables.make("line",{uniforms:I,samples:O,strips:J,position:K,stroke:y,join:B,mask:f,material:k});return{first:D,second:G,resolution:Q,samples:O,line:K,buffer:W,values:Y}};const {lineX:m,lineY:p,crossed:z,axes:t}=this.props;var v=["0000","x000","y000",
"z000","w000"][t[1]];const {stroke:y,join:B}=this.props;this.axes=[];m&&this.axes.push(g("x.","y.",null));p&&this.axes.push(g("y.","x.",z?null:v));v=(()=>{const D=[];for(g of this.axes)D.push(g.line);return D})();this._helpers.visible.make();this._helpers.object.make(v);this._helpers.span.make();return this._listen(this,"span.range",this.updateRanges)}unmake(){this._helpers.visible.unmake();this._helpers.object.unmake();this._helpers.span.unmake();for(const g of this.axes)g.buffer.dispose();this.axes=
null}change(g,f,k){if(g["x.axis.detail"]||g["y.axis.detail"]||g["x.axis.factor"]||g["y.axis.factor"]||g["grid.lineX"]||g["grid.lineY"]||g["line.stroke"]||g["line.join"]||g["grid.crossed"]||g["grid.axes"]&&this.props.crossed)return this.rebuild();if(f.x||f.y||f.area||f.grid||f.view||f.origin||k)return this.updateRanges()}updateRanges(){const g=(v,y,B,D,G)=>{const {second:I,resolution:K,samples:Q,line:O,buffer:J,values:W}=G;G=B.x;B=B.y;x.setDimension(W.gridPosition,v).multiplyScalar(G);x.setDimension(W.gridStep,
v).multiplyScalar((B-G)*K);x.addOrigin(W.gridPosition,f,k);G=D.x;B=D.y;v=this._helpers.scale.generate(I,J,G,B);x.setDimension(W.gridAxis,y);return O.geometry.clip(Q,v.length,1,1)},{axes:f,origin:k}=this.props,m=this._helpers.span.get("x.",f[0]),p=this._helpers.span.get("y.",f[1]),{lineX:z,lineY:t}=this.props;z&&g(f[0],f[1],m,p,this.axes[0]);t&&g(f[1],f[0],p,m,this.axes[+z]);window.cake1=this.axes[0].buffer;window.cake2=this.axes[1].buffer;window.cake3=this.axes[0]}}e.initClass()};
shadow$provide[249]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Line:{enumerable:!0,get:function(){return r}}});var x=l(245);l=l(188);class r extends l.Primitive{static initClass(){this.traits="node object visible style line arrow geometry position bind shade".split(" ")}constructor(e,g,f){super(e,g,f);this.line=this.arrows=null}resize(){if(this.bind.points!=null){var e=this.bind.points.getActiveDimensions(),g=e.width,f=e.height,k=e.depth,m=e.items;this.line.geometry.clip(g,
f,k,m);return Array.from(this.arrows).map(p=>p.geometry.clip(g,f,k,m))}}make(){let e;this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]);if(this.bind.points!=null){var g=this._shaders.shader();g=this.bind.points.sourceShader(g);g=this._helpers.position.pipeline(g);var f=this._helpers.style.uniforms(),k=this._helpers.line.uniforms(),m=this._helpers.arrow.uniforms(),p=this._inherit("unit").getUnitUniforms(),{start:z,end:t}=this.props,{stroke:v,join:y,
proximity:B,closed:D}=this.props;this.proximity=B;var G=this.bind.points.getDimensions(),I=G.width,K=G.height,Q=G.depth;G=G.items;this.bind.colors&&(e=this._shaders.shader(),this.bind.colors.sourceShader(e));var O=this._helpers.object.mask(),J=this._helpers.shade.pipeline()||!1;f=x.merge(m,k,f,p);this.line=this._renderables.make("line",{uniforms:f,samples:I,strips:K,ribbons:Q,layers:G,position:g,color:e,clip:z||t,stroke:v,join:y,proximity:B,closed:D,mask:O,material:J});this.arrows=[];z&&this.arrows.push(this._renderables.make("arrow",
{uniforms:f,flip:!0,samples:I,strips:K,ribbons:Q,layers:G,position:g,color:e,closed:D,mask:O,material:J}));t&&this.arrows.push(this._renderables.make("arrow",{uniforms:f,samples:I,strips:K,ribbons:Q,layers:G,position:g,color:e,closed:D,mask:O,material:J}));this._helpers.visible.make();return this._helpers.object.make(this.arrows.concat([this.line]))}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();this._helpers.visible.unmake();this._helpers.object.unmake();return this.line=this.arrows=
null}change(e,g,f){if(e["geometry.points"]||e["line.stroke"]||e["line.join"]||e["arrow.start"]||e["arrow.end"]||e["line.proximity"]&&this.proximity!=null!==(this.props.proximity!=null))return this.rebuild()}}r.initClass()};
shadow$provide[250]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Point:{enumerable:!0,get:function(){return r}}});var x=l(245);l=l(188);class r extends l.Primitive{static initClass(){this.traits="node object visible style point geometry position bind shade".split(" ")}constructor(e,g,f){super(e,g,f);this.point=null}resize(){if(this.bind.points!=null){var e=this.bind.points.getActiveDimensions(),{items:g,width:f,height:k,depth:m}=e;return this.point.geometry.clip(f,
k,m,g)}}make(){let e,g;this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"point.sizes",trait:"source"}]);if(this.bind.points!=null){var f=this._shaders.shader();f=this.bind.points.sourceShader(f);f=this._helpers.position.pipeline(f);var k=this.bind.points.getDimensions(),{items:m,width:p,height:z,depth:t}=k,v=this._helpers.style.uniforms(),y=this._helpers.point.uniforms(),B=this._inherit("unit").getUnitUniforms();this.bind.colors&&(e=this._shaders.shader(),
this.bind.colors.sourceShader(e));this.bind.sizes&&(g=this._shaders.shader(),this.bind.sizes.sourceShader(g));k=this._helpers.object.mask();var D=this._helpers.shade.pipeline()||!1,{shape:G}=this.props,{fill:I}=this.props,{optical:K}=this.props;v=x.merge(B,y,v);this.point=this._renderables.make("point",{uniforms:v,width:p,height:z,depth:t,items:m,position:f,color:e,size:g,shape:G,optical:K,fill:I,mask:k,material:D});this._helpers.visible.make();this._helpers.object.make([this.point])}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();
this._helpers.visible.unmake();this._helpers.object.unmake();this.point=null}change(e,g,f){if(e["geometry.points"]||e["point.shape"]||e["point.fill"])return this.rebuild()}}r.initClass()};
shadow$provide[251]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Strip:{enumerable:!0,get:function(){return e}}});var x=l(199),r=l(245);l=l(188);class e extends l.Primitive{static initClass(){this.traits="node object visible style line mesh strip geometry position bind shade".split(" ")}constructor(g,f,k){super(g,f,k);this.strip=null}resize(){if(this.bind.points!=null){var g=this.bind.points.getActiveDimensions(),{items:f,width:k,height:m,depth:p}=g;this.strip&&this.strip.geometry.clip(k,
m,p,f);this.line&&this.line.geometry.clip(f,k,m,p);if(this.bind.map!=null&&(g=this.bind.map.getActiveDimensions(),this.strip))return this.strip.geometry.map(g.width,g.height,g.depth,g.items)}}make(){let g;this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"mesh.map",trait:"source"}]);if(this.bind.points!=null){var f=this._shaders.shader();f=this.bind.points.sourceShader(f);f=this._helpers.position.pipeline(f);var k=this._helpers.style.uniforms();
var m=this._helpers.line.uniforms();var p=this._inherit("unit").getUnitUniforms(),{line:z,shaded:t,fill:v,stroke:y,join:B}=this.props,D={};D.styleZBias=this._attributes.make(this._types.number());this.wireZBias=D.styleZBias;var G=this.bind.points.getDimensions(),{items:I,width:K,height:Q,depth:O}=G;this.bind.colors&&(g=this._shaders.shader(),g=this.bind.colors.sourceShader(g));G=this._helpers.object.mask();this._helpers.shade.map(this.bind.map!=null?this.bind.map.sourceShader(this._shaders.shader()):
void 0);var J=this._helpers.shade.pipeline(),W=J||t;J=J||!1;var ba=[];if(z){const Y=this._shaders.shader();Y.pipe(x.swizzleVec4("yzwx"));Y.pipe(f);m=r.merge(p,m,k,D);this.line=this._renderables.make("line",{uniforms:m,samples:I,strips:K,ribbons:Q,layers:O,position:Y,color:g,stroke:y,join:B,mask:G,material:J});ba.push(this.line)}v&&(m=r.merge(k,{}),this.strip=this._renderables.make("strip",{uniforms:m,width:K,height:Q,depth:O,items:I,position:f,color:g,material:W}),ba.push(this.strip));this._helpers.visible.make();
return this._helpers.object.make(ba)}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();this._helpers.visible.unmake();this._helpers.object.unmake();return this.strip=null}change(g,f,k){if(g["geometry.points"]||f.mesh)return this.rebuild();if(g["style.zBias"]||g["mesh.lineBias"]||k){const {fill:m,zBias:p,lineBias:z}=this.props;return this.wireZBias.value=p+(m?z:0)}}}e.initClass()};
shadow$provide[252]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Surface:{enumerable:!0,get:function(){return e}}});var x=l(245),r=l(101);l=l(188);class e extends l.Primitive{static initClass(){this.traits="node object visible style line mesh geometry surface position grid bind shade".split(" ");this.defaults={lineX:!1,lineY:!1}}constructor(g,f,k){super(g,f,k);this.lineX=this.lineY=this.surface=null}resize(){if(this.bind.points!=null){var g=this.bind.points.getActiveDimensions(),
{width:f,height:k,depth:m,items:p}=g;this.surface&&this.surface.geometry.clip(f,k,m,p);this.lineX&&this.lineX.geometry.clip(f,k,m,p);this.lineY&&this.lineY.geometry.clip(k,f,m,p);if(this.bind.map!=null&&(g=this.bind.map.getActiveDimensions(),this.surface))return this.surface.geometry.map(g.width,g.height,g.depth,g.items)}}make(){let g,f;this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"},{to:"mesh.normals",trait:"source"},{to:"mesh.map",trait:"source"}]);
if(this.bind.points!=null){var k=this._shaders.shader();k=this.bind.points.sourceShader(k);k=this._helpers.position.pipeline(k);var m=this._helpers.style.uniforms(),p=this._helpers.style.uniforms(),z=this._helpers.line.uniforms(),t=this._helpers.surface.uniforms(),v=this._inherit("unit").getUnitUniforms();p.styleColor=this._attributes.make(this._types.color());p.styleZBias=this._attributes.make(this._types.number());this.wireColor=p.styleColor.value;this.wireZBias=p.styleZBias;this.wireScratch=new r.Color;
var y=this.bind.points.getDimensions(),{width:B,height:D,depth:G,items:I}=y,{shaded:K,fill:Q,lineX:O,lineY:J,closedX:W,closedY:ba,stroke:Y,join:S,proximity:ca,crossed:V}=this.props;y=[];this.proximity=ca;this.bind.normals!=null&&(f=this._shaders.shader(),this.bind.normals.sourceShader(f),this._helpers.shade.normal(f));this.bind.colors!=null&&(g=this._shaders.shader(),this.bind.colors.sourceShader(g));var xa=this._helpers.object.mask(),na=this._helpers.shade.map(this.bind.map!=null?this.bind.map.sourceShader(this._shaders.shader()):
void 0),N=this._helpers.shade.pipeline(),pa=N||K;N=N||!1;var {swizzle:ra,swizzle2:Ea}=this._helpers.position;p=x.merge(v,z,m,p);z=O||J?-50:0;O&&(this.lineX=this._renderables.make("line",{uniforms:p,samples:B,strips:D,ribbons:G,layers:I,position:k,color:g,normal:f,zUnits:-z,stroke:Y,join:S,mask:xa,material:N,proximity:ca,closed:W||closed}),y.push(this.lineX));J&&(this.lineY=this._renderables.make("line",{uniforms:p,samples:D,strips:B,ribbons:G,layers:I,position:Ea(k,"yxzw","yxzw"),color:ra(g,"yxzw"),
zUnits:-z,stroke:Y,join:S,mask:ra(xa,V?"xyzw":"yxzw"),material:N,proximity:ca,closed:ba||closed}),y.push(this.lineY));Q&&(p=x.merge(v,t,m),this.surface=this._renderables.make("surface",{uniforms:p,width:B,height:D,surfaces:G,layers:I,position:k,color:g,zUnits:z,stroke:Y,material:pa,mask:xa,map:na,intUV:!0,closedX:W||closed,closedY:ba||closed}),y.push(this.surface));this._helpers.visible.make();return this._helpers.object.make(y)}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();this._helpers.visible.unmake();
this._helpers.object.unmake();return this.lineX=this.lineY=this.surface=null}_convertGammaToLinear(g,f=2){g.r=Math.pow(g.r,f);g.g=Math.pow(g.g,f);g.b=Math.pow(g.b,f);return g}_convertLinearToGamma(g,f=2){f=f>0?1/f:1;g.r=Math.pow(g.r,f);g.g=Math.pow(g.g,f);g.b=Math.pow(g.b,f);return g}change(g,f,k){if(g["geometry.points"]||g["mesh.shaded"]||g["mesh.fill"]||g["line.stroke"]||g["line.join"]||f.grid)return this.rebuild();if(g["style.color"]||g["style.zBias"]||g["mesh.fill"]||g["mesh.lineBias"]||k){const {fill:m,
color:p,zBias:z,lineBias:t}=this.props;this.wireZBias.value=z+(m?t:0);this.wireColor.copy(p);m&&(f=this.wireScratch,f.setRGB(p.r,p.g,p.b),this._convertLinearToGamma(this._convertGammaToLinear(f).multiplyScalar(.75)),this.wireColor.r=f.r,this.wireColor.g=f.g,this.wireColor.b=f.b)}if(g["line.proximity"]&&this.proximity!=null!==(this.props.proximity!=null))return this.rebuild()}}e.initClass()};
shadow$provide[253]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Ticks:{enumerable:!0,get:function(){return r}}});var x=l(245);l=l(188);class r extends l.Primitive{static initClass(){this.traits="node object visible style line ticks geometry position bind shade".split(" ")}init(){return this.tickStrip=this.line=null}resize(){if(this.bind.points!=null){var e=this.bind.points.getActiveDimensions(),g=+(e.items>0),f=e.width*g;this.line.geometry.clip(2,f,e.height*g,e.depth*
g);return this.tickStrip.set(0,f-1)}}make(){let e;this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]);if(this.bind.points!=null){var g=this._helpers.style.uniforms();var f=this._helpers.line.uniforms(),k=this._inherit("unit").getUnitUniforms();f=x.merge(f,g,k);k={tickEpsilon:this.node.attributes["ticks.epsilon"],tickSize:this.node.attributes["ticks.size"],tickNormal:this.node.attributes["ticks.normal"],tickStrip:this._attributes.make(this._types.vec2(0,
0)),worldUnit:f.worldUnit,focusDepth:f.focusDepth};this.tickStrip=k.tickStrip.value;var m=g=this._shaders.shader();m.require(this.bind.points.sourceShader(this._shaders.shader()));m.require(this._helpers.position.pipeline(this._shaders.shader()));m.pipe("ticks.position",k);var {stroke:p,join:z}=this.props,t=this.bind.points.getDimensions();k=t.width;m=t.height;t=t.depth;this.bind.colors&&(e=this._shaders.shader(),this.bind.colors.sourceShader(e));var v=this._helpers.object.mask(),y=this._helpers.shade.pipeline()||
!1,{swizzle:B}=this._helpers.position;this.line=this._renderables.make("line",{uniforms:f,samples:2,strips:k,ribbons:m,layers:t,position:g,color:e,stroke:p,join:z,mask:B(v,"yzwx"),material:y});this._helpers.visible.make();return this._helpers.object.make([this.line])}}made(){return this.resize()}unmake(){this.line=null;this._helpers.visible.unmake();return this._helpers.object.unmake()}change(e,g,f){if(e["geometry.points"]||e["line.stroke"]||e["line.join"])return this.rebuild()}}r.initClass()};
shadow$provide[254]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Vector:{enumerable:!0,get:function(){return r}}});var x=l(245);l=l(188);class r extends l.Primitive{static initClass(){this.traits="node object visible style line arrow geometry position bind shade".split(" ")}constructor(e,g,f){super(e,g,f);this.line=this.arrows=null}resize(){if(this.bind.points!=null){var e=this.bind.points.getActiveDimensions(),g=e.items,f=e.width,k=e.height,m=e.depth;this.line.geometry.clip(g,
f,k,m);return Array.from(this.arrows).map(p=>p.geometry.clip(g,f,k,m))}}make(){let e;this._helpers.bind.make([{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]);if(this.bind.points!=null){var g=this._shaders.shader();this.bind.points.sourceShader(g);this._helpers.position.pipeline(g);var f=this._helpers.style.uniforms(),k=this._helpers.line.uniforms(),m=this._helpers.arrow.uniforms(),p=this._inherit("unit").getUnitUniforms(),{start:z,end:t}=this.props,{stroke:v,join:y,proximity:B,
closed:D}=this.props;this.proximity=B;var G=this.bind.points.getDimensions(),I=G.items,K=G.width,Q=G.height;G=G.depth;this.bind.colors&&(e=this._shaders.shader(),this.bind.colors.sourceShader(e));var O=this._helpers.object.mask(),J=this._helpers.shade.pipeline()||!1,{swizzle:W,swizzle2:ba}=this._helpers.position;g=ba(g,"yzwx","yzwx");e=W(e,"yzwx");O=W(O,"yzwx");J=W(J,"yzwx");f=x.merge(m,k,f,p);this.line=this._renderables.make("line",{uniforms:f,samples:I,ribbons:Q,strips:K,layers:G,position:g,color:e,
clip:z||t,stroke:v,join:y,proximity:B,closed:D,mask:O,material:J});this.arrows=[];z&&this.arrows.push(this._renderables.make("arrow",{uniforms:f,flip:!0,samples:I,ribbons:Q,strips:K,layers:G,position:g,color:e,closed:D,mask:O,material:J}));t&&this.arrows.push(this._renderables.make("arrow",{uniforms:f,samples:I,ribbons:Q,strips:K,layers:G,position:g,color:e,closed:D,mask:O,material:J}));this._helpers.visible.make();return this._helpers.object.make(this.arrows.concat([this.line]))}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();
this._helpers.visible.unmake();this._helpers.object.unmake();return this.line=this.arrows=null}change(e,g,f){if(e["geometry.points"]||e["line.stroke"]||e["line.join"]||e["arrow.start"]||e["arrow.end"]||e["line.proximity"]&&this.proximity!=null!==(this.props.proximity!=null))return this.rebuild()}}r.initClass()};
shadow$provide[255]=function(l,L,q){q=l(246);var x=l(247),r=l(248),e=l(249),g=l(250),f=l(251),k=l(252),m=l(253),p=l(254);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f);l.exportCopy(L,k);l.exportCopy(L,m);l.exportCopy(L,p)};
shadow$provide[256]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},HTML:{enumerable:!0,get:function(){return x}}});l=l(240);class x extends l.Voxel{static initClass(){this.traits="node buffer active data voxel html".split(" ");this.finals={channels:1}}init(){super.init();this.storage="pushBuffer"}make(){super.make();const {items:r,width:e,height:g,depth:f}=this.getDimensions();this.dom=this._overlays.make("dom");return this.dom.hint(r*e*g*f)}unmake(){super.unmake();
if(this.dom!=null)return this.dom.dispose(),this.dom=null}update(){return super.update()}change(r,e,g){return e.html?this.rebuild():super.change(r,e,g)}nodes(){return this.buffer.read()}callback(r){const {el:e}=this.dom;return r.length<=6?(g,f,k,m,p)=>r(g,e,f,k,m,p):(g,f,k,m,p)=>r(g,e,f,k,m,p,this.bufferClock,this.bufferStep)}}x.initClass()};
shadow$provide[257]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},DOM:{enumerable:!0,get:function(){return x}}});l=l(188);class x extends l.Primitive{static initClass(){this.traits="node bind object visible overlay dom attach position".split(" ")}init(){this.emitter=this.root=null;this.active={}}make(){super.make();this._helpers.bind.make([{to:"dom.html",trait:"html"},{to:"dom.points",trait:"source"}]);if(this.bind.points!=null&&this.bind.html!=null){this.root=this._inherit("root");
this._listen("root","root.update",this.update);this._listen("root","root.post",this.post);var r=this.bind.points.getDimensions(),e=this.bind.html.getDimensions(),g=Math.min(r.items,e.items),f=Math.min(r.width,e.width),k=Math.min(r.height,e.height);r=Math.min(r.depth,e.depth);e=this.bind.points.sourceShader(this._shaders.shader());e=this._helpers.position.pipeline(e);var m=this._shaders.shader({globals:["projectionMatrix"]});m.pipe("project.readback");e.pipe(m);m=this._shaders.shader();this.readback=
this._renderables.make("readback",{map:e,indexer:m,items:g,width:f,height:k,depth:r,channels:4,stpq:!0});this.dom=this._overlays.make("dom");this.dom.hint(g*f*k*r*2);this.emitter=this.callback(this.bind.html.nodes());this.readback.setCallback(this.emitter);this._helpers.visible.make()}}unmake(){this.readback!=null&&(this.readback.dispose(),this.dom.dispose(),this.emitter=this.root=this.readback=this.dom=null,this.active={});this._helpers.bind.unmake();this._helpers.visible.unmake()}update(){this.readback!=
null&&this.props.visible&&(this.readback.update(this.root!=null?this.root.getCamera():void 0),this.readback.post(),this.readback.iterate())}post(){this.readback!=null&&this.dom.render(this.isVisible?this.emitter.nodes():null)}callback(r){let e,g;var f=this._inherit("unit").getUnitUniforms();const k=f.viewWidth,m=f.viewHeight,p=this.node.attributes["dom.attributes"],z=this.node.attributes["dom.size"],t=this.node.attributes["dom.zoom"],v=this.node.attributes["dom.color"],y=this.node.attributes["dom.outline"],
B=this.node.attributes["dom.pointerEvents"],D=this.node.attributes["overlay.opacity"],G=this.node.attributes["overlay.zIndex"],I=this.node.attributes["attach.offset"],K=this.node.attributes["attach.depth"],Q=this.node.attributes["attach.snap"],{el:O}=this.dom;let J=[],W=null,ba=null,Y=e=g=0,S="";f=function(ca,V,xa,na,N,pa,ra,Ea){xa=r[Ea+Y*N+e*pa+g*ra];N=na<0;pa=1+(1/na-1)*K.value;pa=N?0:pa;ca=(ca+1)*k.value*.5+ +I.value.x*pa;V=(V-1)*m.value*.5+ +I.value.y*pa;ca/=t.value;V/=t.value;Q.value&&(ca=Math.round(ca),
V=Math.round(V));V={className:ba,style:{transform:`translate3d(${ca}px, ${-V}px, ${1-na}px) translate(-50%, -50%) scale(${pa},${pa})`,opacity:Math.min(.999,N?0:D.value)}};for(ra in W)na=W[ra],V.style[ra]=na;ca=p.value;if(ca!=null){N=ca.style;for(ra in ca)na=ca[ra],["style","className"].includes(ra)||(V[ra]=na);if(N!=null)for(ra in N)na=N[ra],V.style[ra]=na}V.className+=" "+((ca!=null?ca.className:void 0)!=null?ca!=null?ca.className:void 0:"mathbox-label");return J.push(O("div",V,xa))};f.reset=()=>
{J=[];[Y,e,g]=Array.from([this.strideI,this.strideJ,this.strideK]);const ca=v.value;S=ca?`rgb(${[Math.floor(ca.x*255),Math.floor(ca.y*255),Math.floor(ca.z*255)]})`:"";ba=`mathbox-outline-${Math.round(y.value)}`;W={};ca&&(W.color=S);W.fontSize=`${z.value}px`;t.value!==1&&(W.zoom=t.value);G.value>0&&(W.zIndex=G.value);if(B.value)return W.pointerEvents="auto"};f.nodes=()=>J;return f}resize(){if(this.readback!=null){var r=this.bind.points.getActiveDimensions();var e=this.bind.html.getActiveDimensions();
this.readback.setActive(Math.min(r.items,e.items),Math.min(r.width,e.width),Math.min(r.height,e.height),Math.min(r.depth,e.depth));this.strideI=r=e.items;this.strideJ=r*=e.width;this.strideK=r*e.height}}change(r,e,g){if(r["dom.html"]||r["dom.points"])return this.rebuild()}}x.initClass()};
shadow$provide[258]=function(l,L,q){q=l(256);var x=l(257);l.exportCopy(L,q);l.exportCopy(L,x)};
shadow$provide[259]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Text:{enumerable:!0,get:function(){return g}}});var x=l(198),r=l(101),e=l(202);l=l(240);class g extends l.Voxel{static initClass(){this.traits="node buffer active data texture voxel text font".split(" ");this.defaults={minFilter:"linear",magFilter:"linear"};this.finals={channels:1}}init(){super.init();return this.atlas=null}textShader(f){return this.atlas.shader(f)}textIsSDF(){return this.props.sdf>
0}textHeight(){return this.props.detail}make(){let {minFilter:f,magFilter:k,type:m}=this.props;const {font:p,style:z,variant:t,weight:v,detail:y,sdf:B}=this.props;this.atlas=this._renderables.make("textAtlas",{font:p,size:y,style:z,variant:t,weight:v,outline:B,minFilter:f,magFilter:k,type:m});this.magFilter=this.minFilter=r.NearestFilter;this.type=r.FloatType;e.Buffer.prototype.make.call(this);f=this.minFilter!=null?this.minFilter:this.props.minFilter;k=this.magFilter!=null?this.magFilter:this.props.magFilter;
m=this.type!=null?this.type:this.props.type;var {width:D}=this.props,{height:G}=this.props;const {depth:I}=this.props,K=this.props.bufferWidth,Q=this.props.bufferHeight,O=this.props.bufferDepth,{channels:J}=this.props,{items:W}=this.props;D=this.spec={channels:J,items:W,width:D,height:G,depth:I};this.items=D.items;this.channels=D.channels;({data:G}=this.props);D=x.getDimensions(G,D);({space:G}=this);G.width=Math.max(K,D.width||1);G.height=Math.max(Q,D.height||1);G.depth=Math.max(O,D.depth||1);this.buffer=
this._renderables.make(this.storage,{width:G.width,height:G.height,depth:G.depth,channels:4,items:W,minFilter:f,magFilter:k,type:m});const {atlas:ba}=this,{emit:Y}=this.buffer.streamer;return this.buffer.streamer.emit=S=>ba.map(S,Y)}unmake(){super.unmake();if(this.atlas)return this.atlas.dispose(),this.atlas=null}update(){this.atlas.begin();super.update();return this.atlas.end()}change(f,k,m){return k.font?this.rebuild():super.change(f,k,m)}}g.initClass()};
shadow$provide[260]=function(l,L,q){function x(e,g,f){if(typeof e!=="undefined"&&e!==null&&typeof e[g]==="function")return f(e,g)}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Operator:{enumerable:!0,get:function(){return r}}});l=l(200);class r extends l.Source{static initClass(){this.traits=["node","bind","operator","source","index"]}indexShader(e){return x(this.bind.source,"indexShader",g=>g.indexShader(e))}sourceShader(e){return x(this.bind.source,"sourceShader",g=>g.sourceShader(e))}getDimensions(){return this.bind.source.getDimensions()}getFutureDimensions(){return this.bind.source.getFutureDimensions()}getActiveDimensions(){return this.bind.source.getActiveDimensions()}getIndexDimensions(){return this.bind.source.getIndexDimensions()}init(){return this.sourceSpec=
[{to:"operator.source",trait:"source",optional:!0}]}make(){super.make();return this._helpers.bind.make(this.sourceSpec)}made(){this.resize();return super.made()}unmake(){return this._helpers.bind.unmake()}resize(e){return this.trigger({type:"source.resize"})}}r.initClass()};
shadow$provide[261]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Format:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(260);class r extends l.Operator{static initClass(){this.traits="node bind operator texture text format font".split(" ");this.defaults={minFilter:"linear",magFilter:"linear"}}init(){super.init();this.atlas=this.buffer=this.used=this.time=null;return this.filled=!1}sourceShader(e){return this.buffer.shader(e)}textShader(e){return this.atlas.shader(e)}textIsSDF(){return this.props.sdf>
0}textHeight(){return this.props.detail}make(){this._helpers.bind.make([{to:"operator.source",trait:"raw"}]);let {minFilter:e,magFilter:g,type:f}=this.props;const {font:k,style:m,variant:p,weight:z,detail:t,sdf:v}=this.props;this.atlas=this._renderables.make("textAtlas",{font:k,size:t,style:m,variant:p,weight:z,outline:v,minFilter:e,magFilter:g,type:f});g=e=x.NearestFilter;f=x.FloatType;const y=this.bind.source.getDimensions(),{items:B,width:D,height:G,depth:I}=y;this.buffer=this._renderables.make("voxelBuffer",
{width:D,height:G,depth:I,channels:4,items:B,minFilter:e,magFilter:g,type:f});const {atlas:K}=this,{emit:Q}=this.buffer.streamer;this.buffer.streamer.emit=O=>K.map(O,Q);this.clockParent=this._inherit("clock");return this._listen("root","root.update",this.update)}made(){super.made();return this.resize()}unmake(){super.unmake();this.buffer&&(this.buffer.dispose(),this.buffer=null);if(this.atlas)return this.atlas.dispose(),this.atlas=null}update(){if((!this.filled||this.props.live)&&this.through){this.time=
this.clockParent.getTime();var {used:e}=this;this.atlas.begin();this.used=this.through();this.buffer.write(this.used);this.atlas.end();this.filled=!0;if(e!==this.used)return this.trigger({type:"source.resize"})}}change(e,g,f){if(g.font)return this.rebuild();if(e["format.expr"]||e["format.digits"]||e["format.data"]||f){let {expr:k}=this.props;const {digits:m,data:p}=this.props;k==null&&(k=p!=null?(z,t,v,y,B)=>p[B]:z=>z);({length:e}=k);m!=null&&(k=(z=>(t,v,y,B,D,G,I,K,Q,O)=>+z(t,v,y,B,D,G,I,K,Q,O).toPrecision(m))(k));
e=e>8?(z,t,v,y,B,D,G,I,K,Q,O)=>z(k(t,v,y,B,D,G,I,K,this.time.clock,this.time.step)):(z,t,v,y,B,D,G,I,K)=>z(k(t,v,y,B,D,G,I,K));return this.through=this.bind.source.rawBuffer().through(e,this.buffer)}}}r.initClass()};
shadow$provide[262]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Label:{enumerable:!0,get:function(){return r}}});var x=l(245);l=l(188);class r extends l.Primitive{static initClass(){this.traits="node bind object visible style label attach geometry position".split(" ")}make(){let e;super.make();this._helpers.bind.make([{to:"label.text",trait:"text"},{to:"geometry.points",trait:"source"},{to:"geometry.colors",trait:"source"}]);if(this.bind.points!=null&&this.bind.text!=
null){var g=this.bind.points.getDimensions(),f=this.bind.text.getDimensions(),k=this.bind.text.textIsSDF(),m=Math.min(g.items,f.items),p=Math.min(g.width,f.width),z=Math.min(g.height,f.height);g=Math.min(g.depth,f.depth);f=this.bind.points.sourceShader(this._shaders.shader());f=this._helpers.position.pipeline(f);var t=this.bind.text.sourceShader(this._shaders.shader()),v=this._shaders.shader().pipe("label.map");v.pipe(this.bind.text.textShader(this._shaders.shader()));var y={spriteDepth:this.node.attributes["attach.depth"],
spriteOffset:this.node.attributes["attach.offset"],spriteSnap:this.node.attributes["attach.snap"],spriteScale:this._attributes.make(this._types.number()),outlineStep:this._attributes.make(this._types.number()),outlineExpand:this._attributes.make(this._types.number()),outlineColor:this.node.attributes["label.background"]};this.spriteScale=y.spriteScale;this.outlineStep=y.outlineStep;this.outlineExpand=y.outlineExpand;k=k?"label.outline":"label.alpha";k=this._shaders.shader().pipe(k,y);this.bind.colors&&
(e=this._shaders.shader(),this.bind.colors.sourceShader(e));var B=this._helpers.object.mask(),D=this._helpers.style.uniforms(),G=this._inherit("unit").getUnitUniforms();y=x.merge(G,D,y);this.sprite=this._renderables.make("sprite",{uniforms:y,width:p,height:z,depth:g,items:m,position:f,sprite:t,map:v,combine:k,color:e,mask:B,linear:!0});this._helpers.visible.make();return this._helpers.object.make([this.sprite])}}unmake(){this._helpers.bind.unmake();this._helpers.visible.unmake();this._helpers.object.unmake();
return this.sprite=null}resize(){const e=this.bind.points.getActiveDimensions(),g=this.bind.text.getActiveDimensions();return this.sprite.geometry.clip(Math.min(e.width,g.width),Math.min(e.height,g.height),Math.min(e.depth,g.depth),Math.min(e.items,g.items))}change(e,g,f){if(g.geometry||e["label.text"])return this.rebuild();if(this.bind.points!=null){({size:f}=this.props);({outline:e}=this.props);({expand:g}=this.props);var k=this.bind.text.textHeight();f/=k;this.outlineExpand.value=g/f*16/255;this.outlineStep.value=
e/f*16/255;return this.spriteScale.value=f}}}r.initClass()};
shadow$provide[263]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Resample:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(260);class r extends l.Operator{static initClass(){this.traits="node bind operator source index resample sampler:x sampler:y sampler:z sampler:w include".split(" ")}indexShader(e){e.pipe(this.indexer);return super.indexShader(e)}sourceShader(e){return e.pipe(this.operator)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(e){const g=
this.resampled,f=this.centered,k=this.padding;this.relativeSize?(f.items||e.items--,f.width||e.width--,f.height||e.height--,f.depth||e.depth--,g.items!=null&&(e.items*=g.items),g.width!=null&&(e.width*=g.width),g.height!=null&&(e.height*=g.height),g.depth!=null&&(e.depth*=g.depth),f.items||e.items++,f.width||e.width++,f.height||e.height++,f.depth||e.depth++,e.items-=k.items*2,e.width-=k.width*2,e.height-=k.height*2,e.depth-=k.depth*2):(g.items!=null&&(e.items=g.items),g.width!=null&&(e.width=g.width),
g.height!=null&&(e.height=g.height),g.depth!=null&&(e.depth=g.depth));e.items=Math.max(0,Math.floor(e.items));e.width=Math.max(0,Math.floor(e.width));e.height=Math.max(0,Math.floor(e.height));e.depth=Math.max(0,Math.floor(e.depth));return e}make(){super.make();if(this.bind.source!=null){this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}]);var {indices:e,channels:g}=this.props,{shader:f}=this.bind,{sample:k,size:m,items:p,width:z,height:t,depth:v}=this.props,y=k===this.node.attributes["resample.sample"].enum.relative,
B=m===this.node.attributes["resample.size"].enum.relative;this.resampled={};p!=null&&(this.resampled.items=p);z!=null&&(this.resampled.width=z);t!=null&&(this.resampled.height=t);v!=null&&(this.resampled.depth=v);this.centered={};this.centered.items=this.props.centeredW;this.centered.width=this.props.centeredX;this.centered.height=this.props.centeredY;this.centered.depth=this.props.centeredZ;this.padding={};this.padding.items=this.props.paddingW;this.padding.width=this.props.paddingX;this.padding.height=
this.props.paddingY;this.padding.depth=this.props.paddingZ;var D=this._shaders.shader(),G=this._shaders.shader(),I=[null,this._types.number,this._types.vec2,this._types.vec3,this._types.vec4][e];I={dataSize:this._attributes.make(I(0,0,0,0)),dataResolution:this._attributes.make(I(0,0,0,0)),targetSize:this._attributes.make(I(0,0,0,0)),targetResolution:this._attributes.make(I(0,0,0,0)),resampleFactor:this._attributes.make(this._types.vec4(0,0,0,0)),resampleBias:this._attributes.make(this._types.vec4(0,
0,0,0))};this.dataResolution=I.dataResolution;this.dataSize=I.dataSize;this.targetResolution=I.targetResolution;this.targetSize=I.targetSize;this.resampleFactor=I.resampleFactor;this.resampleBias=I.resampleBias;var K=p!=null||z!=null||t!=null||v!=null;D.pipe("resample.padding",I);var Q=[],O=!1,J=["width","height","depth","items"];for(let W=0;W<J.length;W++){const ba=this.centered[J[W]];O||(O=ba);Q[W]=ba?"0.5":"0.0"}O&&(Q=`vec4(${Q})`,D.pipe(x.binaryOperator(4,"+",Q)),K&&G.pipe(x.binaryOperator(4,
"+",Q)));y&&(K?(D.pipe("resample.relative",I),G.pipe("resample.relative",I)):G.pipe(x.identity("vec4")));f!=null?(e!==4&&D.pipe(x.truncateVec(4,e)),D.callback(),e!==4&&D.pipe(x.extendVec(e,4)),O&&D.pipe(x.binaryOperator(4,"-",Q)),D.pipe(this.bind.source.sourceShader(this._shaders.shader())),g!==4&&D.pipe(x.truncateVec(4,g)),D.join(),this.bind.shader!=null&&D.pipe(this.bind.shader.shaderBind(I)),g!==4&&D.pipe(x.extendVec(g,4))):(O&&D.pipe(x.binaryOperator(4,"-",Q)),D.pipe(this.bind.source.sourceShader(this._shaders.shader())));
O&&K&&G.pipe(x.binaryOperator(4,"-",Q));this.operator=D;this.indexer=G;this.indices=e;this.relativeSample=y;return this.relativeSize=B}}unmake(){super.unmake();return this.operator=null}resize(){if(this.bind.source!=null){var e=this.bind.source.getActiveDimensions(),g=this.getActiveDimensions(),f=D=>{const G=this.centered[D],I=this.padding[D];g[D]+=I*2;return[G?e[D]/Math.max(1,g[D]):Math.max(1,e[D]-1)/Math.max(1,g[D]-1),I]},[k,m]=Array.from(f("width")),[p,z]=Array.from(f("height")),[t,v]=Array.from(f("depth")),
[y,B]=Array.from(f("items"));this.indices===1?(this.dataResolution.value=1/e.width,this.targetResolution.value=1/g.width,this.dataSize.value=e.width,this.targetSize.value=g.width):(this.dataResolution.value.set(1/e.width,1/e.height,1/e.depth,1/e.items),this.targetResolution.value.set(1/g.width,1/g.height,1/g.depth,1/g.items),this.dataSize.value.set(e.width,e.height,e.depth,e.items),this.targetSize.value.set(g.width,g.height,g.depth,g.items));this.resampleFactor.value.set(k,p,t,y);this.resampleBias.value.set(m,
z,v,B);return super.resize()}}change(e,g,f){if(g.operator||g.resample||g.sampler||g.include)return this.rebuild()}}r.initClass()};
shadow$provide[264]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Retext:{enumerable:!0,get:function(){return x}}});l=l(263);class x extends l.Resample{static initClass(){this.traits="node bind operator resample sampler:x sampler:y sampler:z sampler:w include text".split(" ")}init(){return this.sourceSpec=[{to:"operator.source",trait:"text"}]}textShader(r){return this.bind.source.textShader(r)}textIsSDF(){return(this.bind.source!=null?this.bind.source.props.sdf:void 0)>
0}textHeight(){return this.bind.source!=null?this.bind.source.props.detail:void 0}}x.initClass()};
shadow$provide[265]=function(l,L,q){q=l(259);var x=l(261),r=l(262),e=l(264);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e)};
shadow$provide[266]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Clock:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits=["node","clock","seek","play"]}init(){this.last=this.skew=0;return this.time={now:+new Date/1E3,time:0,delta:0,clock:0,step:0}}make(){return this._listen("clock","clock.tick",this.tick)}reset(){return this.skew=0}tick(r){const {from:e,to:g,speed:f,seek:k,pace:m,delay:p,realtime:z}=this.props,
t=this._inherit("clock").getTime(),v=z?t.time:t.clock,y=z?t.delta:t.step,B=f/m;this.skew+=y*(B-1);this.last>v&&(this.skew=0);this.time.now=t.now+this.skew;this.time.time=t.time;this.time.delta=t.delta;this.time.clock=Math.min(g,e+Math.max(0,(k!=null?k:t.clock+this.skew)-p*B));this.time.step=y*B;this.last=v;return this.trigger(r)}getTime(){return this.time}}x.initClass()};
shadow$provide[267]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Now:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits=["node","clock","now"]}init(){let r;this.now=r=+new Date/1E3;this.skew=0;return this.time={now:r,time:0,delta:0,clock:0,step:0}}make(){this.clockParent=this._inherit("clock");return this._listen("clock","clock.tick",this.tick)}unmake(){return this.clockParent=null}change(r,e,g){if(r["date.now"])return this.skew=
0}tick(r){const {seek:e,pace:g,speed:f}=this.props,k=this.clockParent.getTime();this.skew+=k.step*g/f;e!=null&&(this.skew=e);this.time.now=this.time.time=this.time.clock=(this.props.now!=null?this.props.now:this.now)+this.skew;this.time.delta=this.time.step=k.delta;return this.trigger(r)}getTime(){return this.time}}x.initClass()};
shadow$provide[268]=function(l,L,q){q=l(266);var x=l(267);l.exportCopy(L,q);l.exportCopy(L,x)};
shadow$provide[269]=function(l,L,q){function x(e,g){return typeof e!=="undefined"&&e!==null?g(e):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Transform:{enumerable:!0,get:function(){return r}}});l=l(189);class r extends l.Parent{static initClass(){this.traits=["node","vertex","fragment"]}vertex(e,g){let f;return(f=x(this._inherit("vertex"),k=>k.vertex(e,g)))!=null?f:e}fragment(e,g){let f;return(f=x(this._inherit("fragment"),k=>k.fragment(e,g)))!=null?f:e}}r.initClass()};
shadow$provide[270]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Transform3:{enumerable:!0,get:function(){return r}}});var x=l(195);l=l(269);class r extends l.Transform{static initClass(){this.traits=["node","vertex","transform3"]}make(){this.uniforms={transformMatrix:this._attributes.make(this._types.mat4())};return this.composer=x.transformComposer()}unmake(){return delete this.uniforms}change(e,g,f){if(e["transform3.pass"])return this.rebuild();if(g.transform3||
f)return this.uniforms.transformMatrix.value=this.composer(this.props.position,this.props.rotation,this.props.quaternion,this.props.scale,this.props.matrix,this.props.eulerOrder)}vertex(e,g){g===this.props.pass&&e.pipe("transform3.position",this.uniforms);return super.vertex(e,g)}}r.initClass()};
shadow$provide[271]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Transform4:{enumerable:!0,get:function(){return x}}});l=l(269);class x extends l.Transform{static initClass(){this.traits=["node","vertex","transform4"]}make(){this.uniforms={transformMatrix:this._attributes.make(this._types.mat4()),transformOffset:this.node.attributes["transform4.position"]};return this.transformMatrix=this.uniforms.transformMatrix.value}unmake(){return delete this.uniforms}change(r,
e,g){if(r["transform4.pass"])return this.rebuild();if(e.transform4||g)return r=this.props.scale,e=this.transformMatrix,e.copy(this.props.matrix),e.scale(r)}vertex(r,e){e===this.props.pass&&r.pipe("transform4.position",this.uniforms);return super.vertex(r,e)}}x.initClass()};
shadow$provide[272]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Vertex:{enumerable:!0,get:function(){return x}}});l=l(269);class x extends l.Transform{static initClass(){this.traits=["node","include","vertex","bind"]}make(){return this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}])}unmake(){return this._helpers.bind.unmake()}change(r,e,g){if(e.include)return this.rebuild()}vertex(r,e){this.bind.shader!=null&&e===this.props.pass&&r.pipe(this.bind.shader.shaderBind());
return super.vertex(r,e)}}x.initClass()};
shadow$provide[273]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Fragment:{enumerable:!0,get:function(){return x}}});l=l(269);class x extends l.Transform{static initClass(){this.traits=["node","include","fragment","bind"]}make(){return this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}])}unmake(){return this._helpers.bind.unmake()}change(r,e,g){if(e.include||r["fragment.gamma"])return this.rebuild()}fragment(r,e){this.bind.shader!=null&&e===
this.props.pass&&(this.props.gamma&&r.pipe("mesh.gamma.out"),r.pipe(this.bind.shader.shaderBind()),r.split(),this.props.gamma&&r.pipe("mesh.gamma.in"),r.pass());return super.fragment(r,e)}}x.initClass()};
shadow$provide[274]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Layer:{enumerable:!0,get:function(){return x}}});l=l(269);class x extends l.Transform{static initClass(){this.traits=["node","vertex","layer"]}make(){this._listen("root","root.resize",this.update);return this.uniforms={layerScale:this._attributes.make(this._types.vec4()),layerBias:this._attributes.make(this._types.vec4())}}update(){var r=this._inherit("root").getCamera();const e=r.aspect!=null?r.aspect:
1;r=Math.tan((r.fov!=null?r.fov:1)*Math.PI/360);const g=this.node.attributes["layer.fit"].enum;let {fit:f}=this.props;const {depth:k}=this.props;switch(f){case g.contain:f=e>1?g.y:g.x;break;case g.cover:f=e>1?g.x:g.y}switch(f){case g.x:this.uniforms.layerScale.value.set(r*e,r*e,1,1);break;case g.y:this.uniforms.layerScale.value.set(r,r,1,1)}return this.uniforms.layerBias.value.set(0,0,-k,0)}change(r,e,g){if(r["layer.fit"]||r["layer.depth"]||g)return this.update()}vertex(r,e){return e===2?r.pipe("layer.position",
this.uniforms):e===3?r.pipe("root.position"):r}}x.initClass()};
shadow$provide[275]=function(l,L,q){function x(g,f){return typeof g!=="undefined"&&g!==null?f(g):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Mask:{enumerable:!0,get:function(){return e}}});var r=l(199);l=l(189);class e extends l.Parent{static initClass(){this.traits=["node","include","mask","bind"]}make(){return this._helpers.bind.make([{to:"include.shader",trait:"shader",optional:!0}])}unmake(){return this._helpers.bind.unmake()}change(g,f,k){if(f.include)return this.rebuild()}mask(g){let f,
k;this.bind.shader!=null?g?(k=this._shaders.shader(),k.pipe(r.identity("vec4")),k.fan(),k.pipe(g),k.next(),k.pipe(this.bind.shader.shaderBind()),k.end(),k.pipe("float combine(float a, float b) { return min(a, b); }")):(k=this._shaders.shader(),k.pipe(this.bind.shader.shaderBind())):k=g;return(f=x(this._inherit("mask"),m=>m.mask(k)))!=null?f:k}}e.initClass()};
shadow$provide[276]=function(l,L,q){q=l(269);var x=l(270),r=l(271),e=l(272),g=l(273),f=l(274),k=l(275);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f);l.exportCopy(L,k)};
shadow$provide[277]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Clamp:{enumerable:!0,get:function(){return x}}});l=l(260);class x extends l.Operator{static initClass(){this.traits="node bind operator source index clamp".split(" ")}indexShader(r){r.pipe(this.operator);return super.indexShader(r)}sourceShader(r){r.pipe(this.operator);return super.sourceShader(r)}make(){super.make();if(this.bind.source!=null){var r={clampLimit:this._attributes.make(this._types.vec4())};
this.clampLimit=r.clampLimit;var e=this._shaders.shader();e.pipe("clamp.position",r);return this.operator=e}}unmake(){return super.unmake()}resize(){if(this.bind.source!=null){const r=this.bind.source.getActiveDimensions();this.clampLimit.value.set(r.width-1,r.height-1,r.depth-1,r.items-1)}return super.resize()}change(r,e,g){if(e.operator||e.clamp)return this.rebuild()}}x.initClass()};
shadow$provide[278]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Grow:{enumerable:!0,get:function(){return x}}});l=l(260);class x extends l.Operator{static initClass(){this.traits="node bind operator source index grow".split(" ")}sourceShader(r){return r.pipe(this.operator)}make(){super.make();if(this.bind.source!=null){var r={growScale:this.node.attributes["grow.scale"],growMask:this._attributes.make(this._types.vec4()),growAnchor:this._attributes.make(this._types.vec4())};
this.growMask=r.growMask.value;this.growAnchor=r.growAnchor.value;var e=this._shaders.shader();e.require(this.bind.source.sourceShader(this._shaders.shader()));e.pipe("grow.position",r);return this.operator=e}}unmake(){return super.unmake()}resize(){this.update();return super.resize()}update(){const r=this.bind.source.getFutureDimensions(),e=["width","height","depth","items"];return(()=>{const g=[];for(let f=0;f<e.length;f++){const k=e[f],m=this.props[k];this.growMask.setComponent(f,+(m==null));g.push(this.growAnchor.setComponent(f,
m!=null?((r[k]||1)-1)*(.5-m*.5):0))}return g})()}change(r,e,g){if(e.operator)return this.rebuild();if(e.grow)return this.update()}}x.initClass()};
shadow$provide[279]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Join:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(260);class r extends l.Operator{static initClass(){this.traits="node bind operator source index join".split(" ")}indexShader(e){e.pipe(this.operator);return super.indexShader(e)}sourceShader(e){e.pipe(this.operator);return super.sourceShader(e)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(e){var g;
let f;const {order:k,axis:m,stride:p}=this,z=["width","height","depth","items"],t=k.map(D=>z[D-1]);var v=k.indexOf(m);let y=(()=>{const D=[];for(f of Array.from(t))D.push(e[f]);return D})();const B=((g=y[v+1])!=null?g:1)*p;y.splice(v,2,B);y=y.slice(0,3);y.push(1);g={};for(v=0;v<t.length;v++)f=t[v],g[f]=y[v];return g}make(){super.make();if(this.bind.source!=null){var {order:e}=this.props,{axis:g}=this.props,{overlap:f}=this.props,k=e.join("");g==null&&(g=e[0]);var m=k.indexOf(g);k=k.replace(g,"00").substring(0,
4);var p=[null,"width","height","depth","items"][g];p=this.bind.source.getDimensions()[p];f=Math.min(p-1,f);var z=p-f,t={joinStride:this._attributes.make(this._types.number(z)),joinStrideInv:this._attributes.make(this._types.number(1/z))},v=this._shaders.shader();v.require(x.swizzleVec4(g,1));v.require(x.swizzleVec4(k,4));v.require(x.injectVec4([m,m+1]));v.pipe("join.position",t);v.pipe(x.invertSwizzleVec4(e));this.operator=v;this.order=e;this.axis=g;this.overlap=f;this.length=p;return this.stride=
z}}unmake(){return super.unmake()}change(e,g,f){if(g.join||g.operator)return this.rebuild()}}r.initClass()};
shadow$provide[280]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Lerp:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(260);class r extends l.Operator{static initClass(){this.traits="node bind operator source index lerp sampler:x sampler:y sampler:z sampler:w".split(" ")}indexShader(e){e.pipe(this.indexer);return super.indexShader(e)}sourceShader(e){return e.pipe(this.operator)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(e){const g=
this.resampled,f=this.centered,k=this.padding;this.relativeSize?(f.items||e.items--,f.width||e.width--,f.height||e.height--,f.depth||e.depth--,g.items!=null&&(e.items*=g.items),g.width!=null&&(e.width*=g.width),g.height!=null&&(e.height*=g.height),g.depth!=null&&(e.depth*=g.depth),f.items||e.items++,f.width||e.width++,f.height||e.height++,f.depth||e.depth++,e.items-=k.items*2,e.width-=k.width*2,e.height-=k.height*2,e.depth-=k.depth*2):(g.items!=null&&(e.items=g.items),g.width!=null&&(e.width=g.width),
g.height!=null&&(e.height=g.height),g.depth!=null&&(e.depth=g.depth));e.items=Math.max(0,Math.floor(e.items));e.width=Math.max(0,Math.floor(e.width));e.height=Math.max(0,Math.floor(e.height));e.depth=Math.max(0,Math.floor(e.depth));return e}make(){let e;super.make();if(this.bind.source!=null){var {size:g,items:f,width:k,height:m,depth:p}=this.props,z=g===this.node.attributes["lerp.size"].enum.relative;this.resampled={};f!=null&&(this.resampled.items=f);k!=null&&(this.resampled.width=k);m!=null&&(this.resampled.height=
m);p!=null&&(this.resampled.depth=p);this.centered={};this.centered.items=this.props.centeredW;this.centered.width=this.props.centeredX;this.centered.height=this.props.centeredY;this.centered.depth=this.props.centeredZ;this.padding={};this.padding.items=this.props.paddingW;this.padding.width=this.props.paddingX;this.padding.height=this.props.paddingY;this.padding.depth=this.props.paddingZ;var t=this._shaders.shader(),v=this._shaders.shader(),y={resampleFactor:this._attributes.make(this._types.vec4(0,
0,0,0)),resampleBias:this._attributes.make(this._types.vec4(0,0,0,0))};this.resampleFactor=y.resampleFactor;this.resampleBias=y.resampleBias;var B=f!=null||k!=null||m!=null||p!=null;t.pipe("resample.padding",y);var D=[],G=!1,I=["width","height","depth","items"];for(e=0;e<I.length;e++){var K=I[e];K=this.centered[K];G||(G=K);D[e]=K?"0.5":"0.0"}if(G&&B){var Q=`vec4(${D})`;t.pipe(x.binaryOperator(4,"+",Q));v.pipe(x.binaryOperator(4,"+",Q))}B?(t.pipe("resample.relative",y),v.pipe("resample.relative",y)):
(t.pipe(x.identity("vec4")),v.pipe(x.identity("vec4")));G&&B&&(t.pipe(x.binaryOperator(4,"-",Q)),v.pipe(x.binaryOperator(4,"-",Q)));B=this.bind.source.sourceShader(this._shaders.shader());D=["width","height","depth","items"];for(e=0;e<D.length;e++)K=D[e],G=`lerp.${K}`,this.props[K]!=null&&(B=this._shaders.shader().require(B),B.pipe(G,y));t.pipe(B);this.operator=t;this.indexer=v;return this.relativeSize=z}}unmake(){super.unmake();return this.operator=null}resize(){if(this.bind.source!=null){var e=
this.bind.source.getActiveDimensions(),g=this.getActiveDimensions(),f=D=>{const G=this.centered[D],I=this.padding[D];g[D]+=I*2;return[G?e[D]/Math.max(1,g[D]):Math.max(1,e[D]-1)/Math.max(1,g[D]-1),I]},[k,m]=Array.from(f("width")),[p,z]=Array.from(f("height")),[t,v]=Array.from(f("depth")),[y,B]=Array.from(f("items"));this.resampleFactor.value.set(k,p,t,y);this.resampleBias.value.set(m,z,v,B);return super.resize()}}change(e,g,f){if(g.operator||g.lerp||g.sampler)return this.rebuild()}}r.initClass()};
shadow$provide[281]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Memo:{enumerable:!0,get:function(){return x}}});l=l(260);class x extends l.Operator{static initClass(){this.traits="node bind active operator source index texture memo".split(" ")}sourceShader(r){return this.memo.shaderAbsolute(r,1)}make(){super.make();if(this.bind.source!=null){this._helpers.active.make();this._listen("root","root.update",()=>{if(this.isActive)return this.update()});var {minFilter:r,
magFilter:e,type:g}=this.props,f=this.bind.source.getDimensions(),{items:k,width:m,height:p,depth:z}=f;this.memo=this._renderables.make("memo",{items:k,width:m,height:p,depth:z,minFilter:r,magFilter:e,type:g});f=this._shaders.shader();this.bind.source.sourceShader(f);this.compose=this._renderables.make("memoScreen",{map:f,items:k,width:m,height:p,depth:z});this.memo.adopt(this.compose);this.objects=[this.compose];return this.renders=this.compose.renders}}unmake(){this._helpers.active.unmake();this.bind.source!=
null&&(this.memo.unadopt(this.compose),this.memo.dispose(),this.memo=this.compose=null,super.unmake())}update(){return this.memo!=null?this.memo.render():void 0}resize(){if(this.bind.source!=null){var r=this.bind.source.getActiveDimensions(),{width:e,height:g,depth:f}=r;this.compose.cover(e,g,f);return super.resize()}}change(r,e,g){if(e.texture||e.operator)return this.rebuild()}}x.initClass()};
shadow$provide[282]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Readback:{enumerable:!0,get:function(){return x}}});l=l(188);class x extends l.Primitive{static initClass(){this.traits="node bind operator readback entity active".split(" ");this.finals={channels:4}}init(){this.emitter=this.root=null;return this.active={}}make(){super.make();this._compute("readback.data",()=>this.readback!=null?this.readback.data:void 0);this._compute("readback.items",()=>this.readback!=
null?this.readback.items:void 0);this._compute("readback.width",()=>this.readback!=null?this.readback.width:void 0);this._compute("readback.height",()=>this.readback!=null?this.readback.height:void 0);this._compute("readback.depth",()=>this.readback!=null?this.readback.depth:void 0);this._helpers.bind.make([{to:"operator.source",trait:"source"}]);if(this.bind.source!=null){var {type:r,channels:e,expr:g}=this.props;this.root=this._inherit("root");this._listen("root","root.update",this.update);var {items:f,
width:k,height:m,depth:p}=this.bind.source.getDimensions(),z=this.bind.source.sourceShader(this._shaders.shader());this.readback=this._renderables.make("readback",{map:z,items:f,width:k,height:m,depth:p,channels:e,type:r});g!=null&&this.readback.setCallback(g);this._helpers.active.make()}}unmake(){this.readback!=null&&(this.readback.dispose(),this.emitter=this.root=this.readback=null,this.active={});this._helpers.active.unmake();return this._helpers.bind.unmake()}update(){this.readback!=null&&this.isActive&&
(this.readback.update(this.root!=null?this.root.getCamera():void 0),this.readback.post(),this.props.expr!=null&&this.readback.iterate())}resize(){let r;if(this.readback!=null){var {items:e,width:g,height:f,depth:k}=this.bind.source.getActiveDimensions();this.readback.setActive(e,g,f,k);this.strideI=e;this.strideJ=r=e*g;return this.strideK=r*f}}change(r,e,g){if(r["readback.type"])return this.rebuild();if(r["readback.expr"]&&this.readback)return this.readback.setCallback(this.props.expr)}}x.initClass()};
shadow$provide[283]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Repeat:{enumerable:!0,get:function(){return x}}});l=l(260);class x extends l.Operator{static initClass(){this.traits="node bind operator source index repeat".split(" ")}indexShader(r){r.pipe(this.operator);return super.indexShader(r)}sourceShader(r){r.pipe(this.operator);return super.sourceShader(r)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(r){const e=
this.resample;return{items:e.items*r.items,width:e.width*r.width,height:e.height*r.height,depth:e.depth*r.depth}}make(){super.make();if(this.bind.source!=null){this.resample={};var r={repeatModulus:this._attributes.make(this._types.vec4())};this.repeatModulus=r.repeatModulus;var e=this._shaders.shader();e.pipe("repeat.position",r);return this.operator=e}}unmake(){return super.unmake()}resize(){if(this.bind.source!=null){const r=this.bind.source.getActiveDimensions();this.repeatModulus.value.set(r.width,
r.height,r.depth,r.items)}return super.resize()}change(r,e,g){if(e.operator||e.repeat)return this.rebuild();if(g)return["items","width","height","depth"].map(f=>this.resample[f]=this.props[f])}}x.initClass()};
shadow$provide[284]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Reverse:{enumerable:!0,get:function(){return x}}});l=l(260);class x extends l.Operator{static initClass(){this.traits="node bind operator source index reverse".split(" ")}getDimensions(){return this.bind.source.getDimensions()}getActiveDimensions(){return this.bind.source.getActiveDimensions()}getFutureDimensions(){return this.bind.source.getFutureDimensions()}getIndexDimensions(){return this.bind.source.getIndexDimensions()}sourceShader(r){r.pipe("reverse.position",
this.uniforms);return this.bind.source.sourceShader(r)}_resolveScale(r,e){return this.props[r]?-1:1}_resolveOffset(r,e){e=e[r];return this.props[r]?e-1:0}make(){super.make();if(this.bind.source!=null)return this.uniforms={reverseScale:this._attributes.make(this._types.vec4()),reverseOffset:this._attributes.make(this._types.vec4())}}unmake(){return super.unmake()}resize(){if(this.bind.source!=null){var r=this.bind.source.getActiveDimensions();this.uniforms.reverseScale.value.set(this._resolveScale("width",
r),this._resolveScale("height",r),this._resolveScale("depth",r),this._resolveScale("items",r));this.uniforms.reverseOffset.value.set(this._resolveOffset("width",r),this._resolveOffset("height",r),this._resolveOffset("depth",r),this._resolveOffset("items",r));return super.resize()}}change(r,e,g){if(e.operator)return this.rebuild();if(e.reverse)return this.resize()}}x.initClass()};
shadow$provide[285]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Swizzle:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(260);class r extends l.Operator{static initClass(){this.traits="node bind operator source index swizzle".split(" ")}sourceShader(e){e=super.sourceShader(e);this.swizzler&&e.pipe(this.swizzler);return e}make(){super.make();if(this.bind.source!=null){var {order:e}=this.props;if(e.join()!=="1234")return this.swizzler=x.swizzleVec4(e,4)}}unmake(){super.unmake();
return this.swizzler=null}change(e,g,f){if(g.swizzle||g.operator)return this.rebuild()}}r.initClass()};
shadow$provide[286]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Spread:{enumerable:!0,get:function(){return x}}});l=l(260);class x extends l.Operator{static initClass(){this.traits="node bind operator source index spread".split(" ")}sourceShader(r){return r.pipe(this.operator)}make(){super.make();if(this.bind.source!=null){var r={spreadMatrix:this._attributes.make(this._types.mat4()),spreadOffset:this._attributes.make(this._types.vec4())};this.spreadMatrix=r.spreadMatrix;
this.spreadOffset=r.spreadOffset;var e=this._shaders.shader();e.require(this.bind.source.sourceShader(this._shaders.shader()));e.pipe("spread.position",r);return this.operator=e}}unmake(){return super.unmake()}resize(){this.update();return super.resize()}update(){let r,e,g,f;const k=this.bind.source.getFutureDimensions(),m=this.spreadMatrix.value.elements,p=["width","height","depth","items"],z=["alignWidth","alignHeight","alignDepth","alignItems"],{unit:t}=this.props,v=this.node.attributes["spread.unit"].enum,
y=(()=>{switch(t){case v.relative:return(B,D,G,I)=>m[D*4+G]=I/Math.max(1,k[B]-1);case v.absolute:return(B,D,G,I)=>m[D*4+G]=I}})();return(()=>{const B=[];for(e=0;e<p.length;e++){r=p[e];const I=this.props[r];var D=this.props[z[e]];this.spreadOffset.value.setComponent(e,I!=null?-((k[r]!=null?k[r]:1)-1)*(.5-D*.5):0);D=B;var G=D.push;const K=[];for(g=0;g<=3;g++){let Q;f=(Q=I!=null?I.getComponent(g):void 0)!=null?Q:0;K.push(m[e*4+g]=y(r,e,g,f))}G.call(D,K)}return B})()}change(r,e,g){if(e.operator)return this.rebuild();
if(e.spread)return this.update()}}x.initClass()};
shadow$provide[287]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Split:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(260);class r extends l.Operator{static initClass(){this.traits="node bind operator source index split".split(" ")}indexShader(e){e.pipe(this.operator);return super.indexShader(e)}sourceShader(e){e.pipe(this.operator);return super.sourceShader(e)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(e){let g;
var {order:f}=this,{axis:k}=this,{overlap:m}=this,{length:p}=this;const {stride:z}=this,t=["width","height","depth","items"],v=f.map(y=>t[y-1]);k=f.indexOf(k);f=(()=>{const y=[];for(g of Array.from(v))y.push(e[g]);return y})();f.splice(k,1,p,Math.floor((f[k]-m)/z));f=f.slice(0,4);m={};for(p=0;p<v.length;p++)g=v[p],m[g]=f[p];return m}make(){var e;super.make();if(this.bind.source!=null){var {order:g}=this.props,{axis:f}=this.props,{overlap:k}=this.props,{length:m}=this.props,p=g.join("");f==null&&(f=
g[0]);var z=p.indexOf(f),t=p[z]+((e=p[z+1])!=null?e:0);e=p.replace(t[1],"").replace(t[0],"0")+"0";k=Math.min(m-1,k);p=m-k;var v={splitStride:this._attributes.make(this._types.number(p))},y=this._shaders.shader();y.require(x.swizzleVec4(t,2));y.require(x.swizzleVec4(e,4));y.require(x.injectVec4(z));y.pipe("split.position",v);y.pipe(x.invertSwizzleVec4(g));this.operator=y;this.order=g;this.axis=f;this.overlap=k;this.length=m;return this.stride=p}}unmake(){return super.unmake()}change(e,g,f){if(e["split.axis"]||
e["split.order"]||g.operator)return this.rebuild()}}r.initClass()};
shadow$provide[288]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Slice:{enumerable:!0,get:function(){return x}}});l=l(260);class x extends l.Operator{static initClass(){this.traits="node bind operator source index slice".split(" ")}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}sourceShader(r){r.pipe("slice.position",
this.uniforms);return this.bind.source.sourceShader(r)}_resolve(r,e){var g=this.props[r];r=e[r];if(g==null)return[0,r];e=Math.round(g.x);e=e<0?r+e:e;g=Math.round(g.y);g=Math.max(e,g<0?r+g:g);return[e,g-e]}_resample(r){r.width=this._resolve("width",r)[1];r.height=this._resolve("height",r)[1];r.depth=this._resolve("depth",r)[1];r.items=this._resolve("items",r)[1];return r}make(){super.make();if(this.bind.source!=null)return this.uniforms={sliceOffset:this._attributes.make(this._types.vec4())}}unmake(){return super.unmake()}resize(){if(this.bind.source!=
null){var r=this.bind.source.getActiveDimensions();this.uniforms.sliceOffset.value.set(this._resolve("width",r)[0],this._resolve("height",r)[0],this._resolve("depth",r)[0],this._resolve("items",r)[0]);return super.resize()}}change(r,e,g){if(e.operator)return this.rebuild();if(e.slice)return this.resize()}}x.initClass()};
shadow$provide[289]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Subdivide:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(260);class r extends l.Operator{static initClass(){this.traits="node bind operator source index subdivide".split(" ")}indexShader(e){e.pipe(this.indexer);return super.indexShader(e)}sourceShader(e){return e.pipe(this.operator)}getDimensions(){return this._resample(this.bind.source.getDimensions())}getActiveDimensions(){return this._resample(this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._resample(this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._resample(this.bind.source.getIndexDimensions())}_resample(e){const g=
this.resampled;e.items--;e.width--;e.height--;e.depth--;g.items!=null&&(e.items*=g.items);g.width!=null&&(e.width*=g.width);g.height!=null&&(e.height*=g.height);g.depth!=null&&(e.depth*=g.depth);e.items++;e.width++;e.height++;e.depth++;return e}make(){super.make();if(this.bind.source!=null){var {lerp:e}=this.props,{items:g,width:f,height:k,depth:m}=this.props;this.resampled={};g!=null&&(this.resampled.items=g);f!=null&&(this.resampled.width=f);k!=null&&(this.resampled.height=k);m!=null&&(this.resampled.depth=
m);var p=this._shaders.shader(),z=this._shaders.shader(),t={resampleFactor:this._attributes.make(this._types.vec4(0,0,0,0)),subdivideBevel:this.node.attributes["subdivide.bevel"]};this.resampleFactor=t.resampleFactor;this.resampleBias=t.resampleBias;g!=null||f!=null||k!=null||m!=null?(p.pipe("resample.relative",t),z.pipe("resample.relative",t)):(p.pipe(x.identity("vec4")),z.pipe(x.identity("vec4")));var v=this.bind.source.sourceShader(this._shaders.shader());e=e?".lerp":"";var y=["width","height",
"depth","items"];for(let B=0;B<y.length;B++){const D=y[B],G=`subdivide.${D}${e}`;this.props[D]!=null&&(v=this._shaders.shader().require(v),v.pipe(G,t))}p.pipe(v);this.operator=p;return this.indexer=z}}unmake(){super.unmake();return this.operator=null}resize(){if(this.bind.source!=null){var e=this.bind.source.getActiveDimensions(),g=this.getActiveDimensions(),f=z=>Math.max(1,e[z]-1)/Math.max(1,g[z]-1),k=f("width"),m=f("height"),p=f("depth");f=f("items");this.resampleFactor.value.set(k,m,p,f);return super.resize()}}change(e,
g,f){if(g.operator||g.subdivide)return this.rebuild()}}r.initClass()};
shadow$provide[290]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Transpose:{enumerable:!0,get:function(){return e}}});var x=l(199);l=l(260);const r={1:"width",2:"height",3:"depth",4:"items"};class e extends l.Operator{static initClass(){this.traits="node bind operator source index transpose".split(" ")}indexShader(g){this.swizzler&&g.pipe(this.swizzler);return super.indexShader(g)}sourceShader(g){this.swizzler&&g.pipe(this.swizzler);return super.sourceShader(g)}getDimensions(){return this._remap(this.transpose,
this.bind.source.getDimensions())}getActiveDimensions(){return this._remap(this.transpose,this.bind.source.getActiveDimensions())}getFutureDimensions(){return this._remap(this.transpose,this.bind.source.getFutureDimensions())}getIndexDimensions(){return this._remap(this.transpose,this.bind.source.getIndexDimensions())}_remap(g,f){const k={};for(let m=0;m<=3;m++){const p=r[g[m]];k[r[m+1]]=f[p]!=null?f[p]:1}return k}make(){super.make();if(this.bind.source!=null){var {order:g}=this.props;g.join()!==
"1234"&&(this.swizzler=x.invertSwizzleVec4(g));this.transpose=g;return this.trigger({type:"source.rebuild"})}}unmake(){super.unmake();return this.swizzler=null}change(g,f,k){if(f.transpose||f.operator)return this.rebuild()}}e.initClass()};
shadow$provide[291]=function(l,L,q){q=l(277);var x=l(278),r=l(279),e=l(280),g=l(281),f=l(282),k=l(263),m=l(283),p=l(284),z=l(285),t=l(286),v=l(287),y=l(288),B=l(289),D=l(290);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f);l.exportCopy(L,k);l.exportCopy(L,m);l.exportCopy(L,p);l.exportCopy(L,z);l.exportCopy(L,t);l.exportCopy(L,v);l.exportCopy(L,y);l.exportCopy(L,B);l.exportCopy(L,D)};
shadow$provide[292]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Transition:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits="node transition transform mask visible active".split(" ")}init(){this.uniforms=this.animate=null;this.state={isVisible:!0,isActive:!0,enter:1,exit:1};return this.locked=this.latched=null}make(){this.uniforms={transitionFrom:this._attributes.make(this._types.vec4()),transitionTo:this._attributes.make(this._types.vec4()),
transitionActive:this._attributes.make(this._types.bool()),transitionScale:this._attributes.make(this._types.vec4()),transitionBias:this._attributes.make(this._types.vec4()),transitionEnter:this._attributes.make(this._types.number()),transitionExit:this._attributes.make(this._types.number()),transitionSkew:this._attributes.make(this._types.number())};const r=this._inherit("slide"),e=this._inherit("visible"),g=this._inherit("active");this._listen(r,"transition.latch",f=>this.latch(f.step));this._listen(r,
"transition.release",()=>this.release());this._listen(e,"visible.change",()=>this.update(this.state.isVisible=e.isVisible));this._listen(g,"active.change",()=>this.update(this.state.isActive=g.isActive));this.animate=this._animator.make(this._types.vec2(1,1),{step:f=>{this.state.enter=f.x;this.state.exit=f.y;return this.update()},complete:f=>this.complete(f)});return this.move=this.props.from!=null||this.props.to!=null}unmake(){return this.animate.dispose()}latch(r){this.locked=null;this.latched=
r={isVisible:this.state.isVisible,isActive:this.state.isActive,step:r};if(!this.isVisible){const [e,g]=Array.from(r.step>=0?[0,1]:[1,0]);return this.animate.set(e,g)}}release(){const {latched:r}=this,{state:e}=this;this.latched=null;if(r.isVisible!==e.isVisible){const g=r.step>=0,f=e.isVisible,[k,m]=Array.from(f?[1,1]:g?[1,0]:[0,1]);let {duration:p,durationEnter:z,durationExit:t}=this.props;z==null&&(z=p);t==null&&(t=p);let {delay:v,delayEnter:y,delayExit:B}=this.props;y==null&&(y=v);B==null&&(B=
v);this.animate.immediate({x:k,y:m},{duration:f*z+!f*t,delay:f*y+!f*B,ease:"linear"});this.locked={isVisible:!0,isActive:r.isActive||e.isActive}}return this.update()}complete(r){if(r)return this.locked=null,this.update()}update(){if(this.latched==null){var {enter:r,exit:e}=this.props;r==null&&({enter:r}=this.state);e==null&&({exit:e}=this.state);var g=r*e,f=g>0;this.uniforms.transitionEnter.value=r;this.uniforms.transitionExit.value=e;this.uniforms.transitionActive.value=g<1;f&&(f=!!this.state.isVisible);
this.locked!=null&&(f=this.locked.isVisible);this.isVisible!==f&&(this.isVisible=f,this.trigger({type:"visible.change"}));g=!!(this.state.isActive||this.locked!=null&&this.locked.isActive);if(this.isActive!==g)return this.isActive=g,this.trigger({type:"active.change"})}}change(r,e,g){(r["transition.enter"]||r["transition.exit"]||g)&&this.update();if(r["transition.stagger"]||g){var {stagger:f}=this.props;r=f.x<0;e=f.y<0;g=f.z<0;const k=f.w<0,m=Math.abs(f.x),p=Math.abs(f.y),z=Math.abs(f.z);f=Math.abs(f.w);
this.uniforms.transitionSkew.value=m+p+z+f;this.uniforms.transitionScale.value.set((1-r*2)*m,(1-e*2)*p,(1-g*2)*z,(1-k*2)*f);return this.uniforms.transitionBias.value.set(r*m,e*p,g*z,k*f)}}}x.initClass()};
shadow$provide[293]=function(l,L,q){function x(e,g){return typeof e!=="undefined"&&e!==null?g(e):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Move:{enumerable:!0,get:function(){return r}}});l=l(292);class r extends l.Transition{static initClass(){this.traits="node transition vertex move visible active".split(" ")}make(){super.make();const e={moveFrom:this.node.attributes["move.from"],moveTo:this.node.attributes["move.to"]};for(const g in e)this.uniforms[g]=e[g]}vertex(e,g){let f;
g===this.props.pass&&e.pipe("move.position",this.uniforms);return(f=x(this._inherit("vertex"),k=>k.vertex(e,g)))!=null?f:e}}r.initClass()};
shadow$provide[294]=function(l,L,q){function x(f,k,m){return Math.max(k,Math.min(m,f))}function r(f){return.5-.5*Math.cos(x(f,0,1)*Math.PI)}function e(f){return+(f>=.5)}function g(f){return+(f>=1)}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},binary:{enumerable:!0,get:function(){return e}},clamp:{enumerable:!0,get:function(){return x}},cosine:{enumerable:!0,get:function(){return r}},hold:{enumerable:!0,get:function(){return g}}})};
shadow$provide[295]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Track:{enumerable:!0,get:function(){return e}}});var x=l(294);l=l(188);const r=function(g){const f={};for(const k in g){const m=g[k];f[k]=m instanceof Array?m.slice():m!=null&&typeof m==="object"?r(m):m}return f};class e extends l.Primitive{static initClass(){this.traits=["node","track","seek","bind"]}init(){this.handlers={};this.values=this.script=null;this.playhead=0;return this.expr=this.section=
this.velocity=null}make(){let g;this._helpers.bind.make([{to:"track.target",trait:"node",callback:null}]);const {script:f}=this.props,{node:k}=this.bind.target;this.targetNode=k;return[this.script,this.values,this.start,this.end]=Array.from(g=this._process(k,f)),g}unmake(){this.unbindExpr();this._helpers.bind.unmake();this.script=this.values=this.start=this.end=this.section=this.expr=null;return this.playhead=0}bindExpr(g){this.unbindExpr();this.expr=g;this.targetNode.bind(g,!0);const {clock:f}=this.targetNode,
k=this;return this._attributes.bind(this.measure=function(){let m=null;return()=>{const {step:p}=f.getTime();m!=null&&(k.velocity=(k.playhead-m)/p);return m=k.playhead}}())}unbindExpr(){this.expr!=null&&this.targetNode.unbind(this.expr,!0);this.measure!=null&&this._attributes.unbind(this.measure);return this.expr=this.measure=null}_process(g,f){let k;let m;if(f instanceof Array){var p={};for(var z=0;z<f.length;z++)m=f[z],p[z]=m;f=p}p=[];for(B in f)m=f[B],m==null&&(m=[]),m instanceof Array?m={key:+B,
props:m[0]!=null?r(m[0]):{},bind:m[1]!=null?r(m[1]):{}}:(m=m.key!=null||m.props||m.bind?r(m):{props:r(m)},m.key=m.key!=null?+m.key:+B,m.props==null&&(m.props={}),m.bind==null&&(m.bind={})),p.push(m);f=p;if(!f.length)return[[],{},0,0];f.sort((D,G)=>D.key-G.key);z=f[0].key;const t=f[f.length-1].key;for(B in f){m=f[B];v!=null&&(v.next=m);var v=m}v.next=v;f=p;p={};const y={};for(B in f)for(k in m=f[B],m.props)v=m.props[k],p[k]=!0;for(B in f)for(k in m=f[B],m.bind)v=m.bind[k],p[k]=!0;for(k in p)p[k]=g.get(k);
try{for(k in p)y[k]=[g.attribute(k).T.make(),g.attribute(k).T.make(),g.attribute(k).T.make()]}catch(D){throw console.warn(this.node.toMarkup()),g=`${this.node.toString()} - Target ${g} has no \`${k}\` property`,Error(g);}var B=[];for(m of Array.from(f)){for(k in p)if(v=p[k],v=g.validate(k,m.props[k]!=null?m.props[k]:v),p[k]=m.props[k]=v,m.bind[k]!=null&&typeof m.bind[k]!=="function")throw console.warn(this.node.toMarkup()),g=`${this.node.toString()} - Bind expression \`${m.bind[k]}\` on property \`${k}\` is not a function`,
Error(g);B.push(m)}return[B,y,z,t]}update(){let {playhead:g}=this;const {script:f}=this,{ease:k,seek:m}=this.props,p=this.targetNode;m!=null&&(g=m);if(f.length){let O;var z=function(){let J=f[0];for(let W=0;W<f.length;W++){const ba=f[W];if(ba.key>g)break;J=ba}return J},{section:t}=this;if(!t||g<t.key||g>t.next.key)t=z(f,g);if(t!==this.section){var v=this.section=t,y=t.next,B=v.key,D=y.key,G=(()=>{switch(k){case "linear":case 0:return x.clamp;case "cosine":case 1:return x.cosine;case "binary":case 2:return x.binary;
case "hold":case 3:return x.hold;default:return x.cosine}})(),{clock:I}=p,K=J=>{if(this.velocity==null)return this.playhead;const W=I.getTime();return this.playhead+this.velocity*(J-W.time)},Q=function(){const J=1/Math.max(1E-4,D-B);return W=>G((K(W)-B)*J,0,1)}();z=J=>{const W=v.bind[J],ba=y.bind[J],Y=v.props[J],S=y.props[J],ca=function(){console.warn(p.toMarkup());throw Error(`${this.node.toString()} - Invalid expression result on track \`${J}\``);},V=p.attribute(J),xa=this.values[J],na=this._animator;
return W&&ba?((N,pa,ra)=>function(Ea,Ua){let jb;N[0]=jb=V.T.validate(W(Ea,Ua),N[0],ca);N[1]=Ua=V.T.validate(ba(Ea,Ua),N[1],ca);return N[2]=na.lerp(V.T,jb,Ua,Q(Ea),N[2])})(xa,v,y):W?((N,pa,ra)=>function(Ea,Ua){N[0]=Ua=V.T.validate(W(Ea,Ua),N[0],ca);return N[1]=na.lerp(V.T,Ua,S,Q(Ea),N[1])})(xa,v,y):ba?((N,pa,ra)=>function(Ea,Ua){N[0]=Ua=V.T.validate(ba(Ea,Ua),N[0],ca);return N[1]=na.lerp(V.T,Y,Ua,Q(Ea),N[1])})(xa,v,y):((N,pa,ra)=>(Ea,Ua)=>N[0]=na.lerp(V.T,Y,S,Q(Ea),N[0]))(xa,v,y)};t={};for(O in v.bind)t[O]==
null&&(t[O]=z(O));for(O in y.bind)t[O]==null&&(t[O]=z(O));for(O in v.props)t[O]==null&&(t[O]=z(O));for(O in y.props)t[O]==null&&(t[O]=z(O));return this.bindExpr(t)}}}change(g,f,k){if(g["track.target"]||g["track.script"]||g["track.mode"])return this.rebuild();if(g["seek.seek"]||k)return this.update()}}e.initClass()};
shadow$provide[296]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Play:{enumerable:!0,get:function(){return x}}});l=l(295);class x extends l.Track{static initClass(){this.traits=["node","track","trigger","play","bind"]}init(){super.init();return this.start=this.skew=null}reset(r){r==null&&(r=!0);this.skew=r?0:null;return this.start=null}make(){super.make();this._listen("slide","slide.step",e=>{const {trigger:g}=this.props;if(g!=null&&e.index===g)return this.reset();
if(g!=null&&e.index===0)return this.reset(!1)});this.props.trigger&&this._inherit("slide")!=null||this.reset();const r=this._inherit("clock");return this._listen(r,"clock.tick",()=>{const {from:e,to:g,speed:f,pace:k,delay:m,realtime:p}=this.props;var z=r.getTime();if(this.skew!=null){var t=p?z.time:z.clock;z=p?z.delta:z.step;const v=f/k;this.start==null&&(this.start=t);this.skew+=z*(v-1);t=Math.max(0,t-this.start+this.skew-m*v);this.props.loop&&(t%=g-e);this.playhead=Math.min(g,e+t)}else this.playhead=
0;return this.update()})}update(){return super.update()}change(r,e,g){return r["trigger.trigger"]||r["play.realtime"]?this.rebuild():super.change(r,e,g)}}x.initClass()};
shadow$provide[297]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Present:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits=["node","present"]}init(){}make(){this.nodes=[];this.steps=[];this.length=0;this.last=[];this.index=0;this.dirty=[];this._listen("root","root.update",this.update);return this._compute("present.length",()=>this.length)}adopt(r){const {node:e}=r;this.nodes.indexOf(r)<0&&this.nodes.push(e);
return this.dirty.push(r)}unadopt(r){this.nodes=this.nodes.filter(e=>e!==r);return this.dirty.push(r)}update(){if(this.dirty.length){for(const r of Array.from(this.dirty))this.slideReset(r);[this.steps,this.indices]=Array.from(this.process(this.nodes));this.length=this.steps.length;this.index=null;this.go(this.props.index);return this.dirty=[]}}slideLatch(r,e,g){return r.slideLatch(e,g)}slideStep(r,e,g){return r.slideStep(this.mapIndex(r,e),g)}slideRelease(r,e){return r.slideRelease()}slideReset(r){return r.slideReset()}mapIndex(r,
e){return e-this.indices[r.node._id]}process(r){const e=(k=>m=>{let p,z;const t=[];for(;m&&([m,p]=Array.from(z=[k(m),m]),z);)t.push(p);return t})(function(k){return k.parent.traits.hash.present?null:k.parent}),g=k=>r.indexOf(k)>=0,f=k=>k.sort((m,p)=>m.order-p.order);return function(k){let m;const [p,z]=Array.from(k),t={};let v=[];k=function(B,D){let G;const {props:I}=G=B[0];var K=B[1];const Q=K!=null?t[K._id]:0;K=I.from!=null?Q+I.from:D-I.early;D=I.to!=null?Q+I.to:D+I.steps+I.late;K=Math.max(0,K);
D=Math.min(100,D);t[G._id]==null&&(t[G._id]=K);for(let O=K,J=D,W=K<=J;W?O<J:O>J;W?O++:O--)v[O]=(v[O]!=null?v[O]:v[O]=[]).concat(B);return I.steps};let y=0;for(m of Array.from(p))y+=k(m,y);for(m of Array.from(z))k(m,0);v=(()=>{const B=[];for(m of Array.from(v)){var D=B,G=D.push,I;if(I=m){const K=[];for(let Q=0;Q<I.length;Q++){const O=I[Q];I.indexOf(O)===Q&&K.push(O)}I=K}else I=[];G.call(D,f(I))}return B})();return[v,t]}(function(k){const m=[],p=[];for(const z of Array.from(k))(z[0].props.steps!=null?
m:p).push(z);return[m,p]}((k=>k.sort(function(m,p){const z=m.length,t=p.length;let v=Math.min(z,t);for(let y=1,B=v,D=1<=B;D?y<=B:y>=B;D?y++:y--){const G=m[z-y],I=p[t-y],K=G.props.order,Q=I.props.order;if(K!=null||Q!=null){if(K!=null&&Q!=null&&(v=K-Q)!==0)return v;if(K!=null)return-1;if(Q!=null)return 1}if(I.order!==G.order)return I.order-G.order}v=z-t;return v!==0?v:0}))((k=>Array.from(k).map(m=>e(m).filter(g)))(r))))}go(r){var e;let g;r=Math.max(0,Math.min(this.length+1,+r||0));const f=(e=this.steps[r-
1])!=null?e:[];e=this.props.directed?r-this.index:1;this.index=r;const k=(()=>{const v=[];for(g of Array.from(f))this.last.indexOf(g)<0&&v.push(g);return v})(),m=(()=>{const v=[];for(g of Array.from(this.last))f.indexOf(g)<0&&v.push(g);return v})(),p=(()=>{const v=[];for(g of Array.from(f))k.indexOf(g)<0&&m.indexOf(g)<0&&v.push(g);return v})(),z=v=>v.sort((y,B)=>y.order-B.order),t=v=>v.sort((y,B)=>B.order-y.order);for(g of Array.from(z(k)))this.slideLatch(g.controller,!0,e);for(g of Array.from(z(p)))this.slideLatch(g.controller,
null,e);for(g of Array.from(z(m)))this.slideLatch(g.controller,!1,e);for(g of Array.from(k))this.slideStep(g.controller,r,e);for(g of Array.from(p))this.slideStep(g.controller,r,e);for(g of Array.from(m))this.slideStep(g.controller,r,e);for(g of Array.from(t(k)))this.slideRelease(g.controller);for(g of Array.from(t(p)))this.slideRelease(g.controller);for(g of Array.from(t(m)))this.slideRelease(g.controller);this.last=f}change(r,e,g){if(r["present.index"]||g)return this.go(this.props.index)}}x.initClass()};
shadow$provide[298]=function(l,L,q){function x(g,f){return typeof g!=="undefined"&&g!==null?f(g):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Reveal:{enumerable:!0,get:function(){return e}}});var r=l(199);l=l(292);class e extends l.Transition{static initClass(){this.traits=["node","transition","mask","visible","active"]}mask(g){let f,k;g?(k=this._shaders.shader(),k.pipe(r.identity("vec4")),k.fan(),k.pipe(g,this.uniforms),k.next(),k.pipe("reveal.mask",this.uniforms),k.end(),
k.pipe("float combine(float a, float b) { return min(a, b); }")):(k=this._shaders.shader(),k.pipe("reveal.mask",this.uniforms));return(f=x(this._inherit("mask"),m=>m.mask(k)))!=null?f:k}}e.initClass()};
shadow$provide[299]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Slide:{enumerable:!0,get:function(){return x}}});l=l(189);class x extends l.Parent{static initClass(){this.traits=["node","slide","visible","active"]}make(){this._helpers.visible.make();this._helpers.active.make();if(!this._inherit("present"))throw Error(`${this.node.toString()} must be placed inside <present></present>`);return this._inherit("present").adopt(this)}unmake(){this._helpers.visible.unmake();
this._helpers.active.unmake();return this._inherit("present").unadopt(this)}change(r,e,g){if(r["slide.early"]||r["slide.late"]||r["slide.steps"]||r["slide.from"]||r["slide.to"])return this.rebuild()}slideLatch(r,e){this.trigger({type:"transition.latch",step:e});if(r!=null)return this._instant(r)}slideStep(r,e){return this.trigger({type:"slide.step",index:r,step:e})}slideRelease(){return this.trigger({type:"transition.release"})}slideReset(){this._instant(!1);return this.trigger({type:"slide.reset"})}_instant(r){this.setVisible(r);
return this.setActive(r)}}x.initClass()};
shadow$provide[300]=function(l,L,q){function x(e,g,f){const k=[],m=e<g;for(g=f?m?g+1:g-1:g;m?e<g:e>g;m?e++:e--)k.push(e);return k}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Step:{enumerable:!0,get:function(){return r}}});l=l(295);class r extends l.Track{static initClass(){this.traits=["node","track","step","trigger","bind"]}make(){super.make();const e=this._inherit("clock");this.actualIndex==null&&(this.actualIndex=null);this.animateIndex=this._animator.make(this._types.number(0),
{clock:e,realtime:this.props.realtime,step:g=>this.actualIndex=g});this.lastIndex==null&&(this.lastIndex=null);this.animateStep=this._animator.make(this._types.number(0),{clock:e,realtime:this.props.realtime,step:g=>{this.playhead=g;return this.update()}});this.stops=this.props.stops!=null?this.props.stops:x(0,this.script.length,!1);this._listen("slide","slide.reset",g=>this.lastIndex=null);return this._listen("slide","slide.step",g=>{var f;let {duration:k}=this.props;const {delay:m,pace:p,speed:z,
playback:t,rewind:v,skip:y,trigger:B}=this.props,D=Math.max(0,Math.min(this.stops.length-1,g.index-B)),G=this.playhead,I=this.stops[D];if(this.lastIndex==null&&B)this.lastIndex=D,this.animateStep.set(I),this.animateIndex.set(D);else{var K=(f=this.actualIndex!=null?this.actualIndex:this.lastIndex)!=null?f:0;f=D-K;var Q=this.stops.slice(Math.min(K,D),Math.max(K,D)),O=0;K=Q.shift();for(const J of Array.from(Q))K===J&&O++,K=J;this.lastIndex=D;g=z*(g.step>=0?1:v);g*=y?Math.max(1,Math.abs(f)-O):1;k+=Math.abs(I-
G)*p/g;if(G!==I)return this.animateIndex.immediate(D,{delay:m,duration:k,ease:t}),this.animateStep.immediate(I,{delay:m,duration:k,ease:t})}})}made(){return this.update()}unmake(){this.animateIndex.dispose();this.animateStep.dispose();this.animateIndex=this.animateStep=null;return super.unmake()}change(e,g,f){return e["step.stops"]||e["step.realtime"]?this.rebuild():super.change(e,g,f)}}r.initClass()};
shadow$provide[301]=function(l,L,q){q=l(293);var x=l(296),r=l(297),e=l(298),g=l(299),f=l(300);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f)};
shadow$provide[302]=function(l,L,q){function x(e,g){return typeof e!=="undefined"&&e!==null?g(e):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},RTT:{enumerable:!0,get:function(){return r}}});l=l(189);class r extends l.Parent{static initClass(){this.traits="node root scene vertex texture rtt source index image".split(" ");this.defaults={minFilter:"linear",magFilter:"linear",type:"unsignedByte"}}init(){return this.rtt=this.scene=this.camera=this.width=this.height=this.history=
this.rootSize=this.size=null}indexShader(e){return e}imageShader(e){return this.rtt.shaderRelative(e)}sourceShader(e){return this.rtt.shaderAbsolute(e,this.history)}getDimensions(){return{items:1,width:this.width,height:this.height,depth:this.history}}getActiveDimensions(){return this.getDimensions()}make(){this.parentRoot=this._inherit("root");this.rootSize=this.parentRoot.getSize();this._listen(this.parentRoot,"root.pre",this.pre);this._listen(this.parentRoot,"root.update",this.update);this._listen(this.parentRoot,
"root.render",this.render);this._listen(this.parentRoot,"root.post",this.post);this._listen(this.parentRoot,"root.camera",this.setCamera);this._listen(this.parentRoot,"root.resize",function(y){return this.resize(y.size)});if(this.rootSize!=null){var {minFilter:e,magFilter:g,type:f}=this.props,{width:k,height:m,history:p,size:z}=this.props,t=z===this.node.attributes["rtt.size"].enum.relative;var v=t?this.rootSize.renderWidth:1;t=t?this.rootSize.renderHeight:1;this.width=Math.round(k!=null?k*v:this.rootSize.renderWidth);
this.height=Math.round(m!=null?m*t:this.rootSize.renderHeight);this.history=p;this.aspect=v=this.width/this.height;this.scene==null&&(this.scene=this._renderables.make("scene"));this.rtt=this._renderables.make("renderToTexture",{scene:this.scene,camera:this._context.defaultCamera,width:this.width,height:this.height,frames:this.history,minFilter:e,magFilter:g,type:f});v=k||m?v:this.rootSize.aspect;t=m!=null?m:this.rootSize.viewHeight;return this.size={renderWidth:this.width,renderHeight:this.height,
aspect:v,viewWidth:k!=null?k:this.rootSize.viewWidth,viewHeight:t,pixelRatio:this.height/t}}}made(){this.trigger({type:"source.rebuild"});if(this.size)return this.trigger({type:"root.resize",size:this.size})}unmake(e){if(this.rtt!=null)return this.rtt.dispose(),e||this.scene.dispose(),this.rtt=this.width=this.height=this.history=null}change(e,g,f){if(g.texture||e["rtt.width"]||e["rtt.height"])return this.rebuild();if(e["root.camera"]||f)return this._unattach(),this._attach(this.props.camera,"camera",
this.setCamera,this,this,!0),this.setCamera()}adopt(e){return Array.from(e.renders).map(g=>this.scene.add(g))}unadopt(e){return Array.from(e.renders).map(g=>this.scene.remove(g))}resize(e){let g,f;this.rootSize=e;({width:f,height:g,size:e}=this.props);e=e===this.node.attributes["rtt.size"].enum.relative;if(!this.rtt||f==null||g==null||e)return this.rebuild()}select(e){return this._root.node.model.select(e,[this.node])}watch(e,g){return this._root.node.model.watch(e,g)}unwatch(e){return this._root.node.model.unwatch(e)}pre(e){return this.trigger(e)}update(e){let g;
(g=this.getOwnCamera())!=null&&(g.aspect=this.aspect||1,g.updateProjectionMatrix());return this.trigger(e)}render(e){this.trigger(e);return this.rtt!=null?this.rtt.render(this.getCamera()):void 0}post(e){return this.trigger(e)}setCamera(){const e=x(this.select(this.props.camera)[0],g=>g.controller);if(this.camera!==e)return this.camera=e,this.rtt.camera=this.getCamera(),this.trigger({type:"root.camera"});if(!this.camera)return this.trigger({type:"root.camera"})}getOwnCamera(){return this.camera!=
null?this.camera.getCamera():void 0}getCamera(){let e;return(e=this.getOwnCamera())!=null?e:this._inherit("root").getCamera()}vertex(e,g){return g===2?e.pipe("view.position"):g===3?e.pipe("root.position"):e}}r.initClass()};
shadow$provide[303]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Compose:{enumerable:!0,get:function(){return x}}});l=l(188);class x extends l.Primitive{static initClass(){this.traits="node bind object visible operator style compose".split(" ");this.defaults={zWrite:!1,zTest:!1,color:"#ffffff"}}init(){return this.compose=null}resize(){if(this.compose&&this.bind.source){var r=this.bind.source.getActiveDimensions(),{width:e}=r;({height:r}=r);return this.remapUVScale.set(e,
r)}}make(){this._helpers.bind.make([{to:"operator.source",trait:"source"}]);if(this.bind.source!=null){var r={remapUVScale:this._attributes.make(this._types.vec2())};this.remapUVScale=r.remapUVScale.value;var e=this._shaders.shader(),{alpha:g}=this.props;this.bind.source.is("image")?(e.pipe("screen.pass.uv",r),e=this.bind.source.imageShader(e)):(e.pipe("screen.map.xy",r),e=this.bind.source.sourceShader(e));g||e.pipe("color.opaque");r=this._helpers.style.uniforms();this.compose=this._renderables.make("screen",
{map:e,uniforms:r,linear:!0});this._helpers.visible.make();return this._helpers.object.make([this.compose])}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();this._helpers.visible.unmake();return this._helpers.object.unmake()}change(r,e,g){if(r["operator.source"]||r["compose.alpha"])return this.rebuild()}}x.initClass()};
shadow$provide[304]=function(l,L,q){q=l(302);var x=l(303);l.exportCopy(L,q);l.exportCopy(L,x)};
shadow$provide[305]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},View:{enumerable:!0,get:function(){return x}}});l=l(269);class x extends l.Transform{static initClass(){this.traits=["node","object","visible","view","vertex"]}make(){return this._helpers.visible.make()}unmake(){return this._helpers.visible.unmake()}axis(r){return this.props.range[r-1]}}x.initClass()};
shadow$provide[306]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Cartesian:{enumerable:!0,get:function(){return r}}});var x=l(195);l=l(305);class r extends l.View{static initClass(){this.traits="node object visible view view3 vertex".split(" ")}make(){super.make();this.uniforms={viewMatrix:this._attributes.make(this._types.mat4())};this.viewMatrix=this.uniforms.viewMatrix.value;this.composer=x.transformComposer()}unmake(){super.unmake();delete this.viewMatrix;delete this.objectMatrix;
delete this.uniforms}change(e,g,f){if(g.view||g.view3||f){g=this.props.position;f=this.props.scale;var k=this.props.quaternion,m=this.props.rotation,p=this.props.range,z=this.props.eulerOrder,{x:t}=p[0],v=p[1].x,y=p[2].x,B=p[0].y-t||1,D=p[1].y-v||1;p=p[2].y-y||1;this.viewMatrix.set(2/B,0,0,-(2*t+B)/B,0,2/D,0,-(2*v+D)/D,0,0,2/p,-(2*y+p)/p,0,0,0,1);g=this.composer(g,m,k,f,null,z);this.viewMatrix.multiplyMatrices(g,this.viewMatrix);e["view.range"]&&this.trigger({type:"view.range"})}}vertex(e,g){g===
1&&e.pipe("cartesian.position",this.uniforms);return super.vertex(e,g)}}r.initClass()};
shadow$provide[307]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Cartesian4:{enumerable:!0,get:function(){return x}}});l=l(305);class x extends l.View{static initClass(){this.traits="node object visible view view4 vertex".split(" ")}make(){super.make();this.uniforms={basisOffset:this._attributes.make(this._types.vec4()),basisScale:this._attributes.make(this._types.vec4())};this.basisScale=this.uniforms.basisScale.value;return this.basisOffset=this.uniforms.basisOffset.value}unmake(){super.unmake();
delete this.basisScale;delete this.basisOffset;return delete this.uniforms}change(r,e,g){if(e.view||e.view4||g){e=this.props.position;g=this.props.scale;var f=this.props.range,{x:k}=f[0],m=f[1].x,p=f[2].x,z=f[3].x,t=f[0].y-k||1,v=f[1].y-m||1,y=f[2].y-p||1;f=f[3].y-z||1;var B=function(D,G){D.x*=G.x;D.y*=G.y;D.z*=G.z;return D.w*=G.w};this.basisScale.set(2/t,2/v,2/y,2/f);this.basisOffset.set(-(2*k+t)/t,-(2*m+v)/v,-(2*p+y)/y,-(2*z+f)/f);B(this.basisScale,g);B(this.basisOffset,g);this.basisOffset.add(e);
if(r["view.range"])return this.trigger({type:"view.range"})}}vertex(r,e){e===1&&r.pipe("cartesian4.position",this.uniforms);return super.vertex(r,e)}}x.initClass()};
shadow$provide[308]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Polar:{enumerable:!0,get:function(){return g}}});var x=l(242),r=l(195),e=l(101);l=l(305);class g extends l.View{static initClass(){this.traits="node object visible view view3 polar vertex".split(" ")}make(){super.make();const {types:f}=this._attributes;this.uniforms={polarBend:this.node.attributes["polar.bend"],polarHelix:this.node.attributes["polar.helix"],polarFocus:this._attributes.make(f.number()),
polarAspect:this._attributes.make(f.number()),viewMatrix:this._attributes.make(f.mat4())};this.viewMatrix=this.uniforms.viewMatrix.value;this.composer=r.transformComposer();return this.aspect=1}unmake(){super.unmake();delete this.viewMatrix;delete this.objectMatrix;delete this.aspect;return delete this.uniforms}change(f,k,m){var p;if(k.view||k.view3||k.polar||m){this.helix=this.props.helix;this.bend=p=this.props.bend;this.focus=m=p>0?1/p-1:0;var z=this.props.position,t=this.props.scale,v=this.props.quaternion,
y=this.props.rotation,B=this.props.range,D=this.props.eulerOrder,{x:G}=B[0],I=B[1].x,K=B[2].x,Q=B[0].y-G||1,O=B[1].y-I||1;B=B[2].y-K||1;var J=t.x;var W=t.y,ba=Q>0?1:-1;[I,O]=Array.from(x.recenterAxis(I,O,p));p=Q+(Math.abs(O)*ba-Q)*p;this.aspect=J=Math.abs(p/J/(O/W));this.uniforms.polarFocus.value=m;this.uniforms.polarAspect.value=J;this.viewMatrix.set(2/p,0,0,-(2*G+Q)/Q,0,2/O,0,-(2*I+O)/O,0,0,2/B,-(2*K+B)/B,0,0,0,1);m=this.composer(z,y,v,t,null,D);this.viewMatrix.multiplyMatrices(m,this.viewMatrix);
(f["view.range"]||k.polar)&&this.trigger({type:"view.range"})}}vertex(f,k){k===1&&f.pipe("polar.position",this.uniforms);return super.vertex(f,k)}axis(f){var k=this.props.range[f-1];let m=k.x;k=k.y;f===2&&this.bend>0&&(k=Math.max(Math.abs(k),Math.abs(m)),m=Math.max(-this.focus/this.aspect,m));return new e.Vector2(m,k)}}g.initClass()};
shadow$provide[309]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Spherical:{enumerable:!0,get:function(){return g}}});var x=l(242),r=l(195),e=l(101);l=l(305);class g extends l.View{static initClass(){this.traits="node object visible view view3 spherical vertex".split(" ")}make(){super.make();this.uniforms={sphericalBend:this.node.attributes["spherical.bend"],sphericalFocus:this._attributes.make(this._types.number()),sphericalAspectX:this._attributes.make(this._types.number()),
sphericalAspectY:this._attributes.make(this._types.number()),sphericalScaleY:this._attributes.make(this._types.number()),viewMatrix:this._attributes.make(this._types.mat4())};this.viewMatrix=this.uniforms.viewMatrix.value;this.composer=r.transformComposer();return this.aspectY=this.aspectX=1}unmake(){super.unmake();delete this.viewMatrix;delete this.objectMatrix;delete this.aspectX;delete this.aspectY;return delete this.uniforms}change(f,k,m){let p;if(k.view||k.view3||k.spherical||m){this.bend=m=
this.props.bend;this.focus=p=m>0?1/m-1:0;var z=this.props.position,t=this.props.scale,v=this.props.quaternion,y=this.props.rotation,B=this.props.range,D=this.props.eulerOrder,{x:G}=B[0],I=B[1].x,K=B[2].x,Q=B[0].y-G||1,O=B[1].y-I||1;B=B[2].y-K||1;var J=t.x;var W=t.y;var ba=t.z;[I,O]=Array.from(x.recenterAxis(I,O,m));[K,B]=Array.from(x.recenterAxis(K,B,m));var Y=Math.abs(B),S=Q+(Y*(Q>0?1:-1)-Q)*m;Y=O+(Y*(O>0?1:-1)-O)*m;var ca=B/ba;this.aspectX=ba=Math.abs(S/J/ca);this.aspectY=ca=Math.abs(Y/W/ca/ba);
this.scaleY=J=Math.min(ca/m,1+(O/Q*J/W*2-1)*m);this.uniforms.sphericalBend.value=m;this.uniforms.sphericalFocus.value=p;this.uniforms.sphericalAspectX.value=ba;this.uniforms.sphericalAspectY.value=ca;this.uniforms.sphericalScaleY.value=J;this.viewMatrix.set(2/S,0,0,-(2*G+Q)/Q,0,2/Y,0,-(2*I+O)/O,0,0,2/B,-(2*K+B)/B,0,0,0,1);m=this.composer(z,y,v,t,null,D);this.viewMatrix.multiplyMatrices(m,this.viewMatrix);if(f["view.range"]||k.spherical)return this.trigger({type:"view.range"})}}vertex(f,k){k===1&&
f.pipe("spherical.position",this.uniforms);return super.vertex(f,k)}axis(f){var k=this.props.range[f-1];let m=k.x;k=k.y;f===3&&this.bend>0&&(k=Math.max(Math.abs(k),Math.abs(m)),m=Math.max(-this.focus/this.aspectX+.001,m));return new e.Vector2(m,k)}}g.initClass()};
shadow$provide[310]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Stereographic:{enumerable:!0,get:function(){return e}}});var x=l(242),r=l(195);l=l(305);class e extends l.View{static initClass(){this.traits="node object visible view view3 stereographic vertex".split(" ")}make(){super.make();this.uniforms={stereoBend:this.node.attributes["stereographic.bend"],viewMatrix:this._attributes.make(this._types.mat4())};this.viewMatrix=this.uniforms.viewMatrix.value;return this.composer=
r.transformComposer()}unmake(){super.unmake();delete this.viewMatrix;delete this.rotationMatrix;return delete this.uniforms}change(g,f,k){if(f.view||f.view3||f.stereographic||k){this.bend=k=this.props.bend;var m=this.props.position,p=this.props.scale,z=this.props.quaternion,t=this.props.rotation,v=this.props.range,y=this.props.eulerOrder,{x:B}=v[0],D=v[1].x,G=v[2].x,I=v[0].y-B||1,K=v[1].y-D||1;v=v[2].y-G||1;[G,v]=Array.from(x.recenterAxis(G,v,k,1));this.uniforms.stereoBend.value=k;this.viewMatrix.set(2/
I,0,0,-(2*B+I)/I,0,2/K,0,-(2*D+K)/K,0,0,2/v,-(2*G+v)/v,0,0,0,1);k=this.composer(m,t,z,p,null,y);this.viewMatrix.multiplyMatrices(k,this.viewMatrix);if(g["view.range"]||f.stereographic)return this.trigger({type:"view.range"})}}vertex(g,f){f===1&&g.pipe("stereographic.position",this.uniforms);return super.vertex(g,f)}}e.initClass()};
shadow$provide[311]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Stereographic4:{enumerable:!0,get:function(){return r}}});var x=l(242);l=l(305);class r extends l.View{static initClass(){this.traits="node object visible view view4 stereographic vertex".split(" ")}make(){super.make();this.uniforms={basisOffset:this._attributes.make(this._types.vec4()),basisScale:this._attributes.make(this._types.vec4()),stereoBend:this.node.attributes["stereographic.bend"]};this.basisScale=
this.uniforms.basisScale.value;this.basisOffset=this.uniforms.basisOffset.value}unmake(){super.unmake();delete this.basisScale;delete this.basisOffset;delete this.uniforms}change(e,g,f){if(g.view||g.view4||g.stereographic||f){this.bend=f=this.props.bend;var k=this.props.position,m=this.props.scale,p=this.props.range,{x:z}=p[0],t=p[1].x,v=p[2].x,y=p[3].x,B=p[0].y-z||1,D=p[1].y-t||1,G=p[2].y-v||1;p=p[3].y-y||1;var I=function(K,Q){K.x*=Q.x;K.y*=Q.y;K.z*=Q.z;K.w*=Q.w};[y,p]=Array.from(x.recenterAxis(y,
p,f,1));this.basisScale.set(2/B,2/D,2/G,2/p);this.basisOffset.set(-(2*z+B)/B,-(2*t+D)/D,-(2*v+G)/G,-(2*y+p)/p);I(this.basisScale,m);I(this.basisOffset,m);this.basisOffset.add(k);(e["view.range"]||g.stereographic)&&this.trigger({type:"view.range"})}}vertex(e,g){g===1&&e.pipe("stereographic4.position",this.uniforms);return super.vertex(e,g)}}r.initClass()};
shadow$provide[312]=function(l,L,q){q=l(305);var x=l(306),r=l(307),e=l(308),g=l(309),f=l(310),k=l(311);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f);l.exportCopy(L,k)};
shadow$provide[313]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Shader:{enumerable:!0,get:function(){return r}}});var x=l(199);l=l(188);class r extends l.Primitive{static initClass(){this.traits=["node","bind","shader"];this.freeform=!0}init(){return this.shader=null}make(){const {language:e,code:g}=this.props;if(e!=="glsl")throw Error("GLSL required");this._helpers.bind.make([{to:"shader.sources",trait:"source",multiple:!0}]);var f=this._shaders.fetch(g);const k=
this._types,m={},p=z=>{switch(z){case "i":return k.int();case "f":return k.number();case "v2":return k.vec2();case "v3":return k.vec3();case "v4":return k.vec4();case "m3":return k.mat3();case "m4":return k.mat4();case "t":return k.object();default:return z=z.split(""),z.pop()==="v"?k.array(p(z.join(""))):null}};for(const z of Array.from(f._signatures.uniform))if(f=p(z.type))m[z.name]=f;return this.reconfigure({props:{uniform:m}})}made(){return this.trigger({type:"source.rebuild"})}unmake(){return this.shader=
null}change(e,g,f){if(e["shader.uniforms"]||e["shader.code"]||e["shader.language"])return this.rebuild()}shaderBind(e){let g,f;e==null&&(e={});const {code:k,indices:m,channels:p}=this.props;for(z in this.node.attributes)f=this.node.attributes[z],f.type!=null&&f.short!=null&&f.ns==="uniform"&&e[f.short]==null&&(e[f.short]=f);if((g=this.props.uniforms)!=null)for(z in g)f=g[z],e[z]=f;var z=this._shaders.shader();if(this.bind.sources!=null)for(const t of Array.from(this.bind.sources))z.callback(),m!=
4&&z.pipe(x.extendVec(m,4)),z.pipe(t.sourceShader(this._shaders.shader())),p!=4&&z.pipe(x.truncateVec(4,p)),z.join();return z.pipe(k,e)}}r.initClass()};
shadow$provide[314]=function(l,L,q){q=l(313);l.exportCopy(L,q)};
shadow$provide[315]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Classes:{enumerable:!0,get:function(){return v}}});L=l(194);q=l(197);var x=l(244),r=l(255),e=l(258),g=l(265),f=l(268),k=l(276),m=l(291),p=l(301),z=l(304),t=l(312);l=l(314);const v={axis:r.Axis,face:r.Face,grid:r.Grid,line:r.Line,point:r.Point,strip:r.Strip,surface:r.Surface,ticks:r.Ticks,vector:r.Vector,view:t.View,cartesian:t.Cartesian,cartesian4:t.Cartesian4,polar:t.Polar,spherical:t.Spherical,stereographic:t.Stereographic,
stereographic4:t.Stereographic4,transform:k.Transform3,transform4:k.Transform4,vertex:k.Vertex,fragment:k.Fragment,layer:k.Layer,mask:k.Mask,array:x.Array_,interval:x.Interval,matrix:x.Matrix,area:x.Area,voxel:x.Voxel,volume:x.Volume,scale:x.Scale,latch:x.Latch,html:e.HTML,dom:e.DOM,text:g.Text,format:g.Format,label:g.Label,retext:g.Retext,clamp:m.Clamp,grow:m.Grow,join:m.Join,lerp:m.Lerp,memo:m.Memo,readback:m.Readback,resample:m.Resample,repeat:m.Repeat,reverse:m.Reverse,swizzle:m.Swizzle,spread:m.Spread,
split:m.Split,slice:m.Slice,subdivide:m.Subdivide,transpose:m.Transpose,group:L.Group,inherit:L.Inherit,root:L.Root,unit:L.Unit,shader:l.Shader,camera:q.Camera,rtt:z.RTT,compose:z.Compose,clock:f.Clock,now:f.Now,move:p.Move,play:p.Play,present:p.Present,reveal:p.Reveal,slide:p.Slide,step:p.Step}};
shadow$provide[316]=function(l,L,q){function x(m,p,z){const t=[],v=m<p;for(p=z?v?p+1:p-1:p;v?m<p:m>p;v?m++:m--)t.push(m);return t}function r(m,p,z){if(typeof m!=="undefined"&&m!==null&&typeof m[p]==="function")return z(m,p)}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Types:{enumerable:!0,get:function(){return k}}});var e=l(198),g=l(245),f=l(101);const k=function(m){for(const p in m)m[p]=(z=>function(){const t=z.apply(z,arguments);t.validate==null&&(t.validate=v=>v!=null);t.equals==
null&&(t.equals=(v,y)=>v===y);t.clone==null&&(t.clone=function(v){let y;return(y=r(v,"clone",B=>B.clone()))!=null?y:v});return t})(m[p]);return m}({array(m,p,z=null){const t=m.lerp?function(y,B,D,G){const I=Math.min(y.length,B.length);for(let K=0,Q=I,O=0<=Q;O?K<Q:K>Q;O?K++:K--)D[K]=m.lerp(y[K],B[K],D[K],G);return D}:void 0,v=m.op?function(y,B,D,G){const I=Math.min(y.length,B.length);for(let K=0,Q=I,O=0<=Q;O?K<Q:K>Q;O?K++:K--)D[K]=m.op(y[K],B[K],D[K],G);return D}:void 0;z==null||z instanceof Array||
(z=[z]);return{uniform(){if(m.uniform)return m.uniform()+"v"},make(){return z!=null?z.slice():p?x(0,p,!1).map(y=>m.make()):[]},validate(y,B,D){y instanceof Array||(y=[y]);var G=B.length=p?p:y.length;for(let I=0,K=G,Q=0<=K;Q?I<K:I>K;Q?I++:I--)G=y[I]!=null?y[I]:m.make(),B[I]=m.validate(G,B[I],D);return B},equals(y,B){var D=y.length;const G=B.length;if(D!==G)return!1;D=Math.min(D,G);for(let I=0,K=D,Q=0<=K;Q?I<K:I>K;Q?I++:I--)if(typeof m.equals!=="function"||!m.equals(y[I],B[I]))return!1;return!0},lerp:t,
op:v,clone(y){return Array.from(y).map(B=>m.clone(B))}}},letters(m,p,z=null){if(z!=null){z===""+z&&(z=z.split(""));for(let v=0;v<z.length;v++){const y=z[v];z[v]=m.validate(y,y)}}const t=k.array(m,p,z);return{uniform(){return t.uniform()},make(){return t.make()},validate(v,y,B){v===""+v&&(v=v.split(""));return t.validate(v,y,B)},equals(v,y){return t.equals(v,y)},clone:t.clone}},nullable(m,p){p==null&&(p=!1);let z=p?m.make():null;return{make(){return z},validate(t,v,y){if(t===null)return t;v===null&&
(v=m.make());return m.validate(t,v,y)},uniform(){return typeof m.uniform==="function"?m.uniform():void 0},equals(t,v){let y;const B=t===null,D=v===null;return B&&D?!0:B^D?!1:(y=typeof m.equals==="function"?m.equals(t,v):void 0)!=null?y:t===v},lerp:m.lerp?function(t,v,y,B){if(t===null||v===null)return B<.5?t:v;y==null&&(y=m.make());z=m.lerp(t,v,y,B);return y}:void 0,op:m.op?function(t,v,y,B){if(t===null||v===null)return null;y==null&&(y=m.make());return z=m.op(t,v,y,B)}:void 0,emitter:m.emitter?function(t,
v){return v==null?t:t==null?v:m.emitter(t,v)}:void 0}},enum(m,p,z){let t;p==null&&(p=[]);z==null&&(z={});let v=0;const y={};for(t of Array.from(p))t!==+t&&z[t]==null&&(z[t]=v++);for(t of Array.from(p))t===+t&&(y[t]=t);for(t in z)v=z[t],y[v]=!0;y[m]==null&&(m=z[m]);return{enum(){return z},make(){return m},validate(B,D,G){B=y[B]?B:z[B];return B!=null?B:G()}}},enumber(m,p,z){z==null&&(z={});const t=k.enum(m,p,z);return{enum:t.enum,uniform(){return"f"},make(){let v;return(v=t.make())!=null?v:+m},validate(v,
y,B){return v===+v?v:t.validate(v,y,B)},op(v,y,B,D){return D(v,y)}}},select(m){m==null&&(m="\x3c");m;return{make(){return m},validate(p,z,t){return typeof p==="string"||typeof p==="object"?p:t()}}},bool(m){m=!!m;return{uniform(){return"f"},make(){return m},validate(p,z,t){return!!p}}},int(m){m==null&&(m=0);m=+Math.round(m);return{uniform(){return"i"},make(){return m},validate(p,z,t){let v;return p!==(v=+p)?t():Math.round(v)||0},op(p,z,t,v){return v(p,z)}}},round(m){m==null&&(m=0);m=+Math.round(m);
return{uniform(){return"f"},make(){return m},validate(p,z,t){let v;return p!==(v=+p)?t():Math.round(v)||0},op(p,z,t,v){return v(p,z)}}},number(m){m==null&&(m=0);return{uniform(){return"f"},make(){return+m},validate(p,z,t){let v;return p!==(v=+p)?t():v||0},op(p,z,t,v){return v(p,z)}}},positive(m,p){p==null&&(p=!1);return{uniform:m.uniform,make:m.make,validate(z,t,v){z=m.validate(z,t,v);return z<0||p&&z<=0?v():z},op(z,t,v,y){return y(z,t)}}},string(m){m==null&&(m="");return{make(){return""+m},validate(p,
z,t){let v;return p!==(v=""+p)?t():v}}},func(){return{make(){return function(){}},validate(m,p,z){return typeof m==="function"?m:z()}}},emitter(){return{make(){return m=>m(1,1,1,1)},validate(m,p,z){return typeof m==="function"?m:z()},emitter(m,p){return e.getLerpEmitter(m,p)}}},object(m){return{make(){return m!=null?m:{}},validate(p,z,t){return typeof p==="object"?p:t()},clone(p){return JSON.parse(JSON.stringify(p))}}},timestamp(m=null){typeof m==="string"&&(m=Date.parse(m));return{uniform(){return"f"},
make(){return m!=null?m:+new Date},validate(p,z,t){p=Date.parse(p);return p!==+p?t():p},op(p,z,t,v){return v(p,z)}}},vec2(m,p){m==null&&(m=0);p==null&&(p=0);const z=[m,p];return{uniform(){return"v2"},make(){return new f.Vector2(m,p)},validate(t,v,y){t===+t&&(t=[t]);if(t===null||t===void 0?0:t.isVector2)v.copy(t);else if(t instanceof Array)t=t.concat(z.slice(t.length)),v.set.apply(v,t);else if(t!=null)v.set(t.x!=null?t.x:m,t.y!=null?t.y:p);else return y();return v},equals(t,v){return t.x===v.x&&t.y===
v.y},op(t,v,y,B){y.x=B(t.x,v.x);y.y=B(t.y,v.y);return y}}},ivec2(m,p){m==null&&(m=0);p==null&&(p=0);m=k.vec2(m,p);const {validate:z}=m;m.validate=function(t,v,y){z(t,v,y);v.x=Math.round(v.x);v.y=Math.round(v.y);return v};return m},vec3(m,p,z){m==null&&(m=0);p==null&&(p=0);z==null&&(z=0);const t=[m,p,z];return{uniform(){return"v3"},make(){return new f.Vector3(m,p,z)},validate(v,y,B){v===+v&&(v=[v]);if(v===null||v===void 0?0:v.isVector3)y.copy(v);else if(v instanceof Array)v=v.concat(t.slice(v.length)),
y.set.apply(y,v);else if(v!=null)y.set(v.x!=null?v.x:m,v.y!=null?v.y:p,v.z!=null?v.z:z);else return B();return y},equals(v,y){return v.x===y.x&&v.y===y.y&&v.z===y.z},op(v,y,B,D){B.x=D(v.x,y.x);B.y=D(v.y,y.y);B.z=D(v.z,y.z);return B}}},ivec3(m,p,z){m==null&&(m=0);p==null&&(p=0);z==null&&(z=0);m=k.vec3(m,p,z);const {validate:t}=m;m.validate=function(v,y,B){t(v,y,B);y.x=Math.round(y.x);y.y=Math.round(y.y);y.z=Math.round(y.z);return y};return m},vec4(m,p,z,t){m==null&&(m=0);p==null&&(p=0);z==null&&(z=
0);t==null&&(t=0);const v=[m,p,z,t];return{uniform(){return"v4"},make(){return new f.Vector4(m,p,z,t)},validate(y,B,D){y===+y&&(y=[y]);if(y===null||y===void 0?0:y.isVector4)B.copy(y);else if(y instanceof Array)y=y.concat(v.slice(y.length)),B.set.apply(B,y);else if(y!=null)B.set(y.x!=null?y.x:m,y.y!=null?y.y:p,y.z!=null?y.z:z,y.w!=null?y.w:t);else return D();return B},equals(y,B){return y.x===B.x&&y.y===B.y&&y.z===B.z&&y.w===B.w},op(y,B,D,G){D.x=G(y.x,B.x);D.y=G(y.y,B.y);D.z=G(y.z,B.z);D.w=G(y.w,B.w);
return D}}},ivec4(m,p,z,t){m==null&&(m=0);p==null&&(p=0);z==null&&(z=0);t==null&&(t=0);m=k.vec4(m,p,z,t);const {validate:v}=m;m.validate=function(y,B,D){v(y,B,D);B.x=Math.round(B.x);B.y=Math.round(B.y);B.z=Math.round(B.z);B.w=Math.round(B.w);return B};return m},mat3(m,p,z,t,v,y,B,D,G){m==null&&(m=1);p==null&&(p=0);z==null&&(z=0);t==null&&(t=0);v==null&&(v=1);y==null&&(y=0);B==null&&(B=0);D==null&&(D=0);G==null&&(G=1);const I=[m,p,z,t,v,y,B,D,G];return{uniform(){return"m4"},make(){const K=new f.Matrix3;
K.set(m,p,z,t,v,y,B,D,G);return K},validate(K,Q,O){if(K===null||K===void 0?0:K.isMatrix3)Q.copy(K);else if(K instanceof Array)K=K.concat(I.slice(K.length)),Q.set.apply(Q,K);else return O();return Q}}},mat4(m,p,z,t,v,y,B,D,G,I,K,Q,O,J,W,ba){m==null&&(m=1);p==null&&(p=0);z==null&&(z=0);t==null&&(t=0);v==null&&(v=0);y==null&&(y=1);B==null&&(B=0);D==null&&(D=0);G==null&&(G=0);I==null&&(I=0);K==null&&(K=1);Q==null&&(Q=0);O==null&&(O=0);J==null&&(J=0);W==null&&(W=0);ba==null&&(ba=1);const Y=[m,p,z,t,v,
y,B,D,G,I,K,Q,O,J,W,ba];return{uniform(){return"m4"},make(){const S=new f.Matrix4;S.set(m,p,z,t,v,y,B,D,G,I,K,Q,O,J,W,ba);return S},validate(S,ca,V){if(S===null||S===void 0?0:S.isMatrix4)ca.copy(S);else if(S instanceof Array)S=S.concat(Y.slice(S.length)),ca.set.apply(ca,S);else return V();return ca}}},quat(m,p,z,t){m==null&&(m=0);p==null&&(p=0);z==null&&(z=0);t==null&&(t=1);const v=k.vec4(m,p,z,t);return{uniform(){return"v4"},make(){return new f.Quaternion},validate(y,B,D){(y===null||y===void 0?0:
y.isQuaternion)?B.copy(y):B=v.validate(y,B,D);B.normalize();return B},equals(y,B){return y.x===B.x&&y.y===B.y&&y.z===B.z&&y.w===B.w},op(y,B,D,G){D.x=G(y.x,B.x);D.y=G(y.y,B.y);D.z=G(y.z,B.z);D.w=G(y.w,B.w);D.normalize();return D},lerp(y,B,D,G){D.slerpQuaternions?D.slerpQuaternions(y,B,G):f.Quaternion.slerp(y,B,D,G);return D}}},color(m,p,z){m==null&&(m=.5);p==null&&(p=.5);z==null&&(z=.5);const t=[m,p,z];return{uniform(){return"c"},make(){return new f.Color(m,p,z)},validate(v,y,B){v===""+v?v=(new f.Color).setStyle(v):
v===+v&&(v=new f.Color(v));if(v===null||v===void 0?0:v.isColor)y.copy(v);else if(v instanceof Array)v=v.concat(t.slice(v.length)),y.setRGB.apply(y,v);else if(v!=null)y.set(v.r!=null?v.r:m,v.g!=null?v.g:p,v.b!=null?v.b:z);else return B();return y},equals(v,y){return v.r===y.r&&v.g===y.g&&v.b===y.b},op(v,y,B,D){B.r=D(v.r,y.r);B.g=D(v.g,y.g);B.b=D(v.b,y.b);return B}}},axis(m,p){let z;m==null&&(m=1);p==null&&(p=!1);const t={x:1,y:2,z:3,w:4,W:1,H:2,D:3,I:4,zero:0,null:0,width:1,height:2,depth:3,items:4},
v=p?[0,1,2,3,4]:[1,2,3,4];(z=t[m])!=null&&(m=z);return{make(){return m},validate(y,B,D){let G;(z=t[y])!=null&&(y=z);y=(G=Math.round(y))!=null?G:0;return Array.from(v).includes(y)?y:D()}}},transpose(m){m==null&&(m=[1,2,3,4]);const p=k.letters(k.axis(null,!1),0,m),z=k.letters(k.axis(null,!1),4,m);return{make(){return z.make()},validate(t,v,y){let B=[1,2,3,4];p.validate(t,B,y);B.length<4&&(t=[1,2,3,4].filter(D=>B.indexOf(D)===-1),B=B.concat(t));return Array.from(B).map((D,G)=>B.indexOf(D)===G).indexOf(!1)<
0?z.validate(B,v,y):y()},equals:z.equals,clone:z.clone}},swizzle(m,p=null){m==null&&(m=[1,2,3,4]);p==null&&(p=m.length);m=m.slice(0,p);const z=k.letters(k.axis(null,!1),0,m),t=k.letters(k.axis(null,!0),p,m);return{make(){return t.make()},validate(v,y,B){let D=m.slice();z.validate(v,D,B);D.length<p&&(D=D.concat([0,0,0,0]).slice(0,p));return t.validate(D,y,B)},equals:t.equals,clone:t.clone}},classes(){const m=k.array(k.string());return{make(){return m.make()},validate(p,z,t){p===""+p&&(p=p.split(" "));
p=p.filter(v=>!!v.length);return m.validate(p,z,t)},equals:m.equals,clone:m.clone}},blending(m){m==null&&(m="normal");return k.enum(m,"no normal add subtract multiply custom".split(" "))},filter(m){m==null&&(m="nearest");return k.enum(m,[],{nearest:f.NearestFilter,nearestMipMapNearest:f.NearestMipMapNearestFilter,nearestMipMapLinear:f.NearestMipMapLinearFilter,linear:f.LinearFilter,linearMipMapNearest:f.LinearMipMapNearestFilter,linearMipmapLinear:f.LinearMipMapLinearFilter})},type(m){m==null&&(m=
"unsignedByte");return k.enum(m,[],{unsignedByte:f.UnsignedByteType,byte:f.ByteType,short:f.ShortType,unsignedShort:f.UnsignedShortType,int:f.IntType,unsignedInt:f.UnsignedIntType,float:f.FloatType})},scale(m){m==null&&(m="linear");return k.enum(m,["linear","log"])},mapping(m){m==null&&(m="relative");return k.enum(m,["relative","absolute"])},indexing(m){m==null&&(m="original");return k.enum(m,["original","final"])},shape(m){m==null&&(m="circle");return k.enum(m,"circle square diamond up down left right".split(" "))},
join(m){m==null&&(m="miter");return k.enum(m,["miter","round","bevel"])},stroke(m){m==null&&(m="solid");return k.enum(m,["solid","dotted","dashed"])},vertexPass(m){m==null&&(m="view");return k.enum(m,["data","view","world","eye"])},fragmentPass(m){m==null&&(m="light");return k.enum(m,["color","light","rgba"])},ease(m){m==null&&(m="linear");return k.enum(m,["linear","cosine","binary","hold"])},fit(m){m==null&&(m="contain");return k.enum(m,["x","y","contain","cover"])},anchor(m){m==null&&(m="middle");
return k.enumber(m,[],{first:1,middle:0,last:-1})},transitionState(m){m==null&&(m="enter");return k.enumber(m,[],{enter:-1,visible:0,exit:1})},font(m){m==null&&(m="sans-serif");const p=g.parseQuoted;m instanceof Array||(m=p(m));const z=k.array(k.string(),0,m);return{make(){return z.make()},validate(t,v,y){try{t instanceof Array||(t=p(t))}catch(B){return y()}t=t.filter(B=>!!B.length);return z.validate(t,v,y)},equals:z.equals,clone:z.clone}},data(m){m==null&&(m=[]);return{make(){return[]},validate(p,
z,t){return p instanceof Array?p:(p!=null?p.length:void 0)!=null?p:t()},emitter(p,z){return e.getLerpThunk(p,z)}}}})};
shadow$provide[317]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Types:{enumerable:!0,get:function(){return x}}});const x=l(316).Types};
shadow$provide[318]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Traits:{enumerable:!0,get:function(){return x}}});l=l(317);const x={node:{id:l.Types.nullable(l.Types.string()),classes:l.Types.classes()},entity:{active:l.Types.bool(!0)},object:{visible:l.Types.bool(!0)},latch:{data:l.Types.nullable(l.Types.object()),deep:l.Types.nullable(l.Types.bool(!0))},unit:{scale:l.Types.nullable(l.Types.number()),fov:l.Types.nullable(l.Types.number()),focus:l.Types.nullable(l.Types.number(1),
!0)},span:{range:l.Types.nullable(l.Types.vec2(-1,1))},view:{range:l.Types.array(l.Types.vec2(-1,1),4)},view3:{position:l.Types.vec3(),quaternion:l.Types.quat(),rotation:l.Types.vec3(),scale:l.Types.vec3(1,1,1),eulerOrder:l.Types.swizzle("xyz")},view4:{position:l.Types.vec4(),scale:l.Types.vec4(1,1,1,1)},layer:{depth:l.Types.number(1),fit:l.Types.fit("y")},vertex:{pass:l.Types.vertexPass()},fragment:{pass:l.Types.fragmentPass(),gamma:l.Types.bool(!1)},transform3:{position:l.Types.vec3(),quaternion:l.Types.quat(),
rotation:l.Types.vec3(),eulerOrder:l.Types.swizzle("xyz"),scale:l.Types.vec3(1,1,1),matrix:l.Types.mat4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},transform4:{position:l.Types.vec4(),scale:l.Types.vec4(1,1,1,1),matrix:l.Types.mat4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},camera:{proxy:l.Types.bool(!1),position:l.Types.nullable(l.Types.vec3()),quaternion:l.Types.nullable(l.Types.quat()),rotation:l.Types.nullable(l.Types.vec3()),lookAt:l.Types.nullable(l.Types.vec3()),up:l.Types.nullable(l.Types.vec3()),eulerOrder:l.Types.swizzle("xyz"),
fov:l.Types.nullable(l.Types.number(1))},polar:{bend:l.Types.number(1),helix:l.Types.number(0)},spherical:{bend:l.Types.number(1)},stereographic:{bend:l.Types.number(1)},interval:{axis:l.Types.axis()},area:{axes:l.Types.swizzle([1,2],2)},volume:{axes:l.Types.swizzle([1,2,3],3)},origin:{origin:l.Types.vec4()},scale:{divide:l.Types.number(10),unit:l.Types.number(1),base:l.Types.number(10),mode:l.Types.scale(),start:l.Types.bool(!0),end:l.Types.bool(!0),zero:l.Types.bool(!0),factor:l.Types.positive(l.Types.number(1)),
nice:l.Types.bool(!0)},grid:{lineX:l.Types.bool(!0),lineY:l.Types.bool(!0),crossed:l.Types.bool(!1),closedX:l.Types.bool(!1),closedY:l.Types.bool(!1)},axis:{detail:l.Types.int(1),crossed:l.Types.bool(!1)},data:{data:l.Types.nullable(l.Types.data()),expr:l.Types.nullable(l.Types.emitter()),bind:l.Types.nullable(l.Types.func()),live:l.Types.bool(!0)},buffer:{channels:l.Types.enum(4,[1,2,3,4]),items:l.Types.int(1),fps:l.Types.nullable(l.Types.int(60)),hurry:l.Types.int(5),limit:l.Types.int(60),realtime:l.Types.bool(!1),
observe:l.Types.bool(!1),aligned:l.Types.bool(!1)},sampler:{centered:l.Types.bool(!1),padding:l.Types.number(0)},array:{width:l.Types.nullable(l.Types.positive(l.Types.int(1),!0)),bufferWidth:l.Types.int(1),history:l.Types.int(1)},matrix:{width:l.Types.nullable(l.Types.positive(l.Types.int(1),!0)),height:l.Types.nullable(l.Types.positive(l.Types.int(1),!0)),history:l.Types.int(1),bufferWidth:l.Types.int(1),bufferHeight:l.Types.int(1)},voxel:{width:l.Types.nullable(l.Types.positive(l.Types.int(1),
!0)),height:l.Types.nullable(l.Types.positive(l.Types.int(1),!0)),depth:l.Types.nullable(l.Types.positive(l.Types.int(1),!0)),bufferWidth:l.Types.int(1),bufferHeight:l.Types.int(1),bufferDepth:l.Types.int(1)},resolve:{expr:l.Types.nullable(l.Types.func()),items:l.Types.int(1)},style:{opacity:l.Types.positive(l.Types.number(1)),color:l.Types.color(),blending:l.Types.blending(),zWrite:l.Types.bool(!0),zTest:l.Types.bool(!0),zIndex:l.Types.positive(l.Types.round()),zBias:l.Types.number(0),zOrder:l.Types.nullable(l.Types.int())},
geometry:{points:l.Types.select(),colors:l.Types.nullable(l.Types.select())},point:{size:l.Types.positive(l.Types.number(4)),sizes:l.Types.nullable(l.Types.select()),shape:l.Types.shape(),optical:l.Types.bool(!0),fill:l.Types.bool(!0),depth:l.Types.number(1)},line:{width:l.Types.positive(l.Types.number(2)),depth:l.Types.positive(l.Types.number(1)),join:l.Types.join(),stroke:l.Types.stroke(),proximity:l.Types.nullable(l.Types.number(Infinity)),closed:l.Types.bool(!1)},mesh:{fill:l.Types.bool(!0),shaded:l.Types.bool(!1),
normals:l.Types.nullable(l.Types.select()),map:l.Types.nullable(l.Types.select()),lineBias:l.Types.number(5)},strip:{line:l.Types.bool(!1)},face:{line:l.Types.bool(!1)},arrow:{size:l.Types.number(3),start:l.Types.bool(!1),end:l.Types.bool(!1)},ticks:{normal:l.Types.vec3(0,0,1),size:l.Types.positive(l.Types.number(10)),epsilon:l.Types.positive(l.Types.number(.001))},attach:{offset:l.Types.vec2(0,-20),snap:l.Types.bool(!1),depth:l.Types.number(0)},format:{digits:l.Types.nullable(l.Types.positive(l.Types.number(3))),
data:l.Types.nullable(l.Types.data()),expr:l.Types.nullable(l.Types.func()),live:l.Types.bool(!0)},font:{font:l.Types.font("sans-serif"),style:l.Types.string(),variant:l.Types.string(),weight:l.Types.string(),detail:l.Types.number(24),sdf:l.Types.number(5)},label:{text:l.Types.select(),size:l.Types.number(16),outline:l.Types.number(2),expand:l.Types.number(0),background:l.Types.color(1,1,1)},overlay:{opacity:l.Types.number(1),zIndex:l.Types.positive(l.Types.round(0))},dom:{points:l.Types.select(),
html:l.Types.select(),size:l.Types.number(16),outline:l.Types.number(2),zoom:l.Types.number(1),color:l.Types.nullable(l.Types.color()),attributes:l.Types.nullable(l.Types.object()),pointerEvents:l.Types.bool(!1)},texture:{minFilter:l.Types.filter("nearest"),magFilter:l.Types.filter("nearest"),type:l.Types.type("float")},shader:{sources:l.Types.nullable(l.Types.select()),indices:l.Types.number(4),channels:l.Types.number(4),language:l.Types.string("glsl"),code:l.Types.string(),uniforms:l.Types.nullable(l.Types.object())},
include:{shader:l.Types.select()},operator:{source:l.Types.select()},spread:{unit:l.Types.mapping(),items:l.Types.nullable(l.Types.vec4()),width:l.Types.nullable(l.Types.vec4()),height:l.Types.nullable(l.Types.vec4()),depth:l.Types.nullable(l.Types.vec4()),alignItems:l.Types.anchor(),alignWidth:l.Types.anchor(),alignHeight:l.Types.anchor(),alignDepth:l.Types.anchor()},grow:{scale:l.Types.number(1),items:l.Types.nullable(l.Types.anchor()),width:l.Types.nullable(l.Types.anchor()),height:l.Types.nullable(l.Types.anchor()),
depth:l.Types.nullable(l.Types.anchor())},split:{order:l.Types.transpose("wxyz"),axis:l.Types.nullable(l.Types.axis()),length:l.Types.int(1),overlap:l.Types.int(0)},join:{order:l.Types.transpose("wxyz"),axis:l.Types.nullable(l.Types.axis()),overlap:l.Types.int(0)},swizzle:{order:l.Types.swizzle()},transpose:{order:l.Types.transpose()},repeat:{items:l.Types.number(1),width:l.Types.number(1),height:l.Types.number(1),depth:l.Types.number(1)},slice:{items:l.Types.nullable(l.Types.vec2()),width:l.Types.nullable(l.Types.vec2()),
height:l.Types.nullable(l.Types.vec2()),depth:l.Types.nullable(l.Types.vec2())},reverse:{items:l.Types.bool(!1),width:l.Types.bool(!1),height:l.Types.bool(!1),depth:l.Types.bool(!1)},lerp:{size:l.Types.mapping("absolute"),items:l.Types.nullable(l.Types.number()),width:l.Types.nullable(l.Types.number()),height:l.Types.nullable(l.Types.number()),depth:l.Types.nullable(l.Types.number())},subdivide:{items:l.Types.nullable(l.Types.positive(l.Types.int(),!0)),width:l.Types.nullable(l.Types.positive(l.Types.int(),
!0)),height:l.Types.nullable(l.Types.positive(l.Types.int(),!0)),depth:l.Types.nullable(l.Types.positive(l.Types.int(),!0)),bevel:l.Types.number(1),lerp:l.Types.bool(!0)},resample:{indices:l.Types.number(4),channels:l.Types.number(4),sample:l.Types.mapping(),size:l.Types.mapping("absolute"),items:l.Types.nullable(l.Types.number()),width:l.Types.nullable(l.Types.number()),height:l.Types.nullable(l.Types.number()),depth:l.Types.nullable(l.Types.number())},readback:{type:l.Types.type("float"),expr:l.Types.nullable(l.Types.func()),
data:l.Types.data(),channels:l.Types.enum(4,[1,2,3,4]),items:l.Types.nullable(l.Types.int()),width:l.Types.nullable(l.Types.int()),height:l.Types.nullable(l.Types.int()),depth:l.Types.nullable(l.Types.int())},root:{speed:l.Types.number(1),camera:l.Types.select("[camera]")},inherit:{source:l.Types.select(),traits:l.Types.array(l.Types.string())},rtt:{size:l.Types.mapping("absolute"),width:l.Types.nullable(l.Types.number()),height:l.Types.nullable(l.Types.number()),history:l.Types.int(1)},compose:{alpha:l.Types.bool(!1)},
present:{index:l.Types.int(1),directed:l.Types.bool(!0),length:l.Types.number(0)},slide:{order:l.Types.nullable(l.Types.int(0)),steps:l.Types.number(1),early:l.Types.int(0),late:l.Types.int(0),from:l.Types.nullable(l.Types.int(0)),to:l.Types.nullable(l.Types.int(1))},transition:{stagger:l.Types.vec4(),enter:l.Types.nullable(l.Types.number(1)),exit:l.Types.nullable(l.Types.number(1)),delay:l.Types.number(0),delayEnter:l.Types.nullable(l.Types.number(0)),delayExit:l.Types.nullable(l.Types.number(0)),
duration:l.Types.number(.3),durationEnter:l.Types.nullable(l.Types.number(0)),durationExit:l.Types.nullable(l.Types.number(0))},move:{from:l.Types.vec4(),to:l.Types.vec4()},seek:{seek:l.Types.nullable(l.Types.number(0))},track:{target:l.Types.select(),script:l.Types.object({}),ease:l.Types.ease("cosine")},trigger:{trigger:l.Types.nullable(l.Types.int(1),!0)},step:{playback:l.Types.ease("linear"),stops:l.Types.nullable(l.Types.array(l.Types.number())),delay:l.Types.number(0),duration:l.Types.number(.3),
pace:l.Types.number(0),speed:l.Types.number(1),rewind:l.Types.number(2),skip:l.Types.bool(!0),realtime:l.Types.bool(!1)},play:{delay:l.Types.number(0),pace:l.Types.number(1),speed:l.Types.number(1),from:l.Types.number(0),to:l.Types.number(Infinity),realtime:l.Types.bool(!1),loop:l.Types.bool(!1)},now:{now:l.Types.nullable(l.Types.timestamp()),seek:l.Types.nullable(l.Types.number(0)),pace:l.Types.number(1),speed:l.Types.number(1)}}};
shadow$provide[319]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},linear:{enumerable:!0,get:function(){return x}},log:{enumerable:!0,get:function(){return r}},make:{enumerable:!0,get:function(){return e}}});const x=function(g,f,k,m,p,z,t,v,y,B){let D,G;B==null&&(B=!0);k||(k=10);m||(m=1);p||(p=10);z||(z=1);const I=(f-g)/k;if(!B)return f=(()=>{let W,ba;const Y=[];D=0;ba=k;for(W=0<=ba;W?D<=ba:D>=ba;W?D++:D--)Y.push(g+D*I);return Y})(),t||f.shift(),v||f.pop(),y||(f=f.filter(W=>
W!==0)),f;m||(m=1);p||(p=10);const K=m*Math.pow(p,Math.floor(Math.log(I/m)/Math.log(p))),Q=p%2===0?[p/2,1,.5]:p%3===0?[p/3,1,1/3]:[1];m=(()=>{const W=[];for(G of Array.from(Q))W.push(K*G);return W})();let O=Infinity,J=m.reduce(function(W,ba){G=ba/I;const Y=Math.max(G,1/G);return Y<O?(O=Y,ba):W},K);J*=z;g=Math.ceil(g/J+ +!t)*J;f=(Math.floor(f/J)-+!v)*J;k=Math.ceil((f-g)/J);f=(()=>{let W,ba;const Y=[];D=0;ba=k;for(W=0<=ba;W?D<=ba:D>=ba;W?D++:D--)Y.push(g+D*J);return Y})();y||(f=f.filter(W=>W!==0));
return f},r=function(g,f,k,m,p,z,t,v,y,B){throw Error("Log ticks not yet implemented.");},e=function(g,f,k,m,p,z,t,v,y,B,D){switch(g){case 0:return x(f,k,m,p,z,t,v,y,B,D);case 1:return r(f,k,m,p,z,t,v,y,B,D)}}};
shadow$provide[320]=function(l,L,q){function x(m,p){return typeof m!=="undefined"&&m!==null?p(m):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Helpers:{enumerable:!0,get:function(){return k}}});var r=l(199),e=l(319),g=l(101);const f={bind:{make(m){this.bind==null&&(this.bind={});this.bound==null&&(this.bound=[]);for(const z of Array.from(m)){({callback:m}=z);const {to:t,trait:v,optional:y,unique:B,multiple:D}=z;m==null&&(m=this.rebuild);const G=t.split(/\./g).pop(),I=this._get(t);
let K=null;if(I!=null){let Q=this;for(var p=!1;!p;)Q=K=this._attach(I,v,m,this,Q,y,D),p=B&&(K==null||this.bound.indexOf(K)<0),p=D||y||!B||p}if(K!=null)if(this.resize!=null&&this._listen(K,"source.resize",this.resize),m&&this._listen(K,"source.rebuild",m),D)for(const Q of Array.from(K))this.bound.push(Q);else this.bound.push(K);this.bind[G]=K}return null},unmake(){if(this.bind)return delete this.bind,delete this.bound}},span:{make(){this.spanView=this._inherit("view");return this._listen("view","view.range",
()=>this.trigger({type:"span.range"}))},unmake(){return delete this.spanView},get:function(){const m=new g.Vector2(-1,1);return function(p,z){let t;p=this._get(p+"span.range");return p!=null?p:(t=this.spanView!=null?this.spanView.axis(z):void 0)!=null?t:m}}()},scale:{divide(m){const p=this._get(m+"scale.divide");m=this._get(m+"scale.factor");return Math.round(p*2.5/m)},generate(m,p,z,t){const v=this._get(m+"scale.mode"),y=this._get(m+"scale.divide"),B=this._get(m+"scale.unit"),D=this._get(m+"scale.base"),
G=this._get(m+"scale.factor"),I=this._get(m+"scale.start"),K=this._get(m+"scale.end"),Q=this._get(m+"scale.zero");m=this._get(m+"scale.nice");z=e.make(v,z,t,y,B,D,G,I,K,Q,m);p.copy(z);return z}},style:{uniforms(){return{styleColor:this.node.attributes["style.color"],styleOpacity:this.node.attributes["style.opacity"],styleZBias:this.node.attributes["style.zBias"],styleZIndex:this.node.attributes["style.zIndex"]}}},arrow:{uniforms(){var {start:m}=this.props,{end:p}=this.props;const z=this._attributes.make(this._types.number(1.25/
(m+p)));m=this._attributes.make(this._types.vec2(+m,+p));p=this.node.attributes["arrow.size"];return{clipStyle:m,clipRange:p,clipSpace:z,arrowSpace:z,arrowSize:p}}},point:{uniforms(){return{pointSize:this.node.attributes["point.size"],pointDepth:this.node.attributes["point.depth"]}}},line:{uniforms(){return{lineWidth:this.node.attributes["line.width"],lineDepth:this.node.attributes["line.depth"],lineProximity:this.node.attributes["line.proximity"]}}},surface:{uniforms(){return{}}},shade:{pipeline(m){if(!this._inherit("fragment"))return m;
m==null&&(m=this._shaders.shader());for(let p=0;p<=2;p++)m=x(this._inherit("fragment"),z=>z.fragment(m,p));m.pipe("fragment.map.rgba");return m},normal(m){m.pipe(r.swizzleVec4("xyz"));return m},map(m){return m?this._shaders.shader().pipe("mesh.map.uvwo").pipe(m):m}},position:{pipeline(m){if(!this._inherit("vertex"))return m;m==null&&(m=this._shaders.shader());for(let p=0;p<=3;p++)m=x(this._inherit("vertex"),z=>z.vertex(m,p));return m},swizzle(m,p){if(m)return this._shaders.shader().pipe(r.swizzleVec4(p)).pipe(m)},
swizzle2(m,p,z){if(m)return this._shaders.shader().split().pipe(r.swizzleVec4(p)).next().pipe(r.swizzleVec4(z)).join().pipe(m)}},visible:{make(){const m={type:"visible.change"};let p=null;this.setVisible=function(v){v!=null&&(p=v);return z()};const z=()=>{let v;const y=this.isVisible;let B=(v=p!=null?p:this._get("object.visible"))!=null?v:!0;t!=null&&B&&(B=t.isVisible);this.isVisible=B;if(y!==this.isVisible)return this.trigger(m)},t=this._inherit("visible");t&&this._listen(t,"visible.change",z);this.is("object")&&
this._listen(this.node,"change:object",z);return z()},unmake(){return delete this.isVisible}},active:{make(){const m={type:"active.change"};let p=null;this.setActive=function(v){v!=null&&(p=v);return z()};const z=()=>{let v;const y=this.isActive;let B=(v=p!=null?p:this._get("entity.active"))!=null?v:!0;t!=null&&B&&(B=t.isActive);this.isActive=B;if(y!==this.isActive)return this.trigger(m)},t=this._inherit("active");t&&this._listen(t,"active.change",z);this.is("entity")&&this._listen(this.node,"change:entity",
z);return z()},unmake(){return delete this.isActive}},object:{make(m){let p,z;m==null&&(m=[]);this.objects=m;this.renders=this.objects.reduce((G,I)=>G.concat(I.renders),[]);m=this._inherit("scene");let t=p=z=null;const v=Array.from(this.traits).includes("style");t=1;p=g.NormalBlending;let y=!0,B=!0;v&&({opacity:t}=this.props,{blending:p}=this.props,{zOrder:z}=this.props,{zWrite:y}=this.props,{zTest:B}=this.props);const D=()=>{const G=z!=null?-z:this.node.order;return(this.isVisible!=null?this.isVisible:
1)&&t>0?v?(()=>{const I=[];for(const K of Array.from(this.objects))K.show(t<1,p,G),I.push(K.depth(y,B));return I})():(()=>{const I=[];for(const K of Array.from(this.objects))I.push(K.show(!0,p,G));return I})():(()=>{const I=[];for(const K of Array.from(this.objects))I.push(K.hide());return I})()};this._listen(this.node,"change:style",G=>{({changed:G}=G);let I=null;G["style.opacity"]&&(I=t=this.props.opacity);G["style.blending"]&&(I=p=this.props.blending);G["style.zOrder"]&&(I=z=this.props.zOrder);
G["style.zWrite"]&&(I=y=this.props.zWrite);G["style.zTest"]&&(I=B=this.props.zTest);if(I!=null)return D()});this._listen(this.node,"reindex",D);this._listen(this,"visible.change",D);for(const G of Array.from(this.objects))m.adopt(G);return D()},unmake(m){let p;m==null&&(m=!0);if(this.objects){var z=this._inherit("scene");for(p of Array.from(this.objects))z.unadopt(p);if(m)return(()=>{const t=[];for(p of Array.from(this.objects))t.push(p.dispose());return t})()}},mask(){let m;if(m=this._inherit("mask"))return m.mask(void 0)}},
unit:{make(){let m,p,z,t,v,y,B,D,G,I,K,Q,O=Math.PI;this.unitUniforms={renderScaleInv:D=this._attributes.make(this._types.number(1)),renderScale:B=this._attributes.make(this._types.number(1)),renderAspect:t=this._attributes.make(this._types.number(1)),renderWidth:G=this._attributes.make(this._types.number(0)),renderHeight:v=this._attributes.make(this._types.number(0)),viewWidth:K=this._attributes.make(this._types.number(0)),viewHeight:I=this._attributes.make(this._types.number(0)),pixelRatio:p=this._attributes.make(this._types.number(1)),
pixelUnit:z=this._attributes.make(this._types.number(1)),worldUnit:Q=this._attributes.make(this._types.number(1)),focusDepth:m=this._attributes.make(this._types.number(1)),renderOdd:y=this._attributes.make(this._types.vec2())};const J=new g.Vector3,W=new g.Vector3,ba=()=>{var S;let ca;if((ca=Y!=null?Y.getSize():void 0)!=null){O=Math.PI;var {scale:V}=this.props,{fov:xa}=this.props,na=this.props.focus!=null?this.props.focus:this.inherit("unit").props.focus,N=V===null,pa=1;if(S=Y!=null?Y.getCamera():
void 0)pa=S.projectionMatrix,J.set(0,-.5,1).applyMatrix4(pa),W.set(0,.5,1).applyMatrix4(pa),J.sub(W),pa=J.y;S=ca.renderHeight/ca.viewHeight;xa=xa!=null?pa*Math.tan(xa*O/360):1;V=N?S:ca.renderHeight/V*xa;N=ca.renderHeight*pa/2;K.value=ca.viewWidth;I.value=ca.viewHeight;G.value=ca.renderWidth;v.value=ca.renderHeight;t.value=ca.aspect;B.value=N;D.value=1/N;p.value=S;z.value=V;Q.value=V/N;m.value=na;return y.value.set(ca.renderWidth%2,ca.renderHeight%2).multiplyScalar(.5)}},Y=this.is("root")?this:this._inherit("root");
this._listen(Y,"root.update",ba);return ba()},unmake(){return delete this.unitUniforms},get(){const m={};for(const p in this.unitUniforms)m[p]=this.unitUniforms[p].value;return m},uniforms(){return this.unitUniforms}}},k=function(m,p){const z={};for(const t of Array.from(p))if(p=f[t]){z[t]={};for(const v in p)z[t][v]=p[v].bind(m)}return z}};
shadow$provide[321]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Types:{enumerable:!0,get:function(){return x.Types}}});q=l(315);var x=l(317),r=l(318),e=l(320);l.exportCopy(L,q);l.exportCopy(L,r);l.exportCopy(L,e)};
shadow$provide[322]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},PrimitiveFactory:{enumerable:!0,get:function(){return x}}});class x{constructor(r,e){this.context=e;this.classes=r.Classes;this.helpers=r.Helpers}getTypes(){return Object.keys(this.classes)}make(r,e,g=null){e==null&&(e={});const f=this.classes[r];if(f==null)throw Error(`Unknown primitive class \`${r}\``);r=new f.model(r,f.defaults,e,g,f,this.context.attributes);new f(r,this.context,this.helpers);return r}}
};
shadow$provide[323]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Factory:{enumerable:!0,get:function(){return x.PrimitiveFactory}},Types:{enumerable:!0,get:function(){return e}}});q=l(321);var x=l(322),r=l(188);l.exportCopy(L,r);const e=q};
shadow$provide[324]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Renderable:{enumerable:!0,get:function(){return x}}});class x{constructor(r,e){this.renderer=r;this.shaders=e;this.gl=this.renderer.getContext();this.uniforms==null&&(this.uniforms={})}dispose(){this.uniforms=null}_adopt(r){for(const e in r)this.uniforms[e]=r[e]}_set(r){for(const e in r){const g=r[e];this.uniforms[e]!=null&&(this.uniforms[e].value=g)}}}};
shadow$provide[325]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Scene:{enumerable:!0,get:function(){return e}}});var x=l(101);l=l(324);class r extends x.Object3D{constructor(){super();this.matrixAutoUpdate=this.frustumCulled=this.rotationAutoUpdate=!1}}class e extends l.Renderable{constructor(g,f,k){super(g,f,k);this.root=new r;(k!=null?k.scene:void 0)!=null&&(this.scene=k.scene);this.scene==null&&(this.scene=new x.Scene);this.pending=[];this.async=0;this.scratch=
new x.WebGLRenderTarget(1,1);this.camera=new x.PerspectiveCamera}inject(g){g!=null&&(this.scene=g);return this.scene.add(this.root)}unject(){return this.scene!=null?this.scene.remove(this.root):void 0}add(g){return this.async?this.pending.push(g):this._add(g)}remove(g){this.pending=this.pending.filter(f=>f!==g);if(g.parent!=null)return this._remove(g)}_add(g){return this.root.add(g)}_remove(g){return this.root.remove(g)}dispose(){if(this.root.parent!=null)return this.unject()}warmup(g){return this.async=
+g||0}render(){if(this.pending.length){var {children:g}=this.root,f=[];for(let p=0,z=this.async,t=0<=z;t?p<z:p>z;t?p++:p--){var k=this.pending.shift();if(!k)break;this._add(k);f.push(f)}var m=g.map(function(p){return p.visible});g.map(p=>p.visible=!Array.from(f).includes(p));k=this.renderer.getRenderTarget();this.renderer.setRenderTarget(this.scratch);this.renderer.render(this.scene,this.camera);this.renderer.setRenderTarget(k);return g.map((p,z)=>p.visible=m[z])}}toJSON(){return this.root.toJSON()}}
};
shadow$provide[326]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},RenderFactory:{enumerable:!0,get:function(){return x}}});class x{constructor(r,e,g){this.classes=r;this.renderer=e;this.shaders=g}getTypes(){return Object.keys(this.classes)}make(r,e){return new this.classes[r](this.renderer,this.shaders,e)}}};
shadow$provide[327]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Buffer:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(324);class r extends l.Renderable{constructor(e,g,f){super(e,g);this.items==null&&(this.items=f.items||1);this.samples==null&&(this.samples=f.samples||1);this.channels==null&&(this.channels=f.channels||4);this.callback==null&&(this.callback=f.callback||function(){})}dispose(){return super.dispose()}update(){const e=this.fill();this.write(e);
return e}setActive(e,g,f,k){}setCallback(e){this.callback=e}write(){}fill(){}generate(e){return x.getStreamer(e,this.samples,this.channels,this.items)}}};
shadow$provide[328]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},DataTexture:{enumerable:!0,get:function(){return g}}});var x=l(101),r=l(195),e=l(101);class g{constructor(f,k,m,p,z){this.renderer=f;this.width=k;this.height=m;this.channels=p;this.n=this.width*this.height*this.channels;this.gl=f=this.renderer.getContext();k=(z!=null?z.magFilter:void 0)!=null?z!=null?z.magFilter:void 0:x.NearestFilter;m=(z!=null?z.type:void 0)!=null?z!=null?z.type:void 0:x.FloatType;
this.minFilter=r.paramToGL(f,(z!=null?z.minFilter:void 0)!=null?z!=null?z.minFilter:void 0:x.NearestFilter);this.magFilter=r.paramToGL(f,k);this.type=r.paramToGL(f,m);this.ctor=r.paramToArrayStorage(m);this.build(z)}build(f){const {gl:k}=this,m=this.renderer.state;this.texture=k.createTexture();this.format=[null,k.LUMINANCE,k.LUMINANCE_ALPHA,k.RGB,k.RGBA][this.channels];this.format3=[null,x.LuminanceFormat,x.LuminanceAlphaFormat,x.RGBFormat,x.RGBAFormat][this.channels];m.bindTexture(k.TEXTURE_2D,
this.texture);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,this.minFilter);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,this.magFilter);this.data=new this.ctor(this.n);k.pixelStorei(k.UNPACK_ALIGNMENT,1);k.texImage2D(k.TEXTURE_2D,0,this.format,this.width,this.height,0,this.format,this.type,this.data);this.textureObject=new e.Texture(new Image,x.UVMapping,x.ClampToEdgeWrapping,
x.ClampToEdgeWrapping,f!=null?f.minFilter:void 0,f!=null?f.magFilter:void 0);this.textureProperties=this.renderer.properties.get(this.textureObject);this.textureProperties.__webglInit=!0;this.textureProperties.__webglTexture=this.texture;this.textureObject.format=this.format3;this.textureObject.type=x.FloatType;this.textureObject.unpackAlignment=1;this.textureObject.flipY=!1;this.textureObject.generateMipmaps=!1;this.uniforms={dataResolution:{type:"v2",value:new e.Vector2(1/this.width,1/this.height)},
dataTexture:{type:"t",value:this.textureObject}}}write(f,k,m,p,z){const {gl:t}=this;this.renderer.state.bindTexture(t.TEXTURE_2D,this.texture);t.pixelStorei(t.UNPACK_ALIGNMENT,1);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1);t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);return t.texSubImage2D(t.TEXTURE_2D,0,k,m,p,z,this.format,this.type,f)}dispose(){this.gl.deleteTexture(this.texture);this.textureProperties.__webglInit=!1;return this.textureObject=this.texture=this.textureProperties=this.textureProperties.__webglTexture=
null}}};
shadow$provide[329]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},DataBuffer:{enumerable:!0,get:function(){return f}}});var x=l(198),r=l(199);L=l(327);var e=l(328),g=l(101);class f extends L.Buffer{constructor(k,m,p,z){z==null&&(z=!0);const t=p.width||1,v=p.height||1,y=p.depth||1,B=t*v*y;p.samples||(p.samples=B);super(k,m,p);this.width=t;this.height=v;this.depth=y;this.samples==null&&(this.samples=B);z&&this.build(p)}shader(k,m){m==null&&(m=4);this.items>1||this.depth>
1?(m!==4&&k.pipe(r.extendVec(m,4)),k.pipe("map.xyzw.texture",this.uniforms)):m!==2&&k.pipe(r.truncateVec(m,2));k.pipe(`map.2d.data${this.wrap?".wrap":""}`,this.uniforms);k.pipe("sample.2d",this.uniforms);this.channels<4&&k.pipe(r.swizzleVec4(["0000","x000","xw00","xyz0"][this.channels]));return k}build(k){this.data=new Float32Array(this.samples*this.channels*this.items);this.texture=new e.DataTexture(this.renderer,this.items*this.width,this.height*this.depth,this.channels,k);this.used=this.filled=
0;this._adopt(this.texture.uniforms);this._adopt({dataPointer:{type:"v2",value:new g.Vector2},textureItems:{type:"f",value:this.items},textureHeight:{type:"f",value:this.height}});this.dataPointer=this.uniforms.dataPointer.value;this.streamer=this.generate(this.data)}dispose(){this.data=null;this.texture.dispose();return super.dispose()}getFilled(){return this.filled}setCallback(k){this.callback=k;return this.filled=0}copy(k){const m=Math.min(k.length,this.samples*this.channels*this.items),p=this.data;
for(let z=0,t=m,v=0<=t;v?z<t:z>t;v?z++:z--)p[z]=k[z];this.write(Math.ceil(m/this.channels/this.items))}write(k){k==null&&(k=this.samples);let m=k/this.width;k*=this.items;const p=m<1?k:this.items*this.width;m=Math.ceil(m);this.texture.write(this.data,0,0,p,m);this.dataPointer.set(.5,.5);this.filled=1;this.used=k}through(k,m){let p,z;const {consume:t,done:v}=z=this.streamer,{emit:y}=p=m.streamer;let B=0,D=()=>t((G,I,K,Q)=>k(y,G,I,K,Q,B));D=x.repeatCall(D,this.items);return()=>{z.reset();p.reset();
const G=this.used;for(B=0;!v()&&B<G;)D(),B++;return z.count()}}}};
shadow$provide[330]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},ArrayBuffer_:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(329);class r extends l.DataBuffer{constructor(e,g,f){const k=f.width||1,m=f.history||1;f.width=k;f.height=m;f.depth=1;super(e,g,f,!1);this.width=k;this.history=m;this.samples=k;this.wrap=m>1;this.build(f)}build(e){super.build();this.pad=this.index=0;return this.streamer=this.generate(this.data)}setActive(e){return this.pad=Math.max(0,
this.width-e)}fill(){const {callback:e}=this;typeof e.reset==="function"&&e.reset();const {emit:g,count:f,done:k,reset:m}=this.streamer;m();const p=this.samples-this.pad;let z=0;for(;!k()&&z<p&&e(g,z++)!==!1;)!0;return Math.floor(f()/this.items)}write(e){e==null&&(e=this.samples);e*=this.items;this.texture.write(this.data,0,this.index,e,1);this.dataPointer.set(.5,this.index+.5);this.index=(this.index+this.history-1)%this.history;return this.filled=Math.min(this.history,this.filled+1)}through(e,g){let f,
k;const {consume:m,done:p}=k=this.streamer,{emit:z}=f=g.streamer;let t=0,v=()=>m((y,B,D,G)=>e(z,y,B,D,G,t));v=x.repeatCall(v,this.items);return()=>{k.reset();f.reset();const y=this.samples-this.pad;for(t=0;!p()&&t<y;)v(),t++;return k.count()}}}};
shadow$provide[331]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Geometry:{enumerable:!0,get:function(){return r}}});var x=l(101);class r extends x.BufferGeometry{constructor(){super();new x.BufferGeometry(this);this.uniforms==null&&(this.uniforms={});this.groups==null&&(this.groups=[])}_reduce(e,g){let f=!1;for(let k=0;k<e.length;k++){const m=e[k],p=g[k];f&&(e[k]=p);m>1&&(f=!0)}return e.reduce((k,m)=>k*m)}_emitter(e){e=e=="index"?this.getIndex():this.getAttribute(e);
const g=e.itemSize,{array:f}=e;let k=0;return[null,function(m){f[k++]=m},function(m,p){f[k++]=m;f[k++]=p},function(m,p,z){f[k++]=m;f[k++]=p;f[k++]=z},function(m,p,z,t){f[k++]=m;f[k++]=p;f[k++]=z;f[k++]=t}][g]}_finalize(){}_offsets(e){this.groups=e}}};
shadow$provide[332]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},ClipGeometry:{enumerable:!0,get:function(){return r}}});L=l(331);var x=l(101);class r extends L.Geometry{_clipUniforms(){this.geometryClip=new x.Vector4(1E10,1E10,1E10,1E10);this.geometryResolution=new x.Vector4;this.mapSize=new x.Vector4;this.uniforms==null&&(this.uniforms={});this.uniforms.geometryClip={type:"v4",value:this.geometryClip};this.uniforms.geometryResolution={type:"v4",value:this.geometryResolution};
return this.uniforms.mapSize={type:"v4",value:this.mapSize}}_clipGeometry(e,g,f,k){this.geometryClip.set(Math.max(0,e-1),Math.max(0,g-1),Math.max(0,f-1),Math.max(0,k-1));return this.geometryResolution.set(1/Math.max(1,e-1),1/Math.max(1,g-1),1/Math.max(1,f-1),1/Math.max(1,k-1))}_clipMap(e,g,f,k){return this.mapSize.set(e,g,f,k)}_clipOffsets(e,g,f,k,m,p,z,t,v){g=this._reduce([k,f,g,m],[t,z,p,v]);return this._offsets([{start:0,count:g*e,materialIndex:0}])}}};
shadow$provide[333]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},ArrowGeometry:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(332);class r extends l.ClipGeometry{constructor(e){var g,f,k;let m;var p;let z,t;var v;super(e);this._clipUniforms();this.sides=z=+e.sides||12;this.samples=p=+e.samples||2;this.strips=t=+e.strips||1;this.ribbons=m=+e.ribbons||1;this.layers=k=+e.layers||1;this.flip=g=e.flip!=null?e.flip:!1;this.closed=f=e.closed!=null?e.closed:
!1;this.anchor=e=e.anchor!=null?e.anchor:g||f?0:p-1;var y=t*m*k;var B=(z+2)*y;this.setIndex(new x.BufferAttribute(new Uint32Array(z*2*y*3),1));this.setAttribute("position4",new x.BufferAttribute(new Float32Array(B*4),4));this.setAttribute("arrow",new x.BufferAttribute(new Float32Array(B*3),3));this.setAttribute("attach",new x.BufferAttribute(new Float32Array(B*2),2));var D=this._emitter("index");const G=this._emitter("position4"),I=this._emitter("arrow"),K=this._emitter("attach"),Q=[];B=0;for(v=0<=
z;v?B<z:B>z;v?B++:B--){var O=B/z*2*Math.PI;Q.push([Math.cos(O),Math.sin(O),1])}v=0;for(let J=0,W=y,ba=0<=W;ba?J<W:J>W;ba?J++:J--){const Y=v++,S=Y+z+1;B=0;O=z;for(y=0<=O;y?B<O:B>O;y?B++:B--){const ca=v+B%z,V=v+(B+1)%z;D(Y);D(ca);D(V);D(V);D(ca);D(S)}v+=z+1}D=g?1:f?p-1:-1;g=g&&!f?p-1:0;for(let J=0,W=k,ba=0<=W;ba?J<W:J>W;ba?J++:J--)for(let Y=0,S=m,ca=0<=S;ca?Y<S:Y>S;ca?Y++:Y--)for(let V=0,xa=t,na=0<=xa;na?V<xa:V>xa;na?V++:V--){G(e,V,Y,J);I(0,0,0);K(D,g);B=0;f=z;for(k=0<=f;k?B<f:B>f;k?B++:B--)G(e,V,Y,
J),p=Q[B],I(p[0],p[1],p[2]),K(D,g);G(e,V,Y,J);I(0,0,1);K(D,g)}this._finalize();this.clip()}clip(e,g,f,k){e==null&&({samples:e}=this);g==null&&({strips:g}=this);f==null&&({ribbons:f}=this);k==null&&({layers:k}=this);this._clipGeometry(e,g,f,k);e=e>0?this.sides*this._reduce([k,f,g],[this.layers,this.ribbons,this.strips]):0;return this._offsets([{start:0,count:e*6,materialIndex:0}])}}};
shadow$provide[334]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Base:{enumerable:!0,get:function(){return e}}});var x=l(199),r=l(101);l=l(324);class e extends l.Renderable{constructor(g,f,k){super(g,f,k);this.zUnits=k.zUnits!=null?k.zUnits:0}raw(){for(const g of Array.from(this.renders))this._raw(g);return null}depth(g,f){for(const k of Array.from(this.renders))this._depth(k,g,f);return null}polygonOffset(g,f){for(const k of Array.from(this.renders))this._polygonOffset(k,
g,f);return null}show(g,f,k){return Array.from(this.renders).map(m=>this._show(m,g,f,k))}hide(){for(const g of Array.from(this.renders))this._hide(g);return null}_injectPreamble(g,f){g=g+"\n"+f;return f.match(/#extension/)?this._hoist(g):g}_hoist(g){g=g.split("\n");const f=[];for(const k of Array.from(g))k.match(/^\s*#extension/)?f.unshift(k):f.push(k);return f.join("\n")}_material(g){var f=this.renderer.capabilities.precision;const k=`\
    precision ${f} float;
    precision ${f} int;
uniform mat4 modelMatrix;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 cameraPosition;\
`;f=`\
    precision ${f} float;
    precision ${f} int;
uniform mat4 viewMatrix;
uniform vec3 cameraPosition;\
`;const m={};Object.assign(m,g);delete m.attributes;delete m.varyings;delete m.inspect;delete m.vertexGraph;delete m.fragmentGraph;const p=new r.RawShaderMaterial(m);["vertexGraph","fragmentGraph","inspect"].forEach(z=>p[z]=g[z]);p.vertexShader=this._injectPreamble(k,p.vertexShader);p.fragmentShader=this._injectPreamble(f,p.fragmentShader);return p}_raw(g){g.rotationAutoUpdate=!1;g.frustumCulled=!1;g.matrixAutoUpdate=!1;g.material.defaultAttributeValues=void 0}_depth(g,f,k){g=g.material;g.depthWrite=
f;return g.depthTest=k}_polygonOffset(g,f,k){k-=this.zUnits;const m=k!==0;g=g.material;if(g.polygonOffset=m)return g.polygonOffsetFactor=f,g.polygonOffsetUnits=k}_show(g,f,k,m){f=g.material;g.renderOrder=-m;g.visible=!0;f.transparent=!0;f.blending=k;return null}_hide(g){return g.visible=!1}_vertexColor(g,f){if(g||f){var k=this.shaders.shader();g&&(k.require(g),k.pipe("mesh.vertex.color",this.uniforms));f&&(k.require(f),k.pipe("mesh.vertex.mask",this.uniforms));return k}}_vertexPosition(g,f,k,m,p){let z;
const t=this.shaders.shader();if(k||f&&f!==!0){z={};if(m>0||p)z.POSITION_MAP="";m>0&&(z[["POSITION_U","POSITION_UV","POSITION_UVW","POSITION_UVWO"][m-1]]="");p&&(z.POSITION_STPQ="")}t.require(g);return t.pipe("mesh.vertex.position",this.uniforms,z)}_fragmentColor(g,f,k,m,p,z,t,v,y){const B=this.shaders.shader();let D=!1,G=!1;const I={};z>0&&(I[["POSITION_U","POSITION_UV","POSITION_UVW","POSITION_UVWO"][z-1]]="");t&&(I.POSITION_STPQ="");g&&(B.pipe("style.color",this.uniforms),D=!0,k||p||f)&&(y&&!k||
B.pipe("mesh.gamma.in"),G=!0);k&&(B.isolate(),B.pipe("mesh.fragment.color",this.uniforms),y&&!D||B.pipe("mesh.gamma.in"),B.end(),D&&B.pipe(x.binaryOperator("vec4","*")),y&&D&&B.pipe("mesh.gamma.out"),G=D=!0);p&&(!D&&v&&B.pipe(x.constant("vec4","vec4(1.0)")),B.isolate(),B.require(p),B.pipe("mesh.fragment.map",this.uniforms,I),y||B.pipe("mesh.gamma.in"),B.end(),v?B.pipe(v):D&&B.pipe(x.binaryOperator("vec4","*")),G=D=!0);f&&(D||B.pipe(x.constant("vec4","vec4(1.0)")),f===!0?B.pipe("mesh.fragment.shaded",
this.uniforms):(B.require(f),B.pipe("mesh.fragment.material",this.uniforms,I)),G=!0);G&&!y&&B.pipe("mesh.gamma.out");m&&(B.pipe("mesh.fragment.mask",this.uniforms),D&&B.pipe(x.binaryOperator("vec4","*")));return B}}};
shadow$provide[335]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Arrow:{enumerable:!0,get:function(){return e}}});var x=l(101),r=l(333);l=l(334);class e extends l.Base{constructor(g,f,k){super(g,f,k);var {uniforms:m}=k;const {material:p,position:z,color:t,mask:v,map:y,combine:B,stpq:D,linear:G}=k;m==null&&(m={});g=m.styleColor!=null;this.geometry=new r.ArrowGeometry({sides:k.sides,samples:k.samples,strips:k.strips,ribbons:k.ribbons,layers:k.layers,anchor:k.anchor,
flip:k.flip,closed:k.closed});this._adopt(m);this._adopt(this.geometry.uniforms);k={};closed&&(k.ARROW_CLOSED="");f=f.material();m=f.vertex;m.pipe(this._vertexColor(t,v));m.require(this._vertexPosition(z,p,y,1,D));m.pipe("arrow.position",this.uniforms,k);m.pipe("project.position",this.uniforms);f.fragment=g=this._fragmentColor(g,p,t,v,y,1,D,B,G);g.pipe("fragment.color",this.uniforms);g=f.link({side:x.DoubleSide});this.material=this._material(g);f=new x.Mesh(this.geometry,this.material);f.frustumCulled=
!1;f.matrixAutoUpdate=!1;f.userData=g;this._raw(f);this.renders=[f]}dispose(){this.geometry.dispose();this.material.dispose();this.renders=this.geometry=this.material=null;return super.dispose()}}};
shadow$provide[336]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},BackedTexture:{enumerable:!0,get:function(){return x}}});l=l(328);class x extends l.DataTexture{constructor(r,e,g,f,k){super(r,e,g,f,k);this.data=new this.ctor(this.n)}resize(r,e){const g=this.data,f=this.width,k=this.height;this.width=r;this.height=e;this.n=r*e*this.channels;this.data=new this.ctor(this.n);const {gl:m}=this;this.renderer.state.bindTexture(m.TEXTURE_2D,this.texture);m.pixelStorei(m.UNPACK_ALIGNMENT,
1);m.texImage2D(m.TEXTURE_2D,0,this.format,r,e,0,this.format,this.type,this.data);this.uniforms.dataResolution.value.set(1/r,1/e);return this.write(g,0,0,f,k)}write(r,e,g,f,k){({width:t}=this);const m=this.data;var {channels:p}=this;let z=0;if(t===f&&e===0){var t=g*f*p;for(var v=f*k*p;z<v;)m[t++]=r[z++]}else{v=t*p;const y=f*p;p*=e;let B=g;const D=g+k;for(;B<D;){let G=0;for(t=p+B*v;G++<y;)m[t++]=r[z++];B++}}return super.write(r,e,g,f,k)}dispose(){this.data=null;return super.dispose()}}};
shadow$provide[337]=function(l,L,q){function x(p,z){return typeof p!=="undefined"&&p!==null?z(p):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Atlas:{enumerable:!0,get:function(){return k}}});var r=l(199),e=l(336),g=l(328);L=l(324);var f=l(101);class k extends L.Renderable{constructor(p,z,t,v){v==null&&(v=!0);super(p,z);this.width==null&&(this.width=t.width||512);this.height==null&&(this.height=t.height||512);this.channels==null&&(this.channels=t.channels||4);this.backed==
null&&(this.backed=t.backed||!1);this.samples=this.width*this.height;v&&this.build(t)}shader(p){p.pipe("map.2d.data",this.uniforms);p.pipe("sample.2d",this.uniforms);this.channels<4&&p.pipe(r.swizzleVec4(["0000","x000","xw00","xyz0"][this.channels]));return p}build(p){let z;this.klass=z=this.backed?e.BackedTexture:g.DataTexture;this.texture=new z(this.renderer,this.width,this.height,this.channels,p);this.uniforms={dataPointer:{type:"v2",value:new f.Vector2(0,0)}};this._adopt(this.texture.uniforms);
return this.reset()}reset(){this.rows=[];return this.bottom=0}resize(p,z){if(!this.backed)throw Error("Cannot resize unbacked texture atlas");p>2048&&z>2048?console.warn(`Giant text atlas ${p}x${z}.`):console.info(`Resizing text atlas ${p}x${z}.`);this.texture.resize(p,z);this.width=p;this.height=z;return this.samples=p*z}collapse(p){let z;const {rows:t}=this;t.splice(t.indexOf(p),1);this.bottom=(z=x(t[t.length-1],v=>v.bottom))!=null?z:0;if(this.last===p)return this.last=null}allocate(p,z,t,v){const y=
this.width,B=this.height,D=t*2;if(z>y)return this.resize(y*2,B*2),this.last=null,this.allocate(p,z,t,v);let G=this.last;if(G!=null&&G.height>=t&&G.height<D&&G.width+z<=y)G.append(p,z,t,v);else{var I=0,K=-1,Q=0;for(let O=0;O<this.rows.length;O++)if(G=this.rows[O],G.top-I>=t&&K<0&&(K=O,Q=I),{bottom:I}=G,G.height>=t&&G.height<D&&G.width+z<=y){G.append(p,z,t,v);this.last=G;return}if(K>=0)G=new m(Q,t),this.rows.splice(K,0,G);else{Q=I;I+=t;if(I>=B)return this.resize(y*2,B*2),this.last=null,this.allocate(p,
z,t,v);G=new m(Q,t);this.rows.push(G);this.bottom=I}G.append(p,z,t,v);this.last=G}}read(){return this.texture.textureObject}write(p,z,t,v,y){return this.texture.write(p,z,t,v,y)}dispose(){this.texture.dispose();this.data=null;return super.dispose()}}class m{constructor(p,z){this.top=p;this.bottom=p+z;this.width=0;this.height=z;this.alive=0;this.keys=[]}append(p,z,t,v){t=this.width;const y=this.top;this.alive++;this.width+=z;this.keys.push(p);return v(this,t,y)}}};
shadow$provide[338]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Debug:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(334);class r extends l.Base{constructor(e,g,f){super(e,g,f);this.geometry=new x.PlaneGeometry(1,1);this.material=new x.MeshBasicMaterial({map:f.map});this.material.side=x.DoubleSide;e=new x.Mesh(this.geometry,this.material);e.position.x+=f.x||0;e.position.y+=f.y||0;e.frustumCulled=!1;e.scale.set(2,2,2);e.__debug=!0;this.objects=[e]}dispose(){this.geometry.dispose();
this.material.dispose();this.objects=this.geometry=this.material=null;return super.dispose()}}};
shadow$provide[339]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},FaceGeometry:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(332);class r extends l.ClipGeometry{constructor(e){let g,f,k,m;super(e);this._clipUniforms();this.items=f=+e.items||2;this.width=m=+e.width||1;this.height=g=+e.height||1;this.depth=e=+e.depth||1;this.sides=k=Math.max(0,f-2);const p=m*g*e;var z=f*p;this.setIndex(new x.BufferAttribute(new Uint32Array(k*p*3),1));this.setAttribute("position4",
new x.BufferAttribute(new Float32Array(z*4),4));z=this._emitter("index");const t=this._emitter("position4");let v=0;for(let y=0,B=p,D=0<=B;D?y<B:y>B;D?y++:y--){for(let G=0,I=k,K=0<=I;K?G<I:G>I;K?G++:G--)z(v),z(v+G+1),z(v+G+2);v+=f}for(let y=0,B=e,D=0<=B;D?y<B:y>B;D?y++:y--)for(let G=0,I=g,K=0<=I;K?G<I:G>I;K?G++:G--)for(let Q=0,O=m,J=0<=O;J?Q<O:Q>O;J?Q++:Q--)for(let W=0,ba=f,Y=0<=ba;Y?W<ba:W>ba;Y?W++:W--)t(Q,G,y,W);this._finalize();this.clip()}clip(e,g,f,k){e==null&&({width:e}=this);g==null&&({height:g}=
this);f==null&&({depth:f}=this);k==null&&({items:k}=this);const m=Math.max(0,k-2);this._clipGeometry(e,g,f,k);return this._clipOffsets(3,e,g,f,m,this.width,this.height,this.depth,this.sides)}}};
shadow$provide[340]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Face:{enumerable:!0,get:function(){return e}}});var x=l(101);L=l(334);var r=l(339);class e extends L.Base{constructor(g,f,k){super(g,f,k);let {uniforms:m,material:p}=k;const {position:z,color:t,mask:v,map:y,combine:B,stpq:D,linear:G}=k;m==null&&(m={});p==null&&(p=!0);g=m.styleColor!=null;this.geometry=new r.FaceGeometry({items:k.items,width:k.width,height:k.height,depth:k.depth});this._adopt(m);this._adopt(this.geometry.uniforms);
f=f.material();k=f.vertex;k.pipe(this._vertexColor(t,v));k.require(this._vertexPosition(z,p,y,2,D));p||k.pipe("face.position",this.uniforms);p&&k.pipe("face.position.normal",this.uniforms);k.pipe("project.position",this.uniforms);f.fragment=g=this._fragmentColor(g,p,t,v,y,2,D,B,G);g.pipe("fragment.color",this.uniforms);g=f.link({side:x.DoubleSide});this.material=this._material(g);f=new x.Mesh(this.geometry,this.material);f.userData=g;this._raw(f);this.renders=[f]}dispose(){this.geometry.dispose();
this.material.dispose();this.renders=this.geometry=this.material=null;return super.dispose()}}};
shadow$provide[341]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},LineGeometry:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(332);class r extends l.ClipGeometry{constructor(e){var g,f,k,m;let p,z,t;var v;let y;super(e);this._clipUniforms();this.closed=g=e.closed||!1;this.samples=t=(+e.samples||2)+(g?1:0);this.strips=y=+e.strips||1;this.ribbons=z=+e.ribbons||1;this.layers=p=+e.layers||1;this.detail=f=+e.detail||1;var B=t-1;this.joints=m=f-1;this.vertices=
e=(B-(g?0:1))*m+t;this.segments=v=(B-(g?0:1))*m+B;e=e*y*z*p*2;this.setIndex(new x.BufferAttribute(new Uint32Array(v*y*z*p*2*3),1));this.setAttribute("position4",new x.BufferAttribute(new Float32Array(e*4),4));this.setAttribute("line",new x.BufferAttribute(new Float32Array(e*1),1));f>1&&this.setAttribute("joint",new x.BufferAttribute(new Float32Array(e),1));var D=this._emitter("index");e=this._emitter("position4");B=this._emitter("line");f>1&&(k=this._emitter("joint"));var G=0;for(let W=0,ba=z*p,Y=
0<=ba;Y?W<ba:W>ba;Y?W++:W--)for(let S=0,ca=y,V=0<=ca;V?S<ca:S>ca;V?S++:S--){for(let xa=0,na=v,N=0<=na;N?xa<na:xa>na;N?xa++:xa--)D(G),D(G+1),D(G+2),D(G+2),D(G+1),D(G+3),G+=2;G+=2}var I=g?()=>0:function(W){return W===0?-1:W===t-1?1:0};if(f>1){var K;g=0;for(K=0<=p;K?g<p:g>p;K?g++:g--){var Q=void 0,O=void 0;G=0;O=z;for(Q=0<=O;Q?G<O:G>O;Q?G++:G--){let W,ba;D=0;ba=y;for(W=0<=ba;W?D<ba:D>ba;W?D++:D--){let Y,S,ca;v=ca=0;S=t;for(Y=0<=S;Y?ca<S:ca>S;Y?ca++:ca--,v=ca){var J=I(v);if(J!==0)e(v,D,G,g),e(v,D,G,g),
B(1),B(-1),k(.5),k(.5);else for(let V=0,xa=f,na=0<=xa;na?V<xa:V>xa;na?V++:V--)e(v,D,G,g),e(v,D,G,g),B(1),B(-1),k(V/m),k(V/m)}}}}}else for(g=0,k=0<=p;k?g<p:g>p;k?g++:g--)for(G=0,m=z,f=0<=m;f?G<m:G>m;f?G++:G--)for(D=0,I=y,J=0<=I;J?D<I:D>I;J?D++:D--)for(v=O=0,Q=t,K=0<=Q;K?O<Q:O>Q;K?O++:O--,v=O)e(v,D,G,g),e(v,D,G,g),B(1),B(-1);this._finalize();this.clip()}clip(e,g,f,k){e==null&&(e=this.samples-this.closed);g==null&&({strips:g}=this);f==null&&({ribbons:f}=this);k==null&&({layers:k}=this);const m=e+(e-
(this.closed?0:2))*this.joints-(this.closed?0:1);e+=this.closed;this._clipGeometry(e,g,f,k);return this._clipOffsets(6,m,g,f,k,this.segments,this.strips,this.ribbons,this.layers)}}};
shadow$provide[342]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Line:{enumerable:!0,get:function(){return e}}});var x=l(101);L=l(334);var r=l(341);class e extends L.Base{constructor(g,f,k){var m;super(g,f,k);let {uniforms:p,stroke:z,join:t}=k;const {material:v,position:y,color:B,mask:D,map:G,combine:I,stpq:K,linear:Q,clip:O,proximity:J,closed:W}=k;p==null&&(p={});z=[null,"dotted","dashed"][z];g=p.styleColor!=null;t=(m=["miter","round","bevel"][t])!=null?m:"miter";
m={miter:1,round:4,bevel:2}[t];this.geometry=new r.LineGeometry({samples:k.samples,strips:k.strips,ribbons:k.ribbons,layers:k.layers,anchor:k.anchor,closed:k.closed,detail:m});this._adopt(p);this._adopt(this.geometry.uniforms);f=f.material();k={};z&&(k.LINE_STROKE="");O&&(k.LINE_CLIP="");J!=null&&(k.LINE_PROXIMITY="");k["LINE_JOIN_"+t.toUpperCase()]="";m>1&&(k.LINE_JOIN_DETAIL=m);W&&(k.LINE_CLOSED="");m=f.vertex;m.pipe(this._vertexColor(B,D));m.require(this._vertexPosition(y,v,G,2,K));m.pipe("line.position",
this.uniforms,k);m.pipe("project.position",this.uniforms);k=f.fragment;z&&k.pipe(`fragment.clip.${z}`,this.uniforms);O&&k.pipe("fragment.clip.ends",this.uniforms);J!=null&&k.pipe("fragment.clip.proximity",this.uniforms);k.pipe(this._fragmentColor(g,v,B,D,G,2,K,I,Q));k.pipe("fragment.color",this.uniforms);g=f.link({side:x.DoubleSide});this.material=this._material(g);f=new x.Mesh(this.geometry,this.material);f.userData=g;this._raw(f);this.renders=[f]}dispose(){this.geometry.dispose();this.material.dispose();
this.renders=this.geometry=this.material=null;return super.dispose()}}};
shadow$provide[343]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},MatrixBuffer:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(329);class r extends l.DataBuffer{constructor(e,g,f){const k=f.width||1,m=f.height||1,p=f.history||1;f.depth=p;super(e,g,f,!1);this.width=k;this.height=m;this.history=p;this.samples=k*m;this.wrap=p>1;this.build(f)}build(e){super.build();this.index=0;this.pad={x:0,y:0};return this.streamer=this.generate(this.data)}getFilled(){return this.filled}setActive(e,
g){let f;return[this.pad.x,this.pad.y]=Array.from(f=[Math.max(0,this.width-e),Math.max(0,this.height-g)]),f}fill(){let e,g,f;const {callback:k}=this;typeof k.reset==="function"&&k.reset();const {emit:m,skip:p,count:z,done:t,reset:v}=this.streamer;v();const y=this.width,B=this.pad.x,D=this.samples-this.pad.y*y;let G=e=g=0;if(B)for(;!t()&&g<D&&(g++,f=k(m,G,e),++G===y-B&&(p(B),g+=B,G=0,e++),f!==!1););else for(;!t()&&g<D&&(g++,f=k(m,G,e),++G===y&&(G=0,e++),f!==!1););return Math.floor(z()/this.items)}write(e){e==
null&&(e=this.samples);e*=this.items;const g=this.width*this.items;this.texture.write(this.data,0,this.index*this.height,g,Math.ceil(e/g));this.dataPointer.set(.5,this.index*this.height+.5);this.index=(this.index+this.history-1)%this.history;return this.filled=Math.min(this.history,this.filled+1)}through(e,g){let f,k,m;const {consume:p,skip:z,done:t}=m=this.streamer,{emit:v}=f=g.streamer;let y=k=0,B=()=>p((D,G,I,K)=>e(v,D,G,I,K,y,k));B=x.repeatCall(B,this.items);return()=>{let D;m.reset();f.reset();
const G=this.width,I=this.pad.x,K=this.samples-this.pad.y*G;y=k=D=0;if(I)for(;!t()&&D<K;)D++,B(),++y===G-I&&(z(I),y=0,k++);else for(;!t()&&D<K;)D++,B(),++y===G&&(y=0,k++);return m.count()}}}};
shadow$provide[344]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},RenderTarget:{enumerable:!0,get:function(){return r}}});var x=l(101);class r{constructor(e,g,f,k,m){this.gl=e;m==null&&(m={});m.minFilter==null&&(m.minFilter=x.NearestFilter);m.magFilter==null&&(m.magFilter=x.NearestFilter);m.format==null&&(m.format=x.RGBAFormat);m.type==null&&(m.type=x.UnsignedByteType);this.options=m;this.width=g||1;this.height=f||1;this.frames=k||1;this.buffers=this.frames+1;this.build()}build(){let e;
const g=()=>new x.WebGLRenderTarget(this.width,this.height,this.options);this.targets=(()=>{let k,m;const p=[];e=0;m=this.buffers;for(k=0<=m;k?e<m:e>m;k?e++:e--)p.push(g());return p})();const f=[];this.targets.forEach(k=>f.push(k.texture));this.reads=f;this.write=this.targets[this.buffers-1];this.uniforms={dataResolution:{type:"v2",value:new x.Vector2(1/this.width,1/this.height)},dataTexture:{type:"t",value:this.reads[0]},dataTextures:{type:"tv",value:this.reads}}}cycle(){this.targets.unshift(this.targets.pop());
this.write=this.targets[this.buffers-1];this.reads.unshift(this.reads.pop());this.uniforms.dataTexture.value=this.reads[0]}warmup(e){return(()=>{const g=[];for(let f=0,k=this.buffers,m=0<=k;m?f<k:f>k;m?f++:f--)e(this.write),g.push(this.cycle());return g})()}dispose(){for(const e of Array.from(this.targets))e.dispose();return this.targets=this.reads=this.write=null}}};
shadow$provide[345]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},RenderToTexture:{enumerable:!0,get:function(){return g}}});var x=l(199),r=l(101),e=l(344);l=l(324);class g extends l.Renderable{constructor(f,k,m){super(f,k);this.scene=m.scene!=null?m.scene:new r.Scene;this.camera=m.camera;this.build(m)}shaderRelative(f){f==null&&(f=this.shaders.shader());return f.pipe("sample.2d",this.uniforms)}shaderAbsolute(f,k,m){k==null&&(k=1);m==null&&(m=4);f==null&&(f=this.shaders.shader());
if(k<=1)return m>2&&f.pipe(x.truncateVec(m,2)),f.pipe("map.2d.data",this.uniforms),f.pipe("sample.2d",this.uniforms);k=x.sample2DArray(Math.min(k,this.target.frames));m<4&&f.pipe(x.extendVec(m,4));f.pipe("map.xyzw.2dv");f.split();f.pipe("map.2d.data",this.uniforms);f.pass();return f.pipe(k,this.uniforms)}build(f){this.camera||(this.camera=new r.PerspectiveCamera,this.camera.position.set(0,0,3),this.camera.lookAt(new r.Vector3));typeof this.scene.inject==="function"&&this.scene.inject();this.target=
new e.RenderTarget(this.gl,f.width,f.height,f.frames,f);this.target.warmup(k=>this.renderer.setRenderTarget(k));this.renderer.setRenderTarget(null);this._adopt(this.target.uniforms);this._adopt({dataPointer:{type:"v2",value:new r.Vector2(.5,.5)}});return this.filled=0}adopt(f){return Array.from(f.renders).map(k=>this.scene.add(k))}unadopt(f){return Array.from(f.renders).map(k=>this.scene.remove(k))}render(f){f==null&&({camera:f}=this);const k=this.renderer.getRenderTarget();this.renderer.setRenderTarget(this.target.write);
this.renderer.render(this.scene.scene!=null?this.scene.scene:this.scene,f);this.renderer.setRenderTarget(k);this.target.cycle();if(this.filled<this.target.frames)return this.filled++}read(f){f==null&&(f=0);return this.target.reads[Math.abs(f)]}getFrames(){return this.target.frames}getFilled(){return this.filled}dispose(){typeof this.scene.unject==="function"&&this.scene.unject();this.scene=this.camera=null;this.target.dispose();return super.dispose()}}};
shadow$provide[346]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Memo:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(345);class r extends l.RenderToTexture{constructor(e,g,f){let k,m;const p=f.items||1,z=f.channels||4,t=f.width||1,v=f.height||1,y=f.depth||1;f.format=x.RGBAFormat;f.width=m=p*t;f.height=k=v*y;f.frames=1;delete f.items;delete f.depth;delete f.channels;super(e,g,f);this.items==null&&(this.items=p);this.channels==null&&(this.channels=z);this.width==
null&&(this.width=t);this._width=m;this.height==null&&(this.height=v);this._height=k;this.depth==null&&(this.depth=y);this._adopt({textureItems:{type:"f",value:this.items},textureHeight:{type:"f",value:this.height}})}shaderAbsolute(e){e==null&&(e=this.shaders.shader());e.pipe("map.xyzw.texture",this.uniforms);return super.shaderAbsolute(e,1,2)}}};
shadow$provide[347]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},SurfaceGeometry:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(332);class r extends l.ClipGeometry{constructor(e,g){g==null&&(g=!0);super();g&&this.construct(e)}construct(e){var g,f;let k,m,p;this._clipUniforms();this.closedX=g=e.closedX||!1;this.closedY=f=e.closedY||!1;this.width=g=(+e.width||2)+(g?1:0);this.height=f=(+e.height||2)+(f?1:0);this.surfaces=p=+e.surfaces||1;this.layers=e=+e.layers||
1;this.segmentsX=k=Math.max(0,g-1);this.segmentsY=m=Math.max(0,f-1);var z=g*f*p*e;this.setIndex(new x.BufferAttribute(new Uint32Array(k*m*p*e*2*3),1));this.setAttribute("position4",new x.BufferAttribute(new Float32Array(z*4),4));this.setAttribute("surface",new x.BufferAttribute(new Float32Array(z*2),2));z=this._emitter("index");const t=this._emitter("position4");let v=0;for(let y=0,B=p*e,D=0<=B;D?y<B:y>B;D?y++:y--){for(let G=0,I=m,K=0<=I;K?G<I:G>I;K?G++:G--){for(let Q=0,O=k,J=0<=O;J?Q<O:Q>O;J?Q++:
Q--)z(v),z(v+1),z(v+g),z(v+g),z(v+1),z(v+g+1),v++;v++}v+=g}for(let y=0,B=e,D=0<=B;D?y<B:y>B;D?y++:y--)for(let G=0,I=p,K=0<=I;K?G<I:G>I;K?G++:G--)for(let Q=0,O=Q,J=f,W=0<=J;W?Q<J:Q>J;W?Q++:Q--,O=Q)for(let ba=0,Y=ba,S=g,ca=0<=S;ca?ba<S:ba>S;ca?ba++:ba--,Y=ba)t(Y,O,G,y);this._finalize();this.clip()}clip(e,g,f,k){e==null&&(e=this.width-this.closedX);g==null&&(g=this.height-this.closedY);f==null&&({surfaces:f}=this);k==null&&({layers:k}=this);e+=this.closedX;g+=this.closedY;const m=Math.max(0,e-1),p=Math.max(0,
g-1);this._clipGeometry(e,g,f,k);return this._clipOffsets(6,m,p,f,k,this.segmentsX,this.segmentsY,this.surfaces,this.layers)}map(e,g,f,k){e==null&&({width:e}=this);g==null&&({height:g}=this);f==null&&({surfaces:f}=this);k==null&&({layers:k}=this);return this._clipMap(e,g,f,k)}}};
shadow$provide[348]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},ScreenGeometry:{enumerable:!0,get:function(){return r}}});L=l(347);var x=l(101);class r extends L.SurfaceGeometry{constructor(e){e.width=Math.max(2,+e.width);e.height=Math.max(2,+e.height);super(e,!1);this.uniforms==null&&(this.uniforms={});this.uniforms.geometryScale={type:"v4",value:new x.Vector4};this.cover();this.construct(e)}cover(e,g,f,k){e==null&&(e=1);this.scaleX=e;g==null&&(g=1);this.scaleY=
g;f==null&&(f=1);this.scaleZ=f;k==null&&(k=1);this.scaleW=k}clip(e,g,f,k){e==null&&({width:e}=this);g==null&&({height:g}=this);f==null&&({surfaces:f}=this);k==null&&({layers:k}=this);super.clip(e,g,f,k);return this.uniforms.geometryScale.value.set(1/Math.max(1,e-1)*this.scaleX,1/Math.max(1,g-1)*this.scaleY,1/Math.max(1,f-1)*this.scaleZ,1/Math.max(1,k-1)*this.scaleW)}}};
shadow$provide[349]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Screen:{enumerable:!0,get:function(){return e}}});var x=l(101);L=l(334);var r=l(348);class e extends L.Base{constructor(g,f,k){super(g,f,k);let {uniforms:m}=k;const {map:p,combine:z,stpq:t,linear:v}=k;m==null&&(m={});g=m.styleColor!=null;this.geometry=new r.ScreenGeometry({width:k.width,height:k.height});this._adopt(m);this._adopt(this.geometry.uniforms);f=f.material();k=f.vertex;k.pipe("raw.position.scale",
this.uniforms);k.fan();k.pipe("stpq.xyzw.2d",this.uniforms);k.next();k.pipe("screen.position",this.uniforms);k.join();f.fragment=g=this._fragmentColor(g,!1,null,null,p,2,t,z,v);g.pipe("fragment.color",this.uniforms);g=f.link({side:x.DoubleSide});this.material=this._material(g);f=new x.Mesh(this.geometry,this.material);f.frustumCulled=!1;f.userData=g;this._raw(f);this.renders=[f]}dispose(){this.geometry.dispose();this.material.dispose();this.renders=this.geometry=this.material=null;return super.dispose()}}
};
shadow$provide[350]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},MemoScreen:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(349);class r extends l.Screen{constructor(e,g,f){const {items:k,width:m,height:p,depth:z,stpq:t}=f,v={remapUVScale:{type:"v2",value:new x.Vector2(k*m,p*z)},remapModulus:{type:"v2",value:new x.Vector2(k,p)},remapModulusInv:{type:"v2",value:new x.Vector2(1/Math.max(1,k),1/Math.max(1,p))},remapSTPQScale:{type:"v4",value:new x.Vector4(1/
Math.max(1,m-1),1/Math.max(1,p-1),1/Math.max(1,z-1),1/Math.max(1,k-1))}},y=g.shader();y.pipe("screen.map.xyzw",v);f.map!=null&&(t&&y.pipe("screen.map.stpq",v),y.pipe(f.map));super(e,g,{map:y,linear:!0});this.memo=f;this.uniforms=v;for(const B of Array.from(this.renders))B.transparent=!1}cover(e,g,f,k){e==null&&({width:e}=this.memo);g==null&&({height:g}=this.memo);f==null&&({depth:f}=this.memo);k==null&&({items:k}=this.memo);this.uniforms.remapSTPQScale.value.set(1/Math.max(1,e-1),1/Math.max(1,g-1),
1/Math.max(1,f-1),1/Math.max(1,k-1));e/=this.memo.width;f/=this.memo.depth;this.memo.depth===1&&(f=g/this.memo.height);return this.geometry.cover(e,f)}}};
shadow$provide[351]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},SpriteGeometry:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(332);class r extends l.ClipGeometry{constructor(e){let g,f,k;super(e);this._clipUniforms();this.items=f=+e.items||2;this.width=k=+e.width||1;this.height=g=+e.height||1;this.depth=e=+e.depth||1;const m=f*k*g*e;var p=m*4;this.setIndex(new x.BufferAttribute(new Uint32Array(m*2*3),1));this.setAttribute("position4",new x.BufferAttribute(new Float32Array(p*
4),4));this.setAttribute("sprite",new x.BufferAttribute(new Float32Array(p*2),2));p=this._emitter("index");const z=this._emitter("position4"),t=this._emitter("sprite"),v=[[-1,-1],[-1,1],[1,-1],[1,1]];let y=0;for(let B=0,D=m,G=0<=D;G?B<D:B>D;G?B++:B--)p(y),p(y+1),p(y+2),p(y+1),p(y+2),p(y+3),y+=4;for(let B=0,D=e,G=0<=D;G?B<D:B>D;G?B++:B--)for(let I=0,K=g,Q=0<=K;Q?I<K:I>K;Q?I++:I--)for(let O=0,J=k,W=0<=J;W?O<J:O>J;W?O++:O--)for(let ba=0,Y=f,S=0<=Y;S?ba<Y:ba>Y;S?ba++:ba--)for(const ca of Array.from(v))z(O,
I,B,ba),t(ca[0],ca[1]);this._finalize();this.clip()}clip(e,g,f,k){e==null&&({width:e}=this);g==null&&({height:g}=this);f==null&&({depth:f}=this);k==null&&({items:k}=this);this._clipGeometry(e,g,f,k);return this._clipOffsets(6,e,g,f,k,this.width,this.height,this.depth,this.items)}}};
shadow$provide[352]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Point:{enumerable:!0,get:function(){return e}}});var x=l(101);L=l(334);var r=l(351);class e extends L.Base{constructor(g,f,k){var m;super(g,f,k);let {uniforms:p,shape:z,fill:t}=k;const {material:v,position:y,color:B,size:D,mask:G,map:I,combine:K,linear:Q,optical:O,stpq:J}=k;p==null&&(p={});z=+z;t==null&&(t=!0);var W=p.styleColor!=null;g="circle square diamond up down left right".split(" ");var ba="circle generic generic generic generic generic generic".split(" ");
var Y=[1.2,1,1.414,1.16,1.16,1.16,1.16];ba=ba[z]!=null?ba[z]:ba[0];g=g[z]!=null?g[z]:g[0];Y=(m=O&&Y[z])!=null?m:1;m=t?ba:`${ba}.hollow`;this.geometry=new r.SpriteGeometry({items:k.items,width:k.width,height:k.height,depth:k.depth});this._adopt(p);this._adopt(this.geometry.uniforms);ba={POINT_SHAPE_SCALE:+(Y+1E-5)};k=f.material();Y=k.vertex;Y.pipe(this._vertexColor(B,G));D?(Y.isolate(),Y.require(D),Y.require("point.size.varying",this.uniforms),Y.end()):Y.require("point.size.uniform",this.uniforms);
Y.require(this._vertexPosition(y,v,I,2,J));Y.pipe("point.position",this.uniforms,ba);Y.pipe("project.position",this.uniforms);k.fragment=this._fragmentColor(W,v,B,G,I,2,J,K,Q);W=f.material();W.vertex.pipe(Y);ba=W.fragment.pipe(k.fragment);ba.require(`point.mask.${g}`,this.uniforms);ba.require(`point.alpha.${m}`,this.uniforms);ba.pipe("point.edge",this.uniforms);f=f.material();f.vertex.pipe(Y);ba=f.fragment.pipe(k.fragment);ba.require(`point.mask.${g}`,this.uniforms);ba.require(`point.alpha.${m}`,
this.uniforms);ba.pipe("point.fill",this.uniforms);f=f.link({side:x.DoubleSide});this.fillMaterial=this._material(f);g=W.link({side:x.DoubleSide});this.edgeMaterial=this._material(g);this.fillObject=new x.Mesh(this.geometry,this.fillMaterial);this.edgeObject=new x.Mesh(this.geometry,this.edgeMaterial);this._raw(this.fillObject);this.fillObject.userData=f;this._raw(this.edgeObject);this.edgeObject.userData=g;this.renders=[this.fillObject,this.edgeObject]}show(g,f,k,m){this._show(this.edgeObject,!0,
f,k,m);return this._show(this.fillObject,g,f,k,m)}dispose(){this.geometry.dispose();this.edgeMaterial.dispose();this.fillMaterial.dispose();this.renders=this.edgeObject=this.fillObject=this.geometry=this.edgeMaterial=this.fillMaterial=null;return super.dispose()}}};
shadow$provide[353]=function(l,L,q){function x(e,g,f){const k=[],m=e<g;for(g=f?m?g+1:g-1:g;m?e<g:e>g;m?e++:e--)k.push(e);return k}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},PushBuffer:{enumerable:!0,get:function(){return r}}});l=l(327);class r extends l.Buffer{constructor(e,g,f){const k=f.width||1,m=f.height||1,p=f.depth||1,z=k*m*p;f.samples||(f.samples=z);super(e,g,f);this.width=k;this.height=m;this.depth=p;this.samples==null&&(this.samples=z);this.build(f)}build(e){this.data=
[];this.data.length=this.samples;this.filled=0;this.pad={x:0,y:0,z:0};return this.streamer=this.generate(this.data)}dispose(){this.data=null;return super.dispose()}getFilled(){return this.filled}setActive(e,g,f){let k;return[this.pad.x,this.pad.y,this.pad.z]=Array.from(k=[this.width-e,this.height-g,this.depth-f]),k}read(){return this.data}copy(e){const g=this.data;return x(0,Math.min(e.length,this.samples),!1).map(f=>g[f]=e[f])}fill(){let e,g,f,k;const {callback:m}=this;typeof m.reset==="function"&&
m.reset();const {emit:p,skip:z,count:t,done:v,reset:y}=this.streamer;y();const B=this.width,D=this.height,G=this.pad.x,I=this.pad.y,K=this.samples-this.pad.z*B*D;let Q=e=g=f=0;if(G>0||I>0)for(;!v()&&f<K&&(f++,k=m(p,Q,e,g),++Q===B-G&&(z(G),Q=0,++e===D-I&&(z(B*I),e=0,g++)),k!==!1););else for(;!v()&&f<K&&(f++,k=m(p,Q,e,g),++Q===B&&(Q=0,++e===D&&(e=0,g++)),k!==!1););this.filled=1;return t()}}};
shadow$provide[354]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Readback:{enumerable:!0,get:function(){return k}}});var x=l(198),r=l(199),e=l(101),g=l(346),f=l(350);l=l(324);class k extends l.Renderable{constructor(m,p,z){super(m,p);this.items==null&&(this.items=z.items||1);this.channels==null&&(this.channels=z.channels||4);this.width==null&&(this.width=z.width||1);this.height==null&&(this.height=z.height||1);this.depth==null&&(this.depth=z.depth||1);this.type==
null&&(this.type=z.type||e.FloatType);this.stpq==null&&(this.stpq=z.stpq||!1);this.isFloat=this.type===e.FloatType;this.active=this.sampled=this.rect=this.pad=null;this.build(z)}build(m){let p;({map:G}=m);({indexer:I}=m);m=I!=null&&!I.empty();let {stpq:z}=this;const {items:t,width:v,height:y,depth:B}=this;let D=G;m&&(this._adopt({indexModulus:{type:"v4",value:new e.Vector4(t,t*v,t*v*y,1)}}),D=this.shaders.shader(),D.require(G),D.require(I),D.pipe("float.index.pack",this.uniforms));this.isFloat&&this.channels>
1&&(this.floatMemo=new g.Memo(this.renderer,this.shaders,{items:t,channels:4,width:v,height:y,depth:B,history:0,type:e.FloatType}),this.floatCompose=new f.MemoScreen(this.renderer,this.shaders,{map:D,items:t,width:v,height:y,depth:B,stpq:z}),this.floatMemo.adopt(this.floatCompose),z=!1,D=this.shaders.shader(),this.floatMemo.shaderAbsolute(D));if(this.isFloat){p=this.channels;var G=4}else p=1,G=this.channels;if(p>1){var I=this.shaders.shader();I.pipe(r.mapByte2FloatOffset(p));I.require(D);I.pipe("float.stretch");
I.pipe("float.encode");D=I}else this.isFloat&&(I=this.shaders.shader(),I.pipe(D),I.pipe(r.truncateVec(4,1)),I.pipe("float.encode"),D=I);this.byteMemo=new g.Memo(this.renderer,this.shaders,{items:t*p,channels:G,width:v,height:y,depth:B,history:0,type:e.UnsignedByteType});this.byteCompose=new f.MemoScreen(this.renderer,this.shaders,{map:D,items:t*p,width:v,height:y,depth:B,stpq:z});this.byteMemo.adopt(this.byteCompose);this.samples=this.width*this.height*this.depth;this.bytes=new Uint8Array(t*v*p*(y*
B)*4);this.isFloat&&(this.floats=new Float32Array(this.bytes.buffer));this.data=this.isFloat?this.floats:this.bytes;this.streamer=this.generate(this.data);this.active={items:0,width:0,height:0,depth:0};this.sampled={items:0,width:0,height:0,depth:0};this.rect={w:0,h:0};this.pad={x:0,y:0,z:0,w:0};this.stretch=p;this.isIndexed=m;return this.setActive(t,v,y,B)}generate(m){return x.getStreamer(m,this.samples,4,this.items)}setActive(m,p,z,t){let v;if(m!==this.active.items||p!==this.active.width||z!==this.active.height||
t!==this.active.depth){[this.active.items,this.active.width,this.active.height,this.active.depth]=Array.from([m,p,z,t]);this.floatCompose!=null&&this.floatCompose.cover(p,z,t);this.byteCompose!=null&&this.byteCompose.cover(p*this.stretch,z,t);({items:m}=this);({width:p}=this.active);z=this.depth===1?this.active.height:this.height;({depth:t}=this.active);var y=m*p*this.stretch,B=z*t;[this.sampled.items,this.sampled.width,this.sampled.height,this.sampled.depth]=Array.from([m,p,z,t]);[this.rect.w,this.rect.h]=
Array.from([y,B]);return[this.pad.x,this.pad.y,this.pad.z,this.pad.w]=Array.from(v=[this.sampled.width-this.active.width,this.sampled.height-this.active.height,this.sampled.depth-this.active.depth,this.sampled.items-this.active.items]),v}}update(m){this.floatMemo!=null&&this.floatMemo.render(m);return this.byteMemo!=null?this.byteMemo.render(m):void 0}post(){const m=this.renderer.getRenderTarget();this.renderer.setRenderTarget(this.byteMemo.target.targets[0]);this.gl.readPixels(0,0,this.rect.w,this.rect.h,
this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.bytes);this.renderer.setRenderTarget(m)}readFloat(m){return this.floatMemo!=null?this.floatMemo.read(m):void 0}readByte(m){return this.byteMemo!=null?this.byteMemo.read(m):void 0}setCallback(m){this.emitter=this.callback(m)}callback(m){if(!this.isIndexed)return m;const p=this.width,z=this.height,t=this.items,v=function(y,B,D,G){let I=G;const K=I%t;I=(I-K)/t;const Q=I%p;I=(I-Q)/p;const O=I%z;I=(I-O)/z;return m(y,B,D,G,Q,O,I,K)};v.reset=()=>typeof m.reset==="function"?
m.reset():void 0;return v}iterate(){let m,p,z,t=this.emitter;typeof t.reset==="function"&&t.reset();const {consume:v,skip:y,count:B,done:D,reset:G}=this.streamer;G();const I=this.sampled.width|0;let K=this.sampled.height|0;const Q=this.sampled.items|0,O=this.pad.x|0,J=this.pad.y|0,W=this.pad.w|0,ba=I*K*Q*((this.sampled.depth|0)-(this.pad.z|0));if(!this.isIndexed){const S=t;t=(ca,V,xa,na)=>S(ca,V,xa,na,Y,m,p,z)}let Y=m=p=z=K=0;for(;!D()&&K<ba;){K++;const S=v(t);++z===Q-W&&(y(O),z=0,++Y===I-O&&(y(Q*
O),Y=0,++m===K-J&&(y(Q*I*J),m=0,p++)));if(S===!1)break}return Math.floor(B()/Q)}dispose(){this.floatMemo!=null&&this.floatMemo.unadopt(this.floatCompose);this.floatMemo!=null&&this.floatMemo.dispose();this.floatCompose!=null&&this.floatCompose.dispose();this.byteMemo!=null&&this.byteMemo.unadopt(this.byteCompose);this.byteMemo!=null&&this.byteMemo.dispose();this.byteCompose!=null&&this.byteCompose.dispose();return this.floatMemo=this.byteMemo=this.floatCompose=this.byteCompose=null}}};
shadow$provide[355]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Sprite:{enumerable:!0,get:function(){return e}}});var x=l(101);L=l(334);var r=l(351);class e extends L.Base{constructor(g,f,k){var m;super(g,f,k);({uniforms:m}=k);const {material:p,position:z,sprite:t,map:v,combine:y,linear:B,color:D,mask:G,stpq:I}=k;m==null&&(m={});g=m.styleColor!=null;this.geometry=new r.SpriteGeometry({items:k.items,width:k.width,height:k.height,depth:k.depth});this._adopt(m);this._adopt(this.geometry.uniforms);
m=f.material();k=m.vertex;k.pipe(this._vertexColor(D,G));k.require(this._vertexPosition(z,p,v,2,I));k.require(t);k.pipe("sprite.position",this.uniforms);k.pipe("project.position",this.uniforms);m.fragment=m=this._fragmentColor(g,p,D,G,v,2,I,y,B);g=f.material();g.vertex.pipe(k);g.fragment.pipe(m);g.fragment.pipe("fragment.transparent",this.uniforms);f=f.material();f.vertex.pipe(k);f.fragment.pipe(m);f.fragment.pipe("fragment.solid",this.uniforms);f=f.link({side:x.DoubleSide});this.fillMaterial=this._material(f);
k=g.link({side:x.DoubleSide});this.edgeMaterial=this._material(k);this.fillObject=new x.Mesh(this.geometry,this.fillMaterial);this.edgeObject=new x.Mesh(this.geometry,this.edgeMaterial);this._raw(this.fillObject);this.fillObject.userData=f;this._raw(this.edgeObject);this.edgeObject.userData=k;this.renders=[this.fillObject,this.edgeObject]}show(g,f,k,m){this._show(this.edgeObject,!0,f,k,m);return this._show(this.fillObject,g,f,k,m)}dispose(){this.geometry.dispose();this.edgeMaterial.dispose();this.fillMaterial.dispose();
this.renders=this.geometry=this.edgeMaterial=this.fillMaterial=this.edgeObject=this.fillObject=null;return super.dispose()}}};
shadow$provide[356]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},StripGeometry:{enumerable:!0,get:function(){return r}}});var x=l(101);l=l(332);class r extends l.ClipGeometry{constructor(e){let g;var f;let k,m;super(e);this._clipUniforms();this.items=f=+e.items||2;this.width=m=+e.width||1;this.height=g=+e.height||1;this.depth=e=+e.depth||1;this.sides=k=Math.max(0,f-2);var p=m*g*e,z=f*p;this.setIndex(new x.BufferAttribute(new Uint32Array(k*p*3),1));this.setAttribute("position4",
new x.BufferAttribute(new Float32Array(z*4),4));this.setAttribute("strip",new x.BufferAttribute(new Float32Array(z*3),3));const t=this._emitter("index");z=this._emitter("position4");const v=this._emitter("strip");let y=0;for(let B=0,D=p,G=0<=D;G?B<D:B>D;G?B++:B--){p=y;for(let I=0,K=k,Q=0<=K;Q?I<K:I>K;Q?I++:I--)I&1?(t(p+1),t(p)):(t(p),t(p+1)),t(p+2),p++;y+=f}--f;for(let B=0,D=e,G=0<=D;G?B<D:B>D;G?B++:B--)for(let I=0,K=g,Q=0<=K;Q?I<K:I>K;Q?I++:I--)for(let O=0,J=m,W=0<=J;W?O<J:O>J;W?O++:O--){e=1;z(O,
I,B,0);v(1,2,e);for(let ba=1,Y=f,S=1<=Y;S?ba<Y:ba>Y;S?ba++:ba--)z(O,I,B,ba),v(ba-1,ba+1,e=-e);z(O,I,B,f);v(f-2,f-1,-e)}this._finalize();this.clip()}clip(e,g,f,k){e==null&&({width:e}=this);g==null&&({height:g}=this);f==null&&({depth:f}=this);k==null&&({items:k}=this);const m=Math.max(0,k-2);this._clipGeometry(e,g,f,k);return this._clipOffsets(3,e,g,f,m,this.width,this.height,this.depth,this.sides)}}};
shadow$provide[357]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Strip:{enumerable:!0,get:function(){return e}}});var x=l(101);L=l(334);var r=l(356);class e extends L.Base{constructor(g,f,k){super(g,f,k);let {uniforms:m,material:p}=k;const {position:z,color:t,mask:v,map:y,combine:B,linear:D,stpq:G}=k;m==null&&(m={});p==null&&(p=!0);g=m.styleColor!=null;this.geometry=new r.StripGeometry({items:k.items,width:k.width,height:k.height,depth:k.depth});this._adopt(m);this._adopt(this.geometry.uniforms);
f=f.material();k=f.vertex;k.pipe(this._vertexColor(t,v));k.require(this._vertexPosition(z,p,y,2,G));p||k.pipe("mesh.position",this.uniforms);p&&k.pipe("strip.position.normal",this.uniforms);k.pipe("project.position",this.uniforms);f.fragment=g=this._fragmentColor(g,p,t,v,y,2,G,B,D);g.pipe("fragment.color",this.uniforms);g=f.link({side:x.DoubleSide});this.material=this._material(g);f=new x.Mesh(this.geometry,this.material);f.userData=g;this._raw(f);this.renders=[f]}dispose(){this.geometry.dispose();
this.material.dispose();this.renders=this.geometry=this.material=null;return super.dispose()}}};
shadow$provide[358]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Surface:{enumerable:!0,get:function(){return e}}});var x=l(101);L=l(334);var r=l(347);class e extends L.Base{constructor(g,f,k){super(g,f,k);let {uniforms:m,material:p}=k;const {position:z,color:t,normal:v,mask:y,map:B,combine:D,linear:G,stpq:I,intUV:K}=k;m==null&&(m={});p==null&&(p=!0);g=m.styleColor!=null;this.geometry=new r.SurfaceGeometry({width:k.width,height:k.height,surfaces:k.surfaces,layers:k.layers,
closedX:k.closedX,closedY:k.closedY});this._adopt(m);this._adopt(this.geometry.uniforms);var Q={};k.closedX&&(Q.SURFACE_CLOSED_X="");k.closedY&&(Q.SURFACE_CLOSED_Y="");K&&(Q.POSITION_UV_INT="");f=f.material();k=f.vertex;k.pipe(this._vertexColor(t,y));k.require(this._vertexPosition(z,p,B,2,I));v?(k.require(v),k.pipe("surface.position.normal",this.uniforms,Q)):(p||k.pipe("surface.position",this.uniforms,Q),p&&k.pipe("surface.position.shaded",this.uniforms,Q));k.pipe("project.position",this.uniforms);
f.fragment=g=this._fragmentColor(g,p,t,y,B,2,I,D,G);g.pipe("fragment.color",this.uniforms);g=f.link({side:x.DoubleSide});this.material=this._material(g);Q=new x.Mesh(this.geometry,this.material);Q.userData=g;this._raw(Q);this.renders=[Q]}dispose(){this.geometry.dispose();this.material.dispose();this.renders=this.geometry=this.material=null;return super.dispose()}}};
shadow$provide[359]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},TextAtlas:{enumerable:!0,get:function(){return r}}});L=l(337);var x=l(101);class r extends L.Atlas{constructor(e,g,f){let k;f.width||(f.width=256);f.height||(f.height=256);f.type=x.UnsignedByteType;f.channels=1;f.backed=!0;super(e,g,f,!1);this.font=f.font!=null?f.font:["sans-serif"];this.size=f.size||24;this.style=f.style!=null?f.style:"normal";this.variant=f.variant!=null?f.variant:"normal";this.weight=
f.weight!=null?f.weight:"normal";this.outline=(k=+(f.outline!=null?f.outline:5))!=null?k:0;this.gamma=1;typeof navigator!=="undefined"&&(e=navigator.userAgent,e.match(/Chrome/)&&e.match(/OS X/)&&(this.gamma=.5));this.scratchW=this.scratchH=0;this.build(f)}build(e){super.build(e);e=16;e=this.size;e+=4+2*Math.min(1,this.outline);const g=32*e,f=document.createElement("canvas");f.width=g;f.height=e;var k=this.font.map(z=>`${z.replace(/(['"\\])/g,"\\$1")}`).join(", ");const m=f.getContext("2d",{willReadFrequently:!0});
m.font=`${this.style} ${this.variant} ${this.weight} ${this.size}px ${k}`;m.fillStyle="#FF0000";m.textAlign="left";m.textBaseline="bottom";m.lineJoin="round";k=[];var p=this.outline*3;for(let z=0,t=p,v=0<=t;v?z<t:z>t;v?z++:z--)p=("00"+Math.max(0,-z*8+128-!z*8).toString(16)).slice(-2),k.push("#"+p+p+p);p=new Uint8Array(g*e*2);this.canvas=f;this.context=m;this.lineHeight=e;this.maxWidth=g;this.colors=k;this.scratch=p;this._allocate=this.allocate.bind(this);return this._write=this.write.bind(this)}reset(){super.reset();
return this.mapped={}}begin(){return Array.from(this.rows).map(e=>e.alive=0)}end(){const {mapped:e}=this;for(const g of Array.from(this.rows.slice()))if(g.alive===0){for(const f of Array.from(g.keys))delete e[f];this.collapse(g)}}map(e,g){const {mapped:f}=this;var k=f[e];if(k!=null)return k.row.alive++,g(k.x,k.y,k.w,k.h);this.draw(e);const m=this.scratch,p=this.scratchW,z=this.scratchH;k=this._allocate;const t=this._write;return k(e,p,z,function(v,y,B){f[e]={x:y,y:B,w:p,h:z,row:v};t(m,y,B,p,z);return g(y,
B,p,z)})}draw(e){const g=this.lineHeight;var f=this.outline;var k=this.context;const m=this.scratch;var p=this.maxWidth;var {colors:z}=this,t=f+1,v=Math.round(g*1.05-1);var y=k.measureText(e);p=Math.min(p,Math.ceil(y.width+2*t+1));k.clearRect(0,0,p,g);if(this.outline===0)for(k.fillText(e,t,v),{data:e}=k.getImageData(0,0,p,g),y=3,f=0,z=e.length/4,k=0<=z;k?f<z:f>z;k?f++:f--)m[f]=e[y],y+=4;else{var B;k.globalCompositeOperation="source-over";f=y=f+1;for(B=y<=1;B?f<=1:f>=1;B?f++:f--)y=f>1?f*2-2:f,k.strokeStyle=
z[y-1],k.lineWidth=y,k.strokeText(e,t,v);k.globalCompositeOperation="multiply";k.fillText(e,t,v);({data:e}=k.getImageData(0,0,p,g));y=0;({gamma:t}=this);f=0;z=e.length/4;for(k=0<=z;k?f<z:f>z;k?f++:f--){B=(v=e[y])?e[y+1]/v:1;t===.5&&(B=Math.sqrt(B));B=Math.min(1,Math.max(0,B));const D=256-v;m[f]=Math.max(0,Math.min(255,D+(v-D)*B+2));y+=4}}this.scratchW=p;return this.scratchH=g}}};
shadow$provide[360]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},VoxelBuffer:{enumerable:!0,get:function(){return r}}});var x=l(198);l=l(329);class r extends l.DataBuffer{build(e){super.build();this.pad={x:0,y:0,z:0};return this.streamer=this.generate(this.data)}setActive(e,g,f){let k;return[this.pad.x,this.pad.y,this.pad.z]=Array.from(k=[Math.max(0,this.width-e),Math.max(0,this.height-g),Math.max(0,this.depth-f)]),k}fill(){let e,g,f,k;const {callback:m}=this;typeof m.reset===
"function"&&m.reset();const {emit:p,skip:z,count:t,done:v,reset:y}=this.streamer;y();const B=this.width,D=this.height,G=this.pad.x,I=this.pad.y,K=this.samples-this.pad.z*B*D;let Q=e=g=f=0;if(G>0||I>0)for(;!v()&&f<K&&(f++,k=m(p,Q,e,g),++Q===B-G&&(z(G),f+=G,Q=0,++e===D-I&&(z(B*I),f+=B*I,e=0,g++)),k!==!1););else for(;!v()&&f<K&&(f++,k=m(p,Q,e,g),++Q===B&&(Q=0,++e===D&&(e=0,g++)),k!==!1););return Math.floor(t()/this.items)}through(e,g){let f,k,m,p;const {consume:z,done:t,skip:v}=p=this.streamer,{emit:y}=
f=g.streamer;let B=k=m=0,D=()=>z((G,I,K,Q)=>e(y,G,I,K,Q,B,k,m));D=x.repeatCall(D,this.items);return()=>{let G;p.reset();f.reset();const I=this.width,K=this.height,Q=this.pad.x,O=this.pad.y,J=this.samples-this.pad.z*I*K;B=k=m=G=0;if(Q>0||O>0)for(;!t()&&G<J;)G++,D(),++B===I-Q&&(v(Q),B=0,++k===K-O&&(v(I*O),k=0,m++));else for(;!t()&&G<J;)G++,D(),++B===I&&(B=0,++k===K&&(k=0,m++));return p.count()}}}};
shadow$provide[361]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Classes:{enumerable:!0,get:function(){return O}}});L=l(330);q=l(335);var x=l(337),r=l(329),e=l(338),g=l(340),f=l(342),k=l(343),m=l(346),p=l(350),z=l(352),t=l(353),v=l(354),y=l(345),B=l(325),D=l(349),G=l(355),I=l(357),K=l(358),Q=l(359);l=l(360);const O={sprite:G.Sprite,point:z.Point,line:f.Line,surface:K.Surface,face:g.Face,strip:I.Strip,arrow:q.Arrow,screen:D.Screen,memoScreen:p.MemoScreen,debug:e.Debug,
dataBuffer:r.DataBuffer,arrayBuffer:L.ArrayBuffer_,matrixBuffer:k.MatrixBuffer,voxelBuffer:l.VoxelBuffer,pushBuffer:t.PushBuffer,renderToTexture:y.RenderToTexture,memo:m.Memo,readback:v.Readback,atlas:x.Atlas,textAtlas:Q.TextAtlas,scene:B.Scene}};
shadow$provide[362]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Factory:{enumerable:!0,get:function(){return x.RenderFactory}}});q=l(325);var x=l(326),r=l(361);l.exportCopy(L,q);l.exportCopy(L,q);l.exportCopy(L,r)};
shadow$provide[363]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float worldUnit;\nuniform float lineDepth;\nuniform float lineWidth;\nuniform float focusDepth;\n\nuniform vec4 geometryClip;\nuniform float arrowSize;\nuniform float arrowSpace;\n\nattribute vec4 position4;\nattribute vec3 arrow;\nattribute vec2 attach;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvoid getArrowGeometry(vec4 xyzw, float near, float mid, float far, out vec3 left, out vec3 right, out vec3 middle, out vec3 start) {\n  right  \x3d getPosition(xyzw, 1.0);\n  left   \x3d getPosition(vec4(near, xyzw.yzw), 0.0);\n  middle \x3d getPosition(vec4(mid,  xyzw.yzw), 0.0);\n  start  \x3d getPosition(vec4(far,  xyzw.yzw), 0.0);\n}\n\nmat4 getArrowMatrix(vec3 left, vec3 right, vec3 middle, vec3 start) {\n\n  float depth \x3d focusDepth;\n  if (lineDepth \x3c 1.0) {\n    // Depth blending\n    float z \x3d max(0.00001, -right.z);\n    depth \x3d mix(z, focusDepth, lineDepth);\n  }\n\n  vec3 diff \x3d left - right;\n  float l \x3d length(diff);\n  if (l \x3d\x3d 0.0) {\n    return mat4(1.0, 0.0, 0.0, 0.0,\n                0.0, 1.0, 0.0, 0.0,\n                0.0, 0.0, 1.0, 0.0,\n                0.0, 0.0, 0.0, 1.0);\n  }\n\n  // Construct TBN matrix around shaft\n  vec3 t \x3d normalize(diff);\n  vec3 n \x3d normalize(cross(t, t.yzx + vec3(.1, .2, .3)));\n  vec3 b \x3d cross(n, t);\n\n  // Shrink arrows when vector gets too small\n  // Approach linear scaling with cubic ease the smaller we get\n  float size \x3d arrowSize * lineWidth * worldUnit * depth * 1.25;\n  l \x3d max(length(right - middle), length(middle - start)) * 2.0 * arrowSpace;\n  float mini \x3d clamp(1.0 - l / size * .333, 0.0, 1.0);\n  float scale \x3d 1.0 - mini * mini * mini;\n  float range \x3d size * scale;\n\n  // Size to 2.5:1 ratio\n  float rangeNB \x3d range / 2.5;\n\n  // Anchor at end position\n  return mat4(vec4(n * rangeNB,  0),\n              vec4(b * rangeNB,  0),\n              vec4(t * range, 0),\n              vec4(right,  1.0));\n}\n\nvec3 getArrowPosition() {\n  vec3 left, right, middle, start;\n\n  // Clip arrow position and attachment anchors to data\n  vec4 p \x3d min(geometryClip, position4);\n  vec3 a \x3d vec3(min(geometryClip.x, p.x + attach.x), geometryClip.x / 2.0, min(geometryClip.x, attach.y));\n\n  getArrowGeometry(p, a.x, a.y, a.z, left, right, middle, start);\n  mat4 matrix \x3d getArrowMatrix(left, right, middle, start);\n\n  return (matrix * vec4(arrow.xyz, 1.0)).xyz;\n\n}\n"}}})};
shadow$provide[364]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 axisStep;\nuniform vec4 axisPosition;\n\nvec4 getAxisPosition(vec4 xyzw, inout vec4 stpq) {\n  return axisStep * xyzw.x + axisPosition;\n}\n"}}})};
shadow$provide[365]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 basisScale;\nuniform vec4 basisOffset;\nuniform vec4 viewScale;\nuniform vec4 viewOffset;\n\nvec4 getCartesian4Position(vec4 position, inout vec4 stpq) {\n  return position * basisScale + basisOffset;\n}\n"}}})};
shadow$provide[366]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform mat4 viewMatrix;\n\nvec4 getCartesianPosition(vec4 position, inout vec4 stpq) {\n  return viewMatrix * vec4(position.xyz, 1.0);\n}\n"}}})};
shadow$provide[367]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 clampLimit;\n\nvec4 getClampXYZW(vec4 xyzw) {\n  return clamp(xyzw, vec4(0.0), clampLimit);\n}\n"}}})};
shadow$provide[368]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 opaqueColor(vec4 color) {\n  return vec4(color.rgb, 1.0);\n}\n"}}})};
shadow$provide[369]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 geometryClip;\nattribute vec4 position4;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvec3 getFacePosition() {\n  vec4 p \x3d min(geometryClip, position4);\n  return getPosition(p, 1.0);\n}\n"}}})};
shadow$provide[370]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"attribute vec4 position4;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvarying vec3 vNormal;\nvarying vec3 vLight;\nvarying vec3 vPosition;\n\nvoid getFaceGeometry(vec4 xyzw, out vec3 pos, out vec3 normal) {\n  vec3 a, b, c;\n\n  a   \x3d getPosition(vec4(xyzw.xyz, 0.0), 0.0);\n  b   \x3d getPosition(vec4(xyzw.xyz, 1.0), 0.0);\n  c   \x3d getPosition(vec4(xyzw.xyz, 2.0), 0.0);\n\n  pos \x3d getPosition(xyzw, 1.0);\n  normal \x3d normalize(cross(c - a, b - a));\n}\n\nvec3 getFacePositionNormal() {\n  vec3 center, normal;\n\n  getFaceGeometry(position4, center, normal);\n  vNormal   \x3d normal;\n  vLight    \x3d normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz);\n  vPosition \x3d -center;\n\n  return center;\n}\n"}}})};
shadow$provide[371]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"/*\nFloat encoding technique by\nCarlos Scheidegger\nhttps://github.com/cscheid/lux/blob/master/src/shade/bits/encode_float.js\n\nConversion to GLSL by:\nhttp://concord-consortium.github.io/lab/experiments/webgl-gpgpu/script.js\n*/\n\nfloat shift_right(float v, float amt) { \n  v \x3d floor(v) + 0.5; \n  return floor(v / exp2(amt)); \n}\n\nfloat shift_left(float v, float amt) { \n  return floor(v * exp2(amt) + 0.5); \n}\n\nfloat mask_last(float v, float bits) { \n  return mod(v, shift_left(1.0, bits)); \n}\n\nfloat extract_bits(float num, float from, float to) { \n  from \x3d floor(from + 0.5); to \x3d floor(to + 0.5); \n  return mask_last(shift_right(num, from), to - from); \n}\n\nvec4 encode_float(float val) { \n  if (val \x3d\x3d 0.0) return vec4(0, 0, 0, 0); \n  float valuesign \x3d val \x3e 0.0 ? 0.0 : 1.0; \n  val \x3d abs(val); \n  float exponent \x3d floor(log2(val)); \n  float biased_exponent \x3d exponent + 127.0; \n  float fraction \x3d ((val / exp2(exponent)) - 1.0) * 8388608.0; \n  float t \x3d biased_exponent / 2.0; \n  float last_bit_of_biased_exponent \x3d fract(t) * 2.0; \n  float remaining_bits_of_biased_exponent \x3d floor(t); \n  float byte4 \x3d extract_bits(fraction, 0.0, 8.0) / 255.0; \n  float byte3 \x3d extract_bits(fraction, 8.0, 16.0) / 255.0; \n  float byte2 \x3d (last_bit_of_biased_exponent * 128.0 + extract_bits(fraction, 16.0, 23.0)) / 255.0; \n  float byte1 \x3d (valuesign * 128.0 + remaining_bits_of_biased_exponent) / 255.0; \n  return vec4(byte4, byte3, byte2, byte1); \n}\n"}}})};
shadow$provide[372]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 indexModulus;\n\nvec4 getSample(vec4 xyzw);\nvec4 getIndex(vec4 xyzw);\n\nvec4 floatPackIndex(vec4 xyzw) {\n  vec4 value \x3d getSample(xyzw);\n  vec4 index \x3d getIndex(xyzw);\n\n  vec4 offset \x3d floor(index + .5) * indexModulus;\n  vec2 sum2 \x3d offset.xy + offset.zw;\n  float sum \x3d sum2.x + sum2.y;\n  return vec4(value.xyz, sum);\n}"}}})};
shadow$provide[373]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 getSample(vec4 xyzw);\n\nfloat floatStretch(vec4 xyzw, float channelIndex) {\n  vec4 sample \x3d getSample(xyzw);\n  vec2 xy \x3d channelIndex \x3e 1.5 ? sample.zw : sample.xy;\n  return mod(channelIndex, 2.0) \x3e .5 ? xy.y : xy.x;\n}"}}})};
shadow$provide[374]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vClipStrokeWidth;\nvarying float vClipStrokeIndex;\nvarying vec3  vClipStrokeEven;\nvarying vec3  vClipStrokeOdd;\nvarying vec3  vClipStrokePosition;\n\nvoid clipStrokeFragment() {\n  bool odd \x3d mod(vClipStrokeIndex, 2.0) \x3e\x3d 1.0;\n\n  vec3 tangent;\n  if (odd) {\n    tangent \x3d vClipStrokeOdd;\n  }\n  else {\n    tangent \x3d vClipStrokeEven;\n  }\n\n  float travel \x3d dot(vClipStrokePosition, normalize(tangent)) / vClipStrokeWidth;\n  if (mod(travel, 16.0) \x3e 8.0) {\n    discard;\n  }\n}\n"}}})};
shadow$provide[375]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vClipStrokeWidth;\nvarying float vClipStrokeIndex;\nvarying vec3  vClipStrokeEven;\nvarying vec3  vClipStrokeOdd;\nvarying vec3  vClipStrokePosition;\n\nvoid clipStrokeFragment() {\n  bool odd \x3d mod(vClipStrokeIndex, 2.0) \x3e\x3d 1.0;\n\n  vec3 tangent;\n  if (odd) {\n    tangent \x3d vClipStrokeOdd;\n  }\n  else {\n    tangent \x3d vClipStrokeEven;\n  }\n\n  float travel \x3d dot(vClipStrokePosition, normalize(tangent)) / vClipStrokeWidth;\n  if (mod(travel, 4.0) \x3e 2.0) {\n    discard;\n  }\n}\n"}}})};
shadow$provide[376]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying vec2 vClipEnds;\n\nvoid clipEndsFragment() {\n  if (vClipEnds.x \x3c 0.0 || vClipEnds.y \x3c 0.0) discard;\n}\n"}}})};
shadow$provide[377]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vClipProximity;\n\nvoid clipProximityFragment() {\n  if (vClipProximity \x3e\x3d 0.5) discard;\n}"}}})};
shadow$provide[378]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"void setFragmentColor(vec4 color) {\n  gl_FragColor \x3d color;\n}"}}})};
shadow$provide[379]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 fragmentRGBA(vec4 rgba, vec4 stpq) {\n  return rgba;\n}"}}})};
shadow$provide[380]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"void setFragmentColor(vec4 color) {\n  if (color.a \x3c 1.0) discard;\n  gl_FragColor \x3d color;\n}"}}})};
shadow$provide[381]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"void setFragmentColor(vec4 color) {\n  if (color.a \x3e\x3d 1.0) discard;\n  gl_FragColor \x3d color;\n}"}}})};
shadow$provide[382]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 gridPosition;\nuniform vec4 gridStep;\nuniform vec4 gridAxis;\n\nvec4 sampleData(vec2 xy);\n\nvec4 getGridPosition(vec4 xyzw) {\n  vec4 onAxis  \x3d gridAxis * sampleData(vec2(xyzw.y, 0.0)).x;\n  vec4 offAxis \x3d gridStep * xyzw.x + gridPosition;\n  return onAxis + offAxis;\n}\n"}}})};
shadow$provide[383]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float growScale;\nuniform vec4  growMask;\nuniform vec4  growAnchor;\n\nvec4 getSample(vec4 xyzw);\n\nvec4 getGrowSample(vec4 xyzw) {\n  vec4 anchor \x3d xyzw * growMask + growAnchor;\n\n  vec4 position \x3d getSample(xyzw);\n  vec4 center \x3d getSample(anchor);\n\n  return mix(center, position, growScale);\n}"}}})};
shadow$provide[384]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float joinStride;\nuniform float joinStrideInv;\n\nfloat getIndex(vec4 xyzw);\nvec4 getRest(vec4 xyzw);\nvec4 injectIndices(float a, float b);\n\nvec4 getJoinXYZW(vec4 xyzw) {\n\n  float a \x3d getIndex(xyzw);\n  float b \x3d a * joinStrideInv;\n\n  float integer  \x3d floor(b);\n  float fraction \x3d b - integer;\n  \n  return injectIndices(fraction * joinStride, integer) + getRest(xyzw);\n}\n"}}})};
shadow$provide[385]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nvec4 getLabelAlphaColor(vec4 color, vec4 sample) {\n  float mask \x3d clamp(sample.r * 1000.0, 0.0, 1.0);\n  float alpha \x3d (sample.r - .5) * vPixelSize + .5;\n  float a \x3d mask * alpha * color.a;\n  if (a \x3c\x3d 0.0) discard;\n  return vec4(color.xyz, a);\n}\n"}}})};
shadow$provide[386]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec2 mapUV(vec4 uvwo, vec4 stpq) {\n  return uvwo.xy;\n}\n"}}})};
shadow$provide[387]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float outlineExpand;\nuniform float outlineStep;\nuniform vec3  outlineColor;\n\nvarying float vPixelSize;\n\nconst float PIXEL_STEP \x3d 255.0 / 16.0;\n\nvec4 getLabelOutlineColor(vec4 color, vec4 sample) {\n  float ps \x3d vPixelSize * PIXEL_STEP;\n  float os \x3d outlineStep;\n\n  float sdf \x3d sample.r - .5 + outlineExpand;\n  vec2  sdfs \x3d vec2(sdf, sdf + os);\n  vec2  alpha \x3d clamp(sdfs * ps + .5, 0.0, 1.0);\n\n  if (alpha.y \x3c\x3d 0.0) {\n    discard;\n  }\n\n  vec3 blend \x3d color.xyz;\n  if (alpha.y \x3e alpha.x) {\n    blend \x3d sqrt(mix(outlineColor * outlineColor, blend * blend, alpha.x));\n  }\n  \n  return vec4(blend, alpha.y * color.a);\n}\n"}}})};
shadow$provide[388]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 layerScale;\nuniform vec4 layerBias;\n\n#define PROJECT_ORTHOGONAL\n\nvec4 layerPosition(vec4 position, inout vec4 stpq) {\n  return layerScale * position + layerBias;\n}\n"}}})};
shadow$provide[389]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 lerpDepth(vec4 xyzw) {\n  float x \x3d xyzw.z;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n    \n  vec4 xyzw1 \x3d vec4(xyzw.xy, i, xyzw.w);\n  vec4 xyzw2 \x3d vec4(xyzw.xy, i + 1.0, xyzw.w);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, f);\n}\n"}}})};
shadow$provide[390]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 lerpHeight(vec4 xyzw) {\n  float x \x3d xyzw.y;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n    \n  vec4 xyzw1 \x3d vec4(xyzw.x, i, xyzw.zw);\n  vec4 xyzw2 \x3d vec4(xyzw.x, i + 1.0, xyzw.zw);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, f);\n}\n"}}})};
shadow$provide[391]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 lerpItems(vec4 xyzw) {\n  float x \x3d xyzw.w;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n    \n  vec4 xyzw1 \x3d vec4(xyzw.xyz, i);\n  vec4 xyzw2 \x3d vec4(xyzw.xyz, i + 1.0);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, f);\n}\n"}}})};
shadow$provide[392]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 lerpWidth(vec4 xyzw) {\n  float x \x3d xyzw.x;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n    \n  vec4 xyzw1 \x3d vec4(i, xyzw.yzw);\n  vec4 xyzw2 \x3d vec4(i + 1.0, xyzw.yzw);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, f);\n}\n"}}})};
shadow$provide[393]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"// Units and calibration\nuniform float worldUnit;\nuniform float lineWidth;\nuniform float lineDepth;\nuniform float focusDepth;\n\n// General data index\nuniform vec4 geometryClip;\nattribute vec4 position4;\n\n// (Top/bottom -1,1)\nattribute float line;\n\n// 0...1 for round or bevel joins\n#ifdef LINE_JOIN_DETAIL\nattribute float joint;\n#else\nconst float joint \x3d 0.0;\n#endif\n\n// Knock out excessively long line segments (e.g. for asymtpotes)\n#ifdef LINE_PROXIMITY\nuniform float lineProximity;\nvarying float vClipProximity;\n#endif\n\n// Ghetto line stroking (local only, not global)\n#ifdef LINE_STROKE\nvarying float vClipStrokeWidth;\nvarying float vClipStrokeIndex;\nvarying vec3  vClipStrokeEven;\nvarying vec3  vClipStrokeOdd;\nvarying vec3  vClipStrokePosition;\n#endif\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\n// Clip line ends for arrows / decoration\n#ifdef LINE_CLIP\nuniform float clipRange;\nuniform vec2  clipStyle;\nuniform float clipSpace;\n\nattribute vec2 strip;\n\nvarying vec2 vClipEnds;\n\nvoid clipEnds(vec4 xyzw, vec3 center, vec3 pos) {\n\n  // Sample start of line strip\n  vec4 xyzwS \x3d vec4(0.0, xyzw.yzw);\n  vec3 start \x3d getPosition(xyzwS, 0.0);\n\n  // Sample middle of line strip\n  vec4 xyzwM \x3d vec4(geometryClip.x / 2.0, xyzw.yzw);\n  vec3 middle \x3d getPosition(xyzwM, 0.0);\n\n#ifdef LINE_CLOSED\n  vec3 end \x3d start;\n#else\n  // Sample other end of line strip\n  vec4 xyzwE \x3d vec4(geometryClip.x, xyzw.yzw);\n  vec3 end   \x3d getPosition(xyzwE, 0.0);\n#endif\n\n  // Measure length\n  float l \x3d max(length(end - middle), length(middle - start)) * clipSpace * 2.0;\n\n  // Arrow length (\x3d2.5x radius)\n  float arrowSize \x3d 1.25 * clipRange * lineWidth * worldUnit;\n\n#ifdef LINE_CLOSED\n  // Clip around start/end\n  end \x3d start;\n#endif\n\n  vClipEnds \x3d vec2(1.0);\n\n  if (clipStyle.y \x3e 0.0) {\n    // Depth blend end\n    float depth \x3d focusDepth;\n    if (lineDepth \x3c 1.0) {\n      float z \x3d max(0.00001, -end.z);\n      depth \x3d mix(z, focusDepth, lineDepth);\n    }\n\n    // Absolute arrow length\n    float size \x3d arrowSize * depth;\n\n    // Adjust clip range\n    // Approach linear scaling with cubic ease the smaller we get\n    float mini \x3d clamp(1.0 - l / size * .333, 0.0, 1.0);\n    float scale \x3d 1.0 - mini * mini * mini;\n    float invrange \x3d 1.0 / (size * scale);\n\n    // Clip end\n    vec3 diff \x3d end - center;\n    if(diff \x3d\x3d vec3(0.0))\n      vClipEnds.x \x3d -1.0;\n    else {\n      diff \x3d normalize(end - center);\n      float d \x3d dot(end - pos, diff);\n      vClipEnds.x \x3d d * invrange - 1.0;\n    }\n  }\n\n  if (clipStyle.x \x3e 0.0) {\n    // Depth blend start\n    float depth \x3d focusDepth;\n    if (lineDepth \x3c 1.0) {\n      float z \x3d max(0.00001, -start.z);\n      depth \x3d mix(z, focusDepth, lineDepth);\n    }\n\n    // Absolute arrow length\n    float size \x3d arrowSize * depth;\n\n    // Adjust clip range\n    // Approach linear scaling with cubic ease the smaller we get\n    float mini \x3d clamp(1.0 - l / size * .333, 0.0, 1.0);\n    float scale \x3d 1.0 - mini * mini * mini;\n    float invrange \x3d 1.0 / (size * scale);\n\n    // Clip start\n    vec3 diff \x3d center - start;\n    if(diff \x3d\x3d vec3(0.0))\n      vClipEnds.y \x3d -1.0;\n    else {\n      diff \x3d normalize(center - start);\n      float d \x3d dot(pos - start, diff);\n      vClipEnds.y \x3d d * invrange - 1.0;\n    }\n  }\n}\n#endif\n\n// Adjust left/center/right to be inside near/far z range\nconst float epsilon \x3d 1e-5;\nvoid fixCenter(inout vec3 left, inout vec3 center, inout vec3 right) {\n  if (center.z \x3e\x3d 0.0) {\n    if (left.z \x3c 0.0) {\n      float d \x3d (center.z + epsilon) / (center.z - left.z);\n      center \x3d mix(center, left, d);\n    }\n    else if (right.z \x3c 0.0) {\n      float d \x3d (center.z + epsilon) / (center.z - right.z);\n      center \x3d mix(center, right, d);\n    }\n  }\n\n  if (left.z \x3e\x3d 0.0) {\n    if (center.z \x3c 0.0) {\n      float d \x3d (left.z + epsilon) / (left.z - center.z);\n      left \x3d mix(left, center, d);\n    }\n  }\n\n  if (right.z \x3e\x3d 0.0) {\n    if (center.z \x3c 0.0) {\n      float d \x3d (right.z + epsilon) / (right.z - center.z);\n      right \x3d mix(right, center, d);\n    }\n  }\n}\n\nvec4 wrapAround(vec4 xyzw) {\n#ifdef LINE_CLOSED\n  float gx \x3d geometryClip.x;\n  if (xyzw.x \x3c 0.0) xyzw.x +\x3d gx;\n  if (xyzw.x \x3e\x3d gx) xyzw.x -\x3d gx;\n#endif\n  return xyzw;\n}\n\n// Sample the source data in an edge-aware manner\nvoid getLineGeometry(vec4 xyzw, float edge, out vec3 left, out vec3 center, out vec3 right) {\n  vec4 delta \x3d vec4(1.0, 0.0, 0.0, 0.0);\n\n  center \x3d getPosition(xyzw, 1.0);\n  left   \x3d (edge \x3e -0.5) ? getPosition(wrapAround(xyzw - delta), 0.0) : center;\n  right  \x3d (edge \x3c 0.5)  ? getPosition(wrapAround(xyzw + delta), 0.0) : center;\n}\n\n// Calculate the position for a vertex along the line, including joins\nvec3 getLineJoin(float edge, bool odd, vec3 left, vec3 center, vec3 right, float width, float offset, float joint) {\n  vec2 join \x3d vec2(1.0, 0.0);\n\n  fixCenter(left, center, right);\n\n  vec4 a \x3d vec4(left.xy, right.xy);\n  vec4 b \x3d a / vec4(left.zz, right.zz);\n\n  vec2 l \x3d b.xy;\n  vec2 r \x3d b.zw;\n  vec2 c \x3d center.xy / center.z;\n\n  vec4 d \x3d vec4(l, c) - vec4(c, r);\n  float l1 \x3d dot(d.xy, d.xy);\n  float l2 \x3d dot(d.zw, d.zw);\n\n  if (l1 + l2 \x3e 0.0) {\n\n    if (edge \x3e 0.5 || l2 \x3d\x3d 0.0) {\n      vec2 nl \x3d normalize(d.xy);\n      vec2 tl \x3d vec2(nl.y, -nl.x);\n\n#ifdef LINE_PROXIMITY\n      vClipProximity \x3d 1.0;\n#endif\n\n#ifdef LINE_STROKE\n      vClipStrokeEven \x3d vClipStrokeOdd \x3d normalize(left - center);\n#endif\n      join \x3d tl;\n    }\n    else if (edge \x3c -0.5 || l1 \x3d\x3d 0.0) {\n      vec2 nr \x3d normalize(d.zw);\n      vec2 tr \x3d vec2(nr.y, -nr.x);\n\n#ifdef LINE_PROXIMITY\n      vClipProximity \x3d 1.0;\n#endif\n\n#ifdef LINE_STROKE\n      vClipStrokeEven \x3d vClipStrokeOdd \x3d normalize(center - right);\n#endif\n      join \x3d tr;\n    }\n    else {\n      // Limit join stretch for tiny segments\n      float lmin2 \x3d min(l1, l2) / (width * width);\n\n      // Hide line segment if ratio of leg lengths exceeds promixity threshold\n#ifdef LINE_PROXIMITY\n      float lr     \x3d l1 / l2;\n      float rl     \x3d l2 / l1;\n      float ratio  \x3d max(lr, rl);\n      float thresh \x3d lineProximity + 1.0;\n      vClipProximity \x3d (ratio \x3e thresh * thresh) ? 1.0 : 0.0;\n#endif\n\n      // Calculate normals/tangents\n      vec2 nl \x3d normalize(d.xy);\n      vec2 nr \x3d normalize(d.zw);\n\n      // Calculate tangents\n      vec2 tl \x3d vec2(nl.y, -nl.x);\n      vec2 tr \x3d vec2(nr.y, -nr.x);\n\n#ifdef LINE_PROXIMITY\n      // Mix tangents according to leg lengths\n      vec2 tc \x3d normalize(mix(tl, tr, l1/(l1+l2)));\n#else\n      // Average tangent\n      vec2 tc \x3d normalize(tl + tr);\n#endif\n\n      // Miter join\n      float cosA   \x3d dot(nl, tc);\n      float sinA   \x3d max(0.1, abs(dot(tl, tc)));\n      float factor \x3d cosA / sinA;\n      float scale  \x3d sqrt(1.0 + min(lmin2, factor * factor));\n\n      // Stroke normals\n#ifdef LINE_STROKE\n      vec3 stroke1 \x3d normalize(left - center);\n      vec3 stroke2 \x3d normalize(center - right);\n\n      if (odd) {\n        vClipStrokeEven \x3d stroke1;\n        vClipStrokeOdd  \x3d stroke2;\n      }\n      else {\n        vClipStrokeEven \x3d stroke2;\n        vClipStrokeOdd  \x3d stroke1;\n      }\n#endif\n\n#ifdef LINE_JOIN_MITER\n      // Apply straight up miter\n      join \x3d tc * scale;\n#endif\n\n#ifdef LINE_JOIN_ROUND\n      // Slerp bevel join into circular arc\n      float dotProduct \x3d dot(nl, nr);\n      float angle \x3d acos(dotProduct);\n      float sinT  \x3d sin(angle);\n      join \x3d (sin((1.0 - joint) * angle) * tl + sin(joint * angle) * tr) / sinT;\n#endif\n\n#ifdef LINE_JOIN_BEVEL\n      // Direct bevel join between two flat ends\n      float dotProduct \x3d dot(nl, nr);\n      join \x3d mix(tl, tr, joint);\n#endif\n\n#ifdef LINE_JOIN_DETAIL\n      // Check if on inside or outside of joint\n      float crossProduct \x3d nl.x * nr.y - nl.y * nr.x;\n      if (offset * crossProduct \x3c 0.0) {\n        // For near-180-degree bends, correct back to a miter to avoid discontinuities\n        float ratio \x3d clamp(-dotProduct * 2.0 - 1.0, 0.0, 1.0);\n        // Otherwise collapse the inside vertices into one.\n        join \x3d mix(tc * scale, join, ratio * ratio * ratio);\n      }\n#endif\n\n    }\n    return vec3(join, 0.0);\n  }\n  else {\n    return vec3(0.0);\n  }\n\n}\n\n// Calculate final line position\nvec3 getLinePosition() {\n  vec3 left, center, right, join;\n\n  // Up/down along segment\n  float offset \x3d line;\n\n  // Clip data\n  vec4 p \x3d min(geometryClip, position4);\n\n  // Left/center/right\n  float edge \x3d 0.0;\n#ifdef LINE_CLOSED\n  if (p.x \x3d\x3d geometryClip.x) p.x \x3d 0.0;\n#else\n  if (p.x \x3d\x3d geometryClip.x) edge \x3d 1.0;\n  if (p.x \x3d\x3d 0.0) edge \x3d -1.0;\n#endif\n\n  // Get position + adjacent neighbours\n  getLineGeometry(p, edge, left, center, right);\n\n#ifdef LINE_STROKE\n  // Set parameters for line stroke fragment shader\n  vClipStrokePosition \x3d center;\n  vClipStrokeIndex \x3d p.x;\n  bool odd \x3d mod(p.x, 2.0) \x3e\x3d 1.0;\n#else\n  bool odd \x3d true;\n#endif\n\n  // Divide line width up/down\n  float width \x3d lineWidth * 0.5;\n\n  float depth \x3d focusDepth;\n  if (lineDepth \x3c 1.0) {\n    // Depth blending\n    float z \x3d max(0.00001, -center.z);\n    depth \x3d mix(z, focusDepth, lineDepth);\n  }\n  width *\x3d depth;\n\n  // Convert to world units\n  width *\x3d worldUnit;\n\n  // Calculate line join\n#ifdef LINE_CLOSED\n  join \x3d getLineJoin(0.0, odd, left, center, right, width, offset, joint);\n#else\n  join \x3d getLineJoin(edge, odd, left, center, right, width, offset, joint);\n#endif\n  vec3 pos \x3d center + join * offset * width;\n\n#ifdef LINE_STROKE\n  vClipStrokeWidth \x3d width;\n#endif\n\n#ifdef LINE_CLIP\n  clipEnds(p, center, pos);\n#endif\n\n  return pos;\n}\n"}}})};
shadow$provide[394]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec2 dataResolution;\nuniform vec2 dataPointer;\n\nvec2 map2DData(vec2 xy) {\n  return (xy + dataPointer) * dataResolution;\n}\n"}}})};
shadow$provide[395]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec2 dataResolution;\nuniform vec2 dataPointer;\n\nvec2 map2DData(vec2 xy) {\n  return fract((xy + dataPointer) * dataResolution);\n}\n"}}})};
shadow$provide[396]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"void mapXyzw2DV(vec4 xyzw, out vec2 xy, out float z) {\n  xy \x3d xyzw.xy;\n  z  \x3d xyzw.z;\n}\n\n"}}})};
shadow$provide[397]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 alignXYZW(vec4 xyzw) {\n  return floor(xyzw + .5);\n}\n\n"}}})};
shadow$provide[398]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float textureItems;\nuniform float textureHeight;\n\nvec2 mapXyzwTexture(vec4 xyzw) {\n  \n  float x \x3d xyzw.x;\n  float y \x3d xyzw.y;\n  float z \x3d xyzw.z;\n  float i \x3d xyzw.w;\n  \n  return vec2(i, y) + vec2(x, z) * vec2(textureItems, textureHeight);\n}\n\n"}}})};
shadow$provide[399]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying vec4 vColor;\n\nvec4 getColor() {\n  if (vColor.a \x3c\x3d 0.0) discard;\n  return vColor;\n}\n"}}})};
shadow$provide[400]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"#ifdef POSITION_STPQ\nvarying vec4 vSTPQ;\n#endif\n#ifdef POSITION_U\nvarying float vU;\n#endif\n#ifdef POSITION_UV\nvarying vec2 vUV;\n#endif\n#ifdef POSITION_UVW\nvarying vec3 vUVW;\n#endif\n#ifdef POSITION_UVWO\nvarying vec4 vUVWO;\n#endif\n\nvec4 getSample(vec4 uvwo, vec4 stpq);\n\nvec4 getMapColor() {\n  #ifdef POSITION_STPQ\n  vec4 stpq \x3d vSTPQ;\n  #else\n  vec4 stpq \x3d vec4(0.0);\n  #endif\n\n  #ifdef POSITION_U\n  vec4 uvwo \x3d vec4(vU, 0.0, 0.0, 0.0);\n  #endif\n  #ifdef POSITION_UV\n  vec4 uvwo \x3d vec4(vUV, 0.0, 0.0);\n  #endif\n  #ifdef POSITION_UVW\n  vec4 uvwo \x3d vec4(vUVW, 0.0);\n  #endif\n  #ifdef POSITION_UVWO\n  vec4 uvwo \x3d vec4(vUVWO);\n  #endif\n\n  return getSample(uvwo, stpq);\n}\n"}}})};
shadow$provide[401]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vMask;\n\nfloat ease(float t) {\n  t \x3d clamp(t, 0.0, 1.0);\n  return t * t * (3.0 - 2.0 * t);\n}\n\nvec4 maskColor() {\n  if (vMask \x3c\x3d 0.0) discard;\n  return vec4(vec3(1.0), ease(vMask));\n}\n"}}})};
shadow$provide[402]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"#ifdef POSITION_STPQ\nvarying vec4 vSTPQ;\n#endif\n#ifdef POSITION_U\nvarying float vU;\n#endif\n#ifdef POSITION_UV\nvarying vec2 vUV;\n#endif\n#ifdef POSITION_UVW\nvarying vec3 vUVW;\n#endif\n#ifdef POSITION_UVWO\nvarying vec4 vUVWO;\n#endif\n\nvec4 getSample(vec4 rgba, vec4 stpq);\n\nvec4 getMaterialColor(vec4 rgba) {\n  vec4 stpq \x3d vec4(0.0);\n\n  #ifdef POSITION_U\n  stpq.x \x3d vU;\n  #endif\n  #ifdef POSITION_UV\n  stpq.xy \x3d vUV;\n  #endif\n  #ifdef POSITION_UVW\n  stpq.xyz \x3d vUVW;\n  #endif\n  #ifdef POSITION_UVWO\n  stpq \x3d vUVWO;\n  #endif\n\n  #ifdef POSITION_STPQ\n  stpq \x3d vSTPQ;\n  #endif\n\n  return getSample(rgba, stpq);\n}\n"}}})};
shadow$provide[403]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"\n#extension GL_OES_standard_derivatives : enable\nvarying vec3 vNormal;\nvarying vec3 vLight;\nvarying vec3 vPosition;\n\nvec3 offSpecular(vec3 color) {\n  vec3 c \x3d 1.0 - color;\n  return 1.0 - c * c;\n}\n\nvec4 getShadedColor(vec4 rgba) {\n  \n  vec3 color \x3d rgba.xyz;\n  vec3 color2 \x3d offSpecular(rgba.xyz);\n\n  vec3 normal \x3d normalize(vNormal);\n  vec3 light \x3d normalize(vLight);\n  vec3 position \x3d normalize(vPosition);\n  \n  // Workaround to avoid gl_FrontFacing. See https://github.com/unconed/mathbox/pull/26\n  vec3 pdx \x3d dFdx(vPosition);\n  vec3 pdy \x3d dFdy(vPosition);\n  bool frontFacting \x3d dot(vNormal, cross(pdx, pdy)) \x3e 0.0;\n\n  float side \x3d frontFacting ? 1.0 : -1.0;\n  float cosine  \x3d side * dot(normal, light);\n  float diffuse \x3d mix(max(0.0, cosine), .5 + .5 * cosine, .1);\n  \n  vec3  halfLight \x3d normalize(light + position);\n\tfloat cosineHalf \x3d max(0.0, side * dot(normal, halfLight));\n\tfloat specular \x3d pow(cosineHalf, 16.0);\n\t\n\treturn vec4(color * (diffuse * .9 + .05) + .25 * color2 * specular, rgba.a);\n}\n"}}})};
shadow$provide[404]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return""}}})};
shadow$provide[405]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 getGammaInColor(vec4 rgba) {\n  return vec4(rgba.rgb * rgba.rgb, rgba.a);\n}\n"}}})};
shadow$provide[406]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 getGammaOutColor(vec4 rgba) {\n  return vec4(sqrt(rgba.rgb), rgba.a);\n}\n"}}})};
shadow$provide[407]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 mapUVWO(vec4 uvwo, vec4 stpq) {\n  return uvwo;\n}\n"}}})};
shadow$provide[408]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 geometryClip;\nattribute vec4 position4;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvec3 getMeshPosition() {\n  vec4 p \x3d min(geometryClip, position4);\n  return getPosition(p, 1.0);\n}\n"}}})};
shadow$provide[409]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"attribute vec4 position4;\nuniform vec4 geometryClip;\nvarying vec4 vColor;\n\n// External\nvec4 getSample(vec4 xyzw);\n\nvoid vertexColor() {\n  vec4 p \x3d min(geometryClip, position4);\n  vColor \x3d getSample(p);\n}\n"}}})};
shadow$provide[410]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"attribute vec4 position4;\nuniform vec4 geometryResolution;\nuniform vec4 geometryClip;\nvarying float vMask;\n\n// External\nfloat getSample(vec4 xyzw);\n\nvoid maskLevel() {\n  vec4 p \x3d min(geometryClip, position4);\n  vMask \x3d getSample(p * geometryResolution);\n}\n"}}})};
shadow$provide[411]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 geometryResolution;\n\n#ifdef POSITION_STPQ\nvarying vec4 vSTPQ;\n#endif\n#ifdef POSITION_U\nvarying float vU;\n#endif\n#ifdef POSITION_UV\nvarying vec2 vUV;\n#endif\n#ifdef POSITION_UVW\nvarying vec3 vUVW;\n#endif\n#ifdef POSITION_UVWO\nvarying vec4 vUVWO;\n#endif\n\n// External\nvec3 getPosition(vec4 xyzw, in vec4 stpqIn, out vec4 stpqOut);\n\nvec3 getMeshPosition(vec4 xyzw, float canonical) {\n  vec4 stpqOut, stpqIn \x3d xyzw * geometryResolution;\n  vec3 xyz \x3d getPosition(xyzw, stpqIn, stpqOut);\n\n  #ifdef POSITION_MAP\n  if (canonical \x3e 0.5) {\n    #ifdef POSITION_STPQ\n    vSTPQ \x3d stpqOut;\n    #endif\n    #ifdef POSITION_U\n    vU \x3d stpqOut.x;\n    #endif\n    #ifdef POSITION_UV\n    vUV \x3d stpqOut.xy;\n    #endif\n    #ifdef POSITION_UVW\n    vUVW \x3d stpqOut.xyz;\n    #endif\n    #ifdef POSITION_UVWO\n    vUVWO \x3d stpqOut;\n    #endif\n  }\n  #endif\n  return xyz;\n}\n"}}})};
shadow$provide[412]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float transitionEnter;\nuniform float transitionExit;\nuniform vec4  transitionScale;\nuniform vec4  transitionBias;\nuniform float transitionSkew;\nuniform float transitionActive;\n\nuniform vec4  moveFrom;\nuniform vec4  moveTo;\n\nfloat ease(float t) {\n  t \x3d clamp(t, 0.0, 1.0);\n  return 1.0 - (2.0 - t) * t;\n}\n\nvec4 getTransitionPosition(vec4 xyzw, inout vec4 stpq) {\n  if (transitionActive \x3c 0.5) return xyzw;\n\n  float enter   \x3d transitionEnter;\n  float exit    \x3d transitionExit;\n  float skew    \x3d transitionSkew;\n  vec4  scale   \x3d transitionScale;\n  vec4  bias    \x3d transitionBias;\n\n  float factor  \x3d 1.0 + skew;\n  float offset  \x3d dot(vec4(1.0), stpq * scale + bias);\n\n  float a1 \x3d ease(enter * factor - offset);\n  float a2 \x3d ease(exit  * factor + offset - skew);\n\n  return xyzw + a1 * moveFrom + a2 * moveTo;\n}"}}})};
shadow$provide[413]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec4 getMask(vec4 xyzw) {\n  return vec4(1.0);\n}"}}})};
shadow$provide[414]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getDiscAlpha(float mask) {\n  // Approximation: 1 - x*x is approximately linear around x \x3d 1 with slope 2\n  return vPixelSize * (1.0 - mask);\n  //  return vPixelSize * 2.0 * (1.0 - sqrt(mask));\n}\n"}}})};
shadow$provide[415]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getDiscHollowAlpha(float mask) {\n  return vPixelSize * (0.5 - 2.0 * abs(sqrt(mask) - .75));\n}\n"}}})};
shadow$provide[416]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getGenericAlpha(float mask) {\n  return vPixelSize * 2.0 * (1.0 - mask);\n}\n"}}})};
shadow$provide[417]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getGenericHollowAlpha(float mask) {\n  return vPixelSize * (0.5 - 2.0 * abs(mask - .75));\n}\n"}}})};
shadow$provide[418]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying vec2 vSprite;\n\nfloat getSpriteMask(vec2 xy);\nfloat getSpriteAlpha(float mask);\n\nvoid setFragmentColorFill(vec4 color) {\n  float mask \x3d getSpriteMask(vSprite);\n  if (mask \x3e 1.0) {\n    discard;\n  }\n  float alpha \x3d getSpriteAlpha(mask);\n  if (alpha \x3e\x3d 1.0) {\n    discard;\n  }\n  gl_FragColor \x3d vec4(color.rgb, alpha * color.a);\n}\n"}}})};
shadow$provide[419]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying vec2 vSprite;\n\nfloat getSpriteMask(vec2 xy);\nfloat getSpriteAlpha(float mask);\n\nvoid setFragmentColorFill(vec4 color) {\n  float mask \x3d getSpriteMask(vSprite);\n  if (mask \x3e 1.0) {\n    discard;\n  }\n  float alpha \x3d getSpriteAlpha(mask);\n  if (alpha \x3c 1.0) {\n    discard;\n  }\n  gl_FragColor \x3d color;\n}\n\n"}}})};
shadow$provide[420]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getCircleMask(vec2 uv) {\n  return dot(uv, uv);\n}\n"}}})};
shadow$provide[421]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getDiamondMask(vec2 uv) {\n  vec2 a \x3d abs(uv);\n  return a.x + a.y;\n}\n"}}})};
shadow$provide[422]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getTriangleDownMask(vec2 uv) {\n  uv.y +\x3d .25;\n  return max(uv.y, abs(uv.x) * .866 - uv.y * .5 + .6);\n}\n"}}})};
shadow$provide[423]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getTriangleLeftMask(vec2 uv) {\n  uv.x +\x3d .25;\n  return max(uv.x, abs(uv.y) * .866 - uv.x * .5 + .6);\n}\n"}}})};
shadow$provide[424]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getTriangleRightMask(vec2 uv) {\n  uv.x -\x3d .25;\n  return max(-uv.x, abs(uv.y) * .866 + uv.x * .5 + .6);\n}\n"}}})};
shadow$provide[425]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getSquareMask(vec2 uv) {\n  vec2 a \x3d abs(uv);\n  return max(a.x, a.y);\n}\n"}}})};
shadow$provide[426]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying float vPixelSize;\n\nfloat getTriangleUpMask(vec2 uv) {\n  uv.y -\x3d .25;\n  return max(-uv.y, abs(uv.x) * .866 + uv.y * .5 + .6);\n}\n"}}})};
shadow$provide[427]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float pointDepth;\n\nuniform float pixelUnit;\nuniform float renderScale;\nuniform float renderScaleInv;\nuniform float focusDepth;\n\nuniform vec4 geometryClip;\nattribute vec4 position4;\nattribute vec2 sprite;\n\nvarying vec2 vSprite;\nvarying float vPixelSize;\n\nconst float pointScale \x3d POINT_SHAPE_SCALE;\n\n// External\nfloat getPointSize(vec4 xyzw);\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvec3 getPointPosition() {\n  // Discard out-of-range points by generating degenerate face\n  if (\n    position4.x \x3e geometryClip.x ||\n    position4.y \x3e geometryClip.y ||\n    position4.z \x3e geometryClip.z ||\n    position4.w \x3e geometryClip.w\n  ) return vec3(0.0, 0.0, 0.0);\n  vec4 p \x3d position4;\n\n  vec3 center \x3d getPosition(p, 1.0);\n\n  // Depth blending\n  // TODO: orthographic camera\n  // Workaround: set depth \x3d 0\n  float z \x3d -center.z;\n  float depth \x3d mix(z, focusDepth, pointDepth);\n\n  // Match device/unit mapping\n  // Sprite goes from -1..1, width \x3d 2.\n  float pointSize \x3d getPointSize(p);\n  float size \x3d pointScale * pointSize * pixelUnit * .5;\n  float depthSize \x3d depth * size;\n\n  // Pad sprite by half a pixel to make the anti-aliasing straddle the pixel edge\n  // Note: pixelsize measures radius\n  float pixelSize \x3d .5 * (pointDepth \x3e 0.0 ? depthSize / z : size);\n  float paddedSize \x3d pixelSize + 0.5;\n  float padFactor \x3d paddedSize / pixelSize;\n\n  vPixelSize \x3d paddedSize;\n  vSprite    \x3d sprite;\n\n  return center + vec3(sprite * depthSize * renderScaleInv * padFactor, 0.0);\n}\n"}}})};
shadow$provide[428]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float pointSize;\n\nfloat getPointSize(vec4 xyzw) {\n  return pointSize;\n}"}}})};
shadow$provide[429]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float pointSize;\n\nvec4 getSample(vec4 xyzw);\n\nfloat getPointSize(vec4 xyzw) {\n  return pointSize * getSample(xyzw).x;\n}"}}})};
shadow$provide[430]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float polarBend;\nuniform float polarFocus;\nuniform float polarAspect;\nuniform float polarHelix;\n\nuniform mat4 viewMatrix;\n\nvec4 getPolarPosition(vec4 position, inout vec4 stpq) {\n  if (polarBend \x3e 0.0) {\n\n    if (polarBend \x3c 0.001) {\n      // Factor out large addition/subtraction of polarFocus\n      // to avoid numerical error\n      // sin(x) ~ x\n      // cos(x) ~ 1 - x * x / 2\n      vec2 pb \x3d position.xy * polarBend;\n      float ppbbx \x3d pb.x * pb.x;\n      return viewMatrix * vec4(\n        position.x * (1.0 - polarBend + (pb.y * polarAspect)),\n        position.y * (1.0 - .5 * ppbbx) - (.5 * ppbbx) * polarFocus / polarAspect,\n        position.z + position.x * polarHelix * polarBend,\n        1.0\n      );\n    }\n    else {\n      vec2 xy \x3d position.xy * vec2(polarBend, polarAspect);\n      float radius \x3d polarFocus + xy.y;\n      return viewMatrix * vec4(\n        sin(xy.x) * radius,\n        (cos(xy.x) * radius - polarFocus) / polarAspect,\n        position.z + position.x * polarHelix * polarBend,\n        1.0\n      );\n    }\n  }\n  else {\n    return viewMatrix * vec4(position.xyz, 1.0);\n  }\n}"}}})};
shadow$provide[431]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float styleZBias;\nuniform float styleZIndex;\n\nvoid setPosition(vec3 position) {\n\n  #ifdef PROJECT_ORTHOGONAL\n  // Orthogonal projection with depth preservation around z \x3d 1\n  vec4 pos \x3d projectionMatrix * vec4(position, 1.0);\n  pos.xy *\x3d -position.z;\n  #else\n  // Normal perspective projection\n  vec4 pos \x3d projectionMatrix * vec4(position, 1.0);\n  #endif\n\n  // Apply relative Z bias\n  float bias  \x3d (1.0 - styleZBias / 32768.0);\n  pos.z *\x3d bias;\n\n  // Apply large scale Z index changes\n  if (styleZIndex \x3e 0.0) {\n    float z \x3d pos.z / pos.w;\n    pos.z \x3d ((z + 1.0) / (styleZIndex + 1.0) - 1.0) * pos.w;\n  }\n\n  gl_Position \x3d pos;\n}"}}})};
shadow$provide[432]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"// This is three.js' global uniform, missing from fragment shaders.\nuniform mat4 projectionMatrix;\n\nvec4 readbackPosition(vec3 position, vec4 stpq) {\n  vec4 pos \x3d projectionMatrix * vec4(position, 1.0);\n  vec3 final \x3d pos.xyz / pos.w;\n  if (final.z \x3c -1.0) {\n    return vec4(0.0, 0.0, 0.0, -1.0);\n  }\n  else {\n    return vec4(final, -position.z);\n  }\n}\n"}}})};
shadow$provide[433]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 geometryScale;\nattribute vec4 position4;\n\nvec4 getRawPositionScale() {\n  return geometryScale * position4;\n}\n"}}})};
shadow$provide[434]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 repeatModulus;\n\nvec4 getRepeatXYZW(vec4 xyzw) {\n  return mod(xyzw + .5, repeatModulus) - .5;\n}\n"}}})};
shadow$provide[435]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 resampleBias;\n\nvec4 resamplePadding(vec4 xyzw) {\n  return xyzw + resampleBias;\n}"}}})};
shadow$provide[436]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 resampleFactor;\n\nvec4 resampleRelative(vec4 xyzw) {\n  return xyzw * resampleFactor;\n}"}}})};
shadow$provide[437]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float transitionEnter;\nuniform float transitionExit;\nuniform vec4  transitionScale;\nuniform vec4  transitionBias;\nuniform float transitionSkew;\nuniform float transitionActive;\n\nfloat getTransitionSDFMask(vec4 stpq) {\n  if (transitionActive \x3c 0.5) return 1.0;\n\n  float enter   \x3d transitionEnter;\n  float exit    \x3d transitionExit;\n  float skew    \x3d transitionSkew;\n  vec4  scale   \x3d transitionScale;\n  vec4  bias    \x3d transitionBias;\n\n  float factor  \x3d 1.0 + skew;\n  float offset  \x3d dot(vec4(1.0), stpq * scale + bias);\n\n  vec2 d \x3d vec2(enter, exit) * factor + vec2(-offset, offset - skew);\n  if (exit  \x3d\x3d 1.0) return d.x;\n  if (enter \x3d\x3d 1.0) return d.y;\n  return min(d.x, d.y);\n}"}}})};
shadow$provide[438]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 reverseScale;\nuniform vec4 reverseOffset;\n\nvec4 getReverseOffset(vec4 xyzw) {\n  return xyzw * reverseScale + reverseOffset;\n}"}}})};
shadow$provide[439]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec3 getRootPosition(vec4 position, in vec4 stpqIn, out vec4 stpqOut) {\n  stpqOut \x3d stpqIn; // avoid inout confusion\n  return position.xyz;\n}"}}})};
shadow$provide[440]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform sampler2D dataTexture;\n\nvec4 sample2D(vec2 uv) {\n  return texture2D(dataTexture, uv);\n}\n"}}})};
shadow$provide[441]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 scaleAxis;\nuniform vec4 scaleOffset;\n\nvec4 sampleData(float x);\n\nvec4 getScalePosition(vec4 xyzw) {\n  return scaleAxis * sampleData(xyzw.x).x + scaleOffset;\n}\n"}}})};
shadow$provide[442]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 remapSTPQScale;\n\nvec4 screenMapSTPQ(vec4 xyzw, out vec4 stpq) {\n  stpq \x3d xyzw * remapSTPQScale;\n  return xyzw;\n}\n"}}})};
shadow$provide[443]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec2 remapUVScale;\n\nvec4 screenMapXY(vec4 uvwo, vec4 stpq) {\n  return vec4(floor(remapUVScale * uvwo.xy), 0.0, 0.0);\n}\n"}}})};
shadow$provide[444]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec2 remapUVScale;\nuniform vec2 remapModulus;\nuniform vec2 remapModulusInv;\n\nvec4 screenMapXYZW(vec4 uvwo, vec4 stpq) {\n  vec2 st \x3d floor(remapUVScale * uvwo.xy);\n  vec2 xy \x3d st * remapModulusInv;\n  vec2 ixy \x3d floor(xy);\n  vec2 fxy \x3d xy - ixy;\n  vec2 zw \x3d fxy * remapModulus;\n  return vec4(ixy.x, zw.y, ixy.y, zw.x);\n}\n"}}})};
shadow$provide[445]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"vec2 screenPassUV(vec4 uvwo, vec4 stpq) {\n  return uvwo.xy;\n}\n"}}})};
shadow$provide[446]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"void setScreenPosition(vec4 position) {\n  gl_Position \x3d vec4(position.xy * 2.0 - 1.0, 0.5, 1.0);\n}\n"}}})};
shadow$provide[447]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 sliceOffset;\n\nvec4 getSliceOffset(vec4 xyzw) {\n  return xyzw + sliceOffset;\n}\n"}}})};
shadow$provide[448]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float sphericalBend;\nuniform float sphericalFocus;\nuniform float sphericalAspectX;\nuniform float sphericalAspectY;\nuniform float sphericalScaleY;\n\nuniform mat4 viewMatrix;\n\nvec4 getSphericalPosition(vec4 position, inout vec4 stpq) {\n  if (sphericalBend \x3e 0.0001) {\n\n    vec3 xyz \x3d position.xyz * vec3(sphericalBend, sphericalBend / sphericalAspectY * sphericalScaleY, sphericalAspectX);\n    float radius \x3d sphericalFocus + xyz.z;\n    float cosine \x3d cos(xyz.y) * radius;\n\n    return viewMatrix * vec4(\n      sin(xyz.x) * cosine,\n      sin(xyz.y) * radius * sphericalAspectY,\n      (cos(xyz.x) * cosine - sphericalFocus) / sphericalAspectX,\n      1.0\n    );\n  }\n  else {\n    return viewMatrix * vec4(position.xyz, 1.0);\n  }\n}"}}})};
shadow$provide[449]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float splitStride;\n\nvec2 getIndices(vec4 xyzw);\nvec4 getRest(vec4 xyzw);\nvec4 injectIndex(float v);\n\nvec4 getSplitXYZW(vec4 xyzw) {\n  vec2 uv \x3d getIndices(xyzw);\n  float offset \x3d uv.x + uv.y * splitStride;\n  return injectIndex(offset) + getRest(xyzw);\n}\n"}}})};
shadow$provide[450]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 spreadOffset;\nuniform mat4 spreadMatrix;\n\n// External\nvec4 getSample(vec4 xyzw);\n\nvec4 getSpreadSample(vec4 xyzw) {\n  vec4 sample \x3d getSample(xyzw);\n  return sample + spreadMatrix * (spreadOffset + xyzw);\n}\n"}}})};
shadow$provide[451]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying vec2 vSprite;\n\nvec4 getSample(vec2 xy);\n\nvec4 getSpriteColor() {\n  return getSample(vSprite);\n}"}}})};
shadow$provide[452]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec2 spriteOffset;\nuniform float spriteScale;\nuniform float spriteDepth;\nuniform float spriteSnap;\n\nuniform vec2 renderOdd;\nuniform float renderScale;\nuniform float renderScaleInv;\nuniform float pixelUnit;\nuniform float focusDepth;\n\nuniform vec4 geometryClip;\nattribute vec4 position4;\nattribute vec2 sprite;\n\nvarying float vPixelSize;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\nvec4 getSprite(vec4 xyzw);\n\nvec3 getSpritePosition() {\n  // Clip points\n  vec4 p \x3d min(geometryClip, position4);\n  float diff \x3d length(position4 - p);\n  if (diff \x3e 0.0) {\n    return vec3(0.0, 0.0, 1000.0);\n  }\n\n  // Make sprites\n  vec3 center \x3d getPosition(p, 1.0);\n  vec4 atlas \x3d getSprite(p);\n\n  // Sprite goes from -1..1, width \x3d 2.\n  // -1..1 -\x3e -0.5..0.5\n  vec2 halfSprite \x3d sprite * .5;\n  vec2 halfFlipSprite \x3d vec2(halfSprite.x, -halfSprite.y);\n\n#ifdef POSITION_UV\n  // Assign UVs\n  vUV \x3d atlas.xy + atlas.zw * (halfFlipSprite + .5);\n#endif\n\n  // Depth blending\n  // TODO: orthographic camera\n  // Workaround: set depth \x3d 0\n  float depth \x3d focusDepth, z;\n  z \x3d -center.z;\n  if (spriteDepth \x3c 1.0) {\n    depth \x3d mix(z, focusDepth, spriteDepth);\n  }\n  \n  // Match device/unit mapping \n  float size \x3d pixelUnit * spriteScale;\n  float depthSize \x3d depth * size;\n\n  // Calculate pixelSize for anti-aliasing\n  float pixelSize \x3d (spriteDepth \x3e 0.0 ? depthSize / z : size);\n  vPixelSize \x3d pixelSize;\n\n  // Position sprite\n  vec2 atlasOdd \x3d fract(atlas.zw / 2.0);\n  vec2 offset \x3d (spriteOffset + halfSprite * atlas.zw) * depthSize;\n  if (spriteSnap \x3e 0.5) {\n    // Snap to pixel (w/ epsilon shift to avoid jitter)\n    return vec3(((floor(center.xy / center.z * renderScale + 0.001) + renderOdd + atlasOdd) * center.z + offset) * renderScaleInv, center.z);\n  }\n  else {\n    // Place directly\n    return center + vec3(offset * renderScaleInv, 0.0);\n  }\n\n}\n"}}})};
shadow$provide[453]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float stereoBend;\nuniform vec4 basisScale;\nuniform vec4 basisOffset;\nuniform mat4 viewMatrix;\nuniform vec2 view4D;\n\nvec4 getStereographic4Position(vec4 position, inout vec4 stpq) {\n  \n  vec4 transformed;\n  if (stereoBend \x3e 0.0001) {\n\n    float r \x3d length(position);\n    float w \x3d r + position.w;\n    vec4 project \x3d vec4(position.xyz / w, r);\n    \n    transformed \x3d mix(position, project, stereoBend);\n  }\n  else {\n    transformed \x3d position;\n  }\n\n  vec4 pos4 \x3d transformed * basisScale - basisOffset;\n  vec3 xyz \x3d (viewMatrix * vec4(pos4.xyz, 1.0)).xyz;\n  return vec4(xyz, pos4.w * view4D.y + view4D.x);\n}\n"}}})};
shadow$provide[454]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float stereoBend;\n\nuniform mat4 viewMatrix;\n\nvec4 getStereoPosition(vec4 position, inout vec4 stpq) {\n  if (stereoBend \x3e 0.0001) {\n\n    vec3 pos \x3d position.xyz;\n    float r \x3d length(pos);\n    float z \x3d r + pos.z;\n    vec3 project \x3d vec3(pos.xy / z, r);\n    \n    vec3 lerped \x3d mix(pos, project, stereoBend);\n\n    return viewMatrix * vec4(lerped, 1.0);\n  }\n  else {\n    return viewMatrix * vec4(position.xyz, 1.0);\n  }\n}"}}})};
shadow$provide[455]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying vec2 vST;\n\nvec4 getSample(vec2 st);\n\nvec4 getSTSample() {\n  return getSample(vST);\n}\n"}}})};
shadow$provide[456]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"varying vec2 vUV;\n\nvoid setRawUV(vec4 xyzw) {\n  vUV \x3d xyzw.xy;\n}\n"}}})};
shadow$provide[457]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 geometryClip;\nattribute vec4 position4;\nattribute vec3 strip;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvarying vec3 vNormal;\nvarying vec3 vLight;\nvarying vec3 vPosition;\n\nvoid getStripGeometry(vec4 xyzw, vec3 strip, out vec3 pos, out vec3 normal) {\n  vec3 a, b, c;\n\n  a   \x3d getPosition(xyzw, 1.0);\n  b   \x3d getPosition(vec4(xyzw.xyz, strip.x), 0.0);\n  c   \x3d getPosition(vec4(xyzw.xyz, strip.y), 0.0);\n\n  normal \x3d normalize(cross(c - a, b - a)) * strip.z;\n  \n  pos \x3d a;\n}\n\nvec3 getStripPositionNormal() {\n  vec3 center, normal;\n\n  vec4 p \x3d min(geometryClip, position4);\n\n  getStripGeometry(p, strip, center, normal);\n  vNormal   \x3d normal;\n  vLight    \x3d normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz);\n  vPosition \x3d -center;\n\n  return center;\n}\n"}}})};
shadow$provide[458]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec3 styleColor;\nuniform float styleOpacity;\n\nvec4 getStyleColor() {\n  return vec4(styleColor, styleOpacity);\n}\n"}}})};
shadow$provide[459]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideDepth(vec4 xyzw) {\n  float x \x3d xyzw.z;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  return sampleData(vec4(xyzw.xy, i + g, xyzw.w));\n}\n"}}})};
shadow$provide[460]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideDepthLerp(vec4 xyzw) {\n  float x \x3d xyzw.z;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  vec4 xyzw1 \x3d vec4(xyzw.xy, i, xyzw.w);\n  vec4 xyzw2 \x3d vec4(xyzw.xy, i + 1.0, xyzw.w);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, g);\n}\n"}}})};
shadow$provide[461]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideHeight(vec4 xyzw) {\n  float x \x3d xyzw.y;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  return sampleData(vec4(xyzw.x, i + g, xyzw.zw));\n}\n"}}})};
shadow$provide[462]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideHeightLerp(vec4 xyzw) {\n  float x \x3d xyzw.y;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  vec4 xyzw1 \x3d vec4(xyzw.x, i, xyzw.zw);\n  vec4 xyzw2 \x3d vec4(xyzw.x, i + 1.0, xyzw.zw);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, g);\n}\n"}}})};
shadow$provide[463]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideItems(vec4 xyzw) {\n  float x \x3d xyzw.w;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  return sampleData(vec4(xyzw.xyz, i + g));\n}\n"}}})};
shadow$provide[464]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideItemsLerp(vec4 xyzw) {\n  float x \x3d xyzw.w;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  vec4 xyzw1 \x3d vec4(xyzw.xyz, i);\n  vec4 xyzw2 \x3d vec4(xyzw.xyz, i + 1.0);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, g);\n}\n"}}})};
shadow$provide[465]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideWidth(vec4 xyzw) {\n  float x \x3d xyzw.x;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  return sampleData(vec4(i + g, xyzw.yzw));\n}\n"}}})};
shadow$provide[466]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float subdivideBevel;\n\n// External\nvec4 sampleData(vec4 xyzw);\n\nvec4 subdivideWidthLerp(vec4 xyzw) {\n  float x \x3d xyzw.x;\n  float i \x3d floor(x);\n  float f \x3d x - i;\n\n  float minf \x3d subdivideBevel * min(f, 1.0 - f);\n  float g \x3d (f \x3e 0.5) ? 1.0 - minf : (f \x3c 0.5) ? minf : 0.5;\n\n  vec4 xyzw1 \x3d vec4(i, xyzw.yzw);\n  vec4 xyzw2 \x3d vec4(i + 1.0, xyzw.yzw);\n  \n  vec4 a \x3d sampleData(xyzw1);\n  vec4 b \x3d sampleData(xyzw2);\n\n  return mix(a, b, g);\n}\n"}}})};
shadow$provide[467]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"attribute vec4 position4;\n\nfloat getSurfaceHollowMask(vec4 xyzw) {\n  vec4 df \x3d abs(fract(position4) - .5);\n  vec2 df2 \x3d min(df.xy, df.zw);\n  float df3 \x3d min(df2.x, df2.y);\n  return df3;\n}"}}})};
shadow$provide[468]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 geometryClip;\nuniform vec4 geometryResolution;\nuniform vec4 mapSize;\n\nattribute vec4 position4;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvec3 getSurfacePosition() {\n  vec4 p \x3d min(geometryClip, position4);\n\n#ifdef SURFACE_CLOSED_X\n  if (p.x \x3d\x3d geometryClip.x) p.x \x3d 0.0;\n#endif\n#ifdef SURFACE_CLOSED_Y\n  if (p.y \x3d\x3d geometryClip.y) p.y \x3d 0.0;\n#endif\n\n  vec3 xyz \x3d getPosition(p, 1.0);\n\n  // Overwrite UVs\n#ifdef POSITION_UV\n#ifdef POSITION_UV_INT\n  vUV \x3d -.5 + (position4.xy * geometryResolution.xy) * mapSize.xy;\n#else\n  vUV \x3d position4.xy * geometryResolution.xy;\n#endif\n#endif\n\n  return xyz;\n}\n"}}})};
shadow$provide[469]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 mapSize;\nuniform vec4 geometryResolution;\nuniform vec4 geometryClip;\nattribute vec4 position4;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\nvec3 getNormal(vec4 xyzw);\n\nvarying vec3 vNormal;\nvarying vec3 vLight;\nvarying vec3 vPosition;\n\nvec3 getSurfacePositionNormal() {\n\n  vec4 p \x3d min(geometryClip, position4);\n#ifdef SURFACE_CLOSED_X\n  if (p.x \x3d\x3d geometryClip.x) p.x \x3d 0.0;\n#endif\n#ifdef SURFACE_CLOSED_Y\n  if (p.y \x3d\x3d geometryClip.y) p.y \x3d 0.0;\n#endif\n\n  vec3 center \x3d getPosition(p, 1.0);\n  vNormal     \x3d normalMatrix * normalize(getNormal(p));\n  vLight      \x3d normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz); // hardcoded directional light\n  vPosition   \x3d -center;\n\n#ifdef POSITION_UV\n#ifdef POSITION_UV_INT\n  vUV \x3d -.5 + (position4.xy * geometryResolution.xy) * mapSize.xy;\n#else\n  vUV \x3d position4.xy * geometryResolution.xy;\n#endif\n#endif\n\n  return center;\n}\n"}}})};
shadow$provide[470]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform vec4 mapSize;\nuniform vec4 geometryResolution;\nuniform vec4 geometryClip;\nattribute vec4 position4;\n\n// External\nvec3 getPosition(vec4 xyzw, float canonical);\n\nvec4 wrapAround(vec4 xyzw) {\n#ifdef SURFACE_CLOSED_X\n  float gx \x3d geometryClip.x;\n  if (xyzw.x \x3c 0.0) xyzw.x +\x3d gx;\n  if (xyzw.x \x3e\x3d gx) xyzw.x -\x3d gx;\n#endif\n#ifdef SURFACE_CLOSED_Y\n  float gy \x3d geometryClip.y;\n  if (xyzw.y \x3c 0.0) xyzw.y +\x3d gy;\n  if (xyzw.y \x3e\x3d gy) xyzw.y -\x3d gy;\n#endif\n  return xyzw;\n}\n\nvoid getSurfaceGeometry(vec4 xyzw, float edgeX, float edgeY, out vec3 left, out vec3 center, out vec3 right, out vec3 up, out vec3 down) {\n  vec4 deltaX \x3d vec4(1.0, 0.0, 0.0, 0.0);\n  vec4 deltaY \x3d vec4(0.0, 1.0, 0.0, 0.0);\n\n  center \x3d                  getPosition(xyzw, 1.0);\n  left   \x3d                  center;\n  down   \x3d                  center;\n  right  \x3d (edgeX \x3c 0.5)  ? getPosition(wrapAround(xyzw + deltaX), 0.0) : (2.0 * center - getPosition(xyzw - deltaX, 0.0));\n  up     \x3d (edgeY \x3c 0.5)  ? getPosition(wrapAround(xyzw + deltaY), 0.0) : (2.0 * center - getPosition(xyzw - deltaY, 0.0));\n}\n\nvec3 getSurfaceNormal(vec3 left, vec3 center, vec3 right, vec3 up, vec3 down) {\n  vec3 dx \x3d right - left;\n  vec3 dy \x3d up    - down;\n  vec3 n \x3d cross(dy, dx);\n  if (length(n) \x3e 0.0) {\n    return normalize(n);\n  }\n  return vec3(0.0, 1.0, 0.0);\n}\n\nvarying vec3 vNormal;\nvarying vec3 vLight;\nvarying vec3 vPosition;\n\nvec3 getSurfacePositionShaded() {\n  vec3 left, center, right, up, down;\n\n  vec4 p \x3d min(geometryClip, position4);\n  vec2 surface \x3d vec2(0.0);\n#ifdef SURFACE_CLOSED_X\n  if (p.x \x3d\x3d geometryClip.x) p.x \x3d 0.0;\n#else\n  if (p.x \x3d\x3d geometryClip.x) surface.x \x3d 1.0;\n  //if (p.x \x3d\x3d 0.0) surface.x \x3d -1.0;\n#endif\n#ifdef SURFACE_CLOSED_Y\n  if (p.y \x3d\x3d geometryClip.y) p.y \x3d 0.0;\n#else\n  if (p.y \x3d\x3d geometryClip.y) surface.y \x3d 1.0;\n  //if (p.y \x3d\x3d 0.0) surface.y \x3d -1.0;\n#endif\n\n  getSurfaceGeometry(p, surface.x, surface.y, left, center, right, up, down);\n  vNormal   \x3d getSurfaceNormal(left, center, right, up, down);\n  vLight    \x3d normalize((viewMatrix * vec4(1.0, 2.0, 2.0, 0.0)).xyz); // hardcoded directional light\n  vPosition \x3d -center;\n\n#ifdef POSITION_UV\n#ifdef POSITION_UV_INT\n  vUV \x3d -.5 + (position4.xy * geometryResolution.xy) * mapSize.xy;\n#else\n  vUV \x3d position4.xy * geometryResolution.xy;\n#endif\n#endif\n\n  return center;\n}\n"}}})};
shadow$provide[471]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform float worldUnit;\nuniform float focusDepth;\nuniform float tickSize;\nuniform float tickEpsilon;\nuniform vec3  tickNormal;\nuniform vec2  tickStrip;\n\nvec4 getSample(vec4 xyzw);\n\nvec3 transformPosition(vec4 position, in vec4 stpqIn, out vec4 stpqOut);\n\nvec3 getTickPosition(vec4 xyzw, in vec4 stpqIn, out vec4 stpqOut) {\n  float epsilon \x3d tickEpsilon;\n\n  // determine tick direction\n  float leftX  \x3d max(tickStrip.x, xyzw.y - 1.0);\n  float rightX \x3d min(tickStrip.y, xyzw.y + 1.0);\n  \n  vec4 left    \x3d getSample(vec4(leftX,  xyzw.zw, 0.0));\n  vec4 right   \x3d getSample(vec4(rightX, xyzw.zw, 0.0));\n  vec4 diff    \x3d right - left;\n\n  vec3 normal  \x3d cross(normalize(diff.xyz + vec3(diff.w)), tickNormal);\n  float bias   \x3d max(0.0, 1.0 - length(normal) * 2.0);\n       normal  \x3d mix(normal, tickNormal.yzx, bias * bias);\n  \n  // transform (point) and (point + delta)\n  vec4 center  \x3d getSample(vec4(xyzw.yzw, 0.0));\n  vec4 delta   \x3d vec4(normal, 0.0) * epsilon;\n\n  vec4 a \x3d center;\n  vec4 b \x3d center + delta;\n\n  vec4 _;\n  vec3 c \x3d transformPosition(a, stpqIn, stpqOut);\n  vec3 d \x3d transformPosition(b, stpqIn, _);\n  \n  // sample on either side to create line\n  float line \x3d xyzw.x - .5;\n  vec3  mid  \x3d c;\n  vec3  side \x3d normalize(d - c);\n\n  return mid + side * line * tickSize * worldUnit * focusDepth;\n}\n"}}})};
shadow$provide[472]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform mat4 transformMatrix;\n\nvec4 transformPosition(vec4 position, inout vec4 stpq) {\n  return transformMatrix * vec4(position.xyz, 1.0);\n}\n"}}})};
shadow$provide[473]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"uniform mat4 transformMatrix;\nuniform vec4 transformOffset;\n\nvec4 transformPosition(vec4 position, inout vec4 stpq) {\n  return transformMatrix * position + transformOffset;\n}\n"}}})};
shadow$provide[474]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},default:{enumerable:!0,get:function(){return"// Implicit three.js uniform\n// uniform mat4 viewMatrix;\n\nvec4 getViewPosition(vec4 position, inout vec4 stpq) {\n  return (viewMatrix * vec4(position.xyz, 1.0));\n}\n"}}})};
shadow$provide[475]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Graph:{enumerable:!0,get:function(){return x}}});class x{static initClass(){this.IN=this.index=0;this.OUT=1}static id(r){return++x.index}constructor(r,e=null){this.parent=e;this.id=x.id();this.nodes=[];r&&this.add(r)}inputs(){const r=[];for(const e of Array.from(this.nodes))for(const g of Array.from(e.inputs))g.input===null&&r.push(g);return r}outputs(){const r=[];for(const e of Array.from(this.nodes))for(const g of Array.from(e.outputs))g.output.length===
0&&r.push(g);return r}getIn(r){return Array.from(this.inputs()).filter(e=>e.name===r)[0]}getOut(r){return Array.from(this.outputs()).filter(e=>e.name===r)[0]}add(r,e){if(r.length)for(const g of Array.from(r))this.add(g);else{if(r.graph&&!e)throw Error("Adding node to two graphs at once");r.graph=this;this.nodes.push(r)}}remove(r,e){if(r.length)for(const g of Array.from(r))this.remove(g);else{if(r.graph!==this)throw Error("Removing node from wrong graph.");e||r.disconnect();this.nodes.splice(this.nodes.indexOf(r),
1);r.graph=null}}adopt(r){if(r.length)for(const e of Array.from(r))this.adopt(e);else r.graph.remove(r,!0),this.add(r,!0)}}x.initClass()};
shadow$provide[476]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Outlet:{enumerable:!0,get:function(){return r}}});var x=l(475);class r{static initClass(){this.index=0}static make(e,g){g==null&&(g={});if(e.meta!=null)for(const f in e.meta)g[f]=e.meta[f];return new r(e.inout,e.name,e.hint,e.type,g)}static id(e){return`_io_${++r.index}_${e}`}static hint(e){e=e.replace(/^_io_[0-9]+_/,"");e=e.replace(/_i_o$/,"");return e.replace(/(In|Out|Inout|InOut)$/,"")}constructor(e,
g,f,k,m,p){this.inout=e;this.name=g;this.hint=f;this.type=k;m==null&&(m={});this.meta=m;this.id=p;this.hint==null&&(this.hint=r.hint(this.name));this.input=this.node=null;this.output=[];this.id==null&&(this.id=r.id(this.hint))}morph(e){this.inout=e.inout;this.name=e.name;this.hint=e.hint;this.type=e.type;return this.meta=e.meta}dupe(e){e==null&&(e=this.id);const g=r.make(this);g.name=e;return g}connect(e){if(this.inout===x.Graph.IN&&e.inout===x.Graph.OUT)return e.connect(this);if(this.inout!==x.Graph.OUT||
e.inout!==x.Graph.IN)throw Error("Can only connect out to in.");if(e.input!==this)return e.disconnect(),e.input=this,this.output.push(e)}disconnect(e){this.input&&this.input.disconnect(this);if(this.output.length)if(e){const g=this.output.indexOf(e);if(g>=0)return this.output.splice(g,1),e.input=null}else{for(e of Array.from(this.output))e.input=null;return this.output=[]}}}r.initClass()};
shadow$provide[477]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Node:{enumerable:!0,get:function(){return e}}});var x=l(475),r=l(476);class e{static initClass(){this.index=0}static id(g){return++e.index}constructor(g,f){this.owner=g;this.graph=null;this.inputs=[];this.outputs=[];this.all=[];this.outlets=null;this.id=e.id();this.setOutlets(f)}getIn(g){return Array.from(this.inputs).filter(f=>f.name===g)[0]}getOut(g){return Array.from(this.outputs).filter(f=>f.name===
g)[0]}get(g){return this.getIn(g)||this.getOut(g)}setOutlets(g){if(g!=null){let f;if(this.outlets==null){this.outlets={};for(f of Array.from(g))f instanceof r.Outlet||(f=r.Outlet.make(f)),this._add(f);return}const k={};for(f of Array.from(g))k[[f.name,f.inout,f.type].join("-")]=!0;for(let m in this.outlets)f=this.outlets[m],m=[f.name,f.inout,f.type].join("-"),k[m]?k[m]=f:this._remove(f);for(f of Array.from(g))g=k[[f.name,f.inout,f.type].join("-")],g instanceof r.Outlet?this._morph(g,f):(f instanceof
r.Outlet||(f=r.Outlet.make(f)),this._add(f));this}return this.outlets}connect(g,f,k){let m;let p;const z={},t={};for(m of Array.from(g.inputs))if(k||!m.input)({type:v}=m),g=v+"/"+m.hint,t[g]||(t[g]=m),z[v]=g=z[v]||[],g.push(m);k=this.outputs;k=k.filter(y=>!(f&&y.output.length));for(p of Array.from(k.slice())){({type:v}=p);g=v+"/"+p.hint;var v=z[v];if(m=t[g])p.connect(m),delete t[g],v.splice(v.indexOf(m),1),k.splice(k.indexOf(p),1)}if(!k.length)return this;for(p of Array.from(k.slice()))({type:v}=
p),(v=z[v])&&v.length&&p.connect(v.shift());return this}disconnect(g){let f;for(f of Array.from(this.inputs))f.disconnect();for(f of Array.from(this.outputs))f.disconnect();return this}_key(g){return[g.name,g.inout].join("-")}_add(g){const f=this._key(g);if(g.node)throw Error("Adding outlet to two nodes at once.");if(this.outlets[f])throw Error(`Adding two identical outlets to same node. (${f})`);g.node=this;g.inout===x.Graph.IN&&this.inputs.push(g);g.inout===x.Graph.OUT&&this.outputs.push(g);this.all.push(g);
return this.outlets[f]=g}_morph(g,f){let k=this._key(f);delete this.outlets[k];g.morph(f);k=this._key(f);return this.outlets[k]=f}_remove(g){const f=this._key(g);if(g.node!==this)throw Error("Removing outlet from wrong node.");g.disconnect();g.node=null;delete this.outlets[f];g.inout===x.Graph.IN&&this.inputs.splice(this.inputs.indexOf(g),1);g.inout===x.Graph.OUT&&this.outputs.splice(this.outputs.indexOf(g),1);this.all.splice(this.all.indexOf(g),1);return this}}e.initClass()};
shadow$provide[478]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},IN:{enumerable:!0,get:function(){return e}},OUT:{enumerable:!0,get:function(){return g}}});q=l(475);var x=l(477),r=l(476);const {IN:e,OUT:g}=q.Graph;l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r)};
shadow$provide[479]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Snippet:{enumerable:!0,get:function(){return x}}});class x{static initClass(){this.index=0}static namespace(){return`_sn_${++x.index}_`}static load(r,e,g){const f=r.parse(e,g),[k,m]=Array.from(r.compile(f));return new x(r,k,m,e,g)}constructor(r,e,g,f,k){this.language=r;this._signatures=e;this._compiler=g;this._name=f;this._original=k;this.varyings=this.attributes=this.symbols=this.externals=this.uniforms=
this.entry=this.main=this.code=this.namespace=null;this.language||delete this.language;this._signatures||delete this._signatures;this._compiler||delete this._compiler;this._original||delete this._original;this._name||(this._name=this._signatures!=null?this._signatures.main.name:void 0)}clone(){return new x(this.language,this._signatures,this._compiler,this._name,this._original)}bind(r,e,g,f){let k;var m;let p;e===""+e?[g,e,f]=Array.from([e,g!=null?g:{},f!=null?f:{}]):g!==""+g&&([f,g]=Array.from([g!=
null?g:{},void 0]));this.main=this._signatures.main;this.namespace=(m=g!=null?g:this.namespace)!=null?m:x.namespace();this.entry=this.namespace+this.main.name;this.uniforms={};this.varyings={};this.attributes={};this.externals={};this.symbols=[];g={};const z={};m=function(I){z[I]=!0;return I};const t=I=>this.namespace+I;if(r.globals)for(var v of Array.from(r.globals))m(v);const y=r.globalUniforms?m:t,B=r.globalVaryings?m:t,D=r.globalAttributes?m:t;r=(I,K)=>this.uniforms[y(K!=null?K:I.name)]=I;p=I=>
this.varyings[B(I.name)]=I;v=I=>this.attributes[D(I.name)]=I;m=I=>{const K=t(I.name);this.externals[K]=I;return this.symbols.push(K)};const G=I=>({type:I.type,name:I.name,value:I.value});for(k of Array.from(this._signatures.uniform))g[k.name]=!0;for(k of Array.from(this._signatures.uniform))r(G(k));for(k of Array.from(this._signatures.varying))p(G(k));for(k of Array.from(this._signatures.external))m(k);for(k of Array.from(this._signatures.attribute))v(G(k));for(const I in e)k=e[I],g[I]&&r(k,I);this.body=
this.code=this._compiler(this.namespace,z,f);f&&(e=(()=>{const I=[];for(const K in f)p=f[K],I.push(`#define ${K} ${p}`);return I})().join("\n"),e.length&&(this._original=[e,"//----------------------------------------",this._original].join("\n")));return null}}x.initClass()};
shadow$provide[480]=function(l,L,q){q.make=function(x){x==null&&(x=[]);x instanceof Array||(x=[+x]);return x};q.nest=(x,r)=>x.concat(r);q.compare=function(x,r){var e=Math.min(x.length,r.length);for(let g=0,f=e,k=0<=f;k?g<f:g>f;k?g++:g--){e=x[g];const m=r[g];if(e>m)return-1;if(e<m)return 1}x=x.length;r=r.length;return x>r?-1:x<r?1:0};q.max=function(x,r){return q.compare(x,r)>0?r:x}};
shadow$provide[481]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},assemble:{enumerable:!0,get:function(){return e}}});var x=l(478),r=l(480);const e=function(g,f,k,m){const p={},z=[],t={},v={},y={},B={},D=J=>{let W;J=(()=>{const S=[];for(const ca in J)W=J[ca],S.push(W);return S})();J.sort((S,ca)=>ca.priority-S.priority);const ba=(S,ca,V)=>{I(S,ca,V);({main:V}=ca);({entry:ca}=ca);return g.call(xa=>O(S,xa),xa=>Q(S,xa),ca,V.signature,Y)},Y=g.body();for(W of Array.from(J))ba(W.node,
W.module,W.priority);return[Y,J]},G=function(J,W,ba){const Y=B[J];return Y!=null?Y.priority=r.max(Y.priority,ba):B[J]={code:W,priority:ba}},I=function(J,W,ba){let Y;ba=r.make(ba);for(const S in W.library){const ca=W.library[S];G(S,ca.code,r.nest(ba,ca.priority))}G(W.namespace,W.body,ba);for(Y in W.uniforms)ba=W.uniforms[Y],t[Y]=ba;for(Y in W.varyings)ba=W.varyings[Y],v[Y]=ba;for(Y in W.attributes)ba=W.attributes[Y],y[Y]=ba;return K(J,W)},K=(J,W)=>{const ba=[];for(const Y of Array.from(W.symbols)){const S=
W.externals[Y];if(Q(J,S.name)){const ca={};for(const V in S)ca[V]=S[V];ca.name=O(J,S.name);p[Y]=ca;ba.push(z.push(Y))}else ba.push(void 0)}return ba},Q=function(J,W){J=J.get(W);if(J.inout===x.IN)return J.input===null;if(J.inout===x.OUT)return J.output.length===0},O=function(J,W){J=J.get(W);if(!J)return null;J.input&&(J=J.input);({name:W}=J);return J.id};return function(){let J;for(J in m){var W=m[J];K(W.node,W.module)}[W,k]=Array.from(D(k));f!=null&&(W.entry=f);W=g.build(W,k);var ba=(()=>{const Y=
[];for(J in B)Y.push(B[J]);return Y})().sort((Y,S)=>r.compare(Y.priority,S.priority)).map(Y=>Y.code);ba.push(W.code);ba=g.lines(ba);return{namespace:W.name,library:B,body:W.code,code:ba,main:W,entry:W.name,symbols:z,externals:p,uniforms:t,varyings:v,attributes:y}}()}};
shadow$provide[482]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Program:{enumerable:!0,get:function(){return e}}});var x=l(479),r=l(481);class e{static initClass(){this.index=0}static entry(){return`_pg_${++e.index}_`}constructor(g,f,k){this.language=g;this.namespace=f;this.graph=k;this.calls={};this.requires={}}call(g,f,k){let m;const p=f.namespace;(m=this.calls[p])?m.priority=Math.max(m.priority,k):this.calls[p]={node:g,module:f,priority:k};return this}require(g,
f){return this.requires[f.namespace]={node:g,module:f}}assemble(){const g=(0,r.assemble)(this.language,this.namespace!=null?this.namespace:e.entry,this.calls,this.requires),f=new x.Snippet;for(const k in g)f[k]=g[k];f.graph=this.graph;return f}}e.initClass()};
shadow$provide[483]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},link:{enumerable:!0,get:function(){return e}}});var x=l(478),r=l(480);const e=function(g,f,k,m){let p=[];const z=[],t={},v={},y={},B={},D={},G=function(K,Q,O){const J=D[K];return J!=null?J.priority=r.max(J.priority,O):D[K]={code:Q,priority:O}},I=function(K,Q,O){let J;O=r.make(O);for(var W in Q.library){var ba=Q.library[W];G(W,ba.code,r.nest(O,ba.priority))}G(Q.namespace,Q.body,O);for(J in Q.uniforms)O=
Q.uniforms[J],v[J]=O;for(J in Q.varyings)O=Q.varyings[J],B[J]=O;for(J in Q.attributes)O=Q.attributes[J],y[J]=O;O=[];for(J of Array.from(Q.symbols)){W=Q.externals[J];{ba=K;var Y=W.name;const S=ba.get(Y);if(!S)throw Error(`Unable to link program. Unlinked callback \`${Y}\` on \`${(ba.owner.snippet!=null?ba.owner.snippet._name:void 0)!=null?ba.owner.snippet!=null?ba.owner.snippet._name:void 0:ba.owner.namespace}\``);ba=S.inout===x.IN?S.input===null:S.inout===x.OUT?S.output.length===0:void 0}ba?(t[J]=
W,O.push(z.push(J))):O.push(void 0)}return O};return function(){var K=g.links(f);const Q=[];K.defs!=null&&Q.push(K.defs);K.bodies!=null&&Q.push(K.bodies);for(const O of Array.from(k))I(O.node,O.module,O.priority);p=(()=>{const O=[];for(const J in D)O.push(D[J]);return O})().sort((O,J)=>r.compare(O.priority,J.priority)).map(O=>O.code);K=g.lines(p);K=g.defuse(K);Q.length&&(K=[g.lines(Q),K].join("\n"));K=g.hoist(K);K=g.dedupe(K);return{namespace:m.main.name,code:K,main:m.main,entry:m.main.name,externals:t,
uniforms:v,attributes:y,varyings:B}}()}};
shadow$provide[484]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Layout:{enumerable:!0,get:function(){return e}}});var x=l(479),r=l(483);class e{constructor(g,f){this.language=g;this.graph=f;this.links=[];this.includes=[];this.modules={};this.visits={}}callback(g,f,k,m,p){return this.links.push({node:g,module:f,priority:k,name:m,external:p})}include(g,f,k){let m;if((m=this.modules[f.namespace])!=null)return m.priority=Math.max(k,m.priority);this.modules[f.namespace]=
!0;return this.includes.push({node:g,module:f,priority:k})}visit(g){return this.visits[g]?!1:this.visits[g]=!0}link(g){g=(0,r.link)(this.language,this.links,this.includes,g);const f=new x.Snippet;for(const k in g)f[k]=g[k];f.graph=this.graph;return f}}};
shadow$provide[485]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},load:{enumerable:!0,get:function(){return k}}});q=l(479);var x=l(482),r=l(484),e=l(481),g=l(483),f=l(480);const {load:k}=q.Snippet;l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f)};
shadow$provide[486]=function(l,L,q){function x(k,m){return typeof k!=="undefined"&&k!==null?m(k):void 0}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Block:{enumerable:!0,get:function(){return g}}});var r=l(478),e=l(485);class g{static previous(k){return k.input!=null?k.input.node.owner:void 0}constructor(k){k==null&&(k=!1);k||this.construct()}construct(){let k;this.namespace==null&&(this.namespace=e.Program.entry());return this.node=new r.Node(this,(k=typeof this.makeOutlets==="function"?
this.makeOutlets():void 0)!=null?k:{})}refresh(){let k;return this.node.setOutlets((k=typeof this.makeOutlets==="function"?this.makeOutlets():void 0)!=null?k:{})}clone(){return new g}compile(k,m){k=new e.Program(k,m!=null?m:e.Program.entry(),this.node.graph);this.call(k,0);return k.assemble()}link(k,m){m=this.compile(k,m);k=new e.Layout(k,this.node.graph);this._include(m,k,0);this.export(k,0);return k.link(m)}call(k,m){}callback(k,m,p,z,t){}export(k,m){}_info(k){let m=(this.node.owner.snippet!=null?
this.node.owner.snippet._name:void 0)!=null?this.node.owner.snippet!=null?this.node.owner.snippet._name:void 0:this.node.owner.namespace;if(k!=null)return m+("."+k)}_outlet(k,m){m=r.Outlet.make(k,m);m.meta.def=k;return m}_call(k,m,p){return m.call(this.node,k,p)}_require(k,m){return m.require(this.node,k)}_inputs(k,m,p){return(()=>{const z=[];for(const t of Array.from(k.main.signature)){const v=this.node.get(t.name);z.push(x(g.previous(v),y=>y.call(m,p+1)))}return z})()}_callback(k,m,p,z,t,v){return m.callback(this.node,
k,p,z,t,v)}_include(k,m,p){return m.include(this.node,k,p)}_link(k,m,p){return(()=>{const z=[];for(const t of Array.from(k.symbols)){const v=k.externals[t];let y=this.node.get(v.name);if(!y)throw new f(`External not found on ${this._info(v.name)}`);if(y.meta.child!=null)continue;let B=y,D;for(;!D&&B;)[B,y]=Array.from([y.meta.parent,B]);D=g.previous(y);if(!D)throw new f(`Missing connection on ${this._info(v.name)}`);D.callback(m,p+1,t,v,y.input);z.push(D!=null?D.export(m,p+1):void 0)}return z})()}_trace(k,
m,p){return(()=>{const z=[];for(const t of Array.from(k.main.signature)){const v=this.node.get(t.name);z.push(x(g.previous(v),y=>y.export(m,p+1)))}return z})()}}const f=function(k){k=Error(k);k.name="OutletError";return k};f.prototype=Error()};
shadow$provide[487]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Call:{enumerable:!0,get:function(){return x}}});l=l(486);class x extends l.Block{constructor(r){super(!0);this.snippet=r;this.namespace=r.namespace;this.construct()}clone(){return new x(this.snippet)}makeOutlets(){var r=this.snippet.main.signature;const {externals:e}=this.snippet;var {symbols:g}=this.snippet;r=Array.from(r).map(f=>this._outlet(f,{callback:!1}));g=Array.from(g).map(f=>this._outlet(e[f],
{callback:!0}));return r.concat(g)}call(r,e){this._call(this.snippet,r,e);return this._inputs(this.snippet,r,e)}export(r,e){if(r.visit(this.namespace,e))return this._link(this.snippet,r,e),this._trace(this.snippet,r,e)}}};
shadow$provide[488]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Callback:{enumerable:!0,get:function(){return r}}});var x=l(478);l=l(486);class r extends l.Block{constructor(e){super(!0);this.graph=e;this.construct()}refresh(){super.refresh();return delete this.subroutine}clone(){return new r(this.graph)}makeOutlets(){let e;this.make();const g=[];let f=[],k=[];const m=(p,z)=>{if(p.meta.callback){if(p.inout===x.Graph.IN)return z=p.dupe(),z.meta.child==null&&(z.meta.child=
p),p.meta.parent=z,g.push(z)}else return z.push(p.type)};for(e of Array.from(this.graph.inputs()))m(e,f);for(e of Array.from(this.graph.outputs()))m(e,k);f=f.join(",");k=k.join(",");g.push({name:"callback",type:`(${f})(${k})`,inout:x.Graph.OUT,meta:{callback:!0,def:this.subroutine.main}});return g}make(){return this.subroutine=this.graph.compile(this.namespace)}export(e,g){if(e.visit(this.namespace,g))return this._link(this.subroutine,e,g),this.graph.export(e,g)}call(e,g){return this._require(this.subroutine,
e,g)}callback(e,g,f,k,m){this._include(this.subroutine,e,g);return this._callback(this.subroutine,e,g,f,k,m)}}};
shadow$provide[489]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Isolate:{enumerable:!0,get:function(){return r}}});var x=l(478);l=l(486);class r extends l.Block{constructor(e){super(!0);this.graph=e;this.construct()}refresh(){super.refresh();return delete this.subroutine}clone(){return new r(this.graph)}makeOutlets(){this.make();const e=[],g={};for(const f of["inputs","outputs"])for(const k of Array.from(this.graph[f]())){let m=void 0;["return","callback"].includes(k.hint)&&
k.inout===x.Graph.OUT&&(m=k.hint);g[m]!=null&&(m=void 0);const p=k.dupe(m);p.meta.child==null&&(p.meta.child=k);k.meta.parent=p;m!=null&&(g[m]=!0);e.push(p)}return e}make(){return this.subroutine=this.graph.compile(this.namespace)}call(e,g){this._call(this.subroutine,e,g);return this._inputs(this.subroutine,e,g)}export(e,g){if(e.visit(this.namespace,g))return this._link(this.subroutine,e,g),this._trace(this.subroutine,e,g),this.graph.export(e,g)}callback(e,g,f,k,m){m=m.meta.child;return m.node.owner.callback(e,
g,f,k,m)}}};
shadow$provide[490]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Join:{enumerable:!0,get:function(){return x}}});l=l(486);class x extends l.Block{constructor(r){super(!0);this.nodes=r;this.construct()}clone(){return new x(this.nodes)}makeOutlets(){return[]}call(r,e){return(()=>{const g=[];for(const f of Array.from(this.nodes))g.push(f.owner.call(r,e));return g})()}export(r,e){return(()=>{const g=[];for(const f of Array.from(this.nodes))g.push(f.owner.export(r,e));
return g})()}}};
shadow$provide[491]=function(l,L,q){q=l(486);var x=l(487),r=l(488),e=l(489),g=l(490);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g)};
shadow$provide[492]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},serialize:{enumerable:!0,get:function(){return r}}});var x=l(491);const r=function(e){const g=[],f=[];for(const m of Array.from(e.nodes)){let p;var k={id:m.id,name:null,type:null,depth:null,graph:null,inputs:[],outputs:[]};g.push(k);({inputs:e}=k);const {outputs:z}=k,t=m.owner;t instanceof x.Call?(k.name=t.snippet._name,k.type="call",k.code=t.snippet._original):t instanceof x.Callback?(k.name="Callback",
k.type="callback",k.graph=r(t.graph)):t instanceof x.Isolate?(k.name="Isolate",k.type="isolate",k.graph=r(t.graph)):t instanceof x.Join?(k.name="Join",k.type="join"):t!=null&&(k.name==null&&(k.name=t.name!=null?t.name:t.type),k.type==null&&(k.type=t.type),k.code==null&&(k.code=t.code),t.graph!=null&&(k.graph=r(t.graph)));k=function(v){v=v.replace(")(",")→(");return v.replace("()","")};for(p of Array.from(m.inputs))e.push({id:p.id,name:p.name,type:k(p.type),open:p.input==null});for(p of Array.from(m.outputs)){z.push({id:p.id,
name:p.name,type:k(p.type),open:!p.output.length});for(const v of Array.from(p.output))f.push({from:m.id,out:p.id,to:v.node.id,in:v.id,type:k(p.type)})}}return{nodes:g,links:f}}};
shadow$provide[493]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},hash:{enumerable:!0,get:function(){return r}}});let x=function(e,g){const f=e&65535,k=g&65535;return f*k+((e>>>16&65535)*k+f*(g>>>16&65535)<<16>>>0)|0};Math.imul!=null&&({imul:x}=Math);const r=function(e){let g;const f=e.length;let k=Math.floor(f/2),m=g=0;const p=function(z,t){z|=t<<16;z=x(z^z<<9,3432918353);z=x(z<<15|z>>>17,461845907);g^=z;g=g<<13|g>>>19;g=x(g,5);return g=g+3864292196|0};for(;k--;)p(e.charCodeAt(m++),
e.charCodeAt(m++));f&1&&p(e.charCodeAt(m++),0);g^=f;g^=g>>>16;g=x(g,2246822507);g^=g>>>13;g=x(g,3266489909);return g^=g>>>16}};
shadow$provide[494]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},merge:{enumerable:!0,get:function(){return v}},overlay:{enumerable:!0,get:function(){return z}},process:{enumerable:!0,get:function(){return g}}});var x=l(493);const r=function(y,B){B==null&&(B=1);var D=(0,x.hash)(y)^1193046;y=D&255;let G=D>>>8&255;D=D>>>16&255;var I=Math.max(y,G,D);const K=140/I;I=Math.round(I/3);y=Math.min(255,Math.round(K*Math.max(y,I)));G=Math.min(255,Math.round(K*Math.max(G,I)));
D=Math.min(255,Math.round(K*Math.max(D,I)));return"rgba("+[y,G,D,B].join(", ")+")"},e=function(y){return(y!=null?y:"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/'/g,"\x26#39;").replace(/"/g,"\x26quot;")},g=function(y){const B=[],D=m(y,B);D.update=()=>{if(D.parentNode==null)var G=void 0;else{var I=D.getBoundingClientRect();for(G of Array.from(B)){var K=G.out.getBoundingClientRect(),Q=G.in.getBoundingClientRect();G.coords={x1:(K.left+K.right)/2-I.left,y1:(K.top+
K.bottom)/2-I.top,x2:(Q.left+Q.right)/2-I.left,y2:(Q.top+Q.bottom)/2-I.top}}I=D.querySelector("svg");I!=null&&D.removeChild(I);for(K=D;K.parentNode&&K.offsetHeight===0;)K=K.parentNode;I=p();I.setAttribute("width",K.offsetWidth);I.setAttribute("height",K.offsetHeight);for(G of Array.from(B)){var O=G.coords;const ca=p("path");K=ca;Q=K.setAttribute;{var J=void 0;var W=O.x1;var ba=O.y1,Y=O.x2;O=O.y2;J=Y-W;var S=O-ba;const V=Math.sqrt(J*J+S*S);if(Math.abs(S)>Math.abs(J)){const xa=(W+Y)/2,na=(ba+O)/2;S=
S>0?.3:-.3;J=Math.min(Math.abs(J)/2,20+V/8);W=["M",W,ba,"C",W+J,ba+",",xa,na-V*S,xa,na,"C",xa,na+V*S,Y-J,O+",",Y,O].join(" ")}else J=Math.min(Math.abs(J)/2.5,20+V/4),W=["M",W,ba,"C",W+J,ba+",",Y-J,O+",",Y,O].join(" ")}Q.call(K,"d",W);ca.setAttribute("stroke",G.color);ca.setAttribute("stroke-width",3);ca.setAttribute("fill","transparent");I.appendChild(ca)}G=D.appendChild(I)}return G};f(D);return D},f=function(y){y=y.querySelectorAll(".shadergraph-code");return Array.from(y).map(B=>function(){B.parentNode.classList.add("shadergraph-has-code");
return B.parentNode.addEventListener("click",D=>B.style.display={block:"none",none:"block"}[B.style.display||"none"])}())},k=function(y){let B,D;const G={},I={};for(D of Array.from(y.nodes))G[D.id]=D;for(B of Array.from(y.links))I[B.from]==null&&(I[B.from]=[]),I[B.from].push(B);const K=function(Q,O){O==null&&(O=0);Q.depth=Math.max(Q.depth!=null?Q.depth:0,O);if(Q=I[Q.id])for(B of Array.from(Q))K(G[B.to],O+1);return null};for(D of Array.from(y.nodes))D.depth==null&&K(D);return null},m=function(y,B){k(y);
const D=document.createElement("div");D.classList.add("shadergraph-graph");const G=[],I={};for(const Q of Array.from(y.nodes)){let O;const J=document.createElement("div");J.classList.add("shadergraph-node");J.classList.add(`shadergraph-node-${Q.type}`);J.innerHTML=`\
<div class="shadergraph-header">${e(Q.name)}</div>\
`;var K=function(W,ba){const Y=r(W.type),S=document.createElement("div");S.classList.add("shadergraph-outlet");S.classList.add(`shadergraph-outlet-${ba}`);S.innerHTML=`\
<div class="shadergraph-point" style="background: ${Y}"></div>
<div class="shadergraph-type" style="color: ${Y}">${e(W.type)}</div>
<div class="shadergraph-name">${e(W.name)}</div>\
`;J.appendChild(S);return I[W.id]=S.querySelector(".shadergraph-point")};for(O of Array.from(Q.inputs))K(O,"in");for(O of Array.from(Q.outputs))K(O,"out");Q.graph!=null?J.appendChild(m(Q.graph,B)):(K=document.createElement("div"),K.classList.add("shadergraph-clear"),J.appendChild(K));Q.code!=null&&(K=document.createElement("div"),K.classList.add("shadergraph-code"),K.innerHTML=e((""+Q.code).replace(/^\s+|\s+$/g,"")),J.appendChild(K));K=G[Q.depth];K==null&&(K=document.createElement("div"),K.classList.add("shadergraph-column"),
G[Q.depth]=K);K.appendChild(J)}for(K of Array.from(G))K!=null&&D.appendChild(K);for(const Q of Array.from(y.links))y=r(Q.type),B.push({color:y,out:I[Q.out],in:I[Q.in]});return D},p=function(y){y==null&&(y="svg");return document.createElementNS("http://www.w3.org/2000/svg",y)},z=function(y){const B=document.createElement("div");B.setAttribute("class","shadergraph-overlay");const D=document.createElement("div");D.setAttribute("class","shadergraph-close");D.innerHTML="\x26times;";const G=document.createElement("div");
G.setAttribute("class","shadergraph-view");const I=document.createElement("div");I.setAttribute("class","shadergraph-inside");I.appendChild(y);G.appendChild(I);B.appendChild(G);B.appendChild(D);D.addEventListener("click",()=>B.parentNode.removeChild(B));return B},t=function(y){if(y instanceof Node)return y;const B=document.createElement("span");B.innerText=y!=null?y:"";return B},v=function(y){if(y.length!==1){let B;const D=document.createElement("div");for(B of Array.from(y))D.appendChild(t(B));D.update=
()=>{const G=[];for(B of Array.from(y))G.push(typeof B.update==="function"?B.update():void 0);return G};return D}return t(y[0])}};
shadow$provide[495]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},inspect:{enumerable:!0,get:function(){return k}},markup:{enumerable:!0,get:function(){return r}},serialize:{enumerable:!0,get:function(){return x}},visualize:{enumerable:!0,get:function(){return f}}});L=l(492);l=l(494);const x=L.serialize,r=l,e=function(m){return m==null?m:m instanceof Array?m.map(e):m.vertex!=null&&m.fragment!=null?[e(m.vertex,e(m.fragment))]:m._graph!=null?m._graph:m.graph!=null?m.graph:
m},g=function(m){let p=[];for(const z of Array.from(m))z instanceof Array?p=p.concat(g(z)):z!=null&&p.push(z);return p},f=function(){const m=g(e([].slice.call(arguments)));return r.merge(Array.from(m).filter(p=>p).map(p=>{p?p.nodes&&(p=x(p),p=r.process(p)):p=void 0;return p}))},k=function(){const m=f.apply(null,arguments),p=r.overlay(m);for(const z of Array.from(document.querySelectorAll(".shadergraph-overlay")))z.remove();document.body.appendChild(p);m.update();return p}};
shadow$provide[496]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Factory:{enumerable:!0,get:function(){return g}}});var x=l(478),r=l(491),e=l(495);class g{constructor(k,m,p){this.language=k;this.fetch=m;this.config=p;this.graph()}pipe(k,m,p,z){k instanceof g?this._concat(k):k!=null&&this._call(k,m,p,z);return this}call(k,m,p,z){return this.pipe(k,m,p,z)}require(k,m,p,z){k instanceof g?this._import(k):k!=null&&(this.callback(),this._call(k,m,p,z),this.end());return this}import(k,
m,p,z){return this.require(k,m,p,z)}split(){this._group("_combine",!0);return this}fan(){this._group("_combine",!1);return this}isolate(){this._group("_isolate");return this}callback(){this._group("_callback");return this}next(){this._next();return this}pass(){const k=this._stack[2].end;this.end();this._state.end=this._state.end.concat(k);return this}end(){const [k,m]=Array.from(this._exit()),{op:p}=k;if(this[p])this[p](k,m);return this}join(){return this.end()}graph(){for(;(this._stack!=null?this._stack.length:
void 0)>1;)this.end();this._graph&&this._tail(this._state,this._graph);const k=this._graph;this._graph=new x.Graph;this._state=new f;this._stack=[this._state];return k}compile(k){k==null&&(k="main");return this.graph().compile(k)}link(k){k==null&&(k="main");return this.graph().link(k)}serialize(){return e.serialize(this._graph)}empty(){return this._graph.nodes.length===0}_concat(k){let m;if(k._state.nodes.length===0)return this;this._tail(k._state,k._graph);try{m=new r.Isolate(k._graph)}catch(p){throw this.config.autoInspect&&
e.inspect(p,this._graph,k),p;}this._auto(m);return this}_import(k){let m;if(k._state.nodes.length===0)throw"Can't import empty callback";this._tail(k._state,k._graph);try{m=new r.Callback(k._graph)}catch(p){throw this.config.autoInspect&&e.inspect(p,this._graph,k),p;}this._auto(m);return this}_combine(k,m){for(const p of Array.from(k.start))for(const z of Array.from(m.end))z.connect(p,k.multi);m.end=k.end;return m.nodes=m.nodes.concat(k.nodes)}_isolate(k,m){if(k.nodes.length){let p;m=this._subgraph(k);
this._tail(k,m);try{p=new r.Isolate(m)}catch(z){throw this.config.autoInspect&&e.inspect(z,this._graph,m),z;}return this._auto(p)}}_callback(k,m){if(k.nodes.length){let p;m=this._subgraph(k);this._tail(k,m);try{p=new r.Callback(m)}catch(z){throw this.config.autoInspect&&e.inspect(z,this._graph,m),z;}return this._auto(p)}}_call(k,m,p,z){k=this.fetch(k);k.bind(this.config,m,p,z);m=new r.Call(k);return this._auto(m)}_subgraph(k){const m=new x.Graph(null,this._graph);m.adopt(k.nodes);return m}_tail(k,
m){let p=k.end.concat(k.tail);p=p.filter((z,t)=>p.indexOf(z)===t);p.length>1&&(p=new r.Join(p),p=[p.node],this._graph.add(p));m.tail=p[0];k.end=p;k.tail=[];if(!m.tail)throw Error("Cannot finalize empty graph");m.compile=z=>{z==null&&(z="main");try{return m.tail.owner.compile(this.language,z)}catch(t){throw this.config.autoInspect&&m.inspect(t),t;}};m.link=z=>{z==null&&(z="main");try{return m.tail.owner.link(this.language,z)}catch(t){throw this.config.autoInspect&&m.inspect(t),t;}};m.export=(z,t)=>
m.tail.owner.export(z,t);return m.inspect=(z=null)=>e.inspect(z,m)}_group(k,m){this._push(k,m);this._push();return this}_next(){const k=this._pop();this._state.start=this._state.start.concat(k.start);this._state.end=this._state.end.concat(k.end);this._state.nodes=this._state.nodes.concat(k.nodes);this._state.tail=this._state.tail.concat(k.tail);return this._push()}_exit(){this._next();this._pop();return[this._pop(),this._state]}_push(k,m){this._stack.unshift(new f(k,m));return this._state=this._stack[0]}_pop(){let k;
this._state=this._stack[1];this._state==null&&(this._state=new f);return(k=this._stack.shift())!=null?k:new f}_auto(k){return k.node.inputs.length?this._append(k):this._insert(k)}_append(k){let m;({node:k}=k);this._graph.add(k);for(m of Array.from(this._state.end))m.connect(k);this._state.start.length||(this._state.start=[k]);this._state.end=[k];this._state.nodes.push(k);k.outputs.length||this._state.tail.push(k)}_prepend(k){let m;({node:k}=k);this._graph.add(k);for(m of Array.from(this._state.start))k.connect(m);
this._state.end.length||(this._state.end=[k]);this._state.start=[k];this._state.nodes.push(k);k.outputs.length||this._state.tail.push(k)}_insert(k){({node:k}=k);this._graph.add(k);this._state.start.push(k);this._state.end.push(k);this._state.nodes.push(k);if(!k.outputs.length)return this._state.tail.push(k)}}class f{constructor(k=null,m,p,z,t,v){this.op=k;m==null&&(m=!1);this.multi=m;p==null&&(p=[]);this.start=p;z==null&&(z=[]);this.end=z;t==null&&(t=[]);this.nodes=t;v==null&&(v=[]);this.tail=v}}
};
shadow$provide[497]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Material:{enumerable:!0,get:function(){return r}}});var x=l(495);class r{constructor(e,g){this.vertex=e;this.fragment=g}build(e){return this.link(e)}link(e){e==null&&(e={});const g={},f={},k={},m=this.vertex.link("main"),p=this.fragment.link("main");for(const z of[m,p]){for(const t in z.uniforms)g[t]=z.uniforms[t];for(const t in z.varyings)f[t]=z.varyings[t];for(const t in z.attributes)k[t]=z.attributes[t]}e.vertexShader=
m.code;e.vertexGraph=m.graph;e.fragmentShader=p.code;e.fragmentGraph=p.graph;e.attributes=k;e.uniforms=g;e.varyings=f;e.inspect=()=>x.inspect("Vertex Shader",m,"Fragment Shader",p.graph);return e}inspect(){return x.inspect("Vertex Shader",this.vertex,"Fragment Shader",this.fragment.graph)}}};
shadow$provide[498]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},library:{enumerable:!0,get:function(){return x}}});const x=function(r,e,g){let f=null,k={};e!=null&&(typeof e==="function"?f=p=>g(r,p,e(p)):typeof e==="object"&&(f=function(p){if(e[p]==null)throw Error(`Unknown snippet \`${p}\``);return g(r,p,e[p])}));var m=p=>g(r,"",p);if(f==null)return m;m=function(p){if(p.match(/[{;]/))return g(r,"",p);k[p]=!0;return f(p)};m.used=function(p){p==null&&(p=k);return k=
p};return m}};
shadow$provide[499]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},queue:{enumerable:!0,get:function(){return x}}});const x=function(r){r==null&&(r=100);const e={};let g=null,f=null,k=0;const m=function(z){z.prev=null;z.next=g;g!=null&&(g.prev=z);g=z;if(f==null)return f=z},p=function(z){const {prev:t}=z,{next:v}=z;t!=null&&(t.next=v);v!=null&&(v.prev=t);g===z&&(g=v);if(f===z)return f=t};return function(z){let t,v;(v=e[z])&&v!==g?(p(v),m(v)):(k===r?(t=f.key,p(f),delete e[t]):
k++,v={next:g,prev:null,key:z},m(v),e[z]=v);return t}}};
shadow$provide[500]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},cache:{enumerable:!0,get:function(){return e}}});var x=l(499),r=l(493);const e=function(g){const f={},k=(0,x.queue)(100);return function(m){const p=m.length>32?"##"+(0,r.hash)(m).toString(16):m,z=k(p);z!=null&&delete f[z];f[p]==null&&(f[p]=g(m));return f[p].clone()}}};
shadow$provide[501]=function(l,L,q){q=l(496);var x=l(497),r=l(498),e=l(500),g=l(499),f=l(493);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e);l.exportCopy(L,g);l.exportCopy(L,f)};
shadow$provide[502]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},compile:{enumerable:!0,get:function(){return x}}});const x=function(e){const {code:g,signatures:f}=e;e={};e[f.main.name]=!0;for(var k of["external","internal","varying","uniform","attribute"])for(const m of f[k])e[m.name]=!0;k=r(g,e);return[f,k]},r=function(e,g){let f;const k=new RegExp("\\b("+(()=>{const m=[];for(f in g)m.push(f);return m})().join("|")+")\\b","g");e=e.replace(/\/\/[^\n]*/g,"");e=e.replace(/\/\*([^*]|\*[^/])*\*\//g,
"");return function(m,p,z){let t;m==null&&(m="");p==null&&(p={});z==null&&(z={});const v={};for(t in g)v[t]=p[t]!=null?t:m+t;m=e.replace(k,y=>v[y]);p=(()=>{const y=[];for(t in z)y.push(`#define ${t} ${z[t]}`);return y})();p.length&&p.push("");return p.join("\n")+m}}};
shadow$provide[503]=function(l,L,q){L.exports="precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int uint void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")};
shadow$provide[504]=function(l,L,q){L.exports="\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")};
shadow$provide[505]=function(l,L,q){L.exports="abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")};
shadow$provide[506]=function(l,L,q){l=l(503);L.exports=l.slice().concat("layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray".split(" "))};
shadow$provide[507]=function(l,L,q){l=l(505);l=l.slice().filter(function(x){return!/^(gl_|texture)/.test(x)});L.exports=l.concat("gl_VertexID gl_InstanceID gl_Position gl_PointSize gl_FragCoord gl_FrontFacing gl_FragDepth gl_PointCoord gl_MaxVertexAttribs gl_MaxVertexUniformVectors gl_MaxVertexOutputVectors gl_MaxFragmentInputVectors gl_MaxVertexTextureImageUnits gl_MaxCombinedTextureImageUnits gl_MaxTextureImageUnits gl_MaxFragmentUniformVectors gl_MaxDrawBuffers gl_MinProgramTexelOffset gl_MaxProgramTexelOffset gl_DepthRangeParameters gl_DepthRange trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" "))};
shadow$provide[508]=function(l,L,q){L.exports=function(W){function ba(Tb){Tb.length&&eb.push({type:J[ra],data:Tb,position:Bb,line:rc,column:xb})}function Y(){jb=jb.length?[]:jb;if(Ua==="/"&&Ea==="*")return Bb=pa+N-1,ra=p,Ua=Ea,N+1;if(Ua==="/"&&Ea==="/")return Bb=pa+N-1,ra=z,Ua=Ea,N+1;if(Ea==="#")return ra=t,Bb=pa+N,N;if(/\s/.test(Ea))return ra=K,Bb=pa+N,N;bc=/\d/.test(Ea);qb=/[^\w_]/.test(Ea);Bb=pa+N;ra=bc?y:qb?v:m;return N}function S(){if((Ea==="\r"||Ea==="\n")&&Ua!=="\\")return ba(jb.join("")),
ra=k,N;jb.push(Ea);Ua=Ea;return N+1}function ca(){if(Ua==="."&&/\d/.test(Ea))return ra=B,N;if(Ua==="/"&&Ea==="*")return ra=p,N;if(Ua==="/"&&Ea==="/")return ra=z,N;if(Ea==="."&&jb.length){for(;V(jb););ra=B;return N}if(Ea===";"||Ea===")"||Ea==="("){if(jb.length)for(;V(jb););ba(Ea);ra=k;return N+1}var Tb=jb.length===2&&Ea!=="\x3d";if(/[\w_\d\s]/.test(Ea)||Tb){for(;V(jb););ra=k;return N}jb.push(Ea);Ua=Ea;return N+1}function V(Tb){var yc=0;do{var Ha=r.indexOf(Tb.slice(0,Tb.length+yc).join(""));var fb=
r[Ha];if(Ha===-1){if(yc--+Tb.length>0)continue;fb=Tb.slice(0,1).join("")}ba(fb);Bb+=fb.length;jb=jb.slice(fb.length);return jb.length}while(1)}function xa(){if(Ea==="."||/[eE]/.test(Ea))return jb.push(Ea),ra=B,Ua=Ea,N+1;if(Ea==="x"&&jb.length===1&&jb[0]==="0")return ra=O,jb.push(Ea),Ua=Ea,N+1;if(/[^\d]/.test(Ea))return ba(jb.join("")),ra=k,N;jb.push(Ea);Ua=Ea;return N+1}function na(){Ea==="f"&&(jb.push(Ea),Ua=Ea,N+=1);if(/[eE]/.test(Ea)||(Ea==="-"||Ea==="+")&&/[eE]/.test(Ua))return jb.push(Ea),Ua=
Ea,N+1;if(/[^\d]/.test(Ea))return ba(jb.join("")),ra=k,N;jb.push(Ea);Ua=Ea;return N+1}var N=0,pa=0,ra=k,Ea,Ua,jb=[],eb=[],rc=1,xb=0,Bb=0,bc=!1,qb=!1,cc="",Db;W=W||{};var nc=e,Bc=x;W.version==="300 es"&&(nc=f,Bc=g);var yb={},lb={};for(N=0;N<nc.length;N++)yb[nc[N]]=!0;for(N=0;N<Bc.length;N++)lb[Bc[N]]=!0;return function(Tb){eb=[];if(Tb!==null){N=0;Tb.toString&&(Tb=Tb.toString());cc+=Tb.replace(/\r\n/g,"\n");for(Db=cc.length;Ea=cc[N],N<Db;){Tb=N;switch(ra){case p:Ea==="/"&&Ua==="*"?(jb.push(Ea),ba(jb.join("")),
ra=k):(jb.push(Ea),Ua=Ea);N+=1;break;case z:N=S();break;case t:N=S();break;case v:N=ca();break;case y:N=xa();break;case O:/[^a-fA-F0-9]/.test(Ea)?(ba(jb.join("")),ra=k):(jb.push(Ea),Ua=Ea,N+=1);break;case B:N=na();break;case m:if(/[^\d\w_]/.test(Ea)){var yc=jb.join("");ra=lb[yc]?I:yb[yc]?G:D;ba(jb.join(""));ra=k}else jb.push(Ea),Ua=Ea,N+=1;break;case K:/[^\s]/g.test(Ea)?(ba(jb.join("")),ra=k):(jb.push(Ea),Ua=Ea,N+=1);break;case k:N=Y()}if(Tb!==N)switch(cc[Tb]){case "\n":xb=0;++rc;break;default:++xb}}pa+=
N;cc=cc.slice(N);return eb}jb.length&&ba(jb.join(""));ra=Q;ba("(eof)");return eb}};var x=l(503),r=l(504),e=l(505),g=l(506),f=l(507),k=999,m=9999,p=0,z=1,t=2,v=3,y=4,B=5,D=6,G=7,I=8,K=9,Q=10,O=11,J="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ")};
shadow$provide[509]=function(l,L,q){var x=l(508);L.exports=function(r,e){e=x(e);var g=[];g=g.concat(e(r));return g=g.concat(e(null))}};
shadow$provide[510]=function(l,L,q){function x(){return this}function r(K,Q){let O=I[K];Q=Q||0;O?Q>O.lbp&&(O.lbp=Q):(O=Object.create(G),O.id=K,O.lbp=Q,I[K]=O);return O}function e(K){let Q,O=y;z();for(Q=O.nud();K<y.lbp;)O=y,z(),Q=O.led(Q);return Q}function g(K,Q,O){r(K,Q).led=O||function(J){this.children=[J,e(Q)];this.type="binary";return this}}function f(K,Q,O){K=r(K,Q);K.led=O||function(J){this.children=[J,e(Q-1)];this.type="binary";return this};return K}function k(K,Q){K=r(K);K.nud=Q||function(){this.children=
[e(70)];this.type="unary";return this};return K}function m(K){r(K,150).led=function(Q){this.children=[Q];this.type="suffix";return this}}function p(K){return f(K,10,function(Q){this.children=[Q,e(9)];this.assignment=!0;this.type="assign";return this})}function z(K){let Q,O,J;if(K&&y.data!==K)return v.unexpected("expected `"+K+"`, got `"+y.data+"`");if(D>=B.length)y=I["(end)"];else{K=B[D++];Q=K.data;O=K.type;if(O==="ident")J=v.scope.find(Q)||v.create_node(),O=J.type;else if(O==="builtin")J=I["(builtin)"];
else if(O==="keyword")J=I["(keyword)"];else if(O==="operator"){if(J=I[Q],!J)return v.unexpected("unknown operator `"+Q+"`")}else if(O==="float"||O==="integer")O="literal",J=I["(literal)"];else return v.unexpected("unexpected token.");J&&(J.nud||(J.nud=x),J.children||(J.children=[]));J=Object.create(J);J.token=K;J.type=O;J.data||(J.data=Q);return y=J}}function t(K){return function(){return v.unexpected(K)}}let v,y,B,D;const G={nud:function(){return this.children&&this.children.length?this:t("unexpected")()},
led:t("missing operator")},I={};r("(ident)").nud=x;r("(keyword)").nud=x;r("(builtin)").nud=x;r("(literal)").nud=x;r("(end)");r(":");r(";");r(",");r(")");r("]");r("}");f("\x26\x26",30);f("||",30);g("|",43);g("^",44);g("\x26",45);g("\x3d\x3d",46);g("!\x3d",46);g("\x3c",47);g("\x3c\x3d",47);g("\x3e",47);g("\x3e\x3d",47);g("\x3e\x3e",48);g("\x3c\x3c",48);g("+",50);g("-",50);g("*",60);g("/",60);g("%",60);g("?",20,function(K){this.children=[K,e(0),(z(":"),e(0))];this.type="ternary";return this});g(".",
80,function(K){y.type="literal";v.fake(y);this.children=[K,y];z();return this});g("[",80,function(K){this.children=[K,e(0)];this.type="binary";z("]");return this});g("(",80,function(K){this.children=[K];this.type="call";if(y.data!==")")for(;;){this.children.push(e(0));if(y.data!==",")break;z(",")}z(")");return this});k("-");k("+");k("!");k("~");k("defined");k("(",function(){this.type="group";this.children=[e(0)];z(")");return this});k("++");k("--");m("++");m("--");p("\x3d");p("+\x3d");p("-\x3d");
p("*\x3d");p("/\x3d");p("%\x3d");p("\x26\x3d");p("|\x3d");p("^\x3d");p("\x3e\x3e\x3d");p("\x3c\x3c\x3d");L.exports=function(K,Q){function O(J){v.unshift(J,!1);for(let W=0,ba=J.children.length;W<ba;++W)O(J.children[W]);v.shift()}v=K;B=Q;D=0;if(B.length){z();K=e(0);K.parent=v[0];O(K);if(D<B.length)throw Error("did not use all tokens");K.parent.children=[K]}}};
shadow$provide[511]=function(l,L,q){function x(r){if(this.constructor!==x)return new x(r);this.state=r;this.scopes=[];this.current=null}L.exports=x;l=x.prototype;l.enter=function(r){this.scopes.push(this.current=this.state[0].scope=r||{})};l.exit=function(){this.scopes.pop();this.current=this.scopes[this.scopes.length-1]};l.define=function(r){this.current[r]=this.state[0]};l.find=function(r,e){for(e=this.scopes.length-1;e>-1;--e)if(this.scopes[e].hasOwnProperty(r))return this.scopes[e][r];return null}};
shadow$provide[512]=function(l,L,q){function x(N,pa){return{mode:N,token:pa,children:[],type:na[N],id:(Math.random()*4294967295).toString(16)}}L.exports=function(){function N(Ra){if(Ra===null)return ra(),zc;sd=[];pa(Ra);return sd}function pa(Ra){if(Ra.type==="whitespace"||Ra.type==="line-comment"||Ra.type==="block-comment")Pc.push(Ra);else for(Wb.push(Ra),(Va=Va||Wb[0])&&Pc.length&&(Va.preceding=Va.preceding||[],Va.preceding=Va.preceding.concat(Pc),Pc=[]);$c||!La.length?0:Va=Wb[0];)switch(La[0].mode){case k:Ua();
break;case m:Ea();break;case v:jb();break;case y:eb();break;case I:rc();break;case p:md(!0,!0);break;case K:Hd();break;case f:Va.type!=="ident"&&Va.type!=="builtin"?Db("expected user-defined name, got "+Va.data):(La[0].data=Va.data,La.shift(),Wb.shift());break;case Q:Va.type!=="keyword"?Db("expected keyword, got "+Va.data):(La.shift(),Wb.shift());break;case O:Va.type==="keyword"?(La[0].type="keyword",La[0].mode=Q):Va.type==="ident"?(La[0].type="ident",La[0].mode=f):Db("expected keyword or user-defined name, got "+
Va.data);break;case z:Sd();break;case t:Td();break;case B:qd();break;case D:Ib();break;case S:Rb();break;case J:ic();break;case G:ld();break;case V:Ic()}}function ra(Ra){arguments.length&&pa(Ra);La.length>1&&Db("unexpected EOF")}function Ea(){return yb(function(){La.scope.enter();return g},function(){if(Va.data===La[0].expecting)return La.scope.exit(),La.shift();switch(Va.type){case "preprocessor":La.fake(x(xa[Va.type],Va,uc));Wb.shift();break;default:La.unshift(fc())}})()}function Ua(){if(La[0].brace){if(Va.data!==
"}")return Db("expected `}`, got "+Va.data);La[0].brace=!1;return Wb.shift(),La.shift()}switch(Va.type){case "eof":return rd&&($c=!0),rd=!0,La.shift();case "keyword":switch(Va.data){case "for":return La.unshift(te());case "if":return La.unshift(ue());case "while":return La.unshift(fe());case "do":return La.unshift(ve());case "break":return La.fake(x(W,Va)),Wb.shift();case "continue":return La.fake(x(ba,Va)),Wb.shift();case "discard":return La.fake(x(Y,Va)),Wb.shift();case "return":return La.unshift(ge());
case "precision":return La.unshift(Dc())}return La.unshift(Bb(255));case "ident":var Ra;if(Ra=La.scope.find(Va.data))return Ra.parent.type==="struct"?La.unshift(Bb(255)):La.unshift(qb(";"));case "operator":if(Va.data==="{")return La[0].brace=!0,Ra=Qb(),Ra.expecting="}",Wb.shift(),La.unshift(Ra);if(Va.data===";")return Wb.shift(),La.shift();default:return La.unshift(qb(";"))}}function jb(){const Ra=La[0];return yb(function(){if(Va.data==="invariant")return Ra.flags&8?(La.unshift(cc()),g):Db("`invariant` is not allowed here");
La.fake(x(ca,{data:"",position:Va.position}));return g},function(){if(Va.data==="const"||Va.data==="attribute"||Va.data==="uniform"||Va.data==="varying")return Ra.flags&16?(La.unshift(cc()),g):Db("storage is not allowed here");La.fake(x(ca,{data:"",position:Va.position}));return g},function(){if(Va.data==="in"||Va.data==="inout"||Va.data==="out"){if(Ra.flags&32)return Db("parameter is not allowed here");La.unshift(cc());return g}La.fake(x(ca,{data:"",position:Va.position}));return g},function(){Va.data===
"highp"||Va.data==="mediump"||Va.data==="lowp"?La.unshift(cc()):La.fake(x(ca,{data:"",position:Va.position}));return g},function(){if(Va.data==="struct"){if(!(Ra.flags&64))return Db("cannot nest structs");La.unshift(bc());return g}if(Va.type==="keyword")return La.unshift(cc()),g;const Ab=La.scope.find(Va.data);return Ab?(La.fake(Object.create(Ab)),Wb.shift(),g):Db("expected user defined type, struct or keyword, got "+Va.data)},function(){if(Va.data===","&&!(Ra.flags&2))return La.shift();if(Va.data===
"[")La.unshift(Rd());else{if(Va.data===")")return La.shift();if(Va.data===";")return Ra.stage+3;if(Va.type!=="ident"&&Va.type!=="builtin")return Db("expected identifier, got "+Va.data);Ra.collected_name=Wb.shift();return g}},function(){return Va.data==="("?(Wb.unshift(Ra.collected_name),delete Ra.collected_name,La.unshift(Qd()),Ra.stage+2):g},function(){Wb.unshift(Ra.collected_name);delete Ra.collected_name;La.unshift(oc());return g},function(){return La.shift()})()}function eb(){if(Va.type==="ident"||
Va.type==="builtin"){const Ra=Va.data;La.unshift(pc());La.scope.define(Ra)}else{if(Va.type==="operator"){if(Va.data===",")return La[1].flags&2?Wb.shift():La.shift();if(Va.data==="\x3d"){if(!(La[1].flags&1))return Db("`\x3d` is not allowed here.");Wb.shift();La.unshift(qb(",",";"));return}if(Va.data==="["){La.unshift(Rd());return}}return La.shift()}}function rc(){const Ra=La[0].expecting;La[0].tokens=La[0].tokens||[];La[0].parenlevel===void 0&&(La[0].parenlevel=0,La[0].bracelevel=0);if(La[0].parenlevel<
1&&Ra.indexOf(Va.data)>-1){try{r(La,La[0].tokens)}catch(Ab){throw $c=!0,Ab;}return La.shift()}Va.data==="("?++La[0].parenlevel:Va.data===")"&&--La[0].parenlevel;switch(Va.data){case "{":++La[0].bracelevel;break;case "}":--La[0].bracelevel;break;case "(":++La[0].parenlevel;break;case ")":--La[0].parenlevel}if(La[0].parenlevel<0)return Db("unexpected `)`");if(La[0].bracelevel<0)return Db("unexpected `}`");La[0].tokens.push(Wb.shift())}function xb(Ra){return function(){return x(Ra,Va)}}function Bb(Ra){const Ab=
x(v,Va,uc);Ab.flags=Ra;return Ab}function bc(Ra,Ab){const xc=x(p,Va,uc);xc.allow_assign=Ra===void 0?!0:Ra;xc.allow_comma=Ab===void 0?!0:Ab;return xc}function qb(){const Ra=x(I,Va,uc);Ra.expecting=[].slice.call(arguments);return Ra}function cc(Ra){let Ab=Va;Ra&&(Ab={type:"(implied)",data:"(default)",position:Ab.position});return x(Q,Ab,uc)}function Db(Ra){$c=!0;throw Error((Ra||"unexpected "+La)+" at line "+La[0].token.line);}function nc(Ra,Ab){return 1,Bc(Ra,Va.type)&&Bc(Ab,Va.data)}function Bc(Ra,
Ab){switch(typeof Ra){case "string":return Ab!==Ra&&Db("expected `"+Ra+"`, got "+Ab+"\n"+Va.data),!$c;case "object":return Ra&&Ra.indexOf(Ab)===-1&&Db("expected one of `"+Ra.join("`, `")+"`, got "+Ab),!$c}return!0}function yb(){let Ra=[].slice.call(arguments),Ab,xc;return function(){const Jc=La[0];Jc.stage||(Jc.stage=0);Ab=Ra[Jc.stage];if(!Ab)return Db("parser in undefined state!");xc=Ab();if(xc===g)return++Jc.stage;xc!==void 0&&(Jc.stage=xc)}}function lb(Ra,Ab){Ab=Ab||"operator";return function(){if(nc(Ab,
Ra)){var xc=Wb.shift(),Jc=La[0].children;(Jc=Jc[Jc.length-1])&&Jc.token&&xc.preceding&&(Jc.token.succeeding=Jc.token.succeeding||[],Jc.token.succeeding=Jc.token.succeeding.concat(xc.preceding));return g}}}function Tb(Ra){return function(){La.unshift(qb(Ra));return g}}function yc(Ra){return Ra?function(){const Ab=Va.data;return nc("ident")&&(La.unshift(pc()),La.scope.define(Ab),g)}:function(){if(nc("ident"))return Object.create(La.scope.find(Va.data)).token=Va,Wb.shift(),g}}function Ha(){return function(){const Ra=
Qb();Ra.expecting="}";return La.unshift(Ra),g}}function fb(Ra){return function(){const Ab=La[0].stage;return Va.data!=="{"?(La.unshift(fc()),Ab+Ra):(Wb.shift(),g)}}function ab(){return function(){return La.shift(),La.shift()}}const Qb=xb(m),fc=xb(k),oc=xb(y),Dc=xb(K),pc=xb(f);xb(O);const Qd=xb(z),Ec=xb(t),te=xb(B),ue=xb(G),fe=xb(D),ge=xb(J),ve=xb(S),Rd=xb(V);let md,Hd,Ic,qd,ld,ic,Ib,Rb,Sd,Td,Id=arguments.length?[].slice.call(arguments):[],rd=!1,La=[],sd=[],Wb=[],Pc=[],$c=!1,zc,Va,uc;La.shift=function(){let Ra=
[].shift.call(this),Ab=Id[this.length],xc=!1;Id.length?typeof Id[0]==="function"?xc=Id[0](Ra):Ab!==void 0&&(xc=Ab.test?Ab.test(Ra.type):Ab===Ra.type):xc=!0;xc&&!$c&&sd.push(Ra);uc=Ra.parent;return Ra};La.unshift=function(Ra,Ab){Ra.parent=La[0];const xc=[].unshift.call(this,Ra);(Ab===void 0||Ab)&&uc!==Ra&&uc.children.push(Ra);uc=Ra;return xc};La.fake=function(Ra){La.unshift(Ra);La.shift()};La.unexpected=Db;La.scope=new e(La);La.create_node=function(){const Ra=x(f,Va);Ra.parent=N.program;return Ra};
(function(){md=yb(lb("struct","keyword"),function(){return Va.data==="{"?(La.fake(x(f,{data:"",position:Va.position,type:"ident"})),g):yc(!0)()},function(){La.scope.enter();return g},lb("{"),function(){if(Va.type==="preprocessor")La.fake(x(xa[Va.type],Va,uc)),Wb.shift();else{if(Va.data==="}")return La.scope.exit(),Wb.shift(),La.shift();Va.data===";"?Wb.shift():La.unshift(Bb(166))}});Hd=yb(function(){return Wb.shift(),g},function(){return nc("keyword",["lowp","mediump","highp"])&&(La.unshift(cc()),
g)},function(){return La.unshift(cc()),g},function(){return La.shift()});Ic=yb(lb("["),Tb("]"),lb("]"),function(){return La.shift()});qd=yb(lb("for","keyword"),lb("("),function(){let Ra;if(Va.type==="ident"){if((Ra=La.scope.find(Va.data))||(Ra=La.create_node()),Ra.parent.type==="struct")return La.unshift(Bb(255)),g}else if(Va.type==="builtin"||Va.type==="keyword")return La.unshift(Bb(255)),g;return Tb(";")()},lb(";"),Tb(";"),lb(";"),Tb(")"),lb(")"),fb(3),Ha(),lb("}"),ab());ld=yb(lb("if","keyword"),
lb("("),Tb(")"),lb(")"),fb(3),Ha(),lb("}"),function(){return Va.data==="else"?(Wb.shift(),La.unshift(fc()),g):ab()()},ab());ic=yb(lb("return","keyword"),function(){return Va.data===";"?g:(La.unshift(qb(";")),g)},function(){Wb.shift();ab()()});Ib=yb(lb("while","keyword"),lb("("),Tb(")"),lb(")"),fb(3),Ha(),lb("}"),ab());Rb=yb(lb("do","keyword"),fb(3),Ha(),lb("}"),lb("while","keyword"),lb("("),Tb(")"),lb(")"),ab());Sd=yb(function(){for(let Ra=1,Ab=La.length;Ra<Ab;++Ra)if(La[Ra].mode===z)return Db("function definition is not allowed within another function");
return g},function(){if(nc("ident")){var Ra=Va.data,Ab=La.scope.find(Ra);La.unshift(pc());La.scope.define(Ra);La.scope.enter(Ab?Ab.scope:null);return g}},lb("("),function(){return La.unshift(Ec()),g},lb(")"),function(){return Va.data===";"?(La.scope.exit(),La.shift(),La.shift()):g},lb("{"),Ha(),lb("}"),function(){La.scope.exit();return g},function(){return La.shift(),La.shift(),La.shift()});Td=yb(function(){if(Va.data==="void")return La.fake(cc()),Wb.shift(),g;if(Va.data===")")La.shift();else{if(Va.data===
"struct")return La.unshift(bc(!1,!1)),g;La.unshift(Bb(208));return g}},function(){if(Va.data===",")return Wb.shift(),0;Va.data===")"?La.shift():Db("expected one of `,` or `)`, got "+Va.data)})})();uc=Qb();uc.expecting="(eof)";uc.mode=m;uc.token={type:"(program)",data:"(program)"};zc=uc;N.program=zc;N.scope=function(Ra){arguments.length===1&&(La.scope=Ra);return La.scope};La.unshift(uc);return N};const r=l(510),e=l(511),g={};l=0;let f=l++,k=l++,m=l++,p=l++,z=l++,t=l++,v=l++,y=l++,B=l++,D=l++,G=l++,
I=l++,K=l++;L=l++;q=l++;let Q=l++,O=l++,J=l++,W=l++,ba=l++,Y=l++,S=l++,ca=l++,V=l++;const xa={"block-comment":L,"line-comment":L,preprocessor:q},na=l="ident stmt stmtlist struct function functionargs decl decllist forloop whileloop if expr precision comment preprocessor keyword keyword_or_ident return break continue discard do-while placeholder quantifier".split(" ")};
shadow$provide[513]=function(l,L,q){var x=l(512);L.exports=function(r){for(var e=x(),g=0;g<r.length;g++)e(r[g]);return e(null)}};
shadow$provide[514]=function(l,L,q){function x(){const na=Math.random()*4294967295|0,N=Math.random()*4294967295|0,pa=Math.random()*4294967295|0,ra=Math.random()*4294967295|0;return(Y[na&255]+Y[na>>8&255]+Y[na>>16&255]+Y[na>>24&255]+"-"+Y[N&255]+Y[N>>8&255]+"-"+Y[N>>16&15|64]+Y[N>>24&255]+"-"+Y[pa&63|128]+Y[pa>>8&255]+"-"+Y[pa>>16&255]+Y[pa>>24&255]+Y[ra&255]+Y[ra>>8&255]+Y[ra>>16&255]+Y[ra>>24&255]).toLowerCase()}function r(na,N,pa){return Math.max(N,Math.min(pa,na))}function e(na,N){return(na%N+
N)%N}function g(na,N,pa,ra,Ea){return ra+(na-N)*(Ea-ra)/(pa-N)}function f(na,N,pa){return na!==N?(pa-na)/(N-na):0}function k(na,N,pa){return(1-pa)*na+pa*N}function m(na,N,pa,ra){return k(na,N,1-Math.exp(-pa*ra))}function p(na,N=1){return N-Math.abs(e(na,N*2)-N)}function z(na,N,pa){if(na<=N)return 0;if(na>=pa)return 1;na=(na-N)/(pa-N);return na*na*(3-2*na)}function t(na,N,pa){if(na<=N)return 0;if(na>=pa)return 1;na=(na-N)/(pa-N);return na*na*na*(na*(na*6-15)+10)}function v(na,N){return na+Math.floor(Math.random()*
(N-na+1))}function y(na,N){return na+Math.random()*(N-na)}function B(na){return na*(.5-Math.random())}function D(na){na!==void 0&&(S=na);na=S+=1831565813;na=Math.imul(na^na>>>15,na|1);na^=na+Math.imul(na^na>>>7,na|61);return((na^na>>>14)>>>0)/4294967296}function G(na){return na*ca}function I(na){return na*V}function K(na){return(na&na-1)===0&&na!==0}function Q(na){return Math.pow(2,Math.ceil(Math.log(na)/Math.LN2))}function O(na){return Math.pow(2,Math.floor(Math.log(na)/Math.LN2))}function J(na,
N,pa,ra,Ea){var Ua=Math.cos;const jb=Math.sin,eb=Ua(pa/2);pa=jb(pa/2);const rc=Ua((N+ra)/2),xb=jb((N+ra)/2),Bb=Ua((N-ra)/2),bc=jb((N-ra)/2);Ua=Ua((ra-N)/2);N=jb((ra-N)/2);switch(Ea){case "XYX":na.set(eb*xb,pa*Bb,pa*bc,eb*rc);break;case "YZY":na.set(pa*bc,eb*xb,pa*Bb,eb*rc);break;case "ZXZ":na.set(pa*Bb,pa*bc,eb*xb,eb*rc);break;case "XZX":na.set(eb*xb,pa*N,pa*Ua,eb*rc);break;case "YXY":na.set(pa*Ua,eb*xb,pa*N,eb*rc);break;case "ZYZ":na.set(pa*N,pa*Ua,eb*xb,eb*rc);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+
Ea)}}function W(na,N){switch(N.constructor){case Float32Array:return na;case Uint32Array:return na/4294967295;case Uint16Array:return na/65535;case Uint8Array:return na/255;case Int32Array:return Math.max(na/2147483647,-1);case Int16Array:return Math.max(na/32767,-1);case Int8Array:return Math.max(na/127,-1);default:throw Error("Invalid component type.");}}function ba(na,N){switch(N.constructor){case Float32Array:return na;case Uint32Array:return Math.round(na*4294967295);case Uint16Array:return Math.round(na*
65535);case Uint8Array:return Math.round(na*255);case Int32Array:return Math.round(na*2147483647);case Int16Array:return Math.round(na*32767);case Int8Array:return Math.round(na*127);default:throw Error("Invalid component type.");}}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},DEG2RAD:{enumerable:!0,get:function(){return ca}},MathUtils:{enumerable:!0,get:function(){return xa}},RAD2DEG:{enumerable:!0,get:function(){return V}},ceilPowerOfTwo:{enumerable:!0,get:function(){return Q}},
clamp:{enumerable:!0,get:function(){return r}},damp:{enumerable:!0,get:function(){return m}},degToRad:{enumerable:!0,get:function(){return G}},denormalize:{enumerable:!0,get:function(){return W}},euclideanModulo:{enumerable:!0,get:function(){return e}},floorPowerOfTwo:{enumerable:!0,get:function(){return O}},generateUUID:{enumerable:!0,get:function(){return x}},inverseLerp:{enumerable:!0,get:function(){return f}},isPowerOfTwo:{enumerable:!0,get:function(){return K}},lerp:{enumerable:!0,get:function(){return k}},
mapLinear:{enumerable:!0,get:function(){return g}},normalize:{enumerable:!0,get:function(){return ba}},pingpong:{enumerable:!0,get:function(){return p}},radToDeg:{enumerable:!0,get:function(){return I}},randFloat:{enumerable:!0,get:function(){return y}},randFloatSpread:{enumerable:!0,get:function(){return B}},randInt:{enumerable:!0,get:function(){return v}},seededRandom:{enumerable:!0,get:function(){return D}},setQuaternionFromProperEuler:{enumerable:!0,get:function(){return J}},smootherstep:{enumerable:!0,
get:function(){return t}},smoothstep:{enumerable:!0,get:function(){return z}}});const Y="00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f 40 41 42 43 44 45 46 47 48 49 4a 4b 4c 4d 4e 4f 50 51 52 53 54 55 56 57 58 59 5a 5b 5c 5d 5e 5f 60 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a 7b 7c 7d 7e 7f 80 81 82 83 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f 90 91 92 93 94 95 96 97 98 99 9a 9b 9c 9d 9e 9f a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 aa ab ac ad ae af b0 b1 b2 b3 b4 b5 b6 b7 b8 b9 ba bb bc bd be bf c0 c1 c2 c3 c4 c5 c6 c7 c8 c9 ca cb cc cd ce cf d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 da db dc dd de df e0 e1 e2 e3 e4 e5 e6 e7 e8 e9 ea eb ec ed ee ef f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 fa fb fc fd fe ff".split(" ");
let S=1234567;const ca=Math.PI/180,V=180/Math.PI,xa={DEG2RAD:ca,RAD2DEG:V,generateUUID:x,clamp:r,euclideanModulo:e,mapLinear:g,inverseLerp:f,lerp:k,damp:m,pingpong:p,smoothstep:z,smootherstep:t,randInt:v,randFloat:y,randFloatSpread:B,seededRandom:D,degToRad:G,radToDeg:I,isPowerOfTwo:K,ceilPowerOfTwo:Q,floorPowerOfTwo:O,setQuaternionFromProperEuler:J,normalize:ba,denormalize:W}};
shadow$provide[515]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Vector2:{enumerable:!0,get:function(){return r}}});var x=l(514);class r{constructor(e=0,g=0){r.prototype.isVector2=!0;this.x=e;this.y=g}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,g){this.x=e;this.y=g;return this}setScalar(e){this.y=this.x=e;return this}setX(e){this.x=e;return this}setY(e){this.y=e;return this}setComponent(e,g){switch(e){case 0:this.x=
g;break;case 1:this.y=g;break;default:throw Error("index is out of range: "+e);}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e);}}clone(){return new this.constructor(this.x,this.y)}copy(e){this.x=e.x;this.y=e.y;return this}add(e){this.x+=e.x;this.y+=e.y;return this}addScalar(e){this.x+=e;this.y+=e;return this}addVectors(e,g){this.x=e.x+g.x;this.y=e.y+g.y;return this}addScaledVector(e,g){this.x+=e.x*g;this.y+=e.y*g;return this}sub(e){this.x-=
e.x;this.y-=e.y;return this}subScalar(e){this.x-=e;this.y-=e;return this}subVectors(e,g){this.x=e.x-g.x;this.y=e.y-g.y;return this}multiply(e){this.x*=e.x;this.y*=e.y;return this}multiplyScalar(e){this.x*=e;this.y*=e;return this}divide(e){this.x/=e.x;this.y/=e.y;return this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const g=this.x,f=this.y;e=e.elements;this.x=e[0]*g+e[3]*f+e[6];this.y=e[1]*g+e[4]*f+e[7];return this}min(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);
return this}max(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);return this}clamp(e,g){this.x=(0,x.clamp)(this.x,e.x,g.x);this.y=(0,x.clamp)(this.y,e.y,g.y);return this}clampScalar(e,g){this.x=(0,x.clamp)(this.x,e,g);this.y=(0,x.clamp)(this.y,e,g);return this}clampLength(e,g){const f=this.length();return this.divideScalar(f||1).multiplyScalar((0,x.clamp)(f,e,g))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);
return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);return this}negate(){this.x=-this.x;this.y=-this.y;return this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,
-this.x)+Math.PI}angleTo(e){const g=Math.sqrt(this.lengthSq()*e.lengthSq());if(g===0)return Math.PI/2;e=this.dot(e)/g;return Math.acos((0,x.clamp)(e,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const g=this.x-e.x;e=this.y-e.y;return g*g+e*e}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,g){this.x+=(e.x-this.x)*g;this.y+=(e.y-this.y)*g;return this}lerpVectors(e,g,f){this.x=
e.x+(g.x-e.x)*f;this.y=e.y+(g.y-e.y)*f;return this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,g=0){this.x=e[g];this.y=e[g+1];return this}toArray(e=[],g=0){e[g]=this.x;e[g+1]=this.y;return e}fromBufferAttribute(e,g){this.x=e.getX(g);this.y=e.getY(g);return this}rotateAround(e,g){const f=Math.cos(g);g=Math.sin(g);const k=this.x-e.x,m=this.y-e.y;this.x=k*f-m*g+e.x;this.y=k*g+m*f+e.y;return this}random(){this.x=Math.random();this.y=Math.random();return this}*[Symbol.iterator](){yield this.x;
yield this.y}}};
shadow$provide[516]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Quaternion:{enumerable:!0,get:function(){return r}}});var x=l(514);class r{constructor(e=0,g=0,f=0,k=1){this.isQuaternion=!0;this._x=e;this._y=g;this._z=f;this._w=k}static slerpFlat(e,g,f,k,m,p,z){let t=f[k+0],v=f[k+1],y=f[k+2];f=f[k+3];k=m[p+0];const B=m[p+1],D=m[p+2];m=m[p+3];if(z===0)e[g+0]=t,e[g+1]=v,e[g+2]=y,e[g+3]=f;else if(z===1)e[g+0]=k,e[g+1]=B,e[g+2]=D,e[g+3]=m;else{if(f!==m||t!==k||v!==B||
y!==D){p=1-z;var G=t*k+v*B+y*D+f*m,I=G>=0?1:-1,K=1-G*G;K>Number.EPSILON&&(K=Math.sqrt(K),G=Math.atan2(K,G*I),p=Math.sin(p*G)/K,z=Math.sin(z*G)/K);I*=z;t=t*p+k*I;v=v*p+B*I;y=y*p+D*I;f=f*p+m*I;p===1-z&&(z=1/Math.sqrt(t*t+v*v+y*y+f*f),t*=z,v*=z,y*=z,f*=z)}e[g]=t;e[g+1]=v;e[g+2]=y;e[g+3]=f}}static multiplyQuaternionsFlat(e,g,f,k,m,p){const z=f[k],t=f[k+1],v=f[k+2];f=f[k+3];k=m[p];const y=m[p+1],B=m[p+2];m=m[p+3];e[g]=z*m+f*k+t*B-v*y;e[g+1]=t*m+f*y+v*k-z*B;e[g+2]=v*m+f*B+z*y-t*k;e[g+3]=f*m-z*k-t*y-v*B;
return e}get x(){return this._x}set x(e){this._x=e;this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e;this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e;this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e;this._onChangeCallback()}set(e,g,f,k){this._x=e;this._y=g;this._z=f;this._w=k;this._onChangeCallback();return this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){this._x=e.x;this._y=e.y;this._z=e.z;this._w=e.w;this._onChangeCallback();
return this}setFromEuler(e,g=!0){var f=e._x,k=e._y,m=e._z;e=e._order;var p=Math.cos;const z=Math.sin,t=p(f/2),v=p(k/2);p=p(m/2);f=z(f/2);k=z(k/2);m=z(m/2);switch(e){case "XYZ":this._x=f*v*p+t*k*m;this._y=t*k*p-f*v*m;this._z=t*v*m+f*k*p;this._w=t*v*p-f*k*m;break;case "YXZ":this._x=f*v*p+t*k*m;this._y=t*k*p-f*v*m;this._z=t*v*m-f*k*p;this._w=t*v*p+f*k*m;break;case "ZXY":this._x=f*v*p-t*k*m;this._y=t*k*p+f*v*m;this._z=t*v*m+f*k*p;this._w=t*v*p-f*k*m;break;case "ZYX":this._x=f*v*p-t*k*m;this._y=t*k*p+
f*v*m;this._z=t*v*m-f*k*p;this._w=t*v*p+f*k*m;break;case "YZX":this._x=f*v*p+t*k*m;this._y=t*k*p+f*v*m;this._z=t*v*m-f*k*p;this._w=t*v*p-f*k*m;break;case "XZY":this._x=f*v*p-t*k*m;this._y=t*k*p-f*v*m;this._z=t*v*m+f*k*p;this._w=t*v*p+f*k*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+e)}g===!0&&this._onChangeCallback();return this}setFromAxisAngle(e,g){g/=2;const f=Math.sin(g);this._x=e.x*f;this._y=e.y*f;this._z=e.z*f;this._w=Math.cos(g);this._onChangeCallback();
return this}setFromRotationMatrix(e){var g=e.elements,f=g[0];e=g[4];const k=g[8],m=g[1],p=g[5],z=g[9],t=g[2],v=g[6];g=g[10];const y=f+p+g;y>0?(f=.5/Math.sqrt(y+1),this._w=.25/f,this._x=(v-z)*f,this._y=(k-t)*f,this._z=(m-e)*f):f>p&&f>g?(f=2*Math.sqrt(1+f-p-g),this._w=(v-z)/f,this._x=.25*f,this._y=(e+m)/f,this._z=(k+t)/f):p>g?(f=2*Math.sqrt(1+p-f-g),this._w=(k-t)/f,this._x=(e+m)/f,this._y=.25*f,this._z=(z+v)/f):(f=2*Math.sqrt(1+g-f-p),this._w=(m-e)/f,this._x=(k+t)/f,this._y=(z+v)/f,this._z=.25*f);this._onChangeCallback();
return this}setFromUnitVectors(e,g){let f=e.dot(g)+1;f<1E-8?(f=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*g.z-e.z*g.y,this._y=e.z*g.x-e.x*g.z,this._z=e.x*g.y-e.y*g.x);this._w=f;return this.normalize()}angleTo(e){return 2*Math.acos(Math.abs((0,x.clamp)(this.dot(e),-1,1)))}rotateTowards(e,g){const f=this.angleTo(e);if(f===0)return this;this.slerp(e,Math.min(1,g/f));return this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){this._x*=
-1;this._y*=-1;this._z*=-1;this._onChangeCallback();return this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();e===0?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e);this._onChangeCallback();return this}multiply(e){return this.multiplyQuaternions(this,
e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,g){const f=e._x,k=e._y,m=e._z;e=e._w;const p=g._x,z=g._y,t=g._z;g=g._w;this._x=f*g+e*p+k*t-m*z;this._y=k*g+e*z+m*p-f*t;this._z=m*g+e*t+f*z-k*p;this._w=e*g-f*p-k*z-m*t;this._onChangeCallback();return this}slerp(e,g){if(g===0)return this;if(g===1)return this.copy(e);const f=this._x,k=this._y,m=this._z,p=this._w;var z=p*e._w+f*e._x+k*e._y+m*e._z;z<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,z=-z):this.copy(e);
if(z>=1)return this._w=p,this._x=f,this._y=k,this._z=m,this;e=1-z*z;if(e<=Number.EPSILON)return z=1-g,this._w=z*p+g*this._w,this._x=z*f+g*this._x,this._y=z*k+g*this._y,this._z=z*m+g*this._z,this.normalize(),this;e=Math.sqrt(e);const t=Math.atan2(e,z);z=Math.sin((1-g)*t)/e;g=Math.sin(g*t)/e;this._w=p*z+this._w*g;this._x=f*z+this._x*g;this._y=k*z+this._y*g;this._z=m*z+this._z*g;this._onChangeCallback();return this}slerpQuaternions(e,g,f){return this.copy(e).slerp(g,f)}random(){const e=2*Math.PI*Math.random(),
g=2*Math.PI*Math.random();var f=Math.random();const k=Math.sqrt(1-f);f=Math.sqrt(f);return this.set(k*Math.sin(e),k*Math.cos(e),f*Math.sin(g),f*Math.cos(g))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,g=0){this._x=e[g];this._y=e[g+1];this._z=e[g+2];this._w=e[g+3];this._onChangeCallback();return this}toArray(e=[],g=0){e[g]=this._x;e[g+1]=this._y;e[g+2]=this._z;e[g+3]=this._w;return e}fromBufferAttribute(e,g){this._x=e.getX(g);this._y=e.getY(g);this._z=
e.getZ(g);this._w=e.getW(g);this._onChangeCallback();return this}toJSON(){return this.toArray()}_onChange(e){this._onChangeCallback=e;return this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x;yield this._y;yield this._z;yield this._w}}};
shadow$provide[517]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Vector3:{enumerable:!0,get:function(){return r}}});var x=l(514);l=l(516);class r{constructor(f=0,k=0,m=0){r.prototype.isVector3=!0;this.x=f;this.y=k;this.z=m}set(f,k,m){m===void 0&&(m=this.z);this.x=f;this.y=k;this.z=m;return this}setScalar(f){this.z=this.y=this.x=f;return this}setX(f){this.x=f;return this}setY(f){this.y=f;return this}setZ(f){this.z=f;return this}setComponent(f,k){switch(f){case 0:this.x=
k;break;case 1:this.y=k;break;case 2:this.z=k;break;default:throw Error("index is out of range: "+f);}return this}getComponent(f){switch(f){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+f);}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(f){this.x=f.x;this.y=f.y;this.z=f.z;return this}add(f){this.x+=f.x;this.y+=f.y;this.z+=f.z;return this}addScalar(f){this.x+=f;this.y+=f;this.z+=f;return this}addVectors(f,k){this.x=f.x+
k.x;this.y=f.y+k.y;this.z=f.z+k.z;return this}addScaledVector(f,k){this.x+=f.x*k;this.y+=f.y*k;this.z+=f.z*k;return this}sub(f){this.x-=f.x;this.y-=f.y;this.z-=f.z;return this}subScalar(f){this.x-=f;this.y-=f;this.z-=f;return this}subVectors(f,k){this.x=f.x-k.x;this.y=f.y-k.y;this.z=f.z-k.z;return this}multiply(f){this.x*=f.x;this.y*=f.y;this.z*=f.z;return this}multiplyScalar(f){this.x*=f;this.y*=f;this.z*=f;return this}multiplyVectors(f,k){this.x=f.x*k.x;this.y=f.y*k.y;this.z=f.z*k.z;return this}applyEuler(f){return this.applyQuaternion(g.setFromEuler(f))}applyAxisAngle(f,
k){return this.applyQuaternion(g.setFromAxisAngle(f,k))}applyMatrix3(f){const k=this.x,m=this.y,p=this.z;f=f.elements;this.x=f[0]*k+f[3]*m+f[6]*p;this.y=f[1]*k+f[4]*m+f[7]*p;this.z=f[2]*k+f[5]*m+f[8]*p;return this}applyNormalMatrix(f){return this.applyMatrix3(f).normalize()}applyMatrix4(f){const k=this.x,m=this.y,p=this.z;f=f.elements;const z=1/(f[3]*k+f[7]*m+f[11]*p+f[15]);this.x=(f[0]*k+f[4]*m+f[8]*p+f[12])*z;this.y=(f[1]*k+f[5]*m+f[9]*p+f[13])*z;this.z=(f[2]*k+f[6]*m+f[10]*p+f[14])*z;return this}applyQuaternion(f){const k=
this.x,m=this.y,p=this.z,z=f.x,t=f.y,v=f.z;f=f.w;const y=2*(t*p-v*m),B=2*(v*k-z*p),D=2*(z*m-t*k);this.x=k+f*y+t*D-v*B;this.y=m+f*B+v*y-z*D;this.z=p+f*D+z*B-t*y;return this}project(f){return this.applyMatrix4(f.matrixWorldInverse).applyMatrix4(f.projectionMatrix)}unproject(f){return this.applyMatrix4(f.projectionMatrixInverse).applyMatrix4(f.matrixWorld)}transformDirection(f){const k=this.x,m=this.y,p=this.z;f=f.elements;this.x=f[0]*k+f[4]*m+f[8]*p;this.y=f[1]*k+f[5]*m+f[9]*p;this.z=f[2]*k+f[6]*m+
f[10]*p;return this.normalize()}divide(f){this.x/=f.x;this.y/=f.y;this.z/=f.z;return this}divideScalar(f){return this.multiplyScalar(1/f)}min(f){this.x=Math.min(this.x,f.x);this.y=Math.min(this.y,f.y);this.z=Math.min(this.z,f.z);return this}max(f){this.x=Math.max(this.x,f.x);this.y=Math.max(this.y,f.y);this.z=Math.max(this.z,f.z);return this}clamp(f,k){this.x=(0,x.clamp)(this.x,f.x,k.x);this.y=(0,x.clamp)(this.y,f.y,k.y);this.z=(0,x.clamp)(this.z,f.z,k.z);return this}clampScalar(f,k){this.x=(0,x.clamp)(this.x,
f,k);this.y=(0,x.clamp)(this.y,f,k);this.z=(0,x.clamp)(this.z,f,k);return this}clampLength(f,k){const m=this.length();return this.divideScalar(m||1).multiplyScalar((0,x.clamp)(m,f,k))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this}roundToZero(){this.x=Math.trunc(this.x);
this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this}dot(f){return this.x*f.x+this.y*f.y+this.z*f.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(f){return this.normalize().multiplyScalar(f)}lerp(f,k){this.x+=
(f.x-this.x)*k;this.y+=(f.y-this.y)*k;this.z+=(f.z-this.z)*k;return this}lerpVectors(f,k,m){this.x=f.x+(k.x-f.x)*m;this.y=f.y+(k.y-f.y)*m;this.z=f.z+(k.z-f.z)*m;return this}cross(f){return this.crossVectors(this,f)}crossVectors(f,k){const m=f.x,p=f.y;f=f.z;const z=k.x,t=k.y;k=k.z;this.x=p*k-f*t;this.y=f*z-m*k;this.z=m*t-p*z;return this}projectOnVector(f){var k=f.lengthSq();if(k===0)return this.set(0,0,0);k=f.dot(this)/k;return this.copy(f).multiplyScalar(k)}projectOnPlane(f){e.copy(this).projectOnVector(f);
return this.sub(e)}reflect(f){return this.sub(e.copy(f).multiplyScalar(2*this.dot(f)))}angleTo(f){const k=Math.sqrt(this.lengthSq()*f.lengthSq());if(k===0)return Math.PI/2;f=this.dot(f)/k;return Math.acos((0,x.clamp)(f,-1,1))}distanceTo(f){return Math.sqrt(this.distanceToSquared(f))}distanceToSquared(f){const k=this.x-f.x,m=this.y-f.y;f=this.z-f.z;return k*k+m*m+f*f}manhattanDistanceTo(f){return Math.abs(this.x-f.x)+Math.abs(this.y-f.y)+Math.abs(this.z-f.z)}setFromSpherical(f){return this.setFromSphericalCoords(f.radius,
f.phi,f.theta)}setFromSphericalCoords(f,k,m){const p=Math.sin(k)*f;this.x=p*Math.sin(m);this.y=Math.cos(k)*f;this.z=p*Math.cos(m);return this}setFromCylindrical(f){return this.setFromCylindricalCoords(f.radius,f.theta,f.y)}setFromCylindricalCoords(f,k,m){this.x=f*Math.sin(k);this.y=m;this.z=f*Math.cos(k);return this}setFromMatrixPosition(f){f=f.elements;this.x=f[12];this.y=f[13];this.z=f[14];return this}setFromMatrixScale(f){const k=this.setFromMatrixColumn(f,0).length(),m=this.setFromMatrixColumn(f,
1).length();f=this.setFromMatrixColumn(f,2).length();this.x=k;this.y=m;this.z=f;return this}setFromMatrixColumn(f,k){return this.fromArray(f.elements,k*4)}setFromMatrix3Column(f,k){return this.fromArray(f.elements,k*3)}setFromEuler(f){this.x=f._x;this.y=f._y;this.z=f._z;return this}setFromColor(f){this.x=f.r;this.y=f.g;this.z=f.b;return this}equals(f){return f.x===this.x&&f.y===this.y&&f.z===this.z}fromArray(f,k=0){this.x=f[k];this.y=f[k+1];this.z=f[k+2];return this}toArray(f=[],k=0){f[k]=this.x;
f[k+1]=this.y;f[k+2]=this.z;return f}fromBufferAttribute(f,k){this.x=f.getX(k);this.y=f.getY(k);this.z=f.getZ(k);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();return this}randomDirection(){const f=Math.random()*Math.PI*2,k=Math.random()*2-1,m=Math.sqrt(1-k*k);this.x=m*Math.cos(f);this.y=k;this.z=m*Math.sin(f);return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z}}const e=new r,g=new l.Quaternion};
shadow$provide[518]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Vector4:{enumerable:!0,get:function(){return r}}});var x=l(514);class r{constructor(e=0,g=0,f=0,k=1){r.prototype.isVector4=!0;this.x=e;this.y=g;this.z=f;this.w=k}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,g,f,k){this.x=e;this.y=g;this.z=f;this.w=k;return this}setScalar(e){this.w=this.z=this.y=this.x=e;return this}setX(e){this.x=e;return this}setY(e){this.y=
e;return this}setZ(e){this.z=e;return this}setW(e){this.w=e;return this}setComponent(e,g){switch(e){case 0:this.x=g;break;case 1:this.y=g;break;case 2:this.z=g;break;case 3:this.w=g;break;default:throw Error("index is out of range: "+e);}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e);}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){this.x=e.x;this.y=
e.y;this.z=e.z;this.w=e.w!==void 0?e.w:1;return this}add(e){this.x+=e.x;this.y+=e.y;this.z+=e.z;this.w+=e.w;return this}addScalar(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this}addVectors(e,g){this.x=e.x+g.x;this.y=e.y+g.y;this.z=e.z+g.z;this.w=e.w+g.w;return this}addScaledVector(e,g){this.x+=e.x*g;this.y+=e.y*g;this.z+=e.z*g;this.w+=e.w*g;return this}sub(e){this.x-=e.x;this.y-=e.y;this.z-=e.z;this.w-=e.w;return this}subScalar(e){this.x-=e;this.y-=e;this.z-=e;this.w-=e;return this}subVectors(e,
g){this.x=e.x-g.x;this.y=e.y-g.y;this.z=e.z-g.z;this.w=e.w-g.w;return this}multiply(e){this.x*=e.x;this.y*=e.y;this.z*=e.z;this.w*=e.w;return this}multiplyScalar(e){this.x*=e;this.y*=e;this.z*=e;this.w*=e;return this}applyMatrix4(e){const g=this.x,f=this.y,k=this.z,m=this.w;e=e.elements;this.x=e[0]*g+e[4]*f+e[8]*k+e[12]*m;this.y=e[1]*g+e[5]*f+e[9]*k+e[13]*m;this.z=e[2]*g+e[6]*f+e[10]*k+e[14]*m;this.w=e[3]*g+e[7]*f+e[11]*k+e[15]*m;return this}divide(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;this.w/=e.w;
return this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const g=Math.sqrt(1-e.w*e.w);g<1E-4?(this.x=1,this.z=this.y=0):(this.x=e.x/g,this.y=e.y/g,this.z=e.z/g);return this}setAxisAngleFromRotationMatrix(e){e=e.elements;var g=e[0];var f=e[4];var k=e[8];const m=e[1];var p=e[5],z=e[9];var t=e[2];var v=e[6];var y=e[10];if(Math.abs(f-m)<.01&&Math.abs(k-t)<.01&&Math.abs(z-v)<.01){if(Math.abs(f+m)<.1&&Math.abs(k+t)<.1&&Math.abs(z+v)<.1&&Math.abs(g+
p+y-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;g=(g+1)/2;p=(p+1)/2;y=(y+1)/2;f=(f+m)/4;k=(k+t)/4;z=(z+v)/4;g>p&&g>y?g<.01?(v=0,f=t=.707106781):(v=Math.sqrt(g),t=f/v,f=k/v):p>y?p<.01?(v=.707106781,t=0,f=.707106781):(t=Math.sqrt(p),v=f/t,f=z/t):y<.01?(t=v=.707106781,f=0):(f=Math.sqrt(y),v=k/f,t=z/f);this.set(v,t,f,e);return this}e=Math.sqrt((v-z)*(v-z)+(k-t)*(k-t)+(m-f)*(m-f));Math.abs(e)<.001&&(e=1);this.x=(v-z)/e;this.y=(k-t)/e;this.z=(m-f)/e;this.w=Math.acos((g+p+y-1)/2);return this}setFromMatrixPosition(e){e=
e.elements;this.x=e[12];this.y=e[13];this.z=e[14];this.w=e[15];return this}min(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);this.w=Math.min(this.w,e.w);return this}max(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);this.w=Math.max(this.w,e.w);return this}clamp(e,g){this.x=(0,x.clamp)(this.x,e.x,g.x);this.y=(0,x.clamp)(this.y,e.y,g.y);this.z=(0,x.clamp)(this.z,e.z,g.z);this.w=(0,x.clamp)(this.w,e.w,g.w);return this}clampScalar(e,
g){this.x=(0,x.clamp)(this.x,e,g);this.y=(0,x.clamp)(this.y,e,g);this.z=(0,x.clamp)(this.z,e,g);this.w=(0,x.clamp)(this.w,e,g);return this}clampLength(e,g){const f=this.length();return this.divideScalar(f||1).multiplyScalar((0,x.clamp)(f,e,g))}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this}round(){this.x=
Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this}roundToZero(){this.x=Math.trunc(this.x);this.y=Math.trunc(this.y);this.z=Math.trunc(this.z);this.w=Math.trunc(this.w);return this}negate(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+
this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,g){this.x+=(e.x-this.x)*g;this.y+=(e.y-this.y)*g;this.z+=(e.z-this.z)*g;this.w+=(e.w-this.w)*g;return this}lerpVectors(e,g,f){this.x=e.x+(g.x-e.x)*f;this.y=e.y+(g.y-e.y)*f;this.z=e.z+(g.z-e.z)*f;this.w=e.w+(g.w-e.w)*f;return this}equals(e){return e.x===this.x&&e.y===
this.y&&e.z===this.z&&e.w===this.w}fromArray(e,g=0){this.x=e[g];this.y=e[g+1];this.z=e[g+2];this.w=e[g+3];return this}toArray(e=[],g=0){e[g]=this.x;e[g+1]=this.y;e[g+2]=this.z;e[g+3]=this.w;return e}fromBufferAttribute(e,g){this.x=e.getX(g);this.y=e.getY(g);this.z=e.getZ(g);this.w=e.getW(g);return this}random(){this.x=Math.random();this.y=Math.random();this.z=Math.random();this.w=Math.random();return this}*[Symbol.iterator](){yield this.x;yield this.y;yield this.z;yield this.w}}};
shadow$provide[519]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Matrix3:{enumerable:!0,get:function(){return x}}});class x{constructor(e,g,f,k,m,p,z,t,v){x.prototype.isMatrix3=!0;this.elements=[1,0,0,0,1,0,0,0,1];e!==void 0&&this.set(e,g,f,k,m,p,z,t,v)}set(e,g,f,k,m,p,z,t,v){const y=this.elements;y[0]=e;y[1]=k;y[2]=z;y[3]=g;y[4]=m;y[5]=t;y[6]=f;y[7]=p;y[8]=v;return this}identity(){this.set(1,0,0,0,1,0,0,0,1);return this}copy(e){const g=this.elements;e=e.elements;
g[0]=e[0];g[1]=e[1];g[2]=e[2];g[3]=e[3];g[4]=e[4];g[5]=e[5];g[6]=e[6];g[7]=e[7];g[8]=e[8];return this}extractBasis(e,g,f){e.setFromMatrix3Column(this,0);g.setFromMatrix3Column(this,1);f.setFromMatrix3Column(this,2);return this}setFromMatrix4(e){e=e.elements;this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]);return this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,g){var f=e.elements,k=g.elements;g=this.elements;e=f[0];
const m=f[3],p=f[6],z=f[1],t=f[4],v=f[7],y=f[2],B=f[5];f=f[8];const D=k[0],G=k[3],I=k[6],K=k[1],Q=k[4],O=k[7],J=k[2],W=k[5];k=k[8];g[0]=e*D+m*K+p*J;g[3]=e*G+m*Q+p*W;g[6]=e*I+m*O+p*k;g[1]=z*D+t*K+v*J;g[4]=z*G+t*Q+v*W;g[7]=z*I+t*O+v*k;g[2]=y*D+B*K+f*J;g[5]=y*G+B*Q+f*W;g[8]=y*I+B*O+f*k;return this}multiplyScalar(e){const g=this.elements;g[0]*=e;g[3]*=e;g[6]*=e;g[1]*=e;g[4]*=e;g[7]*=e;g[2]*=e;g[5]*=e;g[8]*=e;return this}determinant(){var e=this.elements;const g=e[0],f=e[1],k=e[2],m=e[3],p=e[4],z=e[5],
t=e[6],v=e[7];e=e[8];return g*p*e-g*z*v-f*m*e+f*z*t+k*m*v-k*p*t}invert(){const e=this.elements,g=e[0],f=e[1],k=e[2],m=e[3],p=e[4],z=e[5],t=e[6],v=e[7],y=e[8],B=y*p-z*v,D=z*t-y*m,G=v*m-p*t;var I=g*B+f*D+k*G;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);I=1/I;e[0]=B*I;e[1]=(k*v-y*f)*I;e[2]=(z*f-k*p)*I;e[3]=D*I;e[4]=(y*g-k*t)*I;e[5]=(k*m-z*g)*I;e[6]=G*I;e[7]=(f*t-v*g)*I;e[8]=(p*g-f*m)*I;return this}transpose(){let e;const g=this.elements;e=g[1];g[1]=g[3];g[3]=e;e=g[2];g[2]=g[6];g[6]=e;e=g[5];g[5]=g[7];
g[7]=e;return this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const g=this.elements;e[0]=g[0];e[1]=g[3];e[2]=g[6];e[3]=g[1];e[4]=g[4];e[5]=g[7];e[6]=g[2];e[7]=g[5];e[8]=g[8];return this}setUvTransform(e,g,f,k,m,p,z){const t=Math.cos(m);m=Math.sin(m);this.set(f*t,f*m,-f*(t*p+m*z)+p+e,-k*m,k*t,-k*(-m*p+t*z)+z+g,0,0,1);return this}scale(e,g){this.premultiply(r.makeScale(e,g));return this}rotate(e){this.premultiply(r.makeRotation(-e));return this}translate(e,
g){this.premultiply(r.makeTranslation(e,g));return this}makeTranslation(e,g){e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,g,0,0,1);return this}makeRotation(e){const g=Math.cos(e);e=Math.sin(e);this.set(g,-e,0,e,g,0,0,0,1);return this}makeScale(e,g){this.set(e,0,0,0,g,0,0,0,1);return this}equals(e){const g=this.elements;e=e.elements;for(let f=0;f<9;f++)if(g[f]!==e[f])return!1;return!0}fromArray(e,g=0){for(let f=0;f<9;f++)this.elements[f]=e[f+g];return this}toArray(e=[],g=0){const f=
this.elements;e[g]=f[0];e[g+1]=f[1];e[g+2]=f[2];e[g+3]=f[3];e[g+4]=f[4];e[g+5]=f[5];e[g+6]=f[6];e[g+7]=f[7];e[g+8]=f[8];return e}clone(){return(new this.constructor).fromArray(this.elements)}}const r=new x};
shadow$provide[520]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},ACESFilmicToneMapping:{enumerable:!0,get:function(){return 4}},AddEquation:{enumerable:!0,get:function(){return 100}},AddOperation:{enumerable:!0,get:function(){return 2}},AdditiveAnimationBlendMode:{enumerable:!0,get:function(){return 2501}},AdditiveBlending:{enumerable:!0,get:function(){return 2}},AgXToneMapping:{enumerable:!0,get:function(){return 6}},AlphaFormat:{enumerable:!0,get:function(){return 1021}},
AlwaysCompare:{enumerable:!0,get:function(){return 519}},AlwaysDepth:{enumerable:!0,get:function(){return 1}},AlwaysStencilFunc:{enumerable:!0,get:function(){return 519}},AttachedBindMode:{enumerable:!0,get:function(){return"attached"}},BackSide:{enumerable:!0,get:function(){return 1}},BasicDepthPacking:{enumerable:!0,get:function(){return 3200}},BasicShadowMap:{enumerable:!0,get:function(){return 0}},ByteType:{enumerable:!0,get:function(){return 1010}},CineonToneMapping:{enumerable:!0,get:function(){return 3}},
ClampToEdgeWrapping:{enumerable:!0,get:function(){return 1001}},ConstantAlphaFactor:{enumerable:!0,get:function(){return 213}},ConstantColorFactor:{enumerable:!0,get:function(){return 211}},CubeReflectionMapping:{enumerable:!0,get:function(){return 301}},CubeRefractionMapping:{enumerable:!0,get:function(){return 302}},CubeUVReflectionMapping:{enumerable:!0,get:function(){return 306}},CullFaceBack:{enumerable:!0,get:function(){return 1}},CullFaceFront:{enumerable:!0,get:function(){return 2}},CullFaceFrontBack:{enumerable:!0,
get:function(){return 3}},CullFaceNone:{enumerable:!0,get:function(){return 0}},CustomBlending:{enumerable:!0,get:function(){return 5}},CustomToneMapping:{enumerable:!0,get:function(){return 5}},DecrementStencilOp:{enumerable:!0,get:function(){return 7683}},DecrementWrapStencilOp:{enumerable:!0,get:function(){return 34056}},DepthFormat:{enumerable:!0,get:function(){return 1026}},DepthStencilFormat:{enumerable:!0,get:function(){return 1027}},DetachedBindMode:{enumerable:!0,get:function(){return"detached"}},
DoubleSide:{enumerable:!0,get:function(){return 2}},DstAlphaFactor:{enumerable:!0,get:function(){return 206}},DstColorFactor:{enumerable:!0,get:function(){return 208}},DynamicCopyUsage:{enumerable:!0,get:function(){return 35050}},DynamicDrawUsage:{enumerable:!0,get:function(){return 35048}},DynamicReadUsage:{enumerable:!0,get:function(){return 35049}},EqualCompare:{enumerable:!0,get:function(){return 514}},EqualDepth:{enumerable:!0,get:function(){return 4}},EqualStencilFunc:{enumerable:!0,get:function(){return 514}},
EquirectangularReflectionMapping:{enumerable:!0,get:function(){return 303}},EquirectangularRefractionMapping:{enumerable:!0,get:function(){return 304}},FloatType:{enumerable:!0,get:function(){return 1015}},FrontSide:{enumerable:!0,get:function(){return 0}},GLSL1:{enumerable:!0,get:function(){return"100"}},GLSL3:{enumerable:!0,get:function(){return"300 es"}},GreaterCompare:{enumerable:!0,get:function(){return 516}},GreaterDepth:{enumerable:!0,get:function(){return 6}},GreaterEqualCompare:{enumerable:!0,
get:function(){return 518}},GreaterEqualDepth:{enumerable:!0,get:function(){return 5}},GreaterEqualStencilFunc:{enumerable:!0,get:function(){return 518}},GreaterStencilFunc:{enumerable:!0,get:function(){return 516}},HalfFloatType:{enumerable:!0,get:function(){return 1016}},IncrementStencilOp:{enumerable:!0,get:function(){return 7682}},IncrementWrapStencilOp:{enumerable:!0,get:function(){return 34055}},IntType:{enumerable:!0,get:function(){return 1013}},InterpolateDiscrete:{enumerable:!0,get:function(){return 2300}},
InterpolateLinear:{enumerable:!0,get:function(){return 2301}},InterpolateSmooth:{enumerable:!0,get:function(){return 2302}},InterpolationSamplingMode:{enumerable:!0,get:function(){return f}},InterpolationSamplingType:{enumerable:!0,get:function(){return g}},InvertStencilOp:{enumerable:!0,get:function(){return 5386}},KeepStencilOp:{enumerable:!0,get:function(){return 7680}},LessCompare:{enumerable:!0,get:function(){return 513}},LessDepth:{enumerable:!0,get:function(){return 2}},LessEqualCompare:{enumerable:!0,
get:function(){return 515}},LessEqualDepth:{enumerable:!0,get:function(){return 3}},LessEqualStencilFunc:{enumerable:!0,get:function(){return 515}},LessStencilFunc:{enumerable:!0,get:function(){return 513}},LinearFilter:{enumerable:!0,get:function(){return 1006}},LinearMipMapLinearFilter:{enumerable:!0,get:function(){return 1008}},LinearMipMapNearestFilter:{enumerable:!0,get:function(){return 1007}},LinearMipmapLinearFilter:{enumerable:!0,get:function(){return 1008}},LinearMipmapNearestFilter:{enumerable:!0,
get:function(){return 1007}},LinearSRGBColorSpace:{enumerable:!0,get:function(){return"srgb-linear"}},LinearToneMapping:{enumerable:!0,get:function(){return 1}},LinearTransfer:{enumerable:!0,get:function(){return"linear"}},LoopOnce:{enumerable:!0,get:function(){return 2200}},LoopPingPong:{enumerable:!0,get:function(){return 2202}},LoopRepeat:{enumerable:!0,get:function(){return 2201}},MOUSE:{enumerable:!0,get:function(){return x}},MaxEquation:{enumerable:!0,get:function(){return 104}},MinEquation:{enumerable:!0,
get:function(){return 103}},MirroredRepeatWrapping:{enumerable:!0,get:function(){return 1002}},MixOperation:{enumerable:!0,get:function(){return 1}},MultiplyBlending:{enumerable:!0,get:function(){return 4}},MultiplyOperation:{enumerable:!0,get:function(){return 0}},NearestFilter:{enumerable:!0,get:function(){return 1003}},NearestMipMapLinearFilter:{enumerable:!0,get:function(){return 1005}},NearestMipMapNearestFilter:{enumerable:!0,get:function(){return 1004}},NearestMipmapLinearFilter:{enumerable:!0,
get:function(){return 1005}},NearestMipmapNearestFilter:{enumerable:!0,get:function(){return 1004}},NeutralToneMapping:{enumerable:!0,get:function(){return 7}},NeverCompare:{enumerable:!0,get:function(){return 512}},NeverDepth:{enumerable:!0,get:function(){return 0}},NeverStencilFunc:{enumerable:!0,get:function(){return 512}},NoBlending:{enumerable:!0,get:function(){return 0}},NoColorSpace:{enumerable:!0,get:function(){return""}},NoToneMapping:{enumerable:!0,get:function(){return 0}},NormalAnimationBlendMode:{enumerable:!0,
get:function(){return 2500}},NormalBlending:{enumerable:!0,get:function(){return 1}},NotEqualCompare:{enumerable:!0,get:function(){return 517}},NotEqualDepth:{enumerable:!0,get:function(){return 7}},NotEqualStencilFunc:{enumerable:!0,get:function(){return 517}},ObjectSpaceNormalMap:{enumerable:!0,get:function(){return 1}},OneFactor:{enumerable:!0,get:function(){return 201}},OneMinusConstantAlphaFactor:{enumerable:!0,get:function(){return 214}},OneMinusConstantColorFactor:{enumerable:!0,get:function(){return 212}},
OneMinusDstAlphaFactor:{enumerable:!0,get:function(){return 207}},OneMinusDstColorFactor:{enumerable:!0,get:function(){return 209}},OneMinusSrcAlphaFactor:{enumerable:!0,get:function(){return 205}},OneMinusSrcColorFactor:{enumerable:!0,get:function(){return 203}},PCFShadowMap:{enumerable:!0,get:function(){return 1}},PCFSoftShadowMap:{enumerable:!0,get:function(){return 2}},RED_GREEN_RGTC2_Format:{enumerable:!0,get:function(){return 36285}},RED_RGTC1_Format:{enumerable:!0,get:function(){return 36283}},
REVISION:{enumerable:!0,get:function(){return"180"}},RGBADepthPacking:{enumerable:!0,get:function(){return 3201}},RGBAFormat:{enumerable:!0,get:function(){return 1023}},RGBAIntegerFormat:{enumerable:!0,get:function(){return 1033}},RGBA_ASTC_10x10_Format:{enumerable:!0,get:function(){return 37819}},RGBA_ASTC_10x5_Format:{enumerable:!0,get:function(){return 37816}},RGBA_ASTC_10x6_Format:{enumerable:!0,get:function(){return 37817}},RGBA_ASTC_10x8_Format:{enumerable:!0,get:function(){return 37818}},RGBA_ASTC_12x10_Format:{enumerable:!0,
get:function(){return 37820}},RGBA_ASTC_12x12_Format:{enumerable:!0,get:function(){return 37821}},RGBA_ASTC_4x4_Format:{enumerable:!0,get:function(){return 37808}},RGBA_ASTC_5x4_Format:{enumerable:!0,get:function(){return 37809}},RGBA_ASTC_5x5_Format:{enumerable:!0,get:function(){return 37810}},RGBA_ASTC_6x5_Format:{enumerable:!0,get:function(){return 37811}},RGBA_ASTC_6x6_Format:{enumerable:!0,get:function(){return 37812}},RGBA_ASTC_8x5_Format:{enumerable:!0,get:function(){return 37813}},RGBA_ASTC_8x6_Format:{enumerable:!0,
get:function(){return 37814}},RGBA_ASTC_8x8_Format:{enumerable:!0,get:function(){return 37815}},RGBA_BPTC_Format:{enumerable:!0,get:function(){return 36492}},RGBA_ETC2_EAC_Format:{enumerable:!0,get:function(){return 37496}},RGBA_PVRTC_2BPPV1_Format:{enumerable:!0,get:function(){return 35843}},RGBA_PVRTC_4BPPV1_Format:{enumerable:!0,get:function(){return 35842}},RGBA_S3TC_DXT1_Format:{enumerable:!0,get:function(){return 33777}},RGBA_S3TC_DXT3_Format:{enumerable:!0,get:function(){return 33778}},RGBA_S3TC_DXT5_Format:{enumerable:!0,
get:function(){return 33779}},RGBDepthPacking:{enumerable:!0,get:function(){return 3202}},RGBFormat:{enumerable:!0,get:function(){return 1022}},RGBIntegerFormat:{enumerable:!0,get:function(){return 1032}},RGB_BPTC_SIGNED_Format:{enumerable:!0,get:function(){return 36494}},RGB_BPTC_UNSIGNED_Format:{enumerable:!0,get:function(){return 36495}},RGB_ETC1_Format:{enumerable:!0,get:function(){return 36196}},RGB_ETC2_Format:{enumerable:!0,get:function(){return 37492}},RGB_PVRTC_2BPPV1_Format:{enumerable:!0,
get:function(){return 35841}},RGB_PVRTC_4BPPV1_Format:{enumerable:!0,get:function(){return 35840}},RGB_S3TC_DXT1_Format:{enumerable:!0,get:function(){return 33776}},RGDepthPacking:{enumerable:!0,get:function(){return 3203}},RGFormat:{enumerable:!0,get:function(){return 1030}},RGIntegerFormat:{enumerable:!0,get:function(){return 1031}},RedFormat:{enumerable:!0,get:function(){return 1028}},RedIntegerFormat:{enumerable:!0,get:function(){return 1029}},ReinhardToneMapping:{enumerable:!0,get:function(){return 2}},
RepeatWrapping:{enumerable:!0,get:function(){return 1E3}},ReplaceStencilOp:{enumerable:!0,get:function(){return 7681}},ReverseSubtractEquation:{enumerable:!0,get:function(){return 102}},SIGNED_RED_GREEN_RGTC2_Format:{enumerable:!0,get:function(){return 36286}},SIGNED_RED_RGTC1_Format:{enumerable:!0,get:function(){return 36284}},SRGBColorSpace:{enumerable:!0,get:function(){return"srgb"}},SRGBTransfer:{enumerable:!0,get:function(){return"srgb"}},ShortType:{enumerable:!0,get:function(){return 1011}},
SrcAlphaFactor:{enumerable:!0,get:function(){return 204}},SrcAlphaSaturateFactor:{enumerable:!0,get:function(){return 210}},SrcColorFactor:{enumerable:!0,get:function(){return 202}},StaticCopyUsage:{enumerable:!0,get:function(){return 35046}},StaticDrawUsage:{enumerable:!0,get:function(){return 35044}},StaticReadUsage:{enumerable:!0,get:function(){return 35045}},StreamCopyUsage:{enumerable:!0,get:function(){return 35042}},StreamDrawUsage:{enumerable:!0,get:function(){return 35040}},StreamReadUsage:{enumerable:!0,
get:function(){return 35041}},SubtractEquation:{enumerable:!0,get:function(){return 101}},SubtractiveBlending:{enumerable:!0,get:function(){return 3}},TOUCH:{enumerable:!0,get:function(){return r}},TangentSpaceNormalMap:{enumerable:!0,get:function(){return 0}},TimestampQuery:{enumerable:!0,get:function(){return e}},TriangleFanDrawMode:{enumerable:!0,get:function(){return 2}},TriangleStripDrawMode:{enumerable:!0,get:function(){return 1}},TrianglesDrawMode:{enumerable:!0,get:function(){return 0}},UVMapping:{enumerable:!0,
get:function(){return 300}},UnsignedByteType:{enumerable:!0,get:function(){return 1009}},UnsignedInt101111Type:{enumerable:!0,get:function(){return 35899}},UnsignedInt248Type:{enumerable:!0,get:function(){return 1020}},UnsignedInt5999Type:{enumerable:!0,get:function(){return 35902}},UnsignedIntType:{enumerable:!0,get:function(){return 1014}},UnsignedShort4444Type:{enumerable:!0,get:function(){return 1017}},UnsignedShort5551Type:{enumerable:!0,get:function(){return 1018}},UnsignedShortType:{enumerable:!0,
get:function(){return 1012}},VSMShadowMap:{enumerable:!0,get:function(){return 3}},WebGLCoordinateSystem:{enumerable:!0,get:function(){return 2E3}},WebGPUCoordinateSystem:{enumerable:!0,get:function(){return 2001}},WrapAroundEnding:{enumerable:!0,get:function(){return 2402}},ZeroCurvatureEnding:{enumerable:!0,get:function(){return 2400}},ZeroFactor:{enumerable:!0,get:function(){return 200}},ZeroSlopeEnding:{enumerable:!0,get:function(){return 2401}},ZeroStencilOp:{enumerable:!0,get:function(){return 0}}});
const x={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},r={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},e={COMPUTE:"compute",RENDER:"render"},g={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},f={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"}};
shadow$provide[521]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Matrix4:{enumerable:!0,get:function(){return r}}});var x=l(520);l=l(517);class r{constructor(t,v,y,B,D,G,I,K,Q,O,J,W,ba,Y,S,ca){r.prototype.isMatrix4=!0;this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t!==void 0&&this.set(t,v,y,B,D,G,I,K,Q,O,J,W,ba,Y,S,ca)}set(t,v,y,B,D,G,I,K,Q,O,J,W,ba,Y,S,ca){const V=this.elements;V[0]=t;V[4]=v;V[8]=y;V[12]=B;V[1]=D;V[5]=G;V[9]=I;V[13]=K;V[2]=Q;V[6]=O;V[10]=J;V[14]=
W;V[3]=ba;V[7]=Y;V[11]=S;V[15]=ca;return this}identity(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this}clone(){return(new r).fromArray(this.elements)}copy(t){const v=this.elements;t=t.elements;v[0]=t[0];v[1]=t[1];v[2]=t[2];v[3]=t[3];v[4]=t[4];v[5]=t[5];v[6]=t[6];v[7]=t[7];v[8]=t[8];v[9]=t[9];v[10]=t[10];v[11]=t[11];v[12]=t[12];v[13]=t[13];v[14]=t[14];v[15]=t[15];return this}copyPosition(t){const v=this.elements;t=t.elements;v[12]=t[12];v[13]=t[13];v[14]=t[14];return this}setFromMatrix3(t){t=
t.elements;this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1);return this}extractBasis(t,v,y){t.setFromMatrixColumn(this,0);v.setFromMatrixColumn(this,1);y.setFromMatrixColumn(this,2);return this}makeBasis(t,v,y){this.set(t.x,v.x,y.x,0,t.y,v.y,y.y,0,t.z,v.z,y.z,0,0,0,0,1);return this}extractRotation(t){const v=this.elements,y=t.elements,B=1/e.setFromMatrixColumn(t,0).length(),D=1/e.setFromMatrixColumn(t,1).length();t=1/e.setFromMatrixColumn(t,2).length();v[0]=y[0]*B;v[1]=y[1]*B;
v[2]=y[2]*B;v[3]=0;v[4]=y[4]*D;v[5]=y[5]*D;v[6]=y[6]*D;v[7]=0;v[8]=y[8]*t;v[9]=y[9]*t;v[10]=y[10]*t;v[11]=0;v[12]=0;v[13]=0;v[14]=0;v[15]=1;return this}makeRotationFromEuler(t){const v=this.elements;var y=t.x,B=t.y,D=t.z;const G=Math.cos(y);y=Math.sin(y);const I=Math.cos(B);B=Math.sin(B);const K=Math.cos(D);D=Math.sin(D);if(t.order==="XYZ"){t=G*K;var Q=G*D,O=y*K,J=y*D;v[0]=I*K;v[4]=-I*D;v[8]=B;v[1]=Q+O*B;v[5]=t-J*B;v[9]=-y*I;v[2]=J-t*B;v[6]=O+Q*B;v[10]=G*I}else t.order==="YXZ"?(t=I*K,Q=I*D,O=B*K,
J=B*D,v[0]=t+J*y,v[4]=O*y-Q,v[8]=G*B,v[1]=G*D,v[5]=G*K,v[9]=-y,v[2]=Q*y-O,v[6]=J+t*y,v[10]=G*I):t.order==="ZXY"?(t=I*K,Q=I*D,O=B*K,J=B*D,v[0]=t-J*y,v[4]=-G*D,v[8]=O+Q*y,v[1]=Q+O*y,v[5]=G*K,v[9]=J-t*y,v[2]=-G*B,v[6]=y,v[10]=G*I):t.order==="ZYX"?(t=G*K,Q=G*D,O=y*K,J=y*D,v[0]=I*K,v[4]=O*B-Q,v[8]=t*B+J,v[1]=I*D,v[5]=J*B+t,v[9]=Q*B-O,v[2]=-B,v[6]=y*I,v[10]=G*I):t.order==="YZX"?(t=G*I,Q=G*B,O=y*I,J=y*B,v[0]=I*K,v[4]=J-t*D,v[8]=O*D+Q,v[1]=D,v[5]=G*K,v[9]=-y*K,v[2]=-B*K,v[6]=Q*D+O,v[10]=t-J*D):t.order===
"XZY"&&(t=G*I,Q=G*B,O=y*I,J=y*B,v[0]=I*K,v[4]=-D,v[8]=B*K,v[1]=t*D+J,v[5]=G*K,v[9]=Q*D-O,v[2]=O*D-Q,v[6]=y*K,v[10]=J*D+t);v[3]=0;v[7]=0;v[11]=0;v[12]=0;v[13]=0;v[14]=0;v[15]=1;return this}makeRotationFromQuaternion(t){return this.compose(f,t,k)}lookAt(t,v,y){const B=this.elements;z.subVectors(t,v);z.lengthSq()===0&&(z.z=1);z.normalize();m.crossVectors(y,z);m.lengthSq()===0&&(Math.abs(y.z)===1?z.x+=1E-4:z.z+=1E-4,z.normalize(),m.crossVectors(y,z));m.normalize();p.crossVectors(z,m);B[0]=m.x;B[4]=p.x;
B[8]=z.x;B[1]=m.y;B[5]=p.y;B[9]=z.y;B[2]=m.z;B[6]=p.z;B[10]=z.z;return this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,v){var y=t.elements,B=v.elements;v=this.elements;t=y[0];const D=y[4],G=y[8],I=y[12],K=y[1],Q=y[5],O=y[9],J=y[13],W=y[2],ba=y[6],Y=y[10],S=y[14],ca=y[3],V=y[7],xa=y[11];y=y[15];const na=B[0],N=B[4],pa=B[8],ra=B[12],Ea=B[1],Ua=B[5],jb=B[9],eb=B[13],rc=B[2],xb=B[6],Bb=B[10],bc=B[14],qb=B[3],cc=B[7],Db=B[11];
B=B[15];v[0]=t*na+D*Ea+G*rc+I*qb;v[4]=t*N+D*Ua+G*xb+I*cc;v[8]=t*pa+D*jb+G*Bb+I*Db;v[12]=t*ra+D*eb+G*bc+I*B;v[1]=K*na+Q*Ea+O*rc+J*qb;v[5]=K*N+Q*Ua+O*xb+J*cc;v[9]=K*pa+Q*jb+O*Bb+J*Db;v[13]=K*ra+Q*eb+O*bc+J*B;v[2]=W*na+ba*Ea+Y*rc+S*qb;v[6]=W*N+ba*Ua+Y*xb+S*cc;v[10]=W*pa+ba*jb+Y*Bb+S*Db;v[14]=W*ra+ba*eb+Y*bc+S*B;v[3]=ca*na+V*Ea+xa*rc+y*qb;v[7]=ca*N+V*Ua+xa*xb+y*cc;v[11]=ca*pa+V*jb+xa*Bb+y*Db;v[15]=ca*ra+V*eb+xa*bc+y*B;return this}multiplyScalar(t){const v=this.elements;v[0]*=t;v[4]*=t;v[8]*=t;v[12]*=
t;v[1]*=t;v[5]*=t;v[9]*=t;v[13]*=t;v[2]*=t;v[6]*=t;v[10]*=t;v[14]*=t;v[3]*=t;v[7]*=t;v[11]*=t;v[15]*=t;return this}determinant(){const t=this.elements,v=t[0],y=t[4],B=t[8],D=t[12],G=t[1],I=t[5],K=t[9],Q=t[13],O=t[2],J=t[6],W=t[10],ba=t[14];return t[3]*(+D*K*J-B*Q*J-D*I*W+y*Q*W+B*I*ba-y*K*ba)+t[7]*(+v*K*ba-v*Q*W+D*G*W-B*G*ba+B*Q*O-D*K*O)+t[11]*(+v*Q*J-v*I*ba-D*G*J+y*G*ba+D*I*O-y*Q*O)+t[15]*(-B*I*O-v*K*J+v*I*W+B*G*J-y*G*W+y*K*O)}transpose(){const t=this.elements;let v;v=t[1];t[1]=t[4];t[4]=v;v=t[2];
t[2]=t[8];t[8]=v;v=t[6];t[6]=t[9];t[9]=v;v=t[3];t[3]=t[12];t[12]=v;v=t[7];t[7]=t[13];t[13]=v;v=t[11];t[11]=t[14];t[14]=v;return this}setPosition(t,v,y){const B=this.elements;t.isVector3?(B[12]=t.x,B[13]=t.y,B[14]=t.z):(B[12]=t,B[13]=v,B[14]=y);return this}invert(){const t=this.elements,v=t[0],y=t[1],B=t[2],D=t[3],G=t[4],I=t[5],K=t[6],Q=t[7],O=t[8],J=t[9],W=t[10],ba=t[11],Y=t[12],S=t[13],ca=t[14],V=t[15],xa=J*ca*Q-S*W*Q+S*K*ba-I*ca*ba-J*K*V+I*W*V,na=Y*W*Q-O*ca*Q-Y*K*ba+G*ca*ba+O*K*V-G*W*V,N=O*S*Q-
Y*J*Q+Y*I*ba-G*S*ba-O*I*V+G*J*V,pa=Y*J*K-O*S*K-Y*I*W+G*S*W+O*I*ca-G*J*ca;var ra=v*xa+y*na+B*N+D*pa;if(ra===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);ra=1/ra;t[0]=xa*ra;t[1]=(S*W*D-J*ca*D-S*B*ba+y*ca*ba+J*B*V-y*W*V)*ra;t[2]=(I*ca*D-S*K*D+S*B*Q-y*ca*Q-I*B*V+y*K*V)*ra;t[3]=(J*K*D-I*W*D-J*B*Q+y*W*Q+I*B*ba-y*K*ba)*ra;t[4]=na*ra;t[5]=(O*ca*D-Y*W*D+Y*B*ba-v*ca*ba-O*B*V+v*W*V)*ra;t[6]=(Y*K*D-G*ca*D-Y*B*Q+v*ca*Q+G*B*V-v*K*V)*ra;t[7]=(G*W*D-O*K*D+O*B*Q-v*W*Q-G*B*ba+v*K*ba)*ra;t[8]=N*ra;t[9]=(Y*J*D-
O*S*D-Y*y*ba+v*S*ba+O*y*V-v*J*V)*ra;t[10]=(G*S*D-Y*I*D+Y*y*Q-v*S*Q-G*y*V+v*I*V)*ra;t[11]=(O*I*D-G*J*D-O*y*Q+v*J*Q+G*y*ba-v*I*ba)*ra;t[12]=pa*ra;t[13]=(O*S*B-Y*J*B+Y*y*W-v*S*W-O*y*ca+v*J*ca)*ra;t[14]=(Y*I*B-G*S*B-Y*y*K+v*S*K+G*y*ca-v*I*ca)*ra;t[15]=(G*J*B-O*I*B+O*y*K-v*J*K-G*y*W+v*I*W)*ra;return this}scale(t){const v=this.elements,y=t.x,B=t.y;t=t.z;v[0]*=y;v[4]*=B;v[8]*=t;v[1]*=y;v[5]*=B;v[9]*=t;v[2]*=y;v[6]*=B;v[10]*=t;v[3]*=y;v[7]*=B;v[11]*=t;return this}getMaxScaleOnAxis(){const t=this.elements;
return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))}makeTranslation(t,v,y){t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,v,0,0,1,y,0,0,0,1);return this}makeRotationX(t){const v=Math.cos(t);t=Math.sin(t);this.set(1,0,0,0,0,v,-t,0,0,t,v,0,0,0,0,1);return this}makeRotationY(t){const v=Math.cos(t);t=Math.sin(t);this.set(v,0,t,0,0,1,0,0,-t,0,v,0,0,0,0,1);return this}makeRotationZ(t){const v=Math.cos(t);
t=Math.sin(t);this.set(v,-t,0,0,t,v,0,0,0,0,1,0,0,0,0,1);return this}makeRotationAxis(t,v){const y=Math.cos(v);v=Math.sin(v);const B=1-y,D=t.x,G=t.y;t=t.z;const I=B*D,K=B*G;this.set(I*D+y,I*G-v*t,I*t+v*G,0,I*G+v*t,K*G+y,K*t-v*D,0,I*t-v*G,K*t+v*D,B*t*t+y,0,0,0,0,1);return this}makeScale(t,v,y){this.set(t,0,0,0,0,v,0,0,0,0,y,0,0,0,0,1);return this}makeShear(t,v,y,B,D,G){this.set(1,y,D,0,t,1,G,0,v,B,1,0,0,0,0,1);return this}compose(t,v,y){const B=this.elements;var D=v._x,G=v._y,I=v._z,K=v._w,Q=D+D,O=
G+G,J=I+I;v=D*Q;const W=D*O;D*=J;const ba=G*O;G*=J;I*=J;Q*=K;O*=K;K*=J;J=y.x;const Y=y.y;y=y.z;B[0]=(1-(ba+I))*J;B[1]=(W+K)*J;B[2]=(D-O)*J;B[3]=0;B[4]=(W-K)*Y;B[5]=(1-(v+I))*Y;B[6]=(G+Q)*Y;B[7]=0;B[8]=(D+O)*y;B[9]=(G-Q)*y;B[10]=(1-(v+ba))*y;B[11]=0;B[12]=t.x;B[13]=t.y;B[14]=t.z;B[15]=1;return this}decompose(t,v,y){var B=this.elements;let D=e.set(B[0],B[1],B[2]).length();const G=e.set(B[4],B[5],B[6]).length(),I=e.set(B[8],B[9],B[10]).length();this.determinant()<0&&(D=-D);t.x=B[12];t.y=B[13];t.z=B[14];
g.copy(this);t=1/D;B=1/G;const K=1/I;g.elements[0]*=t;g.elements[1]*=t;g.elements[2]*=t;g.elements[4]*=B;g.elements[5]*=B;g.elements[6]*=B;g.elements[8]*=K;g.elements[9]*=K;g.elements[10]*=K;v.setFromRotationMatrix(g);y.x=D;y.y=G;y.z=I;return this}makePerspective(t,v,y,B,D,G,I=x.WebGLCoordinateSystem,K=!1){const Q=this.elements;if(K)I=D/(G-D),G=G*D/(G-D);else if(I===x.WebGLCoordinateSystem)I=-(G+D)/(G-D),G=-2*G*D/(G-D);else if(I===x.WebGPUCoordinateSystem)I=-G/(G-D),G=-G*D/(G-D);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+
I);Q[0]=2*D/(v-t);Q[4]=0;Q[8]=(v+t)/(v-t);Q[12]=0;Q[1]=0;Q[5]=2*D/(y-B);Q[9]=(y+B)/(y-B);Q[13]=0;Q[2]=0;Q[6]=0;Q[10]=I;Q[14]=G;Q[3]=0;Q[7]=0;Q[11]=-1;Q[15]=0;return this}makeOrthographic(t,v,y,B,D,G,I=x.WebGLCoordinateSystem,K=!1){const Q=this.elements;if(K)I=1/(G-D),D=G/(G-D);else if(I===x.WebGLCoordinateSystem)I=-2/(G-D),D=-(G+D)/(G-D);else if(I===x.WebGPUCoordinateSystem)I=-1/(G-D),D=-D/(G-D);else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+I);Q[0]=2/(v-t);Q[4]=
0;Q[8]=0;Q[12]=-(v+t)/(v-t);Q[1]=0;Q[5]=2/(y-B);Q[9]=0;Q[13]=-(y+B)/(y-B);Q[2]=0;Q[6]=0;Q[10]=I;Q[14]=D;Q[3]=0;Q[7]=0;Q[11]=0;Q[15]=1;return this}equals(t){const v=this.elements;t=t.elements;for(let y=0;y<16;y++)if(v[y]!==t[y])return!1;return!0}fromArray(t,v=0){for(let y=0;y<16;y++)this.elements[y]=t[y+v];return this}toArray(t=[],v=0){const y=this.elements;t[v]=y[0];t[v+1]=y[1];t[v+2]=y[2];t[v+3]=y[3];t[v+4]=y[4];t[v+5]=y[5];t[v+6]=y[6];t[v+7]=y[7];t[v+8]=y[8];t[v+9]=y[9];t[v+10]=y[10];t[v+11]=y[11];
t[v+12]=y[12];t[v+13]=y[13];t[v+14]=y[14];t[v+15]=y[15];return t}}const e=new l.Vector3,g=new r,f=new l.Vector3(0,0,0),k=new l.Vector3(1,1,1),m=new l.Vector3,p=new l.Vector3,z=new l.Vector3};
shadow$provide[522]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},decl:{enumerable:!0,get:function(){return e}}});L=l(515);q=l(517);var x=l(518),r=l(519);l=l(521);const e={in:0,out:1,inout:2,node:function(p){if((p.children[5]!=null?p.children[5].type:void 0)==="function")return e.function(p);if((p.token!=null?p.token.type:void 0)==="keyword")return e.external(p)},external:function(p){p=p.children;let z=p[1].token.data;const t=p[4].token.data,v=p[5];["attribute","uniform",
"varying"].includes(z)||(z="global");const y=[];for(let D=0;D<v.children.length;D++)if(p=v.children[D],p.type==="ident"){var B=v.children[D+1];B=(B!=null?B.type:void 0)==="quantifier";y.push({decl:"external",storage:z,type:t,ident:p.token.data,quant:!!B,count:B})}return y},function:function(p){var z=p.children;p=z[1].token.data;const t=z[4].token.data;var v=z[5];z=v.children[0].token.data;const y=v.children[2];v=Array.from(v.children[1].children).map(B=>e.argument(B));return[{decl:"function",storage:p,
type:t,ident:z,body:!!y,args:v}]},argument:function(p){p=p.children;const z=p[5],t=z.children[1];return{decl:"argument",storage:p[1].token.data,inout:p[2].token.data,type:p[4].token.data,ident:z.children[0].token.data,quant:!!t,count:t?t.children[0].token.data:void 0}},param:function(p,z,t,v,y){let B=[];z!=null&&B.push(z);t!=null&&B.push(t);B.push("");B=B.join(" ");const D=v?"["+y+"]":"";p!==""&&(p+=" ");const G=(I,K)=>(K?p:"")+`${B}${I}${D}`;G.split=I=>e.param(I,z,t,v,y);return G}},g=typeof window!==
"undefined"&&!!window.THREE,f={int:0,float:0,vec2:g?L.Vector2:null,vec3:g?q.Vector3:null,vec4:g?x.Vector4:null,mat2:null,mat3:g?r.Matrix3:null,mat4:g?l.Matrix4:null,sampler2D:0,samplerCube:0},k={int:"i",float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat2:"m2",mat3:"m3",mat4:"m4",sampler2D:"t",samplerCube:"t"};e.type=function(p,z,t,v,y,B){var D={in:e.in,out:e.out,inout:e.inout};let G=k[z];t&&(G+="v");let I=f[z];I!=null&&I.call&&(I=new I);t&&(I=[I]);D=D[y]!=null?D[y]:D.in;B={const:"const"}[B];t=e.param(y,
B,z,t,v);return new m(p,G,z,t,I,D)};class m{constructor(p,z,t,v,y,B,D){this.name=p;this.type=z;this.spec=t;this.param=v;this.value=y;this.inout=B;this.meta=D}split(){var p=this.meta.shadowed!=null;const z=p?e.in:e.out;p=this.param.split(p?"in":"out");return new m(this.name,this.type,this.spec,p,this.value,z)}copy(p,z){return new m(p!=null?p:this.name,this.type,this.spec,this.param,this.value,this.inout,z)}}};
shadow$provide[523]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},RETURN_ARG:{enumerable:!0,get:function(){return"return"}},SHADOW_ARG:{enumerable:!0,get:function(){return"_i_o"}}})};
shadow$provide[524]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},parse:{enumerable:!0,get:function(){return k}},walk:{enumerable:!0,get:function(){return y}}});L=l(509);q=l(513);var x=l(522),r=l(523),e=l.esmDefault(q),g=l.esmDefault(L);let f=!1;const k=function(D,G){D=m(D,G);let I;f&&(I=B());var K=[];y(p,z(K),D,"");const [Q,O,J]=Array.from(t(K));K=v(Q,O,J);f&&I("GLSL AST");return{ast:D,code:G,signatures:K}},m=function(D,G){let I;var K;let Q=[];f&&(K=B());try{const O=
(0,g.default)(G);I=(0,e.default)(O)}catch(O){Q=[{message:O}]}f&&K("GLSL Tokenize \x26 Parse");K=function(O){O=O.split("\n");const J=(""+O.length).length;return O.map((W,ba)=>{var Y=ba+1;ba=(Y=""+Y).length<J?("       "+Y).slice(-J):Y;return`${ba}: ${W}`}).join("\n")};if(!I||Q.length){D||(D="(inline code)");console.warn(K(G));for(const O of Q)console.error(`${D} -`,O.message);throw Error("GLSL parse error");}return I},p=function(D,G){switch(D.type){case "decl":return G(x.decl.node(D)),!1}return!0},
z=D=>function(G){G!=null&&Array.from(G).map(I=>D.push(I))},t=function(D){let G=null;const I=[];let K=[];const Q={};let O=!1;for(const J of Array.from(D))J.body?(Q[J.ident]&&(K=Array.from(K).filter(W=>W.ident!==J.ident),delete Q[J.ident]),I.push(J),J.ident==="main"?(G=J,O=!0):O||(G=J)):J.storage==="global"?I.push(J):(K.push(J),Q[J.ident]=!0);return[G,I,K]},v=function(D,G,I){let K;const Q={uniform:[],attribute:[],varying:[],external:[],internal:[],global:[],main:null},O=function(J,W){let ba;const Y=
Array.from(J.args).map(V=>x.decl.type(V.ident,V.type,V.quant,V.count,V.inout,V.storage));for(ba of Array.from(Y))if(ba.inout===x.decl.inout){var S=ba,ca=ba.copy();S.inout=x.decl.in;ca.inout=x.decl.out;ca.meta={shadow:S.name};ca.name+=r.SHADOW_ARG;S.meta={shadowed:ca.name};Y.push(ca)}J.type!=="void"&&Y.unshift(x.decl.type(r.RETURN_ARG,J.type,!1,"","out"));S=(()=>{const V=[];for(ba of Array.from(Y))ba.inout===x.decl.in&&V.push(ba.type);return V})().join(",");ca=(()=>{const V=[];for(ba of Array.from(Y))ba.inout===
x.decl.out&&V.push(ba.type);return V})().join(",");return{name:J.ident,type:`(${S})(${ca})`,signature:Y,inout:W,spec:J.type}};Q.main=O(D,x.decl.out);for(K of Array.from(G))Q.internal.push({name:K.ident});for(K of Array.from(I))switch(K.decl){case "external":D=x.decl.type(K.ident,K.type,K.quant,K.count,K.inout,K.storage);Q[K.storage].push(D);break;case "function":D=O(K,x.decl.in),Q.external.push(D)}return Q};f=!1;const y=function(D,G,I,K){f&&console.log(K,I.type,I.token!=null?I.token.data:void 0,I.token!=
null?I.token.type:void 0);if(D(I,G))for(let Q=0;Q<I.children.length;Q++)y(D,G,I.children[Q],K+"  ",f);return null},B=function(){const D=+new Date;return function(G){const I=+new Date-D;console.log(G,I+" ms");return I}}};
shadow$provide[525]=function(l,L,q){function x(O){const J=O.replace(K.SHADOW_ARG,"");return J!==O?J:null}function r(O){return O.join("\n")}function e(O){return O.join(", ")}function g(O){return O.join(";\n")}function f(O){return{entry:O,type:"void",params:[],signature:[],return:"",vars:{},calls:[],post:[],chain:{}}}function k(O,J){return`#define ${O} ${J}`}function m(O,J,W,ba,Y){return`${O} ${J}(${W}) {\n${ba}${Y}}`}function p(O,J,W){O=O?`${O} = `:"";W=e(W);return`  ${O}${J}(${W})`}function z(O,J){for(let W=
0;W<O.length;W++){const ba=O[W],Y=J[W];if(!Y||ba.type!==Y.type||ba.name===K.RETURN_ARG!==(Y.name===K.RETURN_ARG))return!1}return!0}function t(O,J,W,ba,Y){const S=[];let ca="";for(let xa of Array.from(ba)){var V=void 0;const {name:na}=xa;let N=ba=O(na),pa=null,ra=null,Ea=!1;const Ua=na===K.RETURN_ARG;if(V=xa.meta!=null?xa.meta.shadowed:void 0)if(pa=O(V))Y.vars[pa]="  "+xa.param(pa),Y.calls.push(`  ${pa} = ${ba}`),J(V)?ra={shadowed:pa}:xa=xa.split();if(V=xa.meta!=null?xa.meta.shadow:void 0)if(pa=O(V))if(J(V))continue;
else xa=xa.split(),Ea=!0;Ua?ca=ba:Ea||S.push(pa!=null?pa:ba);J(na)?(V="push",Ua?Y.return===""?(V="unshift",N=na,Y.type=xa.spec,Y.return=`  return ${ba}`,Y.vars[ba]="  "+xa.param(ba)):(Y.vars[ba]="  "+xa.param(ba),Y.params.push(xa.param(ba,!0))):Y.params.push(xa.param(ba,!0)),xa=xa.copy(N,ra),Y.signature[V](xa)):Y.vars[ba]="  "+xa.param(ba)}return Y.calls.push(p(ca,W,S))}function v(O,J){const {entry:W}=O;var ba=null;J&&J.length===1&&W!=="main"&&(J=J[0].module,z(O.signature,J.main.signature)&&(ba=k(W,
J.entry)));if(ba==null){J=[];for(var Y in O.vars)J.push(O.vars[Y]);Y=J;({calls:J}=O);({post:ba}=O);let {params:S}=O;const {type:ca}=O,V=O.return;J=J.concat(ba);V!==""&&J.push(V);J.push("");Y.length?(Y.push(""),Y=g(Y)+"\n"):Y="";J=g(J);S=e(S);ba=m(ca,W,S,Y,J)}return{signature:O.signature,code:ba,name:W}}function y(O){const J={defs:[],bodies:[]};for(const W of Array.from(O))Q(W,J);J.defs=r(J.defs);J.bodies=g(J.bodies);J.defs===""&&delete J.defs;J.bodies===""&&delete J.bodies;return J}function B(O){const J=
/([A-Za-z0-9_]+\s+)?[A-Za-z0-9_]+\s+[A-Za-z0-9_]+\s*\([^)]*\)\s*;\s*/gm,W=ca=>ca.replace(J,V=>"");O=O.split(/(?=[{}])/g);let ba=0;for(let ca=0;ca<O.length;ca++){var Y=O[ca];switch(Y[0]){case "{":ba++;break;case "}":ba--}if(ba===0){Y=Y.split(/^[ \t]*#/m);for(let V=0;V<Y.length;V++){var S=Y[V];if(V>0){S=S.split(/\n/);const xa=S.shift();S=S.join("\n");Y[V]=[xa,W(S)].join("\n")}else Y[V]=W(S)}O[ca]=Y.join("#")}}return O=O.join("")}function D(O){const J={};return O.replace(/((attribute|uniform|varying)\s+)[A-Za-z0-9_]+\s+([A-Za-z0-9_]+)\s*(\[[^\]]*\]\s*)?;\s*/gm,
function(W,ba,Y,S,ca){if(J[S])return"";J[S]=!0;return W})}function G(O){const J=function(W,ba){const Y=[],S=[];for(const ca of Array.from(W))(ca.match(ba)?Y:S).push(ca);return Y.concat(S)};O=O.split("\n");O=J(O,/^#define ([^ ]+ _pg_[0-9]+_|_pg_[0-9]+_ [^ ]+)$/);O=J(O,/^#extension/);return O.join("\n")}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},body:{enumerable:!0,get:function(){return f}},build:{enumerable:!0,get:function(){return v}},call:{enumerable:!0,get:function(){return t}},
dedupe:{enumerable:!0,get:function(){return D}},define:{enumerable:!0,get:function(){return k}},defuse:{enumerable:!0,get:function(){return B}},fn:{enumerable:!0,get:function(){return m}},hoist:{enumerable:!0,get:function(){return G}},invoke:{enumerable:!0,get:function(){return p}},lines:{enumerable:!0,get:function(){return r}},link:{enumerable:!0,get:function(){return Q}},links:{enumerable:!0,get:function(){return y}},list:{enumerable:!0,get:function(){return e}},same:{enumerable:!0,get:function(){return z}},
statements:{enumerable:!0,get:function(){return g}},unshadow:{enumerable:!0,get:function(){return x}}});var I=l(478),K=l(523);const Q=(O,J)=>{const {module:W,name:ba,external:Y}=O;var {main:S}=W;({entry:O}=W);if(z(S.signature,Y.signature))return J.defs.push(k(ba,O));var ca=[],V=[];let xa={};const na=[W.namespace,K.RETURN_ARG].join("");for(pa of Array.from(Y.signature)){var N=pa.inout===I.IN?ca:V;N.push(pa)}for(pa of Array.from(S.signature))N=pa.inout===I.IN?ca:V,N=N.shift().name,N===K.RETURN_ARG&&
(N=na),xa[pa.name]=N;var pa=ra=>xa[ra];ca=()=>!0;V=f();t(pa,ca,O,S.signature,V);V.entry=O;xa={return:na};pa=ra=>xa[ra]!=null?xa[ra]:ra;S=f();t(pa,ca,O,Y.signature,S);S.calls=V.calls;S.entry=ba;J.bodies.push(v(V).code.split(" {")[0]);return J.bodies.push(v(S).code)}};
shadow$provide[526]=function(l,L,q){q=l(502);var x=l(524),r=l(525),e=l(523);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r);l.exportCopy(L,e)};
shadow$provide[527]=function(l,L,q){function x(y,B={}){return new v(y,B)}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},ShaderGraph:{enumerable:!0,get:function(){return v}},inspect:{enumerable:!0,get:function(){return p}},load:{enumerable:!0,get:function(){return x}},visualize:{enumerable:!0,get:function(){return m}}});L=l(491);var r=l(501),e=l(526);q=l(478);var g=l(485);l=l(495);const {library:f,cache:k}=r,{visualize:m,inspect:p}=l,{Snippet:z}=g,t=function(y,B={}){const D={};for(let G in y)D[G]=
B[G]||y[G];return D};class v{constructor(y,B){this.config=t({globalUniforms:!1,globalVaryings:!0,globalAttributes:!0,globals:[],autoInspect:!1},B);this.fetch=k(f(e,y,z.load))}shader(y){y==null&&(y={});y=t(this.config,y);return new r.Factory(e,this.fetch,y)}material(y){return new r.Material(this.shader(y),this.shader(y))}inspect(y){return v.inspect(y)}visualize(y){return v.visualize(y)}static inspect(y){return p(y)}static visualize(y){return m(y)}}v.Block=L.Block;v.Factory=r;v.GLSL=e;v.Graph=q;v.Linker=
g;v.Visualize=l};
shadow$provide[528]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Factory:{enumerable:!0,get:function(){return r}}});var x=l(527);const r=function(e){return x.load(function(g){var f=e[g];if(f!=null)return f;f=["#",".",":","["].includes(g[0]);f=document.querySelector(f?g:`#${g}`);if(f!=null&&f.tagName==="SCRIPT")return f.textContent||f.innerText;throw Error(`Unknown shader \`${g}\``);},{autoInspect:!0})}};
shadow$provide[529]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Snippets:{enumerable:!0,get:function(){return Gf}}});var x=l(363),r=l(364),e=l(365),g=l(366),f=l(367),k=l(368),m=l(369),p=l(370),z=l(371),t=l(372),v=l(373),y=l(374),B=l(375),D=l(376),G=l(377),I=l(378),K=l(379),Q=l(380),O=l(381),J=l(382),W=l(383),ba=l(384),Y=l(385),S=l(386),ca=l(387),V=l(388),xa=l(389),na=l(390),N=l(391),pa=l(392),ra=l(393),Ea=l(394),Ua=l(395),jb=l(396),eb=l(397),rc=l(398),xb=l(399),
Bb=l(400),bc=l(401),qb=l(402),cc=l(403),Db=l(404),nc=l(405),Bc=l(406),yb=l(407),lb=l(408),Tb=l(409),yc=l(410),Ha=l(411),fb=l(412),ab=l(413),Qb=l(414),fc=l(415),oc=l(416),Dc=l(417),pc=l(418),Qd=l(419),Ec=l(420),te=l(421),ue=l(422),fe=l(423),ge=l(424),ve=l(425),Rd=l(426),md=l(427),Hd=l(428),Ic=l(429),qd=l(430),ld=l(431),ic=l(432),Ib=l(433),Rb=l(434),Sd=l(435),Td=l(436),Id=l(437),rd=l(438),La=l(439),sd=l(440),Wb=l(441),Pc=l(442),$c=l(443),zc=l(444),Va=l(445),uc=l(446),Ra=l(447),Ab=l(448),xc=l(449),Jc=
l(450),Me=l(451),gc=l(452),eg=l(453),qf=l(454),Eb=l(455),vc=l(456),Ac=l(457),td=l(458),Ne=l(459),ad=l(460),Oe=l(461),Qe=l(462),Fc=l(463),Pe=l(464),we=l(465),ac=l(466),nd=l(467),Re=l(468),cd=l(469),bd=l(470),tb=l(471),Se=l(472),Yb=l(473),Ia=l(474),hc=l(528),dc=l.esmDefault(tb),Te=l.esmDefault(S),gg=l.esmDefault(Va),hg=l.esmDefault(Ic),rf=l.esmDefault(pa),ig=l.esmDefault(pc),jg=l.esmDefault(yc),Vd=l.esmDefault(ld),Ue=l.esmDefault(Ab),sf=l.esmDefault(Oe),se=l.esmDefault(xa),cg=l.esmDefault(Me),dg=l.esmDefault(qd),
tf=l.esmDefault(Ac),uf=l.esmDefault(y),vf=l.esmDefault(yb),Z=l.esmDefault(oc),C=l.esmDefault(eg),w=l.esmDefault(Eb),c=l.esmDefault($c),A=l.esmDefault(cd),P=l.esmDefault(bc),fa=l.esmDefault(t),Da=l.esmDefault(K),kb=l.esmDefault(W),zb=l.esmDefault(ue),Hc=l.esmDefault(Qd),Zc=l.esmDefault(Db),Oc=l.esmDefault(k),Ud=l.esmDefault(fc),Wc=l.esmDefault(Ia),fg=l.esmDefault(Rd),Yg=l.esmDefault(nd),sg=l.esmDefault(Pc),Zg=l.esmDefault(uc),$g=l.esmDefault(r),gi=l.esmDefault(Pe),hi=l.esmDefault(Id),ii=l.esmDefault(gc),
ji=l.esmDefault(B),ki=l.esmDefault(z),li=l.esmDefault(zc),mi=l.esmDefault(qb),ni=l.esmDefault(J),oi=l.esmDefault(Ra),dh=l.esmDefault(Y),eh=l.esmDefault(Rb),pi=l.esmDefault(Ib),qi=l.esmDefault(rd),ri=l.esmDefault(Yb),si=l.esmDefault(Hd),ti=l.esmDefault(ad),fh=l.esmDefault(xc),ui=l.esmDefault(G),vi=l.esmDefault(O),yi=l.esmDefault(Td),zi=l.esmDefault(sd),gh=l.esmDefault(f),Ai=l.esmDefault(m),Bi=l.esmDefault(Ec),Bd=l.esmDefault(na),Rc=l.esmDefault(Tb),hh=l.esmDefault(lb),je=l.esmDefault(Qe),ye=l.esmDefault(ge),
Ci=l.esmDefault(cc),Xa=l.esmDefault(Qb),dd=l.esmDefault(Ne),ma=l.esmDefault(v),tg=l.esmDefault(Ua),ih=l.esmDefault(Bc),Lb=l.esmDefault(ic),ug=l.esmDefault(ac),ze=l.esmDefault(we),Pg=l.esmDefault(Re),jh=l.esmDefault(Ha),kh=l.esmDefault(qf),$b=l.esmDefault(ca),Ae=l.esmDefault(eb),Qg=l.esmDefault(fe),Di=l.esmDefault(vc),Xd=l.esmDefault(p),Ei=l.esmDefault(D),vg=l.esmDefault(bd),Cc=l.esmDefault(N),ec=l.esmDefault(Ea),wg=l.esmDefault(nc),zd=l.esmDefault(ab),yf=l.esmDefault(I),Fi=l.esmDefault(Sd),Cf=l.esmDefault(e),
Gi=l.esmDefault(ra),Sc=l.esmDefault(x),Ld=l.esmDefault(V),wd=l.esmDefault(Fc),Df=l.esmDefault(Jc),Be=l.esmDefault(jb),Ce=l.esmDefault(Bb),De=l.esmDefault(g),Yd=l.esmDefault(fb),Zd=l.esmDefault(ve),ke=l.esmDefault(La),Ze=l.esmDefault(xb),Ef=l.esmDefault(td),Ff=l.esmDefault(md),he=l.esmDefault(Wb),Hi=l.esmDefault(ba),$e=l.esmDefault(te),xg=l.esmDefault(Q),Qc=l.esmDefault(Dc),Md=l.esmDefault(rc),yg=l.esmDefault(Se);const Gf={"arrow.position":Sc.default,"axis.position":$g.default,"cartesian.position":De.default,
"cartesian4.position":Cf.default,"clamp.position":gh.default,"color.opaque":Oc.default,"face.position":Ai.default,"face.position.normal":Xd.default,"float.encode":ki.default,"float.index.pack":fa.default,"float.stretch":ma.default,"fragment.clip.dashed":uf.default,"fragment.clip.dotted":ji.default,"fragment.clip.ends":Ei.default,"fragment.clip.proximity":ui.default,"fragment.color":yf.default,"fragment.map.rgba":Da.default,"fragment.solid":xg.default,"fragment.transparent":vi.default,"grid.position":ni.default,
"grow.position":kb.default,"join.position":Hi.default,"label.alpha":dh.default,"label.map":Te.default,"label.outline":$b.default,"layer.position":Ld.default,"lerp.depth":se.default,"lerp.height":Bd.default,"lerp.items":Cc.default,"lerp.width":rf.default,"line.position":Gi.default,"map.2d.data":ec.default,"map.2d.data.wrap":tg.default,"map.xyzw.2dv":Be.default,"map.xyzw.align":Ae.default,"map.xyzw.texture":Md.default,"mesh.fragment.color":Ze.default,"mesh.fragment.map":Ce.default,"mesh.fragment.mask":P.default,
"mesh.fragment.material":mi.default,"mesh.fragment.shaded":Ci.default,"mesh.fragment.texture":Zc.default,"mesh.gamma.in":wg.default,"mesh.gamma.out":ih.default,"mesh.map.uvwo":vf.default,"mesh.position":hh.default,"mesh.vertex.color":Rc.default,"mesh.vertex.mask":jg.default,"mesh.vertex.position":jh.default,"move.position":Yd.default,"object.mask.default":zd.default,"point.alpha.circle":Xa.default,"point.alpha.circle.hollow":Ud.default,"point.alpha.generic":Z.default,"point.alpha.generic.hollow":Qc.default,
"point.edge":ig.default,"point.fill":Hc.default,"point.mask.circle":Bi.default,"point.mask.diamond":$e.default,"point.mask.down":zb.default,"point.mask.left":Qg.default,"point.mask.right":ye.default,"point.mask.square":Zd.default,"point.mask.up":fg.default,"point.position":Ff.default,"point.size.uniform":si.default,"point.size.varying":hg.default,"polar.position":dg.default,"project.position":Vd.default,"project.readback":Lb.default,"raw.position.scale":pi.default,"repeat.position":eh.default,"resample.padding":Fi.default,
"resample.relative":yi.default,"reveal.mask":hi.default,"reverse.position":qi.default,"root.position":ke.default,"sample.2d":zi.default,"scale.position":he.default,"screen.map.stpq":sg.default,"screen.map.xy":c.default,"screen.map.xyzw":li.default,"screen.pass.uv":gg.default,"screen.position":Zg.default,"slice.position":oi.default,"spherical.position":Ue.default,"split.position":fh.default,"spread.position":Df.default,"sprite.fragment":cg.default,"sprite.position":ii.default,"stereographic.position":kh.default,
"stereographic4.position":C.default,"stpq.sample.2d":w.default,"stpq.xyzw.2d":Di.default,"strip.position.normal":tf.default,"style.color":Ef.default,"subdivide.depth":dd.default,"subdivide.depth.lerp":ti.default,"subdivide.height":sf.default,"subdivide.height.lerp":je.default,"subdivide.items":wd.default,"subdivide.items.lerp":gi.default,"subdivide.width":ze.default,"subdivide.width.lerp":ug.default,"surface.mask.hollow":Yg.default,"surface.position":Pg.default,"surface.position.normal":A.default,
"surface.position.shaded":vg.default,"ticks.position":dc.default,"transform3.position":yg.default,"transform4.position":ri.default,"view.position":Wc.default};l.exportCopy(L,hc)};
shadow$provide[530]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Animator:{enumerable:!0,get:function(){return r}}});var x=l(294);class r{constructor(g){this.context=g;this.anims=[]}make(g,f){g=new e(this,this.context.time,g,f);this.anims.push(g);return g}unmake(g){return this.anims=Array.from(this.anims).filter(f=>f!==g)}update(){const {time:g}=this.context;return this.anims=(()=>{const f=[];for(const k of Array.from(this.anims))k.update(g)!==!1&&f.push(k);return f})()}lerp(g,
f,k,m,p){p==null&&(p=g.make());if(g.lerp)p=g.lerp(f,k,p,m);else{if(g.emitter){p=f.emitterFrom;const z=k.emitterTo;if(p!=null&&z!=null&&p===z)return p.lerp(m),p;g=g.emitter(f,k);f.emitterFrom=g;k.emitterTo=g;g.lerp(m);return g}p=g.op?g.op(f,k,p,function(z,t){return z===+z&&t===+t?z+(t-z)*m:m>.5?t:z}):m>.5?k:f}return p}}class e{constructor(g,f,k,m){this.animator=g;this.time=f;this.type=k;this.options=m;this.value=this.type.make();this.target=this.type.make();this.queue=[]}dispose(){return this.animator.unmake(this)}set(){let {target:g}=
this,f=arguments.length>1?[].slice.call(arguments):arguments[0],k=!1;f=this.type.validate(f,g,()=>k=!0);k||(g=f);this.cancel();this.target=this.value;this.value=g;return this.notify()}getTime(){var {clock:g}=this.options;g=g?g.getTime():this.time;return this.options.realtime?g.time:g.clock}cancel(g){let f;g==null&&(g=this.getTime());const {queue:k}=this,m=(()=>{const p=[];for(f of Array.from(k))f.end>=g&&p.push(f);return p})();this.queue=(()=>{const p=[];for(f of Array.from(k))f.end<g&&p.push(f);
return p})();for(f of Array.from(m))typeof f.complete==="function"&&f.complete(!1);typeof this.options.complete==="function"&&this.options.complete(!1)}notify(){return typeof this.options.step==="function"?this.options.step(this.value):void 0}immediate(g,f){const {duration:k,delay:m,ease:p,step:z,complete:t}=f;f=this.getTime()+m;const v=f+k;let y=!1,B=this.type.make();g=this.type.validate(g,B,function(){y=!0;return null});g===void 0||y||(B=g);this.cancel(f);return this.queue.push({from:null,to:B,
start:f,end:v,ease:p,step:z,complete:t})}update(g){this.time=g;if(this.queue.length===0)return!0;g=this.getTime();let {value:f}=this;const {queue:k}=this;for(var m=!1;!m;){var p=k[0];let {from:z}=p;const {to:t,start:v,end:y,step:B,complete:D,ease:G}=p;z==null&&(z=p.from=this.type.clone(this.value));p=x.clamp((g-v)/Math.max(1E-5,y-v)||0,0,1);if(p===0)return;m=(()=>{switch(G){case "linear":case 0:return null;case "cosine":case 1:return x.cosine;case "binary":case 2:return x.binary;case "hold":case 3:return x.hold;
default:return x.cosine}})();m!=null&&(p=m(p));f=(m=p<1)?this.animator.lerp(this.type,z,t,p,f):t;typeof B==="function"&&B(f);if(!m&&(typeof D==="function"&&D(!0),typeof this.options.complete==="function"&&this.options.complete(!0),k.shift(),k.length===0))break}this.value=f;return this.notify()}}};
shadow$provide[531]=function(l,L,q){function x(f,k,m){const p=[],z=f<k;for(k=m?z?k+1:k-1:k;z?f<k:f>k;z?f++:f--)p.push(f);return p}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},API:{enumerable:!0,get:function(){return g}}});var r=l(134),e=l(527);class g{v2(){return this}constructor(f,k,m){this._context=f;this._up=k;this._targets=m;f=this._context.controller.getRoot();this._targets==null&&(this._targets=[f]);this.isRoot=this._targets.length===1&&this._targets[0]===f;this.isLeaf=this._targets.length===
1&&this._targets[0].children==null;for(f=0;f<this._targets.length;f++)this[f]=this._targets[f];this.length=this._targets.length;for(const p of Array.from(this._context.controller.getTypes()))["root"].includes(p)||(this[p]=(z,t)=>this.add(p,z,t))}select(f){f=this._context.model.select(f,this.isRoot?null:this._targets);return this._push(f)}eq(f){return this._targets.length>f?this._push([this._targets[f]]):this._push([])}filter(f){if(typeof f==="string"){const k=this._context.model._matcher(f);f=m=>
k(m)}return this._push(this._targets.filter(f))}map(f){return x(0,this.length,!1).map(k=>f(this[k],k,this))}each(f){for(let k=0,m=this.length,p=0<=m;p?k<m:k>m;p?k++:k--)f(this[k],k,this);return this}add(f,k,m){const {controller:p}=this._context;if(this.isLeaf)return this._pop().add(f,k,m);const z=[];for(const t of this._targets){const v=p.make(f,k,m);p.add(v,t);z.push(v)}return this._push(z)}remove(f){if(f)return this.select(f).remove();for(const k of Array.from(this._targets.slice().reverse()))this._context.controller.remove(k);
return this._pop()}set(f,k){for(const m of Array.from(this._targets))this._context.controller.set(m,f,k);return this}getAll(f){return Array.from(this._targets).map(k=>this._context.controller.get(k,f))}get(f){return this._targets[0]!=null?this._targets[0].get(f):void 0}evaluate(f,k){return this._targets[0]!=null?this._targets[0].evaluate(f,k):void 0}bind(f,k){for(const m of Array.from(this._targets))this._context.controller.bind(m,f,k);return this}unbind(f){for(const k of Array.from(this._targets))this._context.controller.unbind(k,
f);return this}end(){return(this.isLeaf?this._pop():this)._pop()}_push(f){return new g(this._context,this,f)}_pop(){return this._up!=null?this._up:this}_reset(){let f;return(f=this._up!=null?this._up.reset():void 0)!=null?f:this}map(f){return this._targets.map(f)}on(){const f=arguments;this._targets.map(k=>k.on.apply(k,f));return this}off(){const f=arguments;this._targets.map(k=>k.off.apply(k,f));return this}toString(){const f=this._targets.map(k=>k.toString());return this._targets.length>1?`[${f.join(", ")}]`:
f[0]}toMarkup(){return this._targets.map(f=>f.toMarkup()).join("\n\n")}print(){r.print(this._targets.map(f=>f.toMarkup()).join("\n\n"));return this}debug(){var f=this.inspect();console.log("Renderables: ",f.renderables);console.log("Renders: ",f.renders);console.log("Shaders: ",f.shaders);const k=[];for(const m of Array.from(f.shaders))f=m.owner.constructor.name,k.push(`${f} - Vertex`),k.push(m.vertex),k.push(`${f} - Fragment`),k.push(m.fragment);return e.inspect(k)}inspect(f,k,m){let p;typeof k===
"boolean"&&(m=k,k=null);m==null&&(m=!0);const z=p=function(y,B){B==null&&(B=[]);k&&!y.traits.hash[k]||B.push((y.controller!=null?y.controller.objects:void 0)!=null?y.controller!=null?y.controller.objects:void 0:[]);if(y.children!=null)for(const D of Array.from(y.children))p(D,B);return B},t=function(y){y=y.reduce((B,D)=>B.concat(D),[]);return y=y.filter((B,D)=>B!=null&&y.indexOf(B)===D)},v={nodes:this._targets.slice(),renderables:[],renders:[],shaders:[]};for(const y of Array.from(this._targets)){let B;
m&&y.print(f,"info");const D={renderables:B=t(z(y)),renders:t(B.map(G=>G.renders)),shaders:t(B.map(G=>G.renders!=null?G.renders.map(I=>{const K={};K.owner=G;K.geometry=I.geometry;K.material=I.material;K.vertex=I.userData.vertexGraph;K.fragment=I.userData.fragmentGraph;return K}):void 0))};for(const G in D)v[G]=v[G].concat(D[G])}return v}}};
shadow$provide[532]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Controller:{enumerable:!0,get:function(){return x}}});class x{constructor(r,e){this.model=r;this.primitives=e}getRoot(){return this.model.getRoot()}getTypes(){return this.primitives.getTypes()}make(r,e,g){return this.primitives.make(r,e,g)}get(r,e){return r.get(e)}set(r,e,g){try{return r.set(e,g)}catch(f){return r.print(null,"warn"),console.error(f)}}bind(r,e,g){try{return r.bind(e,g)}catch(f){return r.print(null,
"warn"),console.error(f)}}unbind(r,e){try{return r.unbind(e)}catch(g){return r.print(null,"warn"),console.error(g)}}add(r,e){e==null&&(e=this.model.getRoot());return e.add(r)}remove(r){const e=r.parent;if(e)return e.remove(r)}}};
shadow$provide[533]=function(l,L,q){q=l(530);var x=l(531),r=l(532);l.exportCopy(L,q);l.exportCopy(L,x);l.exportCopy(L,r)};
shadow$provide[534]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Axis:{enumerable:!0,get:function(){return m}},Data:{enumerable:!0,get:function(){return p}},Ease:{enumerable:!0,get:function(){return z}},GLSL:{enumerable:!0,get:function(){return t}},JS:{enumerable:!0,get:function(){return v}},Pretty:{enumerable:!0,get:function(){return y}},Three:{enumerable:!0,get:function(){return B}},Ticks:{enumerable:!0,get:function(){return D}},VDOM:{enumerable:!0,get:function(){return G}}});
L=l(242);q=l(198);var x=l(294),r=l(199),e=l(245),g=l(134),f=l(195),k=l(319);l=l(183);const m=L,p=q,z=x,t=r,v=e,y=g,B=f,D=k,G=l};
shadow$provide[535]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Context:{enumerable:!0,get:function(){return z}}});var x=l(181),r=l(187),e=l(323),g=l(362),f=l(529),k=l(533),m=l(534),p=l(101);class z{static initClass(){this.Namespace={Model:x,Overlay:r,Primitives:e,Render:g,Shaders:f,Stage:k,Util:m,DOM:m.VDOM};this.Version="2.3.1"}constructor(t,v=null,y=null){let B;this.canvas=B=t.domElement;this.element=null;this.shaders=f.Factory(f.Snippets);this.renderables=new g.Factory(g.Classes,
t,this.shaders);this.overlays=new r.Factory(r.Classes,B);this.scene=this.renderables.make("scene",{scene:v});this.camera=this.defaultCamera=y!=null?y:new p.PerspectiveCamera;this.attributes=new x.Attributes(e.Types,this);this.primitives=new e.Factory(e.Types,this);this.root=this.primitives.make("root");this.model=new x.Model(this.root);this.guard=new x.Guard;this.controller=new k.Controller(this.model,this.primitives);this.animator=new k.Animator(this);this.api=new k.API(this);this.speed=1;this.time=
{now:+new Date/1E3,time:0,delta:0,clock:0,step:0}}init(){this.scene.inject();this.overlays.inject();return this}destroy(){this.scene.unject();this.overlays.unject();return this}resize(t){t==null&&(t={});t.renderWidth==null&&(t.renderWidth=t.viewWidth!=null?t.viewWidth:t.viewWidth=1280);t.renderHeight==null&&(t.renderHeight=t.viewHeight!=null?t.viewHeight:t.viewHeight=720);t.pixelRatio==null&&(t.pixelRatio=t.renderWidth/Math.max(1E-6,t.viewWidth));t.aspect==null&&(t.aspect=t.viewWidth/Math.max(1E-6,
t.viewHeight));this.root.controller.resize(t);return this}frame(t){this.pre(t);this.update();this.render();this.post();return this}pre(t){t||(t={now:+new Date/1E3,time:0,delta:0,clock:0,step:0},t.delta=this.time.now!=null?t.now-this.time.now:0,t.delta>1&&(t.delta=1/60),t.step=t.delta*this.speed,t.time=this.time.time+t.delta,t.clock=this.time.clock+t.step);this.time=t;typeof this.root.controller.pre==="function"&&this.root.controller.pre();return this}update(){this.animator.update();this.attributes.compute();
this.guard.iterate({step:()=>this.attributes.digest()||this.model.digest(),last(){return{attribute:this.attributes.getLastTrigger(),model:this.model.getLastTrigger()}}});typeof this.root.controller.update==="function"&&this.root.controller.update();this.camera=this.root.controller.getCamera();this.speed=this.root.controller.getSpeed();return this}render(){typeof this.root.controller.render==="function"&&this.root.controller.render();this.scene.render();return this}post(){typeof this.root.controller.post===
"function"&&this.root.controller.post();return this}setWarmup(t){this.scene.warmup(t);return this}getPending(){return this.scene.pending.length}}z.initClass()};
shadow$provide[536]=function(l,L,q){Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},Context:{enumerable:!0,get:function(){return t}},DOM:{enumerable:!0,get:function(){return O}},Model:{enumerable:!0,get:function(){return y}},Overlay:{enumerable:!0,get:function(){return B}},Primitives:{enumerable:!0,get:function(){return D}},Render:{enumerable:!0,get:function(){return G}},Shaders:{enumerable:!0,get:function(){return I}},Stage:{enumerable:!0,get:function(){return K}},Util:{enumerable:!0,
get:function(){return Q}},e:{enumerable:!0,get:function(){return z}},mathBox:{enumerable:!0,get:function(){return J}},version:{enumerable:!0,get:function(){return v}},"π":{enumerable:!0,get:function(){return m}},"τ":{enumerable:!0,get:function(){return p}}});l(105);l(132);L=l(181);q=l(187);var x=l(323),r=l(362),e=l(529),g=l(533),f=l(534),k=l(104);l=l(535);const m=Math.PI,p=m*2,z=Math.E,t=l.Context,v=l.Context.Version,y=L,B=q,D=x,G=r,I=e,K=g,Q=f,O=f.VDOM,J=function(W){W=new k.Bootstrap(W);W.fallback||
(W.Time||W.install("time"),W.MathBox||W.install(["mathbox","splash"]));return W.mathbox!=null?W.mathbox:W};k.Bootstrap.registerPlugin("mathbox",{defaults:{init:!0,warmup:2,inspect:!0,splash:!0},listen:["ready","pre","update","post","resize"],install(W){let ba=!1;this.first=!0;return W.MathBox={init:Y=>{ba||(ba=!0,this.context=new t(W.renderer,(Y!=null?Y.scene:void 0)||this.options.scene||W.scene,(Y!=null?Y.camera:void 0)||this.options.camera||W.camera),this.context.api.three=W.three=W,this.context.api.mathbox=
W.mathbox=this.context.api,this.context.api.start=()=>W.Loop.start(),this.context.api.stop=()=>W.Loop.stop(),this.context.init(),this.context.resize(W.Size),this.context.setWarmup(this.options.warmup),this.pending=0,this.warm=!this.options.warmup,console.log("MathBox²",v),W.trigger({type:"mathbox/init",version:v,context:this.context}))},destroy:()=>{ba&&(ba=!1,W.trigger({type:"mathbox/destroy",context:this.context}),this.context.destroy(),delete W.mathbox,delete this.context.api.three,delete this.context)},
object:()=>this.context!=null?this.context.scene.root:void 0}},uninstall(W){W.MathBox.destroy();delete W.MathBox},ready(W,ba){if(this.options.init)return ba.MathBox.init(),setTimeout(()=>{if(this.options.inspect&&ba.MathBox)return this.inspect(ba)})},inspect(W){this.context.api.inspect();if(!this.options.warmup)return this.info(W)},info(W){const ba=function(Y){const S=[];for(;Y>=1E3;)S.unshift(("000"+Y%1E3).slice(-3)),Y=Math.floor(Y/1E3);S.unshift(Y);return S.join(",")};W=W.renderer.info.render;console.log("Geometry  ",
ba(W.triangles)+" triangles  ",ba(W.points)+" points  ",ba(W.lines)+" lines  ",ba(W.calls)+" draw calls  ")},resize(W,ba){return this.context!=null?this.context.resize(ba.Size):void 0},pre(W,ba){return this.context!=null?this.context.pre(ba.Time):void 0},update(W,ba){let Y;this.context!=null&&this.context.update();(Y=this.context!=null?this.context.camera:void 0)&&Y!==ba.camera&&(ba.camera=Y);ba.Time.set({speed:this.context.speed});this.progress(this.context.getPending(),ba);return this.context!=
null?this.context.render():void 0},post(W,ba){return this.context!=null?this.context.post():void 0},progress(W,ba){if(W||this.pending){var Y=Math.max(W+this.options.warmup,this.pending),S=Y-W,ca=Y;ba.trigger({type:"mathbox/progress",current:Y-W,total:Y});W===0&&(Y=0);this.pending=Y;S!==ca||this.warm||(this.warm=!0,this.options.inspect&&this.info(ba))}}})};
shadow$provide[537]=function(l,L,q){var x=this&&this.__assign||function(){x=Object.assign||function(y){for(var B,D=1,G=arguments.length;D<G;D++){B=arguments[D];for(var I in B)Object.prototype.hasOwnProperty.call(B,I)&&(y[I]=B[I])}return y};return x.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(y,B,D,G){G===void 0&&(G=D);var I=Object.getOwnPropertyDescriptor(B,D);if(!I||("get"in I?!B.__esModule:I.writable||I.configurable))I={enumerable:!0,get:function(){return B[D]}};
Object.defineProperty(y,G,I)}:function(y,B,D,G){G===void 0&&(G=D);y[G]=B[D]}),e=this&&this.__setModuleDefault||(Object.create?function(y,B){Object.defineProperty(y,"default",{enumerable:!0,value:B})}:function(y,B){y["default"]=B});L=this&&this.__importStar||function(y){if(y&&y.__esModule)return y;var B={};if(y!=null)for(var D in y)D!=="default"&&Object.prototype.hasOwnProperty.call(y,D)&&r(B,y,D);e(B,y);return B};var g=this&&this.__rest||function(y,B){var D={},G;for(G in y)Object.prototype.hasOwnProperty.call(y,
G)&&B.indexOf(G)<0&&(D[G]=y[G]);if(y!=null&&typeof Object.getOwnPropertySymbols==="function"){var I=0;for(G=Object.getOwnPropertySymbols(y);I<G.length;I++)B.indexOf(G[I])<0&&Object.prototype.propertyIsEnumerable.call(y,G[I])&&(D[G[I]]=y[G[I]])}return D},f=this&&this.__importDefault||function(y){return y&&y.__esModule?y:{"default":y}};q.__esModule=!0;var k=L(l(3)),m=l(101),p=l(536),z=f(l(9)),t=l(99),v=f(l(5));q["default"]=(0,k.forwardRef)(function(y,B){var D=y.container,G=y.children,I=y.options,K=
g(y,["container","children","options"]),Q=(0,t.useDeepCompareMemo)(I!==null&&I!==void 0?I:{},{});y=(0,k.useState)(null);var O=y[0],J=y[1];(0,k.useEffect)(function(){if(!D)return function(){};var W=(0,p.mathBox)(x(x({},Q),{element:D}));J(W);W.three.renderer.setClearColor(new m.Color(16777215),1);W.three.camera.position.set(1,1,2);return function(){W.select("*").remove();W.three.destroy();J(null)}},[D,Q]);(0,k.useEffect)(function(){O&&O.set(K)},[O,K]);(0,k.useImperativeHandle)(B,function(){return O},
[O]);return O&&k["default"].createElement(z["default"].Provider,{value:O},k["default"].createElement(v["default"].Provider,{value:O.three},G))})};
shadow$provide[538]=function(l,L,q){var x=this&&this.__assign||function(){x=Object.assign||function(p){for(var z,t=1,v=arguments.length;t<v;t++){z=arguments[t];for(var y in z)Object.prototype.hasOwnProperty.call(z,y)&&(p[y]=z[y])}return p};return x.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(p,z,t,v){v===void 0&&(v=t);var y=Object.getOwnPropertyDescriptor(z,t);if(!y||("get"in y?!z.__esModule:y.writable||y.configurable))y={enumerable:!0,get:function(){return z[t]}};
Object.defineProperty(p,v,y)}:function(p,z,t,v){v===void 0&&(v=t);p[v]=z[t]}),e=this&&this.__setModuleDefault||(Object.create?function(p,z){Object.defineProperty(p,"default",{enumerable:!0,value:z})}:function(p,z){p["default"]=z});L=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var z={};if(p!=null)for(var t in p)t!=="default"&&Object.prototype.hasOwnProperty.call(p,t)&&r(z,p,t);e(z,p);return z};var g=this&&this.__rest||function(p,z){var t={},v;for(v in p)Object.prototype.hasOwnProperty.call(p,
v)&&z.indexOf(v)<0&&(t[v]=p[v]);if(p!=null&&typeof Object.getOwnPropertySymbols==="function"){var y=0;for(v=Object.getOwnPropertySymbols(p);y<v.length;y++)z.indexOf(v[y])<0&&Object.prototype.propertyIsEnumerable.call(p,v[y])&&(t[v[y]]=p[v[y]])}return t},f=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{"default":p}};q.__esModule=!0;var k=L(l(3)),m=f(l(537));q["default"]=(0,k.forwardRef)(function(p,z){var t=p.children,v=p.containerId,y=p.containerClass,B=p.containerStyle;p=g(p,["children",
"containerId","containerClass","containerStyle"]);var D=(0,k.useState)(null),G=D[0];return k["default"].createElement("div",{ref:D[1],id:v,className:y,style:B},G&&k["default"].createElement(m["default"],x({ref:z,container:G},p),t))})};
shadow$provide[539]=function(l,L,q){var x=this&&this.__createBinding||(Object.create?function(r,e,g,f){f===void 0&&(f=g);var k=Object.getOwnPropertyDescriptor(e,g);if(!k||("get"in k?!e.__esModule:k.writable||k.configurable))k={enumerable:!0,get:function(){return e[g]}};Object.defineProperty(r,f,k)}:function(r,e,g,f){f===void 0&&(f=g);r[f]=e[g]});L=this&&this.__exportStar||function(r,e){for(var g in r)g==="default"||Object.prototype.hasOwnProperty.call(e,g)||x(e,r,g)};q.__esModule=!0;q.useMathbox=
q.ContainedMathbox=q.Mathbox=void 0;L(l(100),q);L=l(537);x(q,L,"default","Mathbox");L=l(538);x(q,L,"default","ContainedMathbox");l=l(9);x(q,l,"useMathbox")};
shadow$provide[540]=function(l,L,q){var x=this&&this.__createBinding||(Object.create?function(g,f,k,m){m===void 0&&(m=k);var p=Object.getOwnPropertyDescriptor(f,k);if(!p||("get"in p?!f.__esModule:p.writable||p.configurable))p={enumerable:!0,get:function(){return f[k]}};Object.defineProperty(g,m,p)}:function(g,f,k,m){m===void 0&&(m=k);g[m]=f[k]}),r=this&&this.__setModuleDefault||(Object.create?function(g,f){Object.defineProperty(g,"default",{enumerable:!0,value:f})}:function(g,f){g["default"]=f}),
e=this&&this.__importStar||function(g){if(g&&g.__esModule)return g;var f={};if(g!=null)for(var k in g)k!=="default"&&Object.prototype.hasOwnProperty.call(g,k)&&x(f,g,k);r(f,g);return f};L=this&&this.__exportStar||function(g,f){for(var k in g)k==="default"||Object.prototype.hasOwnProperty.call(f,k)||x(f,g,k)};q.__esModule=!0;q.Threestrap=void 0;e=e(l(8));q.Threestrap=e;L(l(539),q)};
shadow$provide[541]=function(l,L,q){function x(S){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(S.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._isTrackingPointer(S)||(this._addPointer(S),S.pointerType==="touch"?this._onTouchStart(S):this._onMouseDown(S)))}function r(S){this.enabled!==!1&&(S.pointerType==="touch"?this._onTouchMove(S):this._onMouseMove(S))}function e(S){this._removePointer(S);
switch(this._pointers.length){case 0:this.domElement.releasePointerCapture(S.pointerId);this.domElement.removeEventListener("pointermove",this._onPointerMove);this.domElement.removeEventListener("pointerup",this._onPointerUp);this.dispatchEvent(I);this.state=ba.NONE;break;case 1:S=this._pointers[0];const ca=this._pointerPositions[S];this._onTouchStart({pointerId:S,pageX:ca.x,pageY:ca.y})}}function g(S){let ca;switch(S.button){case 0:ca=this.mouseButtons.LEFT;break;case 1:ca=this.mouseButtons.MIDDLE;
break;case 2:ca=this.mouseButtons.RIGHT;break;default:ca=-1}switch(ca){case B.MOUSE.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(S);this.state=ba.DOLLY;break;case B.MOUSE.ROTATE:if(S.ctrlKey||S.metaKey||S.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(S);this.state=ba.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(S);this.state=ba.ROTATE}break;case B.MOUSE.PAN:if(S.ctrlKey||S.metaKey||S.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(S);
this.state=ba.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(S);this.state=ba.PAN}break;default:this.state=ba.NONE}this.state!==ba.NONE&&this.dispatchEvent(G)}function f(S){switch(this.state){case ba.ROTATE:if(this.enableRotate===!1)break;this._handleMouseMoveRotate(S);break;case ba.DOLLY:if(this.enableZoom===!1)break;this._handleMouseMoveDolly(S);break;case ba.PAN:this.enablePan!==!1&&this._handleMouseMovePan(S)}}function k(S){this.enabled!==!1&&this.enableZoom!==!1&&this.state===
ba.NONE&&(S.preventDefault(),this.dispatchEvent(G),this._handleMouseWheel(this._customWheelEvent(S)),this.dispatchEvent(I))}function m(S){this.enabled!==!1&&this._handleKeyDown(S)}function p(S){this._trackPointer(S);switch(this._pointers.length){case 1:switch(this.touches.ONE){case B.TOUCH.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(S);this.state=ba.TOUCH_ROTATE;break;case B.TOUCH.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(S);this.state=ba.TOUCH_PAN;break;
default:this.state=ba.NONE}break;case 2:switch(this.touches.TWO){case B.TOUCH.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(S);this.state=ba.TOUCH_DOLLY_PAN;break;case B.TOUCH.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(S);this.state=ba.TOUCH_DOLLY_ROTATE;break;default:this.state=ba.NONE}break;default:this.state=ba.NONE}this.state!==ba.NONE&&this.dispatchEvent(G)}function z(S){this._trackPointer(S);
switch(this.state){case ba.TOUCH_ROTATE:if(this.enableRotate===!1)break;this._handleTouchMoveRotate(S);this.update();break;case ba.TOUCH_PAN:if(this.enablePan===!1)break;this._handleTouchMovePan(S);this.update();break;case ba.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)break;this._handleTouchMoveDollyPan(S);this.update();break;case ba.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)break;this._handleTouchMoveDollyRotate(S);this.update();break;default:this.state=
ba.NONE}}function t(S){this.enabled!==!1&&S.preventDefault()}function v(S){S.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function y(S){S.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},OrbitControls:{enumerable:!0,get:function(){return Y}}});
var B=l(101);const D={type:"change"},G={type:"start"},I={type:"end"},K=new B.Ray,Q=new B.Plane,O=Math.cos(70*B.MathUtils.DEG2RAD),J=new B.Vector3,W=2*Math.PI,ba={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};class Y extends B.Controls{constructor(S,ca=null){super(S,ca);this.state=ba.NONE;this.target=new B.Vector3;this.cursor=new B.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minTargetRadius=0;this.maxTargetRadius=
Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=!1;this.dampingFactor=.05;this.enableZoom=!0;this.zoomSpeed=1;this.enableRotate=!0;this.keyRotateSpeed=this.rotateSpeed=1;this.enablePan=!0;this.panSpeed=1;this.screenSpacePanning=!0;this.keyPanSpeed=7;this.autoRotate=this.zoomToCursor=!1;this.autoRotateSpeed=2;this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"};this.mouseButtons={LEFT:B.MOUSE.ROTATE,
MIDDLE:B.MOUSE.DOLLY,RIGHT:B.MOUSE.PAN};this.touches={ONE:B.TOUCH.ROTATE,TWO:B.TOUCH.DOLLY_PAN};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this._domElementKeyEvents=null;this._lastPosition=new B.Vector3;this._lastQuaternion=new B.Quaternion;this._lastTargetPosition=new B.Vector3;this._quat=(new B.Quaternion).setFromUnitVectors(S.up,new B.Vector3(0,1,0));this._quatInverse=this._quat.clone().invert();this._spherical=new B.Spherical;this._sphericalDelta=
new B.Spherical;this._scale=1;this._panOffset=new B.Vector3;this._rotateStart=new B.Vector2;this._rotateEnd=new B.Vector2;this._rotateDelta=new B.Vector2;this._panStart=new B.Vector2;this._panEnd=new B.Vector2;this._panDelta=new B.Vector2;this._dollyStart=new B.Vector2;this._dollyEnd=new B.Vector2;this._dollyDelta=new B.Vector2;this._dollyDirection=new B.Vector3;this._mouse=new B.Vector2;this._performCursorZoom=!1;this._pointers=[];this._pointerPositions={};this._controlActive=!1;this._onPointerMove=
r.bind(this);this._onPointerDown=x.bind(this);this._onPointerUp=e.bind(this);this._onContextMenu=t.bind(this);this._onMouseWheel=k.bind(this);this._onKeyDown=m.bind(this);this._onTouchStart=p.bind(this);this._onTouchMove=z.bind(this);this._onMouseDown=g.bind(this);this._onMouseMove=f.bind(this);this._interceptControlDown=v.bind(this);this._interceptControlUp=y.bind(this);this.domElement!==null&&this.connect(this.domElement);this.update()}connect(S){super.connect(S);this.domElement.addEventListener("pointerdown",
this._onPointerDown);this.domElement.addEventListener("pointercancel",this._onPointerUp);this.domElement.addEventListener("contextmenu",this._onContextMenu);this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1});this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0});this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown);this.domElement.removeEventListener("pointermove",
this._onPointerMove);this.domElement.removeEventListener("pointerup",this._onPointerUp);this.domElement.removeEventListener("pointercancel",this._onPointerUp);this.domElement.removeEventListener("wheel",this._onMouseWheel);this.domElement.removeEventListener("contextmenu",this._onContextMenu);this.stopListenToKeyEvents();this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0});this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(S){S.addEventListener("keydown",
this._onKeyDown);this._domElementKeyEvents=S}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target);this.position0.copy(this.object.position);this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0);this.object.position.copy(this.position0);this.object.zoom=this.zoom0;this.object.updateProjectionMatrix();this.dispatchEvent(D);this.update();
this.state=ba.NONE}update(S=null){var ca=this.object.position;J.copy(ca).sub(this.target);J.applyQuaternion(this._quat);this._spherical.setFromVector3(J);this.autoRotate&&this.state===ba.NONE&&this._rotateLeft(this._getAutoRotationAngle(S));this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);S=this.minAzimuthAngle;
var V=this.maxAzimuthAngle;isFinite(S)&&isFinite(V)&&(S<-Math.PI?S+=W:S>Math.PI&&(S-=W),V<-Math.PI?V+=W:V>Math.PI&&(V-=W),this._spherical.theta=S<=V?Math.max(S,Math.min(V,this._spherical.theta)):this._spherical.theta>(S+V)/2?Math.max(S,this._spherical.theta):Math.min(V,this._spherical.theta));this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi));this._spherical.makeSafe();this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):
this.target.add(this._panOffset);this.target.sub(this.cursor);this.target.clampLength(this.minTargetRadius,this.maxTargetRadius);this.target.add(this.cursor);S=!1;this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera?this._spherical.radius=this._clampDistance(this._spherical.radius):(S=this._spherical.radius,this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),S=S!=this._spherical.radius);J.setFromSpherical(this._spherical);J.applyQuaternion(this._quatInverse);
ca.copy(this.target).add(J);this.object.lookAt(this.target);this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0));this.zoomToCursor&&this._performCursorZoom?(ca=null,this.object.isPerspectiveCamera?(S=J.length(),ca=this._clampDistance(S*this._scale),S-=ca,this.object.position.addScaledVector(this._dollyDirection,S),this.object.updateMatrixWorld(),
S=!!S):this.object.isOrthographicCamera?(ca=new B.Vector3(this._mouse.x,this._mouse.y,0),ca.unproject(this.object),S=this.object.zoom,this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),S=S!==this.object.zoom,V=new B.Vector3(this._mouse.x,this._mouse.y,0),V.unproject(this.object),this.object.position.sub(V).add(ca),this.object.updateMatrixWorld(),ca=J.length()):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),
this.zoomToCursor=!1),ca!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(ca).add(this.object.position):(K.origin.copy(this.object.position),K.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(K.direction))<O?this.object.lookAt(this.target):(Q.setFromNormalAndCoplanarPoint(this.object.up,this.target),K.intersectPlane(Q,this.target))))):this.object.isOrthographicCamera&&(ca=this.object.zoom,this.object.zoom=
Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),ca!==this.object.zoom&&(this.object.updateProjectionMatrix(),S=!0));this._scale=1;this._performCursorZoom=!1;return S||this._lastPosition.distanceToSquared(this.object.position)>1E-6||8*(1-this._lastQuaternion.dot(this.object.quaternion))>1E-6||this._lastTargetPosition.distanceToSquared(this.target)>1E-6?(this.dispatchEvent(D),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),
!0):!1}_getAutoRotationAngle(S){return S!==null?W/60*this.autoRotateSpeed*S:W/60/60*this.autoRotateSpeed}_getZoomScale(S){return Math.pow(.95,this.zoomSpeed*Math.abs(S*.01))}_rotateLeft(S){this._sphericalDelta.theta-=S}_rotateUp(S){this._sphericalDelta.phi-=S}_panLeft(S,ca){J.setFromMatrixColumn(ca,0);J.multiplyScalar(-S);this._panOffset.add(J)}_panUp(S,ca){this.screenSpacePanning===!0?J.setFromMatrixColumn(ca,1):(J.setFromMatrixColumn(ca,0),J.crossVectors(this.object.up,J));J.multiplyScalar(S);this._panOffset.add(J)}_pan(S,
ca){const V=this.domElement;if(this.object.isPerspectiveCamera){J.copy(this.object.position).sub(this.target);let xa=J.length();xa*=Math.tan(this.object.fov/2*Math.PI/180);this._panLeft(2*S*xa/V.clientHeight,this.object.matrix);this._panUp(2*ca*xa/V.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(S*(this.object.right-this.object.left)/this.object.zoom/V.clientWidth,this.object.matrix),this._panUp(ca*(this.object.top-this.object.bottom)/this.object.zoom/V.clientHeight,
this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(S){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=S:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(S){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=S:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),
this.enableZoom=!1)}_updateZoomParameters(S,ca){if(this.zoomToCursor){this._performCursorZoom=!0;var V=this.domElement.getBoundingClientRect();ca-=V.top;var xa=V.height;this._mouse.x=(S-V.left)/V.width*2-1;this._mouse.y=-(ca/xa)*2+1;this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}}_clampDistance(S){return Math.max(this.minDistance,Math.min(this.maxDistance,S))}_handleMouseDownRotate(S){this._rotateStart.set(S.clientX,S.clientY)}_handleMouseDownDolly(S){this._updateZoomParameters(S.clientX,
S.clientX);this._dollyStart.set(S.clientX,S.clientY)}_handleMouseDownPan(S){this._panStart.set(S.clientX,S.clientY)}_handleMouseMoveRotate(S){this._rotateEnd.set(S.clientX,S.clientY);this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);S=this.domElement;this._rotateLeft(W*this._rotateDelta.x/S.clientHeight);this._rotateUp(W*this._rotateDelta.y/S.clientHeight);this._rotateStart.copy(this._rotateEnd);this.update()}_handleMouseMoveDolly(S){this._dollyEnd.set(S.clientX,
S.clientY);this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart);this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y));this._dollyStart.copy(this._dollyEnd);this.update()}_handleMouseMovePan(S){this._panEnd.set(S.clientX,S.clientY);this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed);this._pan(this._panDelta.x,this._panDelta.y);this._panStart.copy(this._panEnd);
this.update()}_handleMouseWheel(S){this._updateZoomParameters(S.clientX,S.clientY);S.deltaY<0?this._dollyIn(this._getZoomScale(S.deltaY)):S.deltaY>0&&this._dollyOut(this._getZoomScale(S.deltaY));this.update()}_handleKeyDown(S){let ca=!1;switch(S.code){case this.keys.UP:S.ctrlKey||S.metaKey||S.shiftKey?this.enableRotate&&this._rotateUp(W*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed);ca=!0;break;case this.keys.BOTTOM:S.ctrlKey||S.metaKey||S.shiftKey?
this.enableRotate&&this._rotateUp(-W*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed);ca=!0;break;case this.keys.LEFT:S.ctrlKey||S.metaKey||S.shiftKey?this.enableRotate&&this._rotateLeft(W*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0);ca=!0;break;case this.keys.RIGHT:S.ctrlKey||S.metaKey||S.shiftKey?this.enableRotate&&this._rotateLeft(-W*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&
this._pan(-this.keyPanSpeed,0),ca=!0}ca&&(S.preventDefault(),this.update())}_handleTouchStartRotate(S){if(this._pointers.length===1)this._rotateStart.set(S.pageX,S.pageY);else{const ca=this._getSecondPointerPosition(S);this._rotateStart.set(.5*(S.pageX+ca.x),.5*(S.pageY+ca.y))}}_handleTouchStartPan(S){if(this._pointers.length===1)this._panStart.set(S.pageX,S.pageY);else{const ca=this._getSecondPointerPosition(S);this._panStart.set(.5*(S.pageX+ca.x),.5*(S.pageY+ca.y))}}_handleTouchStartDolly(S){const ca=
this._getSecondPointerPosition(S),V=S.pageX-ca.x;S=S.pageY-ca.y;this._dollyStart.set(0,Math.sqrt(V*V+S*S))}_handleTouchStartDollyPan(S){this.enableZoom&&this._handleTouchStartDolly(S);this.enablePan&&this._handleTouchStartPan(S)}_handleTouchStartDollyRotate(S){this.enableZoom&&this._handleTouchStartDolly(S);this.enableRotate&&this._handleTouchStartRotate(S)}_handleTouchMoveRotate(S){if(this._pointers.length==1)this._rotateEnd.set(S.pageX,S.pageY);else{const ca=this._getSecondPointerPosition(S);this._rotateEnd.set(.5*
(S.pageX+ca.x),.5*(S.pageY+ca.y))}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);S=this.domElement;this._rotateLeft(W*this._rotateDelta.x/S.clientHeight);this._rotateUp(W*this._rotateDelta.y/S.clientHeight);this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(S){if(this._pointers.length===1)this._panEnd.set(S.pageX,S.pageY);else{const ca=this._getSecondPointerPosition(S);this._panEnd.set(.5*(S.pageX+ca.x),.5*(S.pageY+ca.y))}this._panDelta.subVectors(this._panEnd,
this._panStart).multiplyScalar(this.panSpeed);this._pan(this._panDelta.x,this._panDelta.y);this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(S){const ca=this._getSecondPointerPosition(S),V=S.pageX-ca.x,xa=S.pageY-ca.y;this._dollyEnd.set(0,Math.sqrt(V*V+xa*xa));this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed));this._dollyOut(this._dollyDelta.y);this._dollyStart.copy(this._dollyEnd);this._updateZoomParameters((S.pageX+ca.x)*.5,(S.pageY+ca.y)*.5)}_handleTouchMoveDollyPan(S){this.enableZoom&&
this._handleTouchMoveDolly(S);this.enablePan&&this._handleTouchMovePan(S)}_handleTouchMoveDollyRotate(S){this.enableZoom&&this._handleTouchMoveDolly(S);this.enableRotate&&this._handleTouchMoveRotate(S)}_addPointer(S){this._pointers.push(S.pointerId)}_removePointer(S){delete this._pointerPositions[S.pointerId];for(let ca=0;ca<this._pointers.length;ca++)if(this._pointers[ca]==S.pointerId){this._pointers.splice(ca,1);break}}_isTrackingPointer(S){for(let ca=0;ca<this._pointers.length;ca++)if(this._pointers[ca]==
S.pointerId)return!0;return!1}_trackPointer(S){let ca=this._pointerPositions[S.pointerId];ca===void 0&&(ca=new B.Vector2,this._pointerPositions[S.pointerId]=ca);ca.set(S.pageX,S.pageY)}_getSecondPointerPosition(S){return this._pointerPositions[S.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0]]}_customWheelEvent(S){const ca={clientX:S.clientX,clientY:S.clientY,deltaY:S.deltaY};switch(S.deltaMode){case 1:ca.deltaY*=16;break;case 2:ca.deltaY*=100}S.ctrlKey&&!this._controlActive&&(ca.deltaY*=
10);return ca}}};
shadow$provide[542]=function(l,L,q){function x(ra){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(ra.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(ra),ra.pointerType==="touch"?this._onTouchStart(ra):this._onMouseDown(ra))}function r(ra){this.enabled!==!1&&(ra.pointerType==="touch"?this._onTouchMove(ra):this._onMouseMove(ra))}function e(ra){this.enabled!==
!1&&(ra.pointerType==="touch"?this._onTouchEnd(ra):this._onMouseUp(),this._removePointer(ra),this._pointers.length===0&&(this.domElement.releasePointerCapture(ra.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function g(ra){this._removePointer(ra)}function f(){this.enabled!==!1&&(this.keyState=O.NONE,window.addEventListener("keydown",this._onKeyDown))}function k(ra){this.enabled!==!1&&(window.removeEventListener("keydown",
this._onKeyDown),this.keyState===O.NONE)&&(ra.code!==this.keys[O.ROTATE]||this.noRotate?ra.code!==this.keys[O.ZOOM]||this.noZoom?ra.code!==this.keys[O.PAN]||this.noPan||(this.keyState=O.PAN):this.keyState=O.ZOOM:this.keyState=O.ROTATE)}function m(ra){switch(ra.button){case 0:var Ea=this.mouseButtons.LEFT;break;case 1:Ea=this.mouseButtons.MIDDLE;break;case 2:Ea=this.mouseButtons.RIGHT;break;default:Ea=-1}switch(Ea){case G.MOUSE.DOLLY:this.state=O.ZOOM;break;case G.MOUSE.ROTATE:this.state=O.ROTATE;
break;case G.MOUSE.PAN:this.state=O.PAN;break;default:this.state=O.NONE}Ea=this.keyState!==O.NONE?this.keyState:this.state;Ea!==O.ROTATE||this.noRotate?Ea!==O.ZOOM||this.noZoom?Ea!==O.PAN||this.noPan||(this._panStart.copy(this._getMouseOnScreen(ra.pageX,ra.pageY)),this._panEnd.copy(this._panStart)):(this._zoomStart.copy(this._getMouseOnScreen(ra.pageX,ra.pageY)),this._zoomEnd.copy(this._zoomStart)):(this._moveCurr.copy(this._getMouseOnCircle(ra.pageX,ra.pageY)),this._movePrev.copy(this._moveCurr));
this.dispatchEvent(K)}function p(ra){const Ea=this.keyState!==O.NONE?this.keyState:this.state;Ea!==O.ROTATE||this.noRotate?Ea!==O.ZOOM||this.noZoom?Ea!==O.PAN||this.noPan||this._panEnd.copy(this._getMouseOnScreen(ra.pageX,ra.pageY)):this._zoomEnd.copy(this._getMouseOnScreen(ra.pageX,ra.pageY)):(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(ra.pageX,ra.pageY)))}function z(){this.state=O.NONE;this.dispatchEvent(Q)}function t(ra){if(this.enabled!==!1&&this.noZoom!==!0){ra.preventDefault();
switch(ra.deltaMode){case 2:this._zoomStart.y-=ra.deltaY*.025;break;case 1:this._zoomStart.y-=ra.deltaY*.01;break;default:this._zoomStart.y-=ra.deltaY*2.5E-4}this.dispatchEvent(K);this.dispatchEvent(Q)}}function v(ra){this.enabled!==!1&&ra.preventDefault()}function y(ra){this._trackPointer(ra);switch(this._pointers.length){case 1:this.state=O.TOUCH_ROTATE;this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY));this._movePrev.copy(this._moveCurr);break;default:this.state=
O.TOUCH_ZOOM_PAN;ra=this._pointers[0].pageX-this._pointers[1].pageX;const Ea=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(ra*ra+Ea*Ea);this._panStart.copy(this._getMouseOnScreen((this._pointers[0].pageX+this._pointers[1].pageX)/2,(this._pointers[0].pageY+this._pointers[1].pageY)/2));this._panEnd.copy(this._panStart)}this.dispatchEvent(K)}function B(ra){this._trackPointer(ra);switch(this._pointers.length){case 1:this._movePrev.copy(this._moveCurr);
this._moveCurr.copy(this._getMouseOnCircle(ra.pageX,ra.pageY));break;default:const Ea=this._getSecondPointerPosition(ra),Ua=ra.pageX-Ea.x,jb=ra.pageY-Ea.y;this._touchZoomDistanceEnd=Math.sqrt(Ua*Ua+jb*jb);this._panEnd.copy(this._getMouseOnScreen((ra.pageX+Ea.x)/2,(ra.pageY+Ea.y)/2))}}function D(ra){switch(this._pointers.length){case 0:this.state=O.NONE;break;case 1:this.state=O.TOUCH_ROTATE;this._moveCurr.copy(this._getMouseOnCircle(ra.pageX,ra.pageY));this._movePrev.copy(this._moveCurr);break;case 2:this.state=
O.TOUCH_ZOOM_PAN;for(let Ea=0;Ea<this._pointers.length;Ea++)if(this._pointers[Ea].pointerId!==ra.pointerId){ra=this._pointerPositions[this._pointers[Ea].pointerId];this._moveCurr.copy(this._getMouseOnCircle(ra.x,ra.y));this._movePrev.copy(this._moveCurr);break}}this.dispatchEvent(Q)}Object.defineProperties(q,{__esModule:{enumerable:!0,value:!0},TrackballControls:{enumerable:!0,get:function(){return pa}}});var G=l(101);const I={type:"change"},K={type:"start"},Q={type:"end"},O={NONE:-1,ROTATE:0,ZOOM:1,
PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},J=new G.Vector2,W=new G.Vector2,ba=new G.Vector3,Y=new G.Vector3,S=new G.Vector3,ca=new G.Quaternion,V=new G.Vector3,xa=new G.Vector3,na=new G.Vector3,N=new G.Vector3;class pa extends G.Controls{constructor(ra,Ea=null){super(ra,Ea);this.screen={left:0,top:0,width:0,height:0};this.rotateSpeed=1;this.zoomSpeed=1.2;this.panSpeed=.3;this.staticMoving=this.noPan=this.noZoom=this.noRotate=!1;this.dynamicDampingFactor=.2;this.minDistance=0;this.maxDistance=Infinity;
this.minZoom=0;this.maxZoom=Infinity;this.keys=["KeyA","KeyS","KeyD"];this.mouseButtons={LEFT:G.MOUSE.ROTATE,MIDDLE:G.MOUSE.DOLLY,RIGHT:G.MOUSE.PAN};this.target=new G.Vector3;this.keyState=this.state=O.NONE;this._lastPosition=new G.Vector3;this._lastZoom=1;this._lastAngle=this._touchZoomDistanceEnd=this._touchZoomDistanceStart=0;this._eye=new G.Vector3;this._movePrev=new G.Vector2;this._moveCurr=new G.Vector2;this._lastAxis=new G.Vector3;this._zoomStart=new G.Vector2;this._zoomEnd=new G.Vector2;this._panStart=
new G.Vector2;this._panEnd=new G.Vector2;this._pointers=[];this._pointerPositions={};this._onPointerMove=r.bind(this);this._onPointerDown=x.bind(this);this._onPointerUp=e.bind(this);this._onPointerCancel=g.bind(this);this._onContextMenu=v.bind(this);this._onMouseWheel=t.bind(this);this._onKeyDown=k.bind(this);this._onKeyUp=f.bind(this);this._onTouchStart=y.bind(this);this._onTouchMove=B.bind(this);this._onTouchEnd=D.bind(this);this._onMouseDown=m.bind(this);this._onMouseMove=p.bind(this);this._onMouseUp=
z.bind(this);this._target0=this.target.clone();this._position0=this.object.position.clone();this._up0=this.object.up.clone();this._zoom0=this.object.zoom;Ea!==null&&(this.connect(Ea),this.handleResize());this.update()}connect(ra){super.connect(ra);window.addEventListener("keydown",this._onKeyDown);window.addEventListener("keyup",this._onKeyUp);this.domElement.addEventListener("pointerdown",this._onPointerDown);this.domElement.addEventListener("pointercancel",this._onPointerCancel);this.domElement.addEventListener("wheel",
this._onMouseWheel,{passive:!1});this.domElement.addEventListener("contextmenu",this._onContextMenu);this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown);window.removeEventListener("keyup",this._onKeyUp);this.domElement.removeEventListener("pointerdown",this._onPointerDown);this.domElement.removeEventListener("pointermove",this._onPointerMove);this.domElement.removeEventListener("pointerup",this._onPointerUp);this.domElement.removeEventListener("pointercancel",
this._onPointerCancel);this.domElement.removeEventListener("wheel",this._onMouseWheel);this.domElement.removeEventListener("contextmenu",this._onContextMenu);this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const ra=this.domElement.getBoundingClientRect(),Ea=this.domElement.ownerDocument.documentElement;this.screen.left=ra.left+window.pageXOffset-Ea.clientLeft;this.screen.top=ra.top+window.pageYOffset-Ea.clientTop;this.screen.width=ra.width;this.screen.height=ra.height}update(){this._eye.subVectors(this.object.position,
this.target);this.noRotate||this._rotateCamera();this.noZoom||this._zoomCamera();this.noPan||this._panCamera();this.object.position.addVectors(this.target,this._eye);if(this.object.isPerspectiveCamera)this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>1E-6&&(this.dispatchEvent(I),this._lastPosition.copy(this.object.position));else if(this.object.isOrthographicCamera){if(this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>
1E-6||this._lastZoom!==this.object.zoom)this.dispatchEvent(I),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}else console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.keyState=this.state=O.NONE;this.target.copy(this._target0);this.object.position.copy(this._position0);this.object.up.copy(this._up0);this.object.zoom=this._zoom0;this.object.updateProjectionMatrix();this._eye.subVectors(this.object.position,this.target);this.object.lookAt(this.target);
this.dispatchEvent(I);this._lastPosition.copy(this.object.position);this._lastZoom=this.object.zoom}_panCamera(){W.copy(this._panEnd).sub(this._panStart);if(W.lengthSq()){if(this.object.isOrthographicCamera){const ra=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;W.x*=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth;W.y*=ra}W.multiplyScalar(this._eye.length()*this.panSpeed);Y.copy(this._eye).cross(this.object.up).setLength(W.x);Y.add(ba.copy(this.object.up).setLength(W.y));
this.object.position.add(Y);this.target.add(Y);this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(W.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){N.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let ra=N.length();ra?(this._eye.copy(this.object.position).sub(this.target),V.copy(this._eye).normalize(),xa.copy(this.object.up).normalize(),na.crossVectors(xa,V).normalize(),xa.setLength(this._moveCurr.y-
this._movePrev.y),na.setLength(this._moveCurr.x-this._movePrev.x),N.copy(xa.add(na)),S.crossVectors(N,this._eye).normalize(),ra*=this.rotateSpeed,ca.setFromAxisAngle(S,ra),this._eye.applyQuaternion(ca),this.object.up.applyQuaternion(ca),this._lastAxis.copy(S),this._lastAngle=ra):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),ca.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(ca),
this.object.up.applyQuaternion(ca));this._movePrev.copy(this._moveCurr)}_zoomCamera(){let ra;this.state===O.TOUCH_ZOOM_PAN?(ra=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(ra):this.object.isOrthographicCamera?(this.object.zoom=G.MathUtils.clamp(this.object.zoom/ra,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):
(ra=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,ra!==1&&ra>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(ra):this.object.isOrthographicCamera?(this.object.zoom=G.MathUtils.clamp(this.object.zoom/ra,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(ra,
Ea){J.set((ra-this.screen.left)/this.screen.width,(Ea-this.screen.top)/this.screen.height);return J}_getMouseOnCircle(ra,Ea){J.set((ra-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-Ea))/this.screen.width);return J}_addPointer(ra){this._pointers.push(ra)}_removePointer(ra){delete this._pointerPositions[ra.pointerId];for(let Ea=0;Ea<this._pointers.length;Ea++)if(this._pointers[Ea].pointerId==ra.pointerId){this._pointers.splice(Ea,1);break}}_trackPointer(ra){let Ea=
this._pointerPositions[ra.pointerId];Ea===void 0&&(Ea=new G.Vector2,this._pointerPositions[ra.pointerId]=Ea);Ea.set(ra.pageX,ra.pageY)}_getSecondPointerPosition(ra){return this._pointerPositions[(ra.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0]).pointerId]}_checkDistances(){this.noZoom&&this.noPan||(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),
this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}};
'use strict';
var cljs$cst$9631$Spherical = new $APP.cljs.core.Symbol(null, "Spherical", "Spherical", 1316206718, null), cljs$cst$9690$mathbox_DOT_primitives_SLASH_Resample = new $APP.cljs.core.Symbol("mathbox.primitives", "Resample", "mathbox.primitives/Resample", -1111983593, null), cljs$cst$9664$mathbox_DOT_primitives_SLASH_Scale = new $APP.cljs.core.Symbol("mathbox.primitives", "Scale", "mathbox.primitives/Scale", 570368639, null), cljs$cst$9619$Lerp = new $APP.cljs.core.Symbol(null, "Lerp", "Lerp", -1702516612, 
null), cljs$cst$9599$Shader = new $APP.cljs.core.Symbol(null, "Shader", "Shader", 1685374417, null), cljs$cst$9607$Axis = new $APP.cljs.core.Symbol(null, "Axis", "Axis", 1020368522, null), cljs$cst$9552$camera = new $APP.cljs.core.Keyword(null, "camera", "camera", -1190348585), cljs$cst$9632$mathbox_DOT_primitives_SLASH_Swizzle = new $APP.cljs.core.Symbol("mathbox.primitives", "Swizzle", "mathbox.primitives/Swizzle", 324393110, null), cljs$cst$9650$mathbox_DOT_primitives_SLASH_Line = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Line", "mathbox.primitives/Line", -1270459063, null), cljs$cst$9634$mathbox_DOT_primitives_SLASH_Rtt = new $APP.cljs.core.Symbol("mathbox.primitives", "Rtt", "mathbox.primitives/Rtt", -358152424, null), cljs$cst$9576$Point = new $APP.cljs.core.Symbol(null, "Point", "Point", -2145220521, null), cljs$cst$9622$Layer = new $APP.cljs.core.Symbol(null, "Layer", "Layer", -1498190011, null), cljs$cst$9568$mathbox_DOT_primitives = new $APP.cljs.core.Symbol(null, "mathbox.primitives", "mathbox.primitives", 
1541076194, null), cljs$cst$9617$Stereographic4 = new $APP.cljs.core.Symbol(null, "Stereographic4", "Stereographic4", -287163216, null), cljs$cst$9598$Voxel = new $APP.cljs.core.Symbol(null, "Voxel", "Voxel", 1540726319, null), cljs$cst$9605$Split = new $APP.cljs.core.Symbol(null, "Split", "Split", -1276645785, null), cljs$cst$9577$Subdivide = new $APP.cljs.core.Symbol(null, "Subdivide", "Subdivide", -462061977, null), cljs$cst$9611$Join = new $APP.cljs.core.Symbol(null, "Join", "Join", 767879419, 
null), cljs$cst$9655$mathbox_DOT_primitives_SLASH_Inherit = new $APP.cljs.core.Symbol("mathbox.primitives", "Inherit", "mathbox.primitives/Inherit", -191332945, null), cljs$cst$9609$Unit = new $APP.cljs.core.Symbol(null, "Unit", "Unit", 1086897223, null), cljs$cst$9591$Inherit = new $APP.cljs.core.Symbol(null, "Inherit", "Inherit", -1912525274, null), cljs$cst$9575$Retext = new $APP.cljs.core.Symbol(null, "Retext", "Retext", 571350357, null), cljs$cst$9626$Resample = new $APP.cljs.core.Symbol(null, 
"Resample", "Resample", -1271815010, null), cljs$cst$9639$mathbox_DOT_primitives_SLASH_Retext = new $APP.cljs.core.Symbol("mathbox.primitives", "Retext", "mathbox.primitives/Retext", 750297308, null), cljs$cst$9647$mathbox_DOT_primitives_SLASH_Surface = new $APP.cljs.core.Symbol("mathbox.primitives", "Surface", "mathbox.primitives/Surface", 1749844142, null), cljs$cst$9588$Polar = new $APP.cljs.core.Symbol(null, "Polar", "Polar", -382168682, null), cljs$cst$9640$mathbox_DOT_primitives_SLASH_Point = 
new $APP.cljs.core.Symbol("mathbox.primitives", "Point", "mathbox.primitives/Point", -2035787060, null), cljs$cst$9686$mathbox_DOT_primitives_SLASH_Layer = new $APP.cljs.core.Symbol("mathbox.primitives", "Layer", "mathbox.primitives/Layer", -1606831668, null), cljs$cst$9630$Clock = new $APP.cljs.core.Symbol(null, "Clock", "Clock", -1252752132, null), cljs$cst$9625$Now = new $APP.cljs.core.Symbol(null, "Now", "Now", 1010719241, null), cljs$cst$9666$mathbox_DOT_primitives_SLASH_Format = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Format", "mathbox.primitives/Format", -1307425389, null), cljs$cst$9550$max_distance = new $APP.cljs.core.Keyword(null, "max-distance", "max-distance", 848042358), cljs$cst$9556$threestrap = new $APP.cljs.core.Keyword(null, "threestrap", "threestrap", 791250519), cljs$cst$9574$Transform = new $APP.cljs.core.Symbol(null, "Transform", "Transform", -881921137, null), cljs$cst$9648$mathbox_DOT_primitives_SLASH_Cartesian = new $APP.cljs.core.Symbol("mathbox.primitives", "Cartesian", "mathbox.primitives/Cartesian", 
-1354081315, null), cljs$cst$9673$mathbox_DOT_primitives_SLASH_Unit = new $APP.cljs.core.Symbol("mathbox.primitives", "Unit", "mathbox.primitives/Unit", 2058437326, null), cljs$cst$9620$Memo = new $APP.cljs.core.Symbol(null, "Memo", "Memo", -56475788, null), cljs$cst$9595$Strip = new $APP.cljs.core.Symbol(null, "Strip", "Strip", 1159860619, null), cljs$cst$9638$mathbox_DOT_primitives_SLASH_Transform = new $APP.cljs.core.Symbol("mathbox.primitives", "Transform", "mathbox.primitives/Transform", -1243339258, 
null), cljs$cst$9566$MathBox = new $APP.cljs.core.Symbol(null, "MathBox", "MathBox", 1267820069, null), cljs$cst$9675$mathbox_DOT_primitives_SLASH_Join = new $APP.cljs.core.Symbol("mathbox.primitives", "Join", "mathbox.primitives/Join", 660585058, null), cljs$cst$9643$mathbox_DOT_primitives_SLASH_Slide = new $APP.cljs.core.Symbol("mathbox.primitives", "Slide", "mathbox.primitives/Slide", 1353572641, null), cljs$cst$9691$mathbox_DOT_primitives_SLASH_Slice = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Slice", "mathbox.primitives/Slice", -1294348699, null), cljs$cst$9596$Cartesian4 = new $APP.cljs.core.Symbol(null, "Cartesian4", "Cartesian4", 208408284, null), cljs$cst$9572$Face = new $APP.cljs.core.Symbol(null, "Face", "Face", 1066942710, null), cljs$cst$9646$mathbox_DOT_primitives_SLASH_Transform4 = new $APP.cljs.core.Symbol("mathbox.primitives", "Transform4", "mathbox.primitives/Transform4", -1869959749, null), cljs$cst$9683$mathbox_DOT_primitives_SLASH_Lerp = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Lerp", "mathbox.primitives/Lerp", -1827866933, null), cljs$cst$9580$Matrix = new $APP.cljs.core.Symbol(null, "Matrix", "Matrix", 2091502681, null), cljs$cst$9593$Grow = new $APP.cljs.core.Symbol(null, "Grow", "Grow", 508637906, null), cljs$cst$9583$Surface = new $APP.cljs.core.Symbol(null, "Surface", "Surface", 1673998871, null), cljs$cst$9555$container = new $APP.cljs.core.Keyword(null, "container", "container", -1736937707), cljs$cst$9600$Scale = new $APP.cljs.core.Symbol(null, "Scale", "Scale", 
662043888, null), cljs$cst$9581$Play = new $APP.cljs.core.Symbol(null, "Play", "Play", 3494344, null), cljs$cst$9608$Grid = new $APP.cljs.core.Symbol(null, "Grid", "Grid", -593239492, null), cljs$cst$9649$mathbox_DOT_primitives_SLASH_Label = new $APP.cljs.core.Symbol("mathbox.primitives", "Label", "mathbox.primitives/Label", -1901552196, null), cljs$cst$9688$mathbox_DOT_primitives_SLASH_Dom = new $APP.cljs.core.Symbol("mathbox.primitives", "Dom", "mathbox.primitives/Dom", -2079934705, null), cljs$cst$9612$Transpose = 
new $APP.cljs.core.Symbol(null, "Transpose", "Transpose", 213658457, null), cljs$cst$9573$Area = new $APP.cljs.core.Symbol(null, "Area", "Area", 1860906700, null), cljs$cst$9563$mathbox_DOT_core = new $APP.cljs.core.Symbol(null, "mathbox.core", "mathbox.core", -1346776612, null), cljs$cst$9671$mathbox_DOT_primitives_SLASH_Axis = new $APP.cljs.core.Symbol("mathbox.primitives", "Axis", "mathbox.primitives/Axis", 917185793, null), cljs$cst$9659$mathbox_DOT_primitives_SLASH_Strip = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Strip", "mathbox.primitives/Strip", 2075766272, null), cljs$cst$9653$mathbox_DOT_primitives_SLASH_Clamp = new $APP.cljs.core.Symbol("mathbox.primitives", "Clamp", "mathbox.primitives/Clamp", 1137063655, null), cljs$cst$9565$mathbox_DOT_core_SLASH_threestrap_defaults = new $APP.cljs.core.Symbol("mathbox.core", "threestrap-defaults", "mathbox.core/threestrap-defaults", 1294638534, null), cljs$cst$9594$Text = new $APP.cljs.core.Symbol(null, "Text", "Text", -2054460644, null), cljs$cst$9610$Vector = 
new $APP.cljs.core.Symbol(null, "Vector", "Vector", 872890327, null), cljs$cst$9645$mathbox_DOT_primitives_SLASH_Play = new $APP.cljs.core.Symbol("mathbox.primitives", "Play", "mathbox.primitives/Play", 180224833, null), cljs$cst$9672$mathbox_DOT_primitives_SLASH_Grid = new $APP.cljs.core.Symbol("mathbox.primitives", "Grid", "mathbox.primitives/Grid", -988235849, null), cljs$cst$9657$mathbox_DOT_primitives_SLASH_Grow = new $APP.cljs.core.Symbol("mathbox.primitives", "Grow", "mathbox.primitives/Grow", 
400222057, null), cljs$cst$9682$mathbox_DOT_primitives_SLASH_Reveal = new $APP.cljs.core.Symbol("mathbox.primitives", "Reveal", "mathbox.primitives/Reveal", 132115850, null), cljs$cst$9685$mathbox_DOT_primitives_SLASH_Fragment = new $APP.cljs.core.Symbol("mathbox.primitives", "Fragment", "mathbox.primitives/Fragment", 429273026, null), cljs$cst$9592$Html = new $APP.cljs.core.Symbol(null, "Html", "Html", -1695147201, null), cljs$cst$9603$Camera = new $APP.cljs.core.Symbol(null, "Camera", "Camera", 
-1408338669, null), cljs$cst$9628$Group = new $APP.cljs.core.Symbol(null, "Group", "Group", -1810497176, null), cljs$cst$9679$mathbox_DOT_primitives_SLASH_Interval = new $APP.cljs.core.Symbol("mathbox.primitives", "Interval", "mathbox.primitives/Interval", 1202840225, null), cljs$cst$9548$background_color = new $APP.cljs.core.Keyword(null, "background-color", "background-color", 570434026), cljs$cst$9661$mathbox_DOT_primitives_SLASH_Present = new $APP.cljs.core.Symbol("mathbox.primitives", "Present", 
"mathbox.primitives/Present", 15337402, null), cljs$cst$9668$mathbox_DOT_primitives_SLASH_Stereographic = new $APP.cljs.core.Symbol("mathbox.primitives", "Stereographic", "mathbox.primitives/Stereographic", 1764922406, null), cljs$cst$9644$mathbox_DOT_primitives_SLASH_Matrix = new $APP.cljs.core.Symbol("mathbox.primitives", "Matrix", "mathbox.primitives/Matrix", 1981821632, null), cljs$cst$9624$Dom = new $APP.cljs.core.Symbol(null, "Dom", "Dom", -1903068682, null), cljs$cst$9695$mathbox_DOT_primitives_SLASH_Spherical = 
new $APP.cljs.core.Symbol("mathbox.primitives", "Spherical", "mathbox.primitives/Spherical", 1157296007, null), cljs$cst$9642$mathbox_DOT_primitives_SLASH_Volume = new $APP.cljs.core.Symbol("mathbox.primitives", "Volume", "mathbox.primitives/Volume", 1655402604, null), cljs$cst$9676$mathbox_DOT_primitives_SLASH_Transpose = new $APP.cljs.core.Symbol("mathbox.primitives", "Transpose", "mathbox.primitives/Transpose", 104160466, null), cljs$cst$9637$mathbox_DOT_primitives_SLASH_Area = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Area", "mathbox.primitives/Area", 1617026373, null), cljs$cst$9547$controls = new $APP.cljs.core.Keyword(null, "controls", "controls", 1340701452), cljs$cst$9587$Mask = new $APP.cljs.core.Symbol(null, "Mask", "Mask", -375651427, null), cljs$cst$9629$Step = new $APP.cljs.core.Symbol(null, "Step", "Step", -816692470, null), cljs$cst$9606$Move = new $APP.cljs.core.Symbol(null, "Move", "Move", -687448615, null), cljs$cst$9635$mathbox_DOT_primitives_SLASH_Array = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Array", "mathbox.primitives/Array", -313915872, null), cljs$cst$9597$Present = new $APP.cljs.core.Symbol(null, "Present", "Present", -111102675, null), cljs$cst$9623$Compose = new $APP.cljs.core.Symbol(null, "Compose", "Compose", -248875139, null), cljs$cst$9615$Interval = new $APP.cljs.core.Symbol(null, "Interval", "Interval", 1278783288, null), cljs$cst$9560$containerClass = new $APP.cljs.core.Keyword(null, "containerClass", "containerClass", -101509595), cljs$cst$9674$mathbox_DOT_primitives_SLASH_Vector = 
new $APP.cljs.core.Symbol("mathbox.primitives", "Vector", "mathbox.primitives/Vector", 1032645708, null), cljs$cst$9601$View = new $APP.cljs.core.Symbol(null, "View", "View", -131475192, null), cljs$cst$9684$mathbox_DOT_primitives_SLASH_Memo = new $APP.cljs.core.Symbol("mathbox.primitives", "Memo", "mathbox.primitives/Memo", -500462083, null), cljs$cst$9667$mathbox_DOT_primitives_SLASH_Camera = new $APP.cljs.core.Symbol("mathbox.primitives", "Camera", "mathbox.primitives/Camera", -1433074788, null), 
cljs$cst$9562$scittle_DOT_mathbox_SLASH_mathbox = new $APP.cljs.core.Keyword("scittle.mathbox", "mathbox", "scittle.mathbox/mathbox", 441476252), cljs$cst$9692$mathbox_DOT_primitives_SLASH_Group = new $APP.cljs.core.Symbol("mathbox.primitives", "Group", "mathbox.primitives/Group", -1836231535, null), cljs$cst$9636$mathbox_DOT_primitives_SLASH_Face = new $APP.cljs.core.Symbol("mathbox.primitives", "Face", "mathbox.primitives/Face", 956501375, null), cljs$cst$9579$Slide = new $APP.cljs.core.Symbol(null, 
"Slide", "Slide", 1579331222, null), cljs$cst$9585$Label = new $APP.cljs.core.Symbol(null, "Label", "Label", -2133777657, null), cljs$cst$9584$Cartesian = new $APP.cljs.core.Symbol(null, "Cartesian", "Cartesian", -1514043068, null), cljs$cst$9627$Slice = new $APP.cljs.core.Symbol(null, "Slice", "Slice", -1270834964, null), cljs$cst$9641$mathbox_DOT_primitives_SLASH_Subdivide = new $APP.cljs.core.Symbol("mathbox.primitives", "Subdivide", "mathbox.primitives/Subdivide", -470832642, null), cljs$cst$9621$Fragment = 
new $APP.cljs.core.Symbol(null, "Fragment", "Fragment", 388889675, null), cljs$cst$9590$Ticks = new $APP.cljs.core.Symbol(null, "Ticks", "Ticks", -469763046, null), cljs$cst$9681$mathbox_DOT_primitives_SLASH_Stereographic4 = new $APP.cljs.core.Symbol("mathbox.primitives", "Stereographic4", "mathbox.primitives/Stereographic4", -462845377, null), cljs$cst$9604$Stereographic = new $APP.cljs.core.Symbol(null, "Stereographic", "Stereographic", 1739074233, null), cljs$cst$9665$mathbox_DOT_primitives_SLASH_View = 
new $APP.cljs.core.Symbol("mathbox.primitives", "View", "mathbox.primitives/View", -5042301, null), cljs$cst$9618$Reveal = new $APP.cljs.core.Symbol(null, "Reveal", "Reveal", 1011391251, null), cljs$cst$9582$Transform4 = new $APP.cljs.core.Symbol(null, "Transform4", "Transform4", -1726980308, null), cljs$cst$9616$Vertex = new $APP.cljs.core.Symbol(null, "Vertex", "Vertex", -512523831, null), cljs$cst$9558$containerId = new $APP.cljs.core.Keyword(null, "containerId", "containerId", 545549578), cljs$cst$9670$mathbox_DOT_primitives_SLASH_Move = 
new $APP.cljs.core.Symbol("mathbox.primitives", "Move", "mathbox.primitives/Move", -661788090, null), cljs$cst$9687$mathbox_DOT_primitives_SLASH_Compose = new $APP.cljs.core.Symbol("mathbox.primitives", "Compose", "mathbox.primitives/Compose", -2940428, null), cljs$cst$9678$mathbox_DOT_primitives_SLASH_Readback = new $APP.cljs.core.Symbol("mathbox.primitives", "Readback", "mathbox.primitives/Readback", -897225244, null), cljs$cst$9663$mathbox_DOT_primitives_SLASH_Shader = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Shader", "mathbox.primitives/Shader", -1697795990, null), cljs$cst$9561$f_GT_ = new $APP.cljs.core.Keyword(null, "f\x3e", "f\x3e", 1484564198), cljs$cst$9602$Format = new $APP.cljs.core.Symbol(null, "Format", "Format", -1182429160, null), cljs$cst$9564$threestrap_defaults = new $APP.cljs.core.Symbol(null, "threestrap-defaults", "threestrap-defaults", 1862651176, null), cljs$cst$9553$up = new $APP.cljs.core.Keyword(null, "up", "up", -269712113), cljs$cst$9694$mathbox_DOT_primitives_SLASH_Clock = 
new $APP.cljs.core.Symbol("mathbox.primitives", "Clock", "mathbox.primitives/Clock", -1930546827, null), cljs$cst$9689$mathbox_DOT_primitives_SLASH_Now = new $APP.cljs.core.Symbol("mathbox.primitives", "Now", "mathbox.primitives/Now", 933701808, null), cljs$cst$9549$background_opacity = new $APP.cljs.core.Keyword(null, "background-opacity", "background-opacity", -1073748756), cljs$cst$9559$containerStyle = new $APP.cljs.core.Keyword(null, "containerStyle", "containerStyle", -1828381609), cljs$cst$9554$plugins = 
new $APP.cljs.core.Keyword(null, "plugins", "plugins", 1900073717), cljs$cst$9662$mathbox_DOT_primitives_SLASH_Voxel = new $APP.cljs.core.Symbol("mathbox.primitives", "Voxel", "mathbox.primitives/Voxel", 1345267876, null), cljs$cst$9669$mathbox_DOT_primitives_SLASH_Split = new $APP.cljs.core.Symbol("mathbox.primitives", "Split", "mathbox.primitives/Split", -1183933028, null), cljs$cst$9654$mathbox_DOT_primitives_SLASH_Ticks = new $APP.cljs.core.Symbol("mathbox.primitives", "Ticks", "mathbox.primitives/Ticks", 
-361320827, null), cljs$cst$9677$mathbox_DOT_primitives_SLASH_Repeat = new $APP.cljs.core.Symbol("mathbox.primitives", "Repeat", "mathbox.primitives/Repeat", -1574268723, null), cljs$cst$9589$Clamp = new $APP.cljs.core.Symbol(null, "Clamp", "Clamp", 976282718, null), cljs$cst$9570$Spread = new $APP.cljs.core.Symbol(null, "Spread", "Spread", -1805618163, null), cljs$cst$9680$mathbox_DOT_primitives_SLASH_Vertex = new $APP.cljs.core.Symbol("mathbox.primitives", "Vertex", "mathbox.primitives/Vertex", 
-335881150, null), cljs$cst$9569$Swizzle = new $APP.cljs.core.Symbol(null, "Swizzle", "Swizzle", 450790761, null), cljs$cst$9567$mathbox_DOT_core_SLASH_MathBox = new $APP.cljs.core.Symbol("mathbox.core", "MathBox", "mathbox.core/MathBox", -1451256013, null), cljs$cst$9652$mathbox_DOT_primitives_SLASH_Polar = new $APP.cljs.core.Symbol("mathbox.primitives", "Polar", "mathbox.primitives/Polar", -1749556723, null), cljs$cst$9658$mathbox_DOT_primitives_SLASH_Text = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Text", "mathbox.primitives/Text", -1961772649, null), cljs$cst$9660$mathbox_DOT_primitives_SLASH_Cartesian4 = new $APP.cljs.core.Symbol("mathbox.primitives", "Cartesian4", "mathbox.primitives/Cartesian4", 115701845, null), cljs$cst$9614$Readback = new $APP.cljs.core.Symbol(null, "Readback", "Readback", -1069768581, null), cljs$cst$9586$Line = new $APP.cljs.core.Symbol(null, "Line", "Line", -1076951502, null), cljs$cst$9693$mathbox_DOT_primitives_SLASH_Step = new $APP.cljs.core.Symbol("mathbox.primitives", 
"Step", "mathbox.primitives/Step", -181856637, null), cljs$cst$9651$mathbox_DOT_primitives_SLASH_Mask = new $APP.cljs.core.Symbol("mathbox.primitives", "Mask", "mathbox.primitives/Mask", -149597162, null), cljs$cst$9551$rotate_speed = new $APP.cljs.core.Keyword(null, "rotate-speed", "rotate-speed", -564390296), cljs$cst$9571$Rtt = new $APP.cljs.core.Symbol(null, "Rtt", "Rtt", -483528305, null), cljs$cst$9656$mathbox_DOT_primitives_SLASH_Html = new $APP.cljs.core.Symbol("mathbox.primitives", "Html", 
"mathbox.primitives/Html", -1603447226, null), cljs$cst$9633$mathbox_DOT_primitives_SLASH_Spread = new $APP.cljs.core.Symbol("mathbox.primitives", "Spread", "mathbox.primitives/Spread", 1809426052, null), cljs$cst$9578$Volume = new $APP.cljs.core.Symbol(null, "Volume", "Volume", 1797394167, null), cljs$cst$9613$Repeat = new $APP.cljs.core.Symbol(null, "Repeat", "Repeat", -1413718092, null);
var module$node_modules$three$build$three_cjs = $APP.shadow.js.require(101, {});
var module$node_modules$mathbox_react$build$cjs$index = $APP.shadow.js.require(540, {});
var module$node_modules$three$examples$jsm$controls$OrbitControls = $APP.shadow.js.require(541, {});
var module$node_modules$three$examples$jsm$controls$TrackballControls = $APP.shadow.js.require(542, {});
var mathbox = {types:{}};
mathbox.types.__GT_color = function($color$$) {
  return $APP.cljs.core.truth_($color$$.isColor) ? $color$$ : new module$node_modules$three$build$three_cjs.Color($color$$);
};
mathbox.hooks = {};
mathbox.hooks.split_map = function($m$jscomp$650_without$$, $ks$$) {
  var $with$$$ = $APP.cljs.core.select_keys($m$jscomp$650_without$$, $ks$$);
  $m$jscomp$650_without$$ = $APP.cljs.core.apply.cljs$core$IFn$_invoke$arity$3($APP.cljs.core.dissoc, $m$jscomp$650_without$$, $ks$$);
  return new $APP.cljs.core.PersistentVector(null, 2, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$with$$$, $m$jscomp$650_without$$], null);
};
mathbox.hooks.hook_keys = new $APP.cljs.core.PersistentVector(null, 4, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$APP.cljs$cst$1760$renderer, cljs$cst$9547$controls, $APP.cljs$cst$1752$on, $APP.cljs$cst$4791$ref], null);
mathbox.hooks.split_config = function($m$$) {
  return mathbox.hooks.split_map($m$$, mathbox.hooks.hook_keys);
};
mathbox.hooks.refHook = function($box$$, $ref$$) {
  return $APP.module$react.useEffect(function() {
    $APP.cljs.core.truth_($ref$$) && ($ref$$.cljs$core$IFn$_invoke$arity$1 ? $ref$$.cljs$core$IFn$_invoke$arity$1($box$$) : $ref$$.call(null, $box$$));
    if ($APP.cljs.core.truth_($box$$)) {
      return function() {
        return $APP.cljs.core.truth_($ref$$) ? $ref$$.cljs$core$IFn$_invoke$arity$1 ? $ref$$.cljs$core$IFn$_invoke$arity$1(null) : $ref$$.call(null, null) : null;
      };
    }
  }, [$box$$]);
};
mathbox.hooks.configureRenderer = function($box$$, $map__114331__$1_p__114330$$) {
  $map__114331__$1_p__114330$$ = $APP.cljs.core.__destructure_map($map__114331__$1_p__114330$$);
  var $color$$ = $APP.cljs.core.get.cljs$core$IFn$_invoke$arity$2($map__114331__$1_p__114330$$, cljs$cst$9548$background_color), $opacity$$ = $APP.cljs.core.get.cljs$core$IFn$_invoke$arity$2($map__114331__$1_p__114330$$, cljs$cst$9549$background_opacity);
  return $APP.module$react.useEffect(function() {
    if ($APP.cljs.core.truth_($box$$)) {
      var $gl_114370$$ = $box$$.three.renderer;
      if ($APP.cljs.core.truth_($color$$)) {
        var $JSCompiler_temp_const$$ = $gl_114370$$.setClearColor, $JSCompiler_temp_const$jscomp$0$$ = mathbox.types.__GT_color($color$$);
        var $JSCompiler_inline_result$$ = $APP.cljs.core.truth_($opacity$$) ? $opacity$$ : $gl_114370$$.getClearAlpha();
        $JSCompiler_temp_const$$.call($gl_114370$$, $JSCompiler_temp_const$jscomp$0$$, $JSCompiler_inline_result$$);
      } else {
        $APP.cljs.core.truth_($opacity$$) && $gl_114370$$.setClearAlpha($opacity$$);
      }
    }
  }, [$box$$, $color$$, $opacity$$]);
};
mathbox.hooks.control_effect = function($box$$, $k$$, $v$$) {
  return function() {
    var $JSCompiler_temp_const$$ = $APP.cljs.core, $JSCompiler_temp_const$jscomp$0$$ = $JSCompiler_temp_const$$.truth_;
    var $JSCompiler_inline_result$$ = $APP.cljs.core.truth_($box$$) ? $v$$ : $box$$;
    $JSCompiler_temp_const$jscomp$0$$.call($JSCompiler_temp_const$$, $JSCompiler_inline_result$$) && ($box$$.three.controls[$k$$] = $v$$);
  };
};
mathbox.hooks.configureControls = function($box$$, $max_distance_p__114335$$) {
  var $map__114336__$1_rotate_speed$$ = $APP.cljs.core.__destructure_map($max_distance_p__114335$$);
  $max_distance_p__114335$$ = $APP.cljs.core.get.cljs$core$IFn$_invoke$arity$2($map__114336__$1_rotate_speed$$, cljs$cst$9550$max_distance);
  $map__114336__$1_rotate_speed$$ = $APP.cljs.core.get.cljs$core$IFn$_invoke$arity$2($map__114336__$1_rotate_speed$$, cljs$cst$9551$rotate_speed);
  $APP.module$react.useEffect(mathbox.hooks.control_effect($box$$, "maxDistance", $max_distance_p__114335$$), [$box$$, $max_distance_p__114335$$]);
  return $APP.module$react.useEffect(mathbox.hooks.control_effect($box$$, "rotateSpeed", $map__114336__$1_rotate_speed$$), [$box$$, $map__114336__$1_rotate_speed$$]);
};
mathbox.hooks.configureEvents = function($box$$, $event_m$$) {
  return $APP.module$react.useEffect(function() {
    if ($APP.cljs.core.truth_($APP.cljs.core.truth_($box$$) ? $APP.cljs.core.seq($event_m$$) : $box$$)) {
      for (var $G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$ = $APP.cljs.core.seq($event_m$$), $G__114392_chunk__114338_114378_k_114396$$ = null, $G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$ = 0, $i__114340_114380$$ = 0;;) {
        if ($i__114340_114380$$ < $G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$) {
          var $f_114383_vec__114347_114381$$ = $G__114392_chunk__114338_114378_k_114396$$.cljs$core$IIndexed$_nth$arity$2(null, $i__114340_114380$$), $k_114382$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($f_114383_vec__114347_114381$$, 0, null);
          $f_114383_vec__114347_114381$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($f_114383_vec__114347_114381$$, 1, null);
          $box$$.three.on($APP.cljs.core.name($k_114382$$), $f_114383_vec__114347_114381$$);
          $i__114340_114380$$ += 1;
        } else {
          if ($G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$ = $APP.cljs.core.seq($G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$)) {
            $APP.cljs.core.chunked_seq_QMARK_($G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$) ? ($G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$ = $APP.cljs.core.chunk_first($G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$), $G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$ = $APP.cljs.core.chunk_rest($G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$), 
            $G__114392_chunk__114338_114378_k_114396$$ = $G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$, $G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$ = $APP.cljs.core.count($G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$)) : ($G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$ = $APP.cljs.core.first($G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$), 
            $G__114392_chunk__114338_114378_k_114396$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$, 0, null), $G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$, 1, null), $box$$.three.on($APP.cljs.core.name($G__114392_chunk__114338_114378_k_114396$$), 
            $G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$), $G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$ = $APP.cljs.core.next($G__114391_seq__114337_114377_seq__114337_114389__$1_temp__5825__auto___114388$$), $G__114392_chunk__114338_114378_k_114396$$ = null, $G__114393_c__5548__auto___114390_count__114339_114379_f_114397_vec__114350_114395$$ = 0), $i__114340_114380$$ = 0;
          } else {
            break;
          }
        }
      }
      return function() {
        for (var $G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$ = $APP.cljs.core.seq($event_m$$), $c__5548__auto__$$ = null, $G__114408_count__114355$$ = 0, $i__114356$$ = 0;;) {
          if ($i__114356$$ < $G__114408_count__114355$$) {
            var $f$$ = $c__5548__auto__$$.cljs$core$IIndexed$_nth$arity$2(null, $i__114356$$), $G__114407_k$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($f$$, 0, null);
            $f$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($f$$, 1, null);
            $box$$.three.off($APP.cljs.core.name($G__114407_k$$), $f$$);
            $i__114356$$ += 1;
          } else {
            if ($G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$ = $APP.cljs.core.seq($G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$)) {
              $APP.cljs.core.chunked_seq_QMARK_($G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$) ? ($c__5548__auto__$$ = $APP.cljs.core.chunk_first($G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$), $G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$ = $APP.cljs.core.chunk_rest($G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$), $G__114407_k$$ = $c__5548__auto__$$, $G__114408_count__114355$$ = $APP.cljs.core.count($c__5548__auto__$$), $c__5548__auto__$$ = 
              $G__114407_k$$) : ($c__5548__auto__$$ = $APP.cljs.core.first($G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$), $G__114407_k$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($c__5548__auto__$$, 0, null), $f$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($c__5548__auto__$$, 1, null), $box$$.three.off($APP.cljs.core.name($G__114407_k$$), $f$$), $G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$ = $APP.cljs.core.next($G__114406_seq__114353_seq__114353__$1_temp__5825__auto__$$), 
              $c__5548__auto__$$ = null, $G__114408_count__114355$$ = 0), $i__114356$$ = 0;
            } else {
              return null;
            }
          }
        }
      };
    }
  }, [$box$$, $event_m$$]);
};
mathbox.hooks.install_hooks = function($box$$, $config$$) {
  mathbox.hooks.refHook($box$$, $APP.cljs$cst$4791$ref.cljs$core$IFn$_invoke$arity$1($config$$));
  mathbox.hooks.configureRenderer($box$$, $APP.cljs$cst$1760$renderer.cljs$core$IFn$_invoke$arity$1($config$$));
  mathbox.hooks.configureControls($box$$, cljs$cst$9547$controls.cljs$core$IFn$_invoke$arity$1($config$$));
  mathbox.hooks.configureEvents($box$$, $APP.cljs$cst$1752$on.cljs$core$IFn$_invoke$arity$1($config$$));
  return $box$$;
};
mathbox.core = {};
mathbox.core.update_if_exists = function($m$$, $ks$$, $f$$) {
  var $temp__5823__auto__$$ = $APP.cljs.core.get_in.cljs$core$IFn$_invoke$arity$2($m$$, $ks$$);
  return $APP.cljs.core.truth_($temp__5823__auto__$$) ? $APP.cljs.core.assoc_in($m$$, $ks$$, $f$$.cljs$core$IFn$_invoke$arity$1 ? $f$$.cljs$core$IFn$_invoke$arity$1($temp__5823__auto__$$) : $f$$.call(null, $temp__5823__auto__$$)) : $m$$;
};
mathbox.core.k__GT_control = function($k$$) {
  switch($k$$ instanceof $APP.cljs.core.Keyword ? $k$$.fqn : null) {
    case "orbit":
      return module$node_modules$three$examples$jsm$controls$OrbitControls.OrbitControls;
    case "trackball":
      return module$node_modules$three$examples$jsm$controls$TrackballControls.TrackballControls;
    default:
      return $k$$;
  }
};
mathbox.core.update_threestrap = function($m$$) {
  return mathbox.core.update_if_exists(mathbox.core.update_if_exists($m$$, new $APP.cljs.core.PersistentVector(null, 2, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [cljs$cst$9547$controls, $APP.cljs$cst$1504$klass], null), mathbox.core.k__GT_control), new $APP.cljs.core.PersistentVector(null, 2, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [cljs$cst$9552$camera, cljs$cst$9553$up], null), function($v$jscomp$1176_z$$) {
    if ($APP.cljs.core.vector_QMARK_($v$jscomp$1176_z$$)) {
      var $x$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($v$jscomp$1176_z$$, 0, null), $y$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($v$jscomp$1176_z$$, 1, null);
      $v$jscomp$1176_z$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($v$jscomp$1176_z$$, 2, null);
      return new module$node_modules$three$build$three_cjs.Vector3($x$$, $y$$, $v$jscomp$1176_z$$);
    }
    return $v$jscomp$1176_z$$;
  });
};
mathbox.core.threestrap_defaults = new $APP.cljs.core.PersistentArrayMap(null, 2, [cljs$cst$9554$plugins, new $APP.cljs.core.PersistentVector(null, 3, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, ["core", "controls", "cursor"], null), cljs$cst$9547$controls, new $APP.cljs.core.PersistentArrayMap(null, 1, [$APP.cljs$cst$1504$klass, module$node_modules$three$examples$jsm$controls$OrbitControls.OrbitControls], null)], null);
mathbox.core.RawBox = function($var_args$$) {
  for (var $args__5755__auto__$jscomp$546_argseq__5756__auto__$$ = [], $len__5749__auto___114454$$ = arguments.length, $i__5750__auto___114455$$ = 0;;) {
    if ($i__5750__auto___114455$$ < $len__5749__auto___114454$$) {
      $args__5755__auto__$jscomp$546_argseq__5756__auto__$$.push(arguments[$i__5750__auto___114455$$]), $i__5750__auto___114455$$ += 1;
    } else {
      break;
    }
  }
  $args__5755__auto__$jscomp$546_argseq__5756__auto__$$ = 1 < $args__5755__auto__$jscomp$546_argseq__5756__auto__$$.length ? new $APP.cljs.core.IndexedSeq($args__5755__auto__$jscomp$546_argseq__5756__auto__$$.slice(1), 0, null) : null;
  return mathbox.core.RawBox.cljs$core$IFn$_invoke$arity$variadic(arguments[0], $args__5755__auto__$jscomp$546_argseq__5756__auto__$$);
};
mathbox.core.RawBox.cljs$core$IFn$_invoke$arity$variadic = function($container$$, $children$$) {
  var $map__114439__$1_props__$1$$ = $APP.cljs.core.__destructure_map($container$$);
  $container$$ = $APP.cljs.core.get.cljs$core$IFn$_invoke$arity$2($map__114439__$1_props__$1$$, cljs$cst$9555$container);
  var $threestrap$$ = $APP.cljs.core.get.cljs$core$IFn$_invoke$arity$2($map__114439__$1_props__$1$$, cljs$cst$9556$threestrap);
  $map__114439__$1_props__$1$$ = $APP.cljs.core.assoc.cljs$core$IFn$_invoke$arity$3($APP.cljs.core.dissoc.cljs$core$IFn$_invoke$arity$variadic($map__114439__$1_props__$1$$, cljs$cst$9555$container, $APP.cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs$cst$9556$threestrap], 0)), $APP.cljs$cst$1416$options, $threestrap$$);
  if ($container$$ == null) {
    return $APP.cljs.core.into.cljs$core$IFn$_invoke$arity$2(new $APP.cljs.core.PersistentVector(null, 3, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$APP.cljs$cst$9557$_GT_, module$node_modules$mathbox_react$build$cjs$index.ContainedMathbox, $map__114439__$1_props__$1$$], null), $children$$);
  }
  if ($APP.cljs.core.map_QMARK_($container$$)) {
    return $container$$ = $APP.cljs.core.assoc.cljs$core$IFn$_invoke$arity$variadic($map__114439__$1_props__$1$$, cljs$cst$9558$containerId, $APP.cljs$cst$396$id.cljs$core$IFn$_invoke$arity$1($container$$), $APP.cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs$cst$9559$containerStyle, $APP.cljs$cst$1728$style.cljs$core$IFn$_invoke$arity$1($container$$), cljs$cst$9560$containerClass, $APP.cljs$cst$450$class.cljs$core$IFn$_invoke$arity$1($container$$)], 0)), $APP.cljs.core.into.cljs$core$IFn$_invoke$arity$2(new $APP.cljs.core.PersistentVector(null, 
    3, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$APP.cljs$cst$9557$_GT_, module$node_modules$mathbox_react$build$cjs$index.ContainedMathbox, $container$$], null), $children$$);
  }
  if ($container$$ instanceof HTMLElement) {
    return $APP.cljs.core.into.cljs$core$IFn$_invoke$arity$2(new $APP.cljs.core.PersistentVector(null, 3, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$APP.cljs$cst$9557$_GT_, module$node_modules$mathbox_react$build$cjs$index.Mathbox, $map__114439__$1_props__$1$$], null), $children$$);
  }
  throw $APP.cljs.core.ex_info.cljs$core$IFn$_invoke$arity$2("Unsupported container : ", new $APP.cljs.core.PersistentArrayMap(null, 1, [cljs$cst$9555$container, $container$$], null));
};
mathbox.core.RawBox.cljs$lang$maxFixedArity = 1;
mathbox.core.RawBox.cljs$lang$applyTo = function($seq114436_seq114436__$1$$) {
  var $G__114437$$ = $APP.cljs.core.first($seq114436_seq114436__$1$$);
  $seq114436_seq114436__$1$$ = $APP.cljs.core.next($seq114436_seq114436__$1$$);
  return this.cljs$core$IFn$_invoke$arity$variadic($G__114437$$, $seq114436_seq114436__$1$$);
};
mathbox.core.MathBox_STAR_ = function($var_args$$) {
  for (var $args__5755__auto__$jscomp$547_argseq__5756__auto__$$ = [], $len__5749__auto___114457$$ = arguments.length, $i__5750__auto___114458$$ = 0;;) {
    if ($i__5750__auto___114458$$ < $len__5749__auto___114457$$) {
      $args__5755__auto__$jscomp$547_argseq__5756__auto__$$.push(arguments[$i__5750__auto___114458$$]), $i__5750__auto___114458$$ += 1;
    } else {
      break;
    }
  }
  $args__5755__auto__$jscomp$547_argseq__5756__auto__$$ = 1 < $args__5755__auto__$jscomp$547_argseq__5756__auto__$$.length ? new $APP.cljs.core.IndexedSeq($args__5755__auto__$jscomp$547_argseq__5756__auto__$$.slice(1), 0, null) : null;
  return mathbox.core.MathBox_STAR_.cljs$core$IFn$_invoke$arity$variadic(arguments[0], $args__5755__auto__$jscomp$547_argseq__5756__auto__$$);
};
mathbox.core.MathBox_STAR_.cljs$core$IFn$_invoke$arity$variadic = function($hook_config_props$$, $children$$) {
  var $props__$2$$ = $APP.module$react.useState(null), $box$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($props__$2$$, 0, null);
  $props__$2$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($props__$2$$, 1, null);
  var $props__$1$$ = mathbox.hooks.split_config($hook_config_props$$);
  $hook_config_props$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($props__$1$$, 0, null);
  $props__$1$$ = $APP.cljs.core.nth.cljs$core$IFn$_invoke$arity$3($props__$1$$, 1, null);
  $props__$2$$ = $APP.cljs.core.update.cljs$core$IFn$_invoke$arity$3($APP.cljs.core.assoc.cljs$core$IFn$_invoke$arity$3($props__$1$$, $APP.cljs$cst$4791$ref, $props__$2$$), cljs$cst$9556$threestrap, function($m$$) {
    return $APP.cljs.core.truth_($m$$) ? $APP.cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic($APP.cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([mathbox.core.threestrap_defaults, mathbox.core.update_threestrap($m$$)], 0)) : mathbox.core.threestrap_defaults;
  });
  mathbox.hooks.install_hooks($box$$, $hook_config_props$$);
  return $APP.cljs.core.into.cljs$core$IFn$_invoke$arity$2(new $APP.cljs.core.PersistentVector(null, 2, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [mathbox.core.RawBox, $props__$2$$], null), $children$$);
};
mathbox.core.MathBox_STAR_.cljs$lang$maxFixedArity = 1;
mathbox.core.MathBox_STAR_.cljs$lang$applyTo = function($seq114443_seq114443__$1$$) {
  var $G__114444$$ = $APP.cljs.core.first($seq114443_seq114443__$1$$);
  $seq114443_seq114443__$1$$ = $APP.cljs.core.next($seq114443_seq114443__$1$$);
  return this.cljs$core$IFn$_invoke$arity$variadic($G__114444$$, $seq114443_seq114443__$1$$);
};
mathbox.core.MathBox = function($var_args$$) {
  for (var $args__5755__auto__$jscomp$548_argseq__5756__auto__$$ = [], $len__5749__auto___114460$$ = arguments.length, $i__5750__auto___114461$$ = 0;;) {
    if ($i__5750__auto___114461$$ < $len__5749__auto___114460$$) {
      $args__5755__auto__$jscomp$548_argseq__5756__auto__$$.push(arguments[$i__5750__auto___114461$$]), $i__5750__auto___114461$$ += 1;
    } else {
      break;
    }
  }
  $args__5755__auto__$jscomp$548_argseq__5756__auto__$$ = 1 < $args__5755__auto__$jscomp$548_argseq__5756__auto__$$.length ? new $APP.cljs.core.IndexedSeq($args__5755__auto__$jscomp$548_argseq__5756__auto__$$.slice(1), 0, null) : null;
  return mathbox.core.MathBox.cljs$core$IFn$_invoke$arity$variadic(arguments[0], $args__5755__auto__$jscomp$548_argseq__5756__auto__$$);
};
mathbox.core.MathBox.cljs$core$IFn$_invoke$arity$variadic = function($props$$, $children$$) {
  return $APP.cljs.core.into.cljs$core$IFn$_invoke$arity$2(new $APP.cljs.core.PersistentVector(null, 3, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [cljs$cst$9561$f_GT_, mathbox.core.MathBox_STAR_, $props$$], null), $children$$);
};
mathbox.core.MathBox.cljs$lang$maxFixedArity = 1;
mathbox.core.MathBox.cljs$lang$applyTo = function($seq114451_seq114451__$1$$) {
  var $G__114452$$ = $APP.cljs.core.first($seq114451_seq114451__$1$$);
  $seq114451_seq114451__$1$$ = $APP.cljs.core.next($seq114451_seq114451__$1$$);
  return this.cljs$core$IFn$_invoke$arity$variadic($G__114452$$, $seq114451_seq114451__$1$$);
};
mathbox.primitives = {};
mathbox.primitives.base = {};
mathbox.primitives.base.Group = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Group);
mathbox.primitives.base.Inherit = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Inherit);
mathbox.primitives.base.Unit = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Unit);
mathbox.primitives.camera = {};
mathbox.primitives.camera.Camera = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Camera);
mathbox.primitives.data = {};
mathbox.primitives.data.Area = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Area);
mathbox.primitives.data.Array = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Array);
mathbox.primitives.data.Interval = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Interval);
mathbox.primitives.data.Matrix = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Matrix);
mathbox.primitives.data.Scale = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Scale);
mathbox.primitives.data.Volume = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Volume);
mathbox.primitives.data.Voxel = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Voxel);
mathbox.primitives.draw = {};
mathbox.primitives.draw.Axis = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Axis);
mathbox.primitives.draw.Face = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Face);
mathbox.primitives.draw.Grid = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Grid);
mathbox.primitives.draw.Line = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Line);
mathbox.primitives.draw.Point = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Point);
mathbox.primitives.draw.Strip = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Strip);
mathbox.primitives.draw.Surface = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Surface);
mathbox.primitives.draw.Ticks = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Ticks);
mathbox.primitives.draw.Vector = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Vector);
mathbox.primitives.operator = {};
mathbox.primitives.operator.Clamp = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Clamp);
mathbox.primitives.operator.Grow = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Grow);
mathbox.primitives.operator.Join = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Join);
mathbox.primitives.operator.Lerp = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Lerp);
mathbox.primitives.operator.Memo = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Memo);
mathbox.primitives.operator.Readback = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Readback);
mathbox.primitives.operator.Repeat = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Repeat);
mathbox.primitives.operator.Resample = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Resample);
mathbox.primitives.operator.Slice = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Slice);
mathbox.primitives.operator.Split = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Split);
mathbox.primitives.operator.Spread = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Spread);
mathbox.primitives.operator.Subdivide = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Subdivide);
mathbox.primitives.operator.Swizzle = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Swizzle);
mathbox.primitives.operator.Transpose = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Transpose);
mathbox.primitives.overlay = {};
mathbox.primitives.overlay.Dom = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Dom);
mathbox.primitives.overlay.Html = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Html);
mathbox.primitives.present = {};
mathbox.primitives.present.Move = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Move);
mathbox.primitives.present.Play = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Play);
mathbox.primitives.present.Present = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Present);
mathbox.primitives.present.Reveal = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Reveal);
mathbox.primitives.present.Slide = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Slide);
mathbox.primitives.present.Step = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Step);
mathbox.primitives.rtt = {};
mathbox.primitives.rtt.Compose = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Compose);
mathbox.primitives.rtt.Rtt = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Rtt);
mathbox.primitives.shader = {};
mathbox.primitives.shader.Shader = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Shader);
mathbox.primitives.text = {};
mathbox.primitives.text.Format = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Format);
mathbox.primitives.text.Label = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Label);
mathbox.primitives.text.Retext = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Retext);
mathbox.primitives.text.Text = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Text);
mathbox.primitives.time = {};
mathbox.primitives.time.Clock = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Clock);
mathbox.primitives.time.Now = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Now);
mathbox.primitives.transform = {};
mathbox.primitives.transform.Fragment = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Fragment);
mathbox.primitives.transform.Layer = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Layer);
mathbox.primitives.transform.Mask = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Mask);
mathbox.primitives.transform.Transform = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Transform);
mathbox.primitives.transform.Transform4 = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Transform4);
mathbox.primitives.transform.Vertex = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Vertex);
mathbox.primitives.view = {};
mathbox.primitives.view.Cartesian = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Cartesian);
mathbox.primitives.view.Cartesian4 = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Cartesian4);
mathbox.primitives.view.Polar = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Polar);
mathbox.primitives.view.Spherical = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Spherical);
mathbox.primitives.view.Stereographic = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Stereographic);
mathbox.primitives.view.Stereographic4 = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.Stereographic4);
mathbox.primitives.view.View = $APP.reagent.core.adapt_react_class(module$node_modules$mathbox_react$build$cjs$index.View);
mathbox.primitives.Group = mathbox.primitives.base.Group;
mathbox.primitives.Inherit = mathbox.primitives.base.Inherit;
mathbox.primitives.Unit = mathbox.primitives.base.Unit;
mathbox.primitives.Camera = mathbox.primitives.camera.Camera;
mathbox.primitives.Area = mathbox.primitives.data.Area;
mathbox.primitives.Array = mathbox.primitives.data.Array;
mathbox.primitives.Interval = mathbox.primitives.data.Interval;
mathbox.primitives.Matrix = mathbox.primitives.data.Matrix;
mathbox.primitives.Scale = mathbox.primitives.data.Scale;
mathbox.primitives.Volume = mathbox.primitives.data.Volume;
mathbox.primitives.Voxel = mathbox.primitives.data.Voxel;
mathbox.primitives.Axis = mathbox.primitives.draw.Axis;
mathbox.primitives.Face = mathbox.primitives.draw.Face;
mathbox.primitives.Grid = mathbox.primitives.draw.Grid;
mathbox.primitives.Line = mathbox.primitives.draw.Line;
mathbox.primitives.Point = mathbox.primitives.draw.Point;
mathbox.primitives.Strip = mathbox.primitives.draw.Strip;
mathbox.primitives.Surface = mathbox.primitives.draw.Surface;
mathbox.primitives.Ticks = mathbox.primitives.draw.Ticks;
mathbox.primitives.Vector = mathbox.primitives.draw.Vector;
mathbox.primitives.Clamp = mathbox.primitives.operator.Clamp;
mathbox.primitives.Grow = mathbox.primitives.operator.Grow;
mathbox.primitives.Join = mathbox.primitives.operator.Join;
mathbox.primitives.Lerp = mathbox.primitives.operator.Lerp;
mathbox.primitives.Memo = mathbox.primitives.operator.Memo;
mathbox.primitives.Readback = mathbox.primitives.operator.Readback;
mathbox.primitives.Repeat = mathbox.primitives.operator.Repeat;
mathbox.primitives.Resample = mathbox.primitives.operator.Resample;
mathbox.primitives.Slice = mathbox.primitives.operator.Slice;
mathbox.primitives.Split = mathbox.primitives.operator.Split;
mathbox.primitives.Spread = mathbox.primitives.operator.Spread;
mathbox.primitives.Subdivide = mathbox.primitives.operator.Subdivide;
mathbox.primitives.Swizzle = mathbox.primitives.operator.Swizzle;
mathbox.primitives.Transpose = mathbox.primitives.operator.Transpose;
mathbox.primitives.Dom = mathbox.primitives.overlay.Dom;
mathbox.primitives.Html = mathbox.primitives.overlay.Html;
mathbox.primitives.Move = mathbox.primitives.present.Move;
mathbox.primitives.Play = mathbox.primitives.present.Play;
mathbox.primitives.Present = mathbox.primitives.present.Present;
mathbox.primitives.Reveal = mathbox.primitives.present.Reveal;
mathbox.primitives.Slide = mathbox.primitives.present.Slide;
mathbox.primitives.Step = mathbox.primitives.present.Step;
mathbox.primitives.Compose = mathbox.primitives.rtt.Compose;
mathbox.primitives.Rtt = mathbox.primitives.rtt.Rtt;
mathbox.primitives.Shader = mathbox.primitives.shader.Shader;
mathbox.primitives.Format = mathbox.primitives.text.Format;
mathbox.primitives.Label = mathbox.primitives.text.Label;
mathbox.primitives.Retext = mathbox.primitives.text.Retext;
mathbox.primitives.Text = mathbox.primitives.text.Text;
mathbox.primitives.Clock = mathbox.primitives.time.Clock;
mathbox.primitives.Now = mathbox.primitives.time.Now;
mathbox.primitives.Fragment = mathbox.primitives.transform.Fragment;
mathbox.primitives.Layer = mathbox.primitives.transform.Layer;
mathbox.primitives.Mask = mathbox.primitives.transform.Mask;
mathbox.primitives.Transform = mathbox.primitives.transform.Transform;
mathbox.primitives.Transform4 = mathbox.primitives.transform.Transform4;
mathbox.primitives.Vertex = mathbox.primitives.transform.Vertex;
mathbox.primitives.Cartesian = mathbox.primitives.view.Cartesian;
mathbox.primitives.Cartesian4 = mathbox.primitives.view.Cartesian4;
mathbox.primitives.Polar = mathbox.primitives.view.Polar;
mathbox.primitives.Spherical = mathbox.primitives.view.Spherical;
mathbox.primitives.Stereographic = mathbox.primitives.view.Stereographic;
mathbox.primitives.Stereographic4 = mathbox.primitives.view.Stereographic4;
mathbox.primitives.View = mathbox.primitives.view.View;
$APP.scittle.mathbox = {};
$APP.scittle.mathbox.init = function() {
  return $APP.scittle.core.register_plugin_BANG_(cljs$cst$9562$scittle_DOT_mathbox_SLASH_mathbox, new $APP.cljs.core.PersistentArrayMap(null, 1, [$APP.cljs$cst$398$namespaces, new $APP.cljs.core.PersistentArrayMap(null, 2, [cljs$cst$9563$mathbox_DOT_core, $APP.sci.core._copy_ns(new $APP.cljs.core.PersistentArrayMap(null, 2, [cljs$cst$9564$threestrap_defaults, new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9565$mathbox_DOT_core_SLASH_threestrap_defaults, $APP.cljs$cst$108$val, 
  mathbox.core.threestrap_defaults, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), $APP.cljs.core.with_meta(cljs$cst$9566$MathBox, new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$273$arglists, $APP.cljs.core.list($APP.cljs$cst$167$quote, $APP.cljs.core.list(new $APP.cljs.core.PersistentVector(null, 3, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$APP.cljs$cst$5746$props, $APP.cljs$cst$148$_AMPERSAND_, $APP.cljs$cst$3091$children], null))), $APP.cljs$cst$256$doc, 
  'Component that configures a MathBox-backed canvas and reactively mounts all\n  children into the canvas.\n\n  Supports the following options:\n\n  - `:threestrap`: these options are passed directly to the [mathbox\n    constructor](https://github.com/unconed/mathbox#basic-usage) on instantiation;\n    these are in turn passed along to Threestrap\'s `Bootstrap` constructor.\n    See [this page](https://github.com/unconed/threestrap#plugins) for an example\n    of what to pass and why.\n\n  - `:renderer`: optional map with `:background-color` and `:background-opacity`\n    keys. Updating these will update the settings without a re-render.\n\n  - `:controls`: optional map with `:max-distance` and `:rotate-speed` keys.\n    Updating these will update the settings on the registered controls without a\n    re-render.\n\n  - `:on`: optional map of type {\x3cevent-name\x3e (fn [event three] ,,,)} On mount,\n    each event will be bound via `mathbox.three.on`, as described in [Threestrap\'s\n    docs](https://github.com/unconed/threestrap#events).\n\n  - `:ref`: a 1-arg function that receives the underlying mathbox instance\n    whenever it changes. Note that you may receive `nil` and should guard against\n    it.\n\n  As well as all options used to configure the [base/root\n  component](https://github.com/unconed/mathbox/blob/master/docs/primitives.md#base/root). (The\n  format of each following line is \x3ckeyword\x3e: \x3cdefault\x3e (\x3ctype\x3e) -\n  \x3cdescription\x3e.)\n\n  - `:camera`: `"[camera]"` (select) - Active camera\n  - `:classes`: `[]` (string array) - Custom classes, e.g. `["big"]`\n  - `:focus`: `1` (nullable number) - Camera focus distance in world units\n  - `:fov`: `null` (nullable number) - (Vertical) Field-of-view to calibrate units for (degrees), e.g. `60`\n  - `:id`: `null` (nullable string) - Unique ID, e.g. `"sampler"`\n  - `:pass`: `"view"` (vertexPass) - Vertex pass (data, view, world, eye)\n  - `:scale`: `null` (nullable number) - (Vertical) Reference scale of viewport in pixels, e.g. `720`\n  - `:speed`: `1` (number) - Global speed', 
  $APP.cljs$cst$1377$top_fn, new $APP.cljs.core.PersistentArrayMap(null, 6, [$APP.cljs$cst$1378$variadic_QMARK_, !0, $APP.cljs$cst$553$fixed_arity, 1, $APP.cljs$cst$1379$max_fixed_arity, 1, $APP.cljs$cst$1380$method_params, new $APP.cljs.core.PersistentVector(null, 1, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$APP.cljs.core.list($APP.cljs$cst$5746$props, $APP.cljs$cst$3091$children)], null), $APP.cljs$cst$273$arglists, $APP.cljs.core.list(new $APP.cljs.core.PersistentVector(null, 3, 5, $APP.cljs.core.PersistentVector.EMPTY_NODE, 
  [$APP.cljs$cst$5746$props, $APP.cljs$cst$148$_AMPERSAND_, $APP.cljs$cst$3091$children], null)), $APP.cljs$cst$1381$arglists_meta, $APP.cljs.core.list(null)], null)], null)), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9567$mathbox_DOT_core_SLASH_MathBox, $APP.cljs$cst$108$val, mathbox.core.MathBox, $APP.cljs$cst$2$meta, new $APP.cljs.core.PersistentArrayMap(null, 2, [$APP.cljs$cst$273$arglists, $APP.cljs.core.list(new $APP.cljs.core.PersistentVector(null, 3, 
  5, $APP.cljs.core.PersistentVector.EMPTY_NODE, [$APP.cljs$cst$5746$props, $APP.cljs$cst$148$_AMPERSAND_, $APP.cljs$cst$3091$children], null)), $APP.cljs$cst$256$doc, 'Component that configures a MathBox-backed canvas and reactively mounts all\n  children into the canvas.\n\n  Supports the following options:\n\n  - `:threestrap`: these options are passed directly to the [mathbox\n    constructor](https://github.com/unconed/mathbox#basic-usage) on instantiation;\n    these are in turn passed along to Threestrap\'s `Bootstrap` constructor.\n    See [this page](https://github.com/unconed/threestrap#plugins) for an example\n    of what to pass and why.\n\n  - `:renderer`: optional map with `:background-color` and `:background-opacity`\n    keys. Updating these will update the settings without a re-render.\n\n  - `:controls`: optional map with `:max-distance` and `:rotate-speed` keys.\n    Updating these will update the settings on the registered controls without a\n    re-render.\n\n  - `:on`: optional map of type {\x3cevent-name\x3e (fn [event three] ,,,)} On mount,\n    each event will be bound via `mathbox.three.on`, as described in [Threestrap\'s\n    docs](https://github.com/unconed/threestrap#events).\n\n  - `:ref`: a 1-arg function that receives the underlying mathbox instance\n    whenever it changes. Note that you may receive `nil` and should guard against\n    it.\n\n  As well as all options used to configure the [base/root\n  component](https://github.com/unconed/mathbox/blob/master/docs/primitives.md#base/root). (The\n  format of each following line is \x3ckeyword\x3e: \x3cdefault\x3e (\x3ctype\x3e) -\n  \x3cdescription\x3e.)\n\n  - `:camera`: `"[camera]"` (select) - Active camera\n  - `:classes`: `[]` (string array) - Custom classes, e.g. `["big"]`\n  - `:focus`: `1` (nullable number) - Camera focus distance in world units\n  - `:fov`: `null` (nullable number) - (Vertical) Field-of-view to calibrate units for (degrees), e.g. `60`\n  - `:id`: `null` (nullable string) - Unique ID, e.g. `"sampler"`\n  - `:pass`: `"view"` (vertexPass) - Vertex pass (data, view, world, eye)\n  - `:scale`: `null` (nullable number) - (Vertical) Reference scale of viewport in pixels, e.g. `720`\n  - `:speed`: `1` (number) - Global speed'], 
  null)], null)], null), $APP.sci.core.create_ns.cljs$core$IFn$_invoke$arity$2(cljs$cst$9563$mathbox_DOT_core, null)), cljs$cst$9568$mathbox_DOT_primitives, $APP.sci.core._copy_ns($APP.cljs.core.PersistentHashMap.fromArrays([cljs$cst$9569$Swizzle, cljs$cst$9570$Spread, cljs$cst$9571$Rtt, $APP.cljs$cst$6076$Array, cljs$cst$9572$Face, cljs$cst$9573$Area, cljs$cst$9574$Transform, cljs$cst$9575$Retext, cljs$cst$9576$Point, cljs$cst$9577$Subdivide, cljs$cst$9578$Volume, cljs$cst$9579$Slide, cljs$cst$9580$Matrix, 
  cljs$cst$9581$Play, cljs$cst$9582$Transform4, cljs$cst$9583$Surface, cljs$cst$9584$Cartesian, cljs$cst$9585$Label, cljs$cst$9586$Line, cljs$cst$9587$Mask, cljs$cst$9588$Polar, cljs$cst$9589$Clamp, cljs$cst$9590$Ticks, cljs$cst$9591$Inherit, cljs$cst$9592$Html, cljs$cst$9593$Grow, cljs$cst$9594$Text, cljs$cst$9595$Strip, cljs$cst$9596$Cartesian4, cljs$cst$9597$Present, cljs$cst$9598$Voxel, cljs$cst$9599$Shader, cljs$cst$9600$Scale, cljs$cst$9601$View, cljs$cst$9602$Format, cljs$cst$9603$Camera, 
  cljs$cst$9604$Stereographic, cljs$cst$9605$Split, cljs$cst$9606$Move, cljs$cst$9607$Axis, cljs$cst$9608$Grid, cljs$cst$9609$Unit, cljs$cst$9610$Vector, cljs$cst$9611$Join, cljs$cst$9612$Transpose, cljs$cst$9613$Repeat, cljs$cst$9614$Readback, cljs$cst$9615$Interval, cljs$cst$9616$Vertex, cljs$cst$9617$Stereographic4, cljs$cst$9618$Reveal, cljs$cst$9619$Lerp, cljs$cst$9620$Memo, cljs$cst$9621$Fragment, cljs$cst$9622$Layer, cljs$cst$9623$Compose, cljs$cst$9624$Dom, cljs$cst$9625$Now, cljs$cst$9626$Resample, 
  cljs$cst$9627$Slice, cljs$cst$9628$Group, cljs$cst$9629$Step, cljs$cst$9630$Clock, cljs$cst$9631$Spherical], [new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9632$mathbox_DOT_primitives_SLASH_Swizzle, $APP.cljs$cst$108$val, mathbox.primitives.Swizzle, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9633$mathbox_DOT_primitives_SLASH_Spread, $APP.cljs$cst$108$val, 
  mathbox.primitives.Spread, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9634$mathbox_DOT_primitives_SLASH_Rtt, $APP.cljs$cst$108$val, mathbox.primitives.Rtt, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9635$mathbox_DOT_primitives_SLASH_Array, $APP.cljs$cst$108$val, mathbox.primitives.Array, 
  $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9636$mathbox_DOT_primitives_SLASH_Face, $APP.cljs$cst$108$val, mathbox.primitives.Face, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9637$mathbox_DOT_primitives_SLASH_Area, $APP.cljs$cst$108$val, mathbox.primitives.Area, $APP.cljs$cst$2$meta, 
  $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9638$mathbox_DOT_primitives_SLASH_Transform, $APP.cljs$cst$108$val, mathbox.primitives.Transform, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9639$mathbox_DOT_primitives_SLASH_Retext, $APP.cljs$cst$108$val, mathbox.primitives.Retext, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], 
  null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9640$mathbox_DOT_primitives_SLASH_Point, $APP.cljs$cst$108$val, mathbox.primitives.Point, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9641$mathbox_DOT_primitives_SLASH_Subdivide, $APP.cljs$cst$108$val, mathbox.primitives.Subdivide, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), 
  new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9642$mathbox_DOT_primitives_SLASH_Volume, $APP.cljs$cst$108$val, mathbox.primitives.Volume, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9643$mathbox_DOT_primitives_SLASH_Slide, $APP.cljs$cst$108$val, mathbox.primitives.Slide, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 
  3, [$APP.cljs$cst$272$name, cljs$cst$9644$mathbox_DOT_primitives_SLASH_Matrix, $APP.cljs$cst$108$val, mathbox.primitives.Matrix, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9645$mathbox_DOT_primitives_SLASH_Play, $APP.cljs$cst$108$val, mathbox.primitives.Play, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, 
  cljs$cst$9646$mathbox_DOT_primitives_SLASH_Transform4, $APP.cljs$cst$108$val, mathbox.primitives.Transform4, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9647$mathbox_DOT_primitives_SLASH_Surface, $APP.cljs$cst$108$val, mathbox.primitives.Surface, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9648$mathbox_DOT_primitives_SLASH_Cartesian, 
  $APP.cljs$cst$108$val, mathbox.primitives.Cartesian, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9649$mathbox_DOT_primitives_SLASH_Label, $APP.cljs$cst$108$val, mathbox.primitives.Label, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9650$mathbox_DOT_primitives_SLASH_Line, $APP.cljs$cst$108$val, 
  mathbox.primitives.Line, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9651$mathbox_DOT_primitives_SLASH_Mask, $APP.cljs$cst$108$val, mathbox.primitives.Mask, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9652$mathbox_DOT_primitives_SLASH_Polar, $APP.cljs$cst$108$val, mathbox.primitives.Polar, 
  $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9653$mathbox_DOT_primitives_SLASH_Clamp, $APP.cljs$cst$108$val, mathbox.primitives.Clamp, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9654$mathbox_DOT_primitives_SLASH_Ticks, $APP.cljs$cst$108$val, mathbox.primitives.Ticks, $APP.cljs$cst$2$meta, 
  $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9655$mathbox_DOT_primitives_SLASH_Inherit, $APP.cljs$cst$108$val, mathbox.primitives.Inherit, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9656$mathbox_DOT_primitives_SLASH_Html, $APP.cljs$cst$108$val, mathbox.primitives.Html, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], 
  null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9657$mathbox_DOT_primitives_SLASH_Grow, $APP.cljs$cst$108$val, mathbox.primitives.Grow, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9658$mathbox_DOT_primitives_SLASH_Text, $APP.cljs$cst$108$val, mathbox.primitives.Text, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 
  3, [$APP.cljs$cst$272$name, cljs$cst$9659$mathbox_DOT_primitives_SLASH_Strip, $APP.cljs$cst$108$val, mathbox.primitives.Strip, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9660$mathbox_DOT_primitives_SLASH_Cartesian4, $APP.cljs$cst$108$val, mathbox.primitives.Cartesian4, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, 
  cljs$cst$9661$mathbox_DOT_primitives_SLASH_Present, $APP.cljs$cst$108$val, mathbox.primitives.Present, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9662$mathbox_DOT_primitives_SLASH_Voxel, $APP.cljs$cst$108$val, mathbox.primitives.Voxel, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9663$mathbox_DOT_primitives_SLASH_Shader, 
  $APP.cljs$cst$108$val, mathbox.primitives.Shader, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9664$mathbox_DOT_primitives_SLASH_Scale, $APP.cljs$cst$108$val, mathbox.primitives.Scale, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9665$mathbox_DOT_primitives_SLASH_View, $APP.cljs$cst$108$val, 
  mathbox.primitives.View, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9666$mathbox_DOT_primitives_SLASH_Format, $APP.cljs$cst$108$val, mathbox.primitives.Format, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9667$mathbox_DOT_primitives_SLASH_Camera, $APP.cljs$cst$108$val, mathbox.primitives.Camera, 
  $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9668$mathbox_DOT_primitives_SLASH_Stereographic, $APP.cljs$cst$108$val, mathbox.primitives.Stereographic, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9669$mathbox_DOT_primitives_SLASH_Split, $APP.cljs$cst$108$val, mathbox.primitives.Split, 
  $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9670$mathbox_DOT_primitives_SLASH_Move, $APP.cljs$cst$108$val, mathbox.primitives.Move, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9671$mathbox_DOT_primitives_SLASH_Axis, $APP.cljs$cst$108$val, mathbox.primitives.Axis, $APP.cljs$cst$2$meta, 
  $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9672$mathbox_DOT_primitives_SLASH_Grid, $APP.cljs$cst$108$val, mathbox.primitives.Grid, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9673$mathbox_DOT_primitives_SLASH_Unit, $APP.cljs$cst$108$val, mathbox.primitives.Unit, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], 
  null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9674$mathbox_DOT_primitives_SLASH_Vector, $APP.cljs$cst$108$val, mathbox.primitives.Vector, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9675$mathbox_DOT_primitives_SLASH_Join, $APP.cljs$cst$108$val, mathbox.primitives.Join, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 
  3, [$APP.cljs$cst$272$name, cljs$cst$9676$mathbox_DOT_primitives_SLASH_Transpose, $APP.cljs$cst$108$val, mathbox.primitives.Transpose, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9677$mathbox_DOT_primitives_SLASH_Repeat, $APP.cljs$cst$108$val, mathbox.primitives.Repeat, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, 
  cljs$cst$9678$mathbox_DOT_primitives_SLASH_Readback, $APP.cljs$cst$108$val, mathbox.primitives.Readback, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9679$mathbox_DOT_primitives_SLASH_Interval, $APP.cljs$cst$108$val, mathbox.primitives.Interval, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9680$mathbox_DOT_primitives_SLASH_Vertex, 
  $APP.cljs$cst$108$val, mathbox.primitives.Vertex, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9681$mathbox_DOT_primitives_SLASH_Stereographic4, $APP.cljs$cst$108$val, mathbox.primitives.Stereographic4, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9682$mathbox_DOT_primitives_SLASH_Reveal, 
  $APP.cljs$cst$108$val, mathbox.primitives.Reveal, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9683$mathbox_DOT_primitives_SLASH_Lerp, $APP.cljs$cst$108$val, mathbox.primitives.Lerp, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9684$mathbox_DOT_primitives_SLASH_Memo, $APP.cljs$cst$108$val, 
  mathbox.primitives.Memo, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9685$mathbox_DOT_primitives_SLASH_Fragment, $APP.cljs$cst$108$val, mathbox.primitives.Fragment, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9686$mathbox_DOT_primitives_SLASH_Layer, $APP.cljs$cst$108$val, mathbox.primitives.Layer, 
  $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9687$mathbox_DOT_primitives_SLASH_Compose, $APP.cljs$cst$108$val, mathbox.primitives.Compose, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9688$mathbox_DOT_primitives_SLASH_Dom, $APP.cljs$cst$108$val, mathbox.primitives.Dom, $APP.cljs$cst$2$meta, 
  $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9689$mathbox_DOT_primitives_SLASH_Now, $APP.cljs$cst$108$val, mathbox.primitives.Now, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9690$mathbox_DOT_primitives_SLASH_Resample, $APP.cljs$cst$108$val, mathbox.primitives.Resample, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], 
  null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9691$mathbox_DOT_primitives_SLASH_Slice, $APP.cljs$cst$108$val, mathbox.primitives.Slice, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9692$mathbox_DOT_primitives_SLASH_Group, $APP.cljs$cst$108$val, mathbox.primitives.Group, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 
  3, [$APP.cljs$cst$272$name, cljs$cst$9693$mathbox_DOT_primitives_SLASH_Step, $APP.cljs$cst$108$val, mathbox.primitives.Step, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, cljs$cst$9694$mathbox_DOT_primitives_SLASH_Clock, $APP.cljs$cst$108$val, mathbox.primitives.Clock, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null), new $APP.cljs.core.PersistentArrayMap(null, 3, [$APP.cljs$cst$272$name, 
  cljs$cst$9695$mathbox_DOT_primitives_SLASH_Spherical, $APP.cljs$cst$108$val, mathbox.primitives.Spherical, $APP.cljs$cst$2$meta, $APP.cljs.core.PersistentArrayMap.EMPTY], null)]), $APP.sci.core.create_ns.cljs$core$IFn$_invoke$arity$2(cljs$cst$9568$mathbox_DOT_primitives, null))], null)], null));
};
$APP.scittle.mathbox.init();

}).call(this);